[
  {"title": "决策树算法及实现", "url": "http://blog.jobbole.com/112206/", "url_object_id": "20f251db4302493feab2277f2e28cf93", "create_date": "2017/08/16", "front_image_url": ["http://jbcdn2.b0.upaiyun.com/2017/08/d5e765a446f9f0cf17c21b596186d3b9.png"], "praise_nums": "1", "fav_nums": 0, "comment_nums": 0, "tags": "IT技术,决策树,算法", "content": "<div class=\"entry\">\r\n\r\n        \t\t\t<div class=\"textwidget\"></div>\n\t\t\r\n\t\t<div class=\"copyright-area\">原文出处： <a target=\"_blank\" href=\"http://www.jianshu.com/p/c4d0837e9439\">ZPPenny</a>   </div><p>在计算机科学中，树是一种很重要的数据结构，比如我们最为熟悉的二叉查找树（Binary Search Tree），红黑树（Red-Black Tree）等，通过引入树这种数据结构，我们可以很快地缩小问题规模，实现高效的查找。</p>\n<p>在监督学习中，面对样本中复杂多样的特征，选取什么样的策略可以实现较高的学习效率和较好的分类效果一直是科学家们探索的目标。那么，树这种结构到底可以如何用于机器学习中呢？我们先从一个游戏开始。</p>\n<p>我们应该都玩过或者听过这么一种游戏：游戏中，出题者写下一个明星的名字，其他人需要猜出这个人是谁。当然，如果游戏规则仅此而已的话，几乎是无法猜出来的，因为问题的规模太大了。为了降低游戏的难度，答题者可以向出题者问问题，而出题者必须准确回答是或者否，答题者依据回答提出下一个问题，如果能够在指定次数内确定谜底，即为胜出。加入了问答规则之后，我们是否有可能猜出谜底呢？我们先实验一下，现在我已经写下了一个影视明星的名字，而你和我的问答记录如下：</p>\n<ol>\n<li>是男的吗？Y</li>\n<li>是亚洲人吗？Y</li>\n<li>是中国人吗？N</li>\n<li>是印度人吗？Y</li>\n<li> ……</li>\n</ol>\n<p>虽然只有短短四个问题，但是我们已经把答案的范围大大缩小了，那么接下，第5个问题你应该如何问呢？我相信你应该基本可以锁定答案了，因为我看过的印度电影就那么几部。我们将上面的信息结构化如下图所示：</p>\n<p><a href=\"http://jbcdn2.b0.upaiyun.com/2017/08/d5e765a446f9f0cf17c21b596186d3b9.png\"><img class=\"aligncenter wp-image-112208 size-full\" src=\"http://jbcdn2.b0.upaiyun.com/2017/08/d5e765a446f9f0cf17c21b596186d3b9.png\" alt=\"2119554-bfc7f93e51ee6786\" width=\"521\" height=\"257\"></a></p>\n<p>在上面的游戏中，我们针对性的提出问题，每一个问题都可以将我们的答案范围缩小，在提问中和回答者有相同知识背景的前提下，得出答案的难度比我们想象的要小很多。</p>\n<p>回到我们最初的问题中，如何将树结构用于机器学习中？结合上面的图，我们可以看出，在每一个节点，依据问题答案，可以将答案划分为左右两个分支，左分支代表的是Yes，右分支代表的是No，虽然为了简化，我们只画出了其中的一条路径，但是也可以明显看出这是一个树形结构，这便是决策树的原型。</p>\n<h1>1. 决策树算法简介</h1>\n<p>我们面对的样本通常具有很多个特征，正所谓对事物的判断不能只从一个角度，那如何结合不同的特征呢？决策树算法的思想是，先从一个特征入手，就如同我们上面的游戏中一样，既然无法直接分类，那就先根据一个特征进行分类，虽然分类结果达不到理想效果，但是通过这次分类，我们的问题规模变小了，同时分类后的子集相比原来的样本集更加易于分类了。然后针对上一次分类后的样本子集，重复这个过程。在理想的情况下，经过多层的决策分类，我们将得到完全纯净的子集，也就是每一个子集中的样本都属于同一个分类。<a href=\"http://jbcdn2.b0.upaiyun.com/2017/08/4e67fca8490cef73a42855761c896291.png\"><img class=\"aligncenter wp-image-112209 size-full\" src=\"http://jbcdn2.b0.upaiyun.com/2017/08/4e67fca8490cef73a42855761c896291.png\" alt=\"2119554-bfc7f93e51ee6786\" width=\"395\" height=\"376\"></a>比如上图中，平面坐标中的六个点，我们无法通过其x坐标或者y坐标直接就将两类点分开。采用决策树算法思想：我们先依据y坐标将六个点划分为两个子类（如水平线所示），水平线上面的两个点是同一个分类，但是水平线之下的四个点是不纯净的。但是没关系，我们对这四个点进行再次分类，这次我们以x左边分类（见图中的竖线），通过两层分类，我们实现了对样本点的完全分类。这样，我们的决策树的伪代码实现如下：</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-599440e2a043e044546882\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-always\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"复制代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\nif y &gt; a:\r\n    output dot\r\nelse:\r\n    if x &lt; b:\r\n          output cross\r\n    else:\r\n          output dot</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-599440e2a043e044546882-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599440e2a043e044546882-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-599440e2a043e044546882-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599440e2a043e044546882-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-599440e2a043e044546882-5\">5</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599440e2a043e044546882-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-599440e2a043e044546882-7\">7</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-599440e2a043e044546882-1\"><span class=\"crayon-st\">if</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">y</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">a</span><span class=\"crayon-o\">:</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599440e2a043e044546882-2\"><span class=\"crayon-h\">    </span><span class=\"crayon-e\">output </span><span class=\"crayon-e\">dot</span></div><div class=\"crayon-line\" id=\"crayon-599440e2a043e044546882-3\"><span class=\"crayon-st\">else</span><span class=\"crayon-o\">:</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599440e2a043e044546882-4\"><span class=\"crayon-h\">    </span><span class=\"crayon-st\">if</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">x</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">b</span><span class=\"crayon-o\">:</span></div><div class=\"crayon-line\" id=\"crayon-599440e2a043e044546882-5\"><span class=\"crayon-h\">          </span><span class=\"crayon-e\">output </span><span class=\"crayon-e\">cross</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599440e2a043e044546882-6\"><span class=\"crayon-e\">    </span><span class=\"crayon-st\">else</span><span class=\"crayon-o\">:</span></div><div class=\"crayon-line\" id=\"crayon-599440e2a043e044546882-7\"><span class=\"crayon-h\">          </span><span class=\"crayon-e\">output </span><span class=\"crayon-v\">dot</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0009 seconds] -->\r\n<p>由这个分类的过程形成一个树形的判决模型，树的每一个非叶子节点都是一个特征分割点，叶子节点是最终的决策分类。如下图所示：<a href=\"http://jbcdn2.b0.upaiyun.com/2017/08/7c7879e3286895e28cdd65ffa0da4740.png\"><img class=\"aligncenter wp-image-112210 size-full\" src=\"http://jbcdn2.b0.upaiyun.com/2017/08/7c7879e3286895e28cdd65ffa0da4740.png\" alt=\"2119554-bfc7f93e51ee6786\" width=\"423\" height=\"298\"></a>将新样本输入决策树进行判决时，就是将样本在决策树上自顶向下，依据决策树的节点规则进行遍历，最终落入的叶子节点就是该样本所属的分类。</p>\n<h1>2 决策树算法流程</h1>\n<p>上面我们介绍决策树算法的思想，可以简单归纳为如下两点：</p>\n<ol>\n<li>每次选择其中一个特征对样本集进行分类</li>\n<li>对分类后的子集递归进行步骤1</li>\n</ol>\n<p>看起来是不是也太简单了呢？实际上每一个步骤我们还有很多考虑的。在第一个步骤中，我们需要考虑的一个最重要的策略是，选取什么样的特征可以实现最好的分类效果，而所谓的分类效果好坏，必然也需要一个评价的指标。在上文中，我们都用纯净来说明分类效果好，那何为纯净呢？直观来说就是集合中样本所属类别比较集中，最理想的是样本都属于同一个分类。样本集的纯度可以用<a href=\"https://en.wikipedia.org/wiki/Entropy_(information_theory)\" target=\"_blank\">熵</a>来进行衡量。</p>\n<p>在信息论中，熵代表了一个系统的混乱程度，熵越大，说明我们的数据集纯度越低，当我们的数据集都是同一个类别的时候，熵为0，熵的计算公式如下：</p>\n<p><a href=\"https://wikimedia.org/api/rest_v1/media/math/render/svg/9017e7f5171f1770f8bd702487f297b77df8a907\"><img class=\"aligncenter\" src=\"https://wikimedia.org/api/rest_v1/media/math/render/svg/9017e7f5171f1770f8bd702487f297b77df8a907\" width=\"390\" height=\"56\"></a></p>\n<p>其中，P(xi)表示概率，b在此处取2。比如抛硬币的时候，正面的概率就是1/2，反面的概率也是1/2，那么这个过程的熵为：<a href=\"https://wikimedia.org/api/rest_v1/media/math/render/svg/0d5eab2ab8165e547d69a5fb49db1c18cb1518ef\"><img class=\"aligncenter\" src=\"https://wikimedia.org/api/rest_v1/media/math/render/svg/0d5eab2ab8165e547d69a5fb49db1c18cb1518ef\" width=\"649\" height=\"59\"></a>可见，由于抛硬币是一个完全随机事件，其结果正面和反面是等概率的，所以具有很高的熵。假如我们观察的是硬币最终飞行的方向，那么硬币最后往下落的概率是1，往天上飞的概率是0，带入上面的公式中，可以得到这个过程的熵为0，所以，熵越小，结果的可预测性就越强。在决策树的生成过程中，我们的目标就是要划分后的子集中其熵最小，这样后续的的迭代中，就更容易对其进行分类。</p>\n<p>既然是递归过程，那么就需要制定递归的停止规则。在两种情况下我们停止进一步对子集进行划分，其一是划分已经达到可以理想效果了，另外一种就是进一步划分收效甚微，不值得再继续了。用专业术语总结终止条件有以下几个：</p>\n<ol>\n<li>子集的熵达到阈值</li>\n<li>子集规模够小</li>\n<li>进一步划分的增益小于阈值</li>\n</ol>\n<p style=\"text-align: left\">其中，条件3中的增益代表的是一次划分对数据纯度的提升效果，也就是划分以后，熵减少越多，说明增益越大，那么这次划分也就越有价值，增益的计算公式如下：<a href=\"//upload-images.jianshu.io/upload_images/2119554-ed959b962943ebaf.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240\"><img class=\"aligncenter\" src=\"//upload-images.jianshu.io/upload_images/2119554-ed959b962943ebaf.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240\" alt=\"Gain\" width=\"316\" height=\"60\"></a></p>\n<p style=\"text-align: center\">Gain</p>\n<p>上述公式可以理解为：计算这次划分之后两个子集的熵之和相对划分之前的熵减少了多少，需要注意的是，计算子集的熵之和需要乘上各个子集的权重，权重的计算方法是子集的规模占分割前父集的比重，比如划分前熵为e，划分为子集A和B，大小分别为m和n，熵分别为e1和e2，那么增益就是<strong><span style=\"color: #ff0000\"><code>e - m/(m + n) * e1 - n/(m + n) * e2</code>。</span></strong></p>\n<h1>3. 决策树算法实现</h1>\n<p>有了上述概念，我们就可以开始开始决策树的训练了，训练过程分为：</p>\n<ol>\n<li>选取特征，分割样本集</li>\n<li>计算增益，如果增益够大，将分割后的样本集作为决策树的子节点，否则停止分割</li>\n<li>递归执行上两步</li>\n</ol>\n<p>上述步骤是依照ID3的算法思想（依据信息增益进行特征选取和分裂），除此之外还有C4.5以及CART等决策树算法。</p>\n<p>算法框架如下：</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-599440e2a044e647518364\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-always\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"复制代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\nclass DecisionTree(object):\r\n    def fit(self, X, y):\r\n        # 依据输入样本生成决策树\r\n        self.root = self._build_tree(X, y)\r\n\r\n    def _build_tree(self, X, y, current_depth=0):\r\n        #1. 选取最佳分割特征，生成左右节点\r\n        #2. 针对左右节点递归生成子树\r\n      \r\n    def predict_value(self, x, tree=None):\r\n        # 将输入样本传入决策树中，自顶向下进行判定\r\n        # 到达叶子节点即为预测值</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-599440e2a044e647518364-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599440e2a044e647518364-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-599440e2a044e647518364-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599440e2a044e647518364-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-599440e2a044e647518364-5\">5</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599440e2a044e647518364-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-599440e2a044e647518364-7\">7</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599440e2a044e647518364-8\">8</div><div class=\"crayon-num\" data-line=\"crayon-599440e2a044e647518364-9\">9</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599440e2a044e647518364-10\">10</div><div class=\"crayon-num\" data-line=\"crayon-599440e2a044e647518364-11\">11</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599440e2a044e647518364-12\">12</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-599440e2a044e647518364-1\"><span class=\"crayon-t\">class</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">DecisionTree</span><span class=\"crayon-sy\">(</span><span class=\"crayon-t\">object</span><span class=\"crayon-sy\">)</span><span class=\"crayon-o\">:</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599440e2a044e647518364-2\"><span class=\"crayon-h\">    </span><span class=\"crayon-e\">def </span><span class=\"crayon-e\">fit</span><span class=\"crayon-sy\">(</span><span class=\"crayon-r\">self</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">X</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">y</span><span class=\"crayon-sy\">)</span><span class=\"crayon-o\">:</span></div><div class=\"crayon-line\" id=\"crayon-599440e2a044e647518364-3\"><span class=\"crayon-h\">        </span><span class=\"crayon-p\"># 依据输入样本生成决策树</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599440e2a044e647518364-4\"><span class=\"crayon-h\">        </span><span class=\"crayon-r\">self</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">root</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-r\">self</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">_build_tree</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">X</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">y</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line\" id=\"crayon-599440e2a044e647518364-5\"> </div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599440e2a044e647518364-6\"><span class=\"crayon-h\">    </span><span class=\"crayon-e\">def </span><span class=\"crayon-e\">_build_tree</span><span class=\"crayon-sy\">(</span><span class=\"crayon-r\">self</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">X</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">y</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">current_depth</span><span class=\"crayon-o\">=</span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">)</span><span class=\"crayon-o\">:</span></div><div class=\"crayon-line\" id=\"crayon-599440e2a044e647518364-7\"><span class=\"crayon-h\">        </span><span class=\"crayon-p\">#1. 选取最佳分割特征，生成左右节点</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599440e2a044e647518364-8\"><span class=\"crayon-h\">        </span><span class=\"crayon-p\">#2. 针对左右节点递归生成子树</span></div><div class=\"crayon-line\" id=\"crayon-599440e2a044e647518364-9\"><span class=\"crayon-h\">      </span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599440e2a044e647518364-10\"><span class=\"crayon-h\">    </span><span class=\"crayon-e\">def </span><span class=\"crayon-e\">predict_value</span><span class=\"crayon-sy\">(</span><span class=\"crayon-r\">self</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">x</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">tree</span><span class=\"crayon-o\">=</span><span class=\"crayon-v\">None</span><span class=\"crayon-sy\">)</span><span class=\"crayon-o\">:</span></div><div class=\"crayon-line\" id=\"crayon-599440e2a044e647518364-11\"><span class=\"crayon-h\">        </span><span class=\"crayon-p\"># 将输入样本传入决策树中，自顶向下进行判定</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599440e2a044e647518364-12\"><span class=\"crayon-h\">        </span><span class=\"crayon-p\"># 到达叶子节点即为预测值</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0018 seconds] -->\r\n<p>在上述代码中，实现决策树的关键是递归构造子树的过程，为了实现这个过程，我们需要做好三件事：分别是节点的定义，最佳分割特征的选择，递归生成子树。</p>\n<h2>3.1 节点定义</h2>\n<p>决策树的目的是用于分类预测，即各个节点需要选取输入样本的<strong>特征</strong>，进行<strong>规则</strong>判定，最终决定样本归属到哪一棵<strong>子树</strong>，基于这个目的，决策树的每一个节点需要包含以下几个关键信息：</p>\n<ol>\n<li>判决特征：当前节点针对哪一个特征进行判决</li>\n<li>判决规则：对于二类问题，这个规则一般是一个布尔表达式</li>\n<li>左子树：判决为TRUE的样本</li>\n<li>右子树：判决为FALSE的样本</li>\n</ol>\n<p>决策树节点的定义代码如下所示：</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-599440e2a0453270706044\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-always\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"复制代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\nclass DecisionNode():\r\n    \r\n    def __init__(self, feature_i=None, threshold=None,\r\n                 value=None, true_branch=None, false_branch=None):\r\n        self.feature_i = feature_i  # 用于测试的特征对应的索引\r\n        self.threshold = threshold  # 判断规则：&gt;=threshold为true\r\n        self.value = value  # 如果是叶子节点，用于保存预测结果\r\n        self.true_branch = true_branch  # 左子树\r\n        self.false_branch = false_branch  # 右子树</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-599440e2a0453270706044-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599440e2a0453270706044-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-599440e2a0453270706044-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599440e2a0453270706044-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-599440e2a0453270706044-5\">5</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599440e2a0453270706044-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-599440e2a0453270706044-7\">7</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599440e2a0453270706044-8\">8</div><div class=\"crayon-num\" data-line=\"crayon-599440e2a0453270706044-9\">9</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-599440e2a0453270706044-1\"><span class=\"crayon-t\">class</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">DecisionNode</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">)</span><span class=\"crayon-o\">:</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599440e2a0453270706044-2\"><span class=\"crayon-h\">    </span></div><div class=\"crayon-line\" id=\"crayon-599440e2a0453270706044-3\"><span class=\"crayon-h\">    </span><span class=\"crayon-e\">def </span><span class=\"crayon-e\">__init__</span><span class=\"crayon-sy\">(</span><span class=\"crayon-r\">self</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">feature_i</span><span class=\"crayon-o\">=</span><span class=\"crayon-v\">None</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">threshold</span><span class=\"crayon-o\">=</span><span class=\"crayon-v\">None</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599440e2a0453270706044-4\"><span class=\"crayon-h\">                 </span><span class=\"crayon-v\">value</span><span class=\"crayon-o\">=</span><span class=\"crayon-v\">None</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">true_branch</span><span class=\"crayon-o\">=</span><span class=\"crayon-v\">None</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">false_branch</span><span class=\"crayon-o\">=</span><span class=\"crayon-v\">None</span><span class=\"crayon-sy\">)</span><span class=\"crayon-o\">:</span></div><div class=\"crayon-line\" id=\"crayon-599440e2a0453270706044-5\"><span class=\"crayon-h\">        </span><span class=\"crayon-r\">self</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">feature_i</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">feature_i</span><span class=\"crayon-h\">  </span><span class=\"crayon-p\"># 用于测试的特征对应的索引</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599440e2a0453270706044-6\"><span class=\"crayon-h\">        </span><span class=\"crayon-r\">self</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">threshold</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">threshold</span><span class=\"crayon-h\">  </span><span class=\"crayon-p\"># 判断规则：&gt;=threshold为true</span></div><div class=\"crayon-line\" id=\"crayon-599440e2a0453270706044-7\"><span class=\"crayon-h\">        </span><span class=\"crayon-r\">self</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">value</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">value</span><span class=\"crayon-h\">  </span><span class=\"crayon-p\"># 如果是叶子节点，用于保存预测结果</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599440e2a0453270706044-8\"><span class=\"crayon-h\">        </span><span class=\"crayon-r\">self</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">true_branch</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">true_branch</span><span class=\"crayon-h\">  </span><span class=\"crayon-p\"># 左子树</span></div><div class=\"crayon-line\" id=\"crayon-599440e2a0453270706044-9\"><span class=\"crayon-h\">        </span><span class=\"crayon-r\">self</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">false_branch</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">false_branch</span><span class=\"crayon-h\">  </span><span class=\"crayon-p\"># 右子树</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0022 seconds] -->\r\n<p></p>\n<h2>3.2 特征选取</h2>\n<p>特征选取是构造决策树最关键的步骤，其目的是选出能够实现分割结果最纯净的那个特征，其操作流程的代码如下：</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-599440e2a0457798596815\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-always\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"复制代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\n# 遍历样本集中的所有特征，针对每一个特征计算最佳分割点\r\n# 再选取最佳的分割特征\r\nfor feature_i in range(n_features):\r\n    # 遍历集合中某个特征的所有取值\r\n    for threshold in unique_values:\r\n        # 以当前特征值作为阈值进行分割\r\n        Xy1, Xy2 = divide_on_feature(X_y, feature_i, threshold)\r\n        # 计算分割后的增益\r\n        gain = gain(y, y1, y2)\r\n        # 记录最佳分割特征，最佳分割阈值\r\n        if gain &gt; largest_gain:\r\n        largest_gain = gain\r\n            best_criteria = {\r\n                \"feature_i\": feature_i, \r\n                \"threshold\": threshold \r\n                }</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-599440e2a0457798596815-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599440e2a0457798596815-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-599440e2a0457798596815-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599440e2a0457798596815-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-599440e2a0457798596815-5\">5</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599440e2a0457798596815-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-599440e2a0457798596815-7\">7</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599440e2a0457798596815-8\">8</div><div class=\"crayon-num\" data-line=\"crayon-599440e2a0457798596815-9\">9</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599440e2a0457798596815-10\">10</div><div class=\"crayon-num\" data-line=\"crayon-599440e2a0457798596815-11\">11</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599440e2a0457798596815-12\">12</div><div class=\"crayon-num\" data-line=\"crayon-599440e2a0457798596815-13\">13</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599440e2a0457798596815-14\">14</div><div class=\"crayon-num\" data-line=\"crayon-599440e2a0457798596815-15\">15</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599440e2a0457798596815-16\">16</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-599440e2a0457798596815-1\"><span class=\"crayon-p\"># 遍历样本集中的所有特征，针对每一个特征计算最佳分割点</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599440e2a0457798596815-2\"><span class=\"crayon-p\"># 再选取最佳的分割特征</span></div><div class=\"crayon-line\" id=\"crayon-599440e2a0457798596815-3\"><span class=\"crayon-st\">for</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">feature_i </span><span class=\"crayon-st\">in</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">range</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">n_features</span><span class=\"crayon-sy\">)</span><span class=\"crayon-o\">:</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599440e2a0457798596815-4\"><span class=\"crayon-h\">    </span><span class=\"crayon-p\"># 遍历集合中某个特征的所有取值</span></div><div class=\"crayon-line\" id=\"crayon-599440e2a0457798596815-5\"><span class=\"crayon-h\">    </span><span class=\"crayon-st\">for</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">threshold </span><span class=\"crayon-st\">in</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">unique_values</span><span class=\"crayon-o\">:</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599440e2a0457798596815-6\"><span class=\"crayon-h\">        </span><span class=\"crayon-p\"># 以当前特征值作为阈值进行分割</span></div><div class=\"crayon-line\" id=\"crayon-599440e2a0457798596815-7\"><span class=\"crayon-h\">        </span><span class=\"crayon-v\">Xy1</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Xy2</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">divide_on_feature</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">X_y</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">feature_i</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">threshold</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599440e2a0457798596815-8\"><span class=\"crayon-h\">        </span><span class=\"crayon-p\"># 计算分割后的增益</span></div><div class=\"crayon-line\" id=\"crayon-599440e2a0457798596815-9\"><span class=\"crayon-h\">        </span><span class=\"crayon-v\">gain</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">gain</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">y</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">y1</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">y2</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599440e2a0457798596815-10\"><span class=\"crayon-h\">        </span><span class=\"crayon-p\"># 记录最佳分割特征，最佳分割阈值</span></div><div class=\"crayon-line\" id=\"crayon-599440e2a0457798596815-11\"><span class=\"crayon-h\">        </span><span class=\"crayon-st\">if</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">gain</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">largest_gain</span><span class=\"crayon-o\">:</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599440e2a0457798596815-12\"><span class=\"crayon-h\">        </span><span class=\"crayon-v\">largest_gain</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">gain</span></div><div class=\"crayon-line\" id=\"crayon-599440e2a0457798596815-13\"><span class=\"crayon-e\">            </span><span class=\"crayon-v\">best_criteria</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599440e2a0457798596815-14\"><span class=\"crayon-h\">                </span><span class=\"crayon-s\">\"feature_i\"</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">feature_i</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span></div><div class=\"crayon-line\" id=\"crayon-599440e2a0457798596815-15\"><span class=\"crayon-h\">                </span><span class=\"crayon-s\">\"threshold\"</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">threshold</span><span class=\"crayon-h\"> </span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599440e2a0457798596815-16\"><span class=\"crayon-h\">                </span><span class=\"crayon-sy\">}</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0026 seconds] -->\r\n<p></p>\n<h2>3.3 节点分裂</h2>\n<p>节点分裂的时候有两条处理分支，如果增益够大，就分裂为左右子树，如果增益很小，就停止分裂，将这个节点直接作为叶子节点。节点分裂和Gain（分割后增益）的计算可以做一个优化，在上一个步骤中，我们寻找最优分割点的时候其实就可以将最佳分裂子集和Gain计算并保存下来，将上一步中的for循环改写为：</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-599440e2a045b225737515\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-always\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"复制代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\n# 以当前特征值作为阈值进行分割\r\nXy1, Xy2 = divide_on_feature(X_y, feature_i, threshold)\r\n# 计算分割后的熵\r\ngain = gain(y, y1, y2)\r\n# 记录最佳分割特征，最佳分割阈值\r\nif gain &gt; largest_gain:\r\n    largest_gain = gain\r\n        best_criteria = {\r\n        \"feature_i\": feature_i, \r\n        \"threshold\": threshold ,\r\n        }\r\n    best_sets = {\r\n        \"left\": Xy1,\r\n        \"right\": Xy2,\r\n        \"gain\": gain\r\n        }</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-599440e2a045b225737515-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599440e2a045b225737515-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-599440e2a045b225737515-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599440e2a045b225737515-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-599440e2a045b225737515-5\">5</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599440e2a045b225737515-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-599440e2a045b225737515-7\">7</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599440e2a045b225737515-8\">8</div><div class=\"crayon-num\" data-line=\"crayon-599440e2a045b225737515-9\">9</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599440e2a045b225737515-10\">10</div><div class=\"crayon-num\" data-line=\"crayon-599440e2a045b225737515-11\">11</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599440e2a045b225737515-12\">12</div><div class=\"crayon-num\" data-line=\"crayon-599440e2a045b225737515-13\">13</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599440e2a045b225737515-14\">14</div><div class=\"crayon-num\" data-line=\"crayon-599440e2a045b225737515-15\">15</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599440e2a045b225737515-16\">16</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-599440e2a045b225737515-1\"><span class=\"crayon-p\"># 以当前特征值作为阈值进行分割</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599440e2a045b225737515-2\"><span class=\"crayon-v\">Xy1</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Xy2</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">divide_on_feature</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">X_y</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">feature_i</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">threshold</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line\" id=\"crayon-599440e2a045b225737515-3\"><span class=\"crayon-p\"># 计算分割后的熵</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599440e2a045b225737515-4\"><span class=\"crayon-v\">gain</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">gain</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">y</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">y1</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">y2</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line\" id=\"crayon-599440e2a045b225737515-5\"><span class=\"crayon-p\"># 记录最佳分割特征，最佳分割阈值</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599440e2a045b225737515-6\"><span class=\"crayon-st\">if</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">gain</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">largest_gain</span><span class=\"crayon-o\">:</span></div><div class=\"crayon-line\" id=\"crayon-599440e2a045b225737515-7\"><span class=\"crayon-h\">    </span><span class=\"crayon-v\">largest_gain</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">gain</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599440e2a045b225737515-8\"><span class=\"crayon-e\">        </span><span class=\"crayon-v\">best_criteria</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-599440e2a045b225737515-9\"><span class=\"crayon-h\">        </span><span class=\"crayon-s\">\"feature_i\"</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">feature_i</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599440e2a045b225737515-10\"><span class=\"crayon-h\">        </span><span class=\"crayon-s\">\"threshold\"</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">threshold</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line\" id=\"crayon-599440e2a045b225737515-11\"><span class=\"crayon-h\">        </span><span class=\"crayon-sy\">}</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599440e2a045b225737515-12\"><span class=\"crayon-h\">    </span><span class=\"crayon-v\">best_sets</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-599440e2a045b225737515-13\"><span class=\"crayon-h\">        </span><span class=\"crayon-s\">\"left\"</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Xy1</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599440e2a045b225737515-14\"><span class=\"crayon-h\">        </span><span class=\"crayon-s\">\"right\"</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Xy2</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line\" id=\"crayon-599440e2a045b225737515-15\"><span class=\"crayon-h\">        </span><span class=\"crayon-s\">\"gain\"</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">gain</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599440e2a045b225737515-16\"><span class=\"crayon-h\">        </span><span class=\"crayon-sy\">}</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0024 seconds] -->\r\n<p>为了防止过拟合，需要设置合适的停止条件，比如设置Gain的阈值，如果Gain比较小，就没有必要继续进行分割，所以接下来，我们就可以依据gain来决定分割策略：</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-599440e2a045e265106629\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-always\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"复制代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\nif best_sets[\"gain\"] &gt; MIN_GAIN:\r\n    # 对best_sets[\"left\"]进一步构造子树，并作为父节点的左子树\r\n    # 对best_sets[\"right\"]进一步构造子树，并作为父节点的右子树\r\n    ...\r\nelse:\r\n    # 直接将父节点作为叶子节点\r\n    ...</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-599440e2a045e265106629-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599440e2a045e265106629-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-599440e2a045e265106629-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599440e2a045e265106629-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-599440e2a045e265106629-5\">5</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599440e2a045e265106629-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-599440e2a045e265106629-7\">7</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-599440e2a045e265106629-1\"><span class=\"crayon-st\">if</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">best_sets</span><span class=\"crayon-sy\">[</span><span class=\"crayon-s\">\"gain\"</span><span class=\"crayon-sy\">]</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">MIN_GAIN</span><span class=\"crayon-o\">:</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599440e2a045e265106629-2\"><span class=\"crayon-h\">    </span><span class=\"crayon-p\"># 对best_sets[\"left\"]进一步构造子树，并作为父节点的左子树</span></div><div class=\"crayon-line\" id=\"crayon-599440e2a045e265106629-3\"><span class=\"crayon-h\">    </span><span class=\"crayon-p\"># 对best_sets[\"right\"]进一步构造子树，并作为父节点的右子树</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599440e2a045e265106629-4\"><span class=\"crayon-h\">    </span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span></div><div class=\"crayon-line\" id=\"crayon-599440e2a045e265106629-5\"><span class=\"crayon-st\">else</span><span class=\"crayon-o\">:</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599440e2a045e265106629-6\"><span class=\"crayon-h\">    </span><span class=\"crayon-p\"># 直接将父节点作为叶子节点</span></div><div class=\"crayon-line\" id=\"crayon-599440e2a045e265106629-7\"><span class=\"crayon-h\">    </span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0008 seconds] -->\r\n<p>下面，我们结合一组实验数据来学习决策树的训练方法。实验数据来源于<a href=\"http://www.onlamp.com/pub/a/python/2006/02/09/ai_decision_trees.html\" target=\"_blank\">这里</a>，下表中的数据是一组消费调查结果，我们训练决策树的目的，就是构造一个分类算法，使得有新的用户数据时，我们依据训练结果去推断一个用户是否购买这个商品：</p>\n<table>\n<thead>\n<tr>\n<th>AGE</th>\n<th>EDUCATION</th>\n<th>INCOME</th>\n<th>MARITAL STATUS</th>\n<th>PURCHASE?</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>36-55</td>\n<td>master’s</td>\n<td>high</td>\n<td>single</td>\n<td>yes</td>\n</tr>\n<tr>\n<td>18-35</td>\n<td>high school</td>\n<td>low</td>\n<td>single</td>\n<td>no</td>\n</tr>\n<tr>\n<td>36-55</td>\n<td>master’s</td>\n<td>low</td>\n<td>single</td>\n<td>yes</td>\n</tr>\n<tr>\n<td>18-35</td>\n<td>bachelor’s</td>\n<td>high</td>\n<td>single</td>\n<td>no</td>\n</tr>\n<tr>\n<td> &lt; 18</td>\n<td>high school</td>\n<td>low</td>\n<td>single</td>\n<td>yes</td>\n</tr>\n<tr>\n<td>18-35</td>\n<td>bachelor’s</td>\n<td>high</td>\n<td>married</td>\n<td>no</td>\n</tr>\n<tr>\n<td>36-55</td>\n<td>bachelor’s</td>\n<td>low</td>\n<td>married</td>\n<td>no</td>\n</tr>\n<tr>\n<td>&gt; 55</td>\n<td>bachelor’s</td>\n<td>high</td>\n<td>single</td>\n<td>yes</td>\n</tr>\n<tr>\n<td>36-55</td>\n<td>master’s</td>\n<td>low</td>\n<td>married</td>\n<td>no</td>\n</tr>\n<tr>\n<td>&gt; 55</td>\n<td>master’s</td>\n<td>low</td>\n<td>married</td>\n<td>yes</td>\n</tr>\n<tr>\n<td>36-55</td>\n<td>master’s</td>\n<td>high</td>\n<td>single</td>\n<td>yes</td>\n</tr>\n<tr>\n<td>&gt; 55</td>\n<td>master’s</td>\n<td>high</td>\n<td>single</td>\n<td>yes</td>\n</tr>\n<tr>\n<td>18</td>\n<td>high school</td>\n<td>high</td>\n<td>single</td>\n<td>no</td>\n</tr>\n<tr>\n<td>36-55</td>\n<td>master’s</td>\n<td>low</td>\n<td>single</td>\n<td>yes</td>\n</tr>\n<tr>\n<td>36-55</td>\n<td>high school</td>\n<td>low</td>\n<td>single</td>\n<td>yes</td>\n</tr>\n<tr>\n<td> &lt; 18</td>\n<td>high school</td>\n<td>low</td>\n<td>married</td>\n<td>yes</td>\n</tr>\n<tr>\n<td>18-35</td>\n<td>bachelor’s</td>\n<td>high</td>\n<td>married</td>\n<td>no</td>\n</tr>\n<tr>\n<td>&gt; 55</td>\n<td>high school</td>\n<td>high</td>\n<td>married</td>\n<td>yes</td>\n</tr>\n<tr>\n<td>&gt; 55</td>\n<td>bachelor’s</td>\n<td>low</td>\n<td>single</td>\n<td>yes</td>\n</tr>\n<tr>\n<td>36-55</td>\n<td>high school</td>\n<td>high</td>\n<td>married</td>\n<td>no</td>\n</tr>\n</tbody>\n</table>\n<p>从表中可以看出，我们一共有20组调查样本，每一组样本包含四个特征，分别是年龄段，学历，收入，婚姻状况，而最后一列是所属分类，在这个问题中就代表是否购买了该产品。</p>\n<p>监督学习就是在每一个样本都有正确答案的前提下，用算法预测结果，然后根据预测情况的好坏，调整算法参数。在决策树中，预测的过程就是依据各个特征划分样本集，评价预测结果的好坏标准是划分结果的纯度。</p>\n<p>为了方便处理，我们对样本数据进行了简化，将年龄特征按照样本的特点，转化为离散的数据，比如小于18对应0，18对应1，18-35对应2，36-55对应3，大于55对应4，以此类推，同样其他的特征也一样最数字化处理，教育水平分别映射为0(hight school)，1(bachelor’s)，2(master’s)，收入映射为0(low)和1(hight), 婚姻状况同样映射为0(single), 1(married)，最终处理后的样本，放到一个numpy矩阵中，如下所示：</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-599440e2a0464446290606\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-always\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"复制代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\nX_y = np.array(\r\n        [[3, 2, 1, 0, 1],\r\n         [2, 0, 0, 0, 0],\r\n         [3, 2, 0, 0, 1],\r\n         [2, 1, 1, 0, 0],\r\n         [0, 0, 0, 0, 1],\r\n         [2, 1, 1, 1, 0],\r\n         [3, 1, 0, 1, 0],\r\n         [4, 1, 1, 0, 1],\r\n         [3, 2, 0, 1, 0],\r\n         [4, 2, 0, 1, 1],\r\n         [3, 2, 1, 0, 1],\r\n         [4, 2, 1, 0, 1],\r\n         [1, 0, 1, 0, 0],\r\n         [3, 2, 0, 0, 1],\r\n         [3, 0, 0, 0, 1],\r\n         [0, 0, 0, 1, 1],\r\n         [2, 1, 1, 1, 0],\r\n         [4, 0, 1, 1, 1],\r\n         [4, 1, 0, 0, 1],\r\n         [3, 0, 1, 1, 0]]\r\n    )</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-599440e2a0464446290606-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599440e2a0464446290606-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-599440e2a0464446290606-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599440e2a0464446290606-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-599440e2a0464446290606-5\">5</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599440e2a0464446290606-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-599440e2a0464446290606-7\">7</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599440e2a0464446290606-8\">8</div><div class=\"crayon-num\" data-line=\"crayon-599440e2a0464446290606-9\">9</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599440e2a0464446290606-10\">10</div><div class=\"crayon-num\" data-line=\"crayon-599440e2a0464446290606-11\">11</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599440e2a0464446290606-12\">12</div><div class=\"crayon-num\" data-line=\"crayon-599440e2a0464446290606-13\">13</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599440e2a0464446290606-14\">14</div><div class=\"crayon-num\" data-line=\"crayon-599440e2a0464446290606-15\">15</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599440e2a0464446290606-16\">16</div><div class=\"crayon-num\" data-line=\"crayon-599440e2a0464446290606-17\">17</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599440e2a0464446290606-18\">18</div><div class=\"crayon-num\" data-line=\"crayon-599440e2a0464446290606-19\">19</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599440e2a0464446290606-20\">20</div><div class=\"crayon-num\" data-line=\"crayon-599440e2a0464446290606-21\">21</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599440e2a0464446290606-22\">22</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-599440e2a0464446290606-1\"><span class=\"crayon-v\">X_y</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">np</span><span class=\"crayon-sy\">.</span><span class=\"crayon-t\">array</span><span class=\"crayon-sy\">(</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599440e2a0464446290606-2\"><span class=\"crayon-h\">        </span><span class=\"crayon-sy\">[</span><span class=\"crayon-sy\">[</span><span class=\"crayon-cn\">3</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">2</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">1</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">1</span><span class=\"crayon-sy\">]</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line\" id=\"crayon-599440e2a0464446290606-3\"><span class=\"crayon-h\">         </span><span class=\"crayon-sy\">[</span><span class=\"crayon-cn\">2</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">]</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599440e2a0464446290606-4\"><span class=\"crayon-h\">         </span><span class=\"crayon-sy\">[</span><span class=\"crayon-cn\">3</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">2</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">1</span><span class=\"crayon-sy\">]</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line\" id=\"crayon-599440e2a0464446290606-5\"><span class=\"crayon-h\">         </span><span class=\"crayon-sy\">[</span><span class=\"crayon-cn\">2</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">1</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">1</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">]</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599440e2a0464446290606-6\"><span class=\"crayon-h\">         </span><span class=\"crayon-sy\">[</span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">1</span><span class=\"crayon-sy\">]</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line\" id=\"crayon-599440e2a0464446290606-7\"><span class=\"crayon-h\">         </span><span class=\"crayon-sy\">[</span><span class=\"crayon-cn\">2</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">1</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">1</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">1</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">]</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599440e2a0464446290606-8\"><span class=\"crayon-h\">         </span><span class=\"crayon-sy\">[</span><span class=\"crayon-cn\">3</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">1</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">1</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">]</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line\" id=\"crayon-599440e2a0464446290606-9\"><span class=\"crayon-h\">         </span><span class=\"crayon-sy\">[</span><span class=\"crayon-cn\">4</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">1</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">1</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">1</span><span class=\"crayon-sy\">]</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599440e2a0464446290606-10\"><span class=\"crayon-h\">         </span><span class=\"crayon-sy\">[</span><span class=\"crayon-cn\">3</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">2</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">1</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">]</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line\" id=\"crayon-599440e2a0464446290606-11\"><span class=\"crayon-h\">         </span><span class=\"crayon-sy\">[</span><span class=\"crayon-cn\">4</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">2</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">1</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">1</span><span class=\"crayon-sy\">]</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599440e2a0464446290606-12\"><span class=\"crayon-h\">         </span><span class=\"crayon-sy\">[</span><span class=\"crayon-cn\">3</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">2</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">1</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">1</span><span class=\"crayon-sy\">]</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line\" id=\"crayon-599440e2a0464446290606-13\"><span class=\"crayon-h\">         </span><span class=\"crayon-sy\">[</span><span class=\"crayon-cn\">4</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">2</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">1</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">1</span><span class=\"crayon-sy\">]</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599440e2a0464446290606-14\"><span class=\"crayon-h\">         </span><span class=\"crayon-sy\">[</span><span class=\"crayon-cn\">1</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">1</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">]</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line\" id=\"crayon-599440e2a0464446290606-15\"><span class=\"crayon-h\">         </span><span class=\"crayon-sy\">[</span><span class=\"crayon-cn\">3</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">2</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">1</span><span class=\"crayon-sy\">]</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599440e2a0464446290606-16\"><span class=\"crayon-h\">         </span><span class=\"crayon-sy\">[</span><span class=\"crayon-cn\">3</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">1</span><span class=\"crayon-sy\">]</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line\" id=\"crayon-599440e2a0464446290606-17\"><span class=\"crayon-h\">         </span><span class=\"crayon-sy\">[</span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">1</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">1</span><span class=\"crayon-sy\">]</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599440e2a0464446290606-18\"><span class=\"crayon-h\">         </span><span class=\"crayon-sy\">[</span><span class=\"crayon-cn\">2</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">1</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">1</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">1</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">]</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line\" id=\"crayon-599440e2a0464446290606-19\"><span class=\"crayon-h\">         </span><span class=\"crayon-sy\">[</span><span class=\"crayon-cn\">4</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">1</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">1</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">1</span><span class=\"crayon-sy\">]</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599440e2a0464446290606-20\"><span class=\"crayon-h\">         </span><span class=\"crayon-sy\">[</span><span class=\"crayon-cn\">4</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">1</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">1</span><span class=\"crayon-sy\">]</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line\" id=\"crayon-599440e2a0464446290606-21\"><span class=\"crayon-h\">         </span><span class=\"crayon-sy\">[</span><span class=\"crayon-cn\">3</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">1</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">1</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">]</span><span class=\"crayon-sy\">]</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599440e2a0464446290606-22\"><span class=\"crayon-h\">    </span><span class=\"crayon-sy\">)</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0063 seconds] -->\r\n<p></p>\n<h1>4. 新样本预测</h1>\n<p>依照上面的算法构造决策树，我们将决策树打印出来，如下所示：</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-599440e2a0476760109504\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-always\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"复制代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\n-- Classification Tree --\r\n0 : 4? \r\n   T -&gt; 1\r\n   F -&gt; 3 : 1? \r\n      T -&gt; 0 : 2? \r\n            T -&gt; 0\r\n            F -&gt; 1\r\n      F -&gt; 0 : 3? \r\n            T -&gt; 1\r\n            F -&gt; 0 : 1? \r\n                        T -&gt; 0\r\n                        F -&gt; 1</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-599440e2a0476760109504-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599440e2a0476760109504-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-599440e2a0476760109504-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599440e2a0476760109504-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-599440e2a0476760109504-5\">5</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599440e2a0476760109504-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-599440e2a0476760109504-7\">7</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599440e2a0476760109504-8\">8</div><div class=\"crayon-num\" data-line=\"crayon-599440e2a0476760109504-9\">9</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599440e2a0476760109504-10\">10</div><div class=\"crayon-num\" data-line=\"crayon-599440e2a0476760109504-11\">11</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599440e2a0476760109504-12\">12</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-599440e2a0476760109504-1\"><span class=\"crayon-o\">--</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">Classification </span><span class=\"crayon-v\">Tree</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">--</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599440e2a0476760109504-2\"><span class=\"crayon-cn\">0</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">4</span><span class=\"crayon-sy\">?</span><span class=\"crayon-h\"> </span></div><div class=\"crayon-line\" id=\"crayon-599440e2a0476760109504-3\"><span class=\"crayon-h\">   </span><span class=\"crayon-v\">T</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">1</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599440e2a0476760109504-4\"><span class=\"crayon-h\">   </span><span class=\"crayon-v\">F</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">3</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">1</span><span class=\"crayon-sy\">?</span><span class=\"crayon-h\"> </span></div><div class=\"crayon-line\" id=\"crayon-599440e2a0476760109504-5\"><span class=\"crayon-h\">      </span><span class=\"crayon-v\">T</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">2</span><span class=\"crayon-sy\">?</span><span class=\"crayon-h\"> </span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599440e2a0476760109504-6\"><span class=\"crayon-h\">            </span><span class=\"crayon-v\">T</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span></div><div class=\"crayon-line\" id=\"crayon-599440e2a0476760109504-7\"><span class=\"crayon-h\">            </span><span class=\"crayon-v\">F</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">1</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599440e2a0476760109504-8\"><span class=\"crayon-h\">      </span><span class=\"crayon-v\">F</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">3</span><span class=\"crayon-sy\">?</span><span class=\"crayon-h\"> </span></div><div class=\"crayon-line\" id=\"crayon-599440e2a0476760109504-9\"><span class=\"crayon-h\">            </span><span class=\"crayon-v\">T</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">1</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599440e2a0476760109504-10\"><span class=\"crayon-h\">            </span><span class=\"crayon-v\">F</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">1</span><span class=\"crayon-sy\">?</span><span class=\"crayon-h\"> </span></div><div class=\"crayon-line\" id=\"crayon-599440e2a0476760109504-11\"><span class=\"crayon-h\">                        </span><span class=\"crayon-v\">T</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599440e2a0476760109504-12\"><span class=\"crayon-h\">                        </span><span class=\"crayon-v\">F</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">1</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0021 seconds] -->\r\n<p>其中，冒号前代表选择的分割特征，冒号后面代表判别规则，二者组合起来就是一个决策树的非叶子节点，每个非叶子节点进一步分割为分为True和False分支，对于叶子节点箭头后面表示最终分类，0表示不购买，1表示购买。由于我们的数据做过简化，所以上述结果不太直观，我们将对应的特征以及判断规则翻译一下：</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-599440e2a047b772924694\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-always\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"复制代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\n年龄 : 大于55? \r\n   是 -&gt; 购买\r\n   否 -&gt; 收入 : 高? \r\n      是 -&gt; 年龄 : 大于18? \r\n            是 -&gt; 不购买\r\n            否 -&gt; 购买\r\n      否 -&gt; 年龄 : 大于36? \r\n            是 -&gt; 购买\r\n            否 -&gt; 年龄 : 大于等于18? \r\n                        是 -&gt; 不购买\r\n                        否 -&gt; 购买</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-599440e2a047b772924694-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599440e2a047b772924694-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-599440e2a047b772924694-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599440e2a047b772924694-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-599440e2a047b772924694-5\">5</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599440e2a047b772924694-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-599440e2a047b772924694-7\">7</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599440e2a047b772924694-8\">8</div><div class=\"crayon-num\" data-line=\"crayon-599440e2a047b772924694-9\">9</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599440e2a047b772924694-10\">10</div><div class=\"crayon-num\" data-line=\"crayon-599440e2a047b772924694-11\">11</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-599440e2a047b772924694-1\">年龄<span class=\"crayon-h\"> </span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span>大于<span class=\"crayon-cn\">55</span><span class=\"crayon-sy\">?</span><span class=\"crayon-h\"> </span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599440e2a047b772924694-2\"><span class=\"crayon-h\">   </span>是<span class=\"crayon-h\"> </span><span class=\"crayon-o\">-&gt;</span><span class=\"crayon-h\"> </span>购买</div><div class=\"crayon-line\" id=\"crayon-599440e2a047b772924694-3\"><span class=\"crayon-h\">   </span>否<span class=\"crayon-h\"> </span><span class=\"crayon-o\">-&gt;</span><span class=\"crayon-h\"> </span>收入<span class=\"crayon-h\"> </span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span>高<span class=\"crayon-sy\">?</span><span class=\"crayon-h\"> </span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599440e2a047b772924694-4\"><span class=\"crayon-h\">      </span>是<span class=\"crayon-h\"> </span><span class=\"crayon-o\">-&gt;</span><span class=\"crayon-h\"> </span>年龄<span class=\"crayon-h\"> </span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span>大于<span class=\"crayon-cn\">18</span><span class=\"crayon-sy\">?</span><span class=\"crayon-h\"> </span></div><div class=\"crayon-line\" id=\"crayon-599440e2a047b772924694-5\"><span class=\"crayon-h\">            </span>是<span class=\"crayon-h\"> </span><span class=\"crayon-o\">-&gt;</span><span class=\"crayon-h\"> </span>不购买</div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599440e2a047b772924694-6\"><span class=\"crayon-h\">            </span>否<span class=\"crayon-h\"> </span><span class=\"crayon-o\">-&gt;</span><span class=\"crayon-h\"> </span>购买</div><div class=\"crayon-line\" id=\"crayon-599440e2a047b772924694-7\"><span class=\"crayon-h\">      </span>否<span class=\"crayon-h\"> </span><span class=\"crayon-o\">-&gt;</span><span class=\"crayon-h\"> </span>年龄<span class=\"crayon-h\"> </span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span>大于<span class=\"crayon-cn\">36</span><span class=\"crayon-sy\">?</span><span class=\"crayon-h\"> </span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599440e2a047b772924694-8\"><span class=\"crayon-h\">            </span>是<span class=\"crayon-h\"> </span><span class=\"crayon-o\">-&gt;</span><span class=\"crayon-h\"> </span>购买</div><div class=\"crayon-line\" id=\"crayon-599440e2a047b772924694-9\"><span class=\"crayon-h\">            </span>否<span class=\"crayon-h\"> </span><span class=\"crayon-o\">-&gt;</span><span class=\"crayon-h\"> </span>年龄<span class=\"crayon-h\"> </span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span>大于等于<span class=\"crayon-cn\">18</span><span class=\"crayon-sy\">?</span><span class=\"crayon-h\"> </span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599440e2a047b772924694-10\"><span class=\"crayon-h\">                        </span>是<span class=\"crayon-h\"> </span><span class=\"crayon-o\">-&gt;</span><span class=\"crayon-h\"> </span>不购买</div><div class=\"crayon-line\" id=\"crayon-599440e2a047b772924694-11\"><span class=\"crayon-h\">                        </span>否<span class=\"crayon-h\"> </span><span class=\"crayon-o\">-&gt;</span><span class=\"crayon-h\"> </span>购买</div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0022 seconds] -->\r\n<p>决策树构造完之后，我们就可以用来进行新样本的分类了。决策树的预测过程十分容易理解，只需要将从根节点开始，按照节点定义的规则进行判决，选择对应的子树，并重复这个过程，直到叶子节点即可。决策树的预测功能实现代码如下：</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-599440e2a047e567849042\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-always\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"复制代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\ndef predict_value(self, x, tree=None):\r\n        # 如果当前节点是叶子节点，直接输出其值\r\n        if tree.value is not None:\r\n            return tree.value\r\n        # 否则将x按照当前节点的规则进行判决\r\n        # 如果判决为true选择左子树，否则选择右子树，\r\n        feature_value = x[tree.feature_i]\r\n        if feature_value &gt;= tree.threshold:\r\n            branch = tree.true_branch\r\n        else:\r\n            branch = tree.false_branch\r\n        # 在选中的子树上递归进行判断\r\n        return self.predict_value(x, branch)</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-599440e2a047e567849042-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599440e2a047e567849042-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-599440e2a047e567849042-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599440e2a047e567849042-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-599440e2a047e567849042-5\">5</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599440e2a047e567849042-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-599440e2a047e567849042-7\">7</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599440e2a047e567849042-8\">8</div><div class=\"crayon-num\" data-line=\"crayon-599440e2a047e567849042-9\">9</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599440e2a047e567849042-10\">10</div><div class=\"crayon-num\" data-line=\"crayon-599440e2a047e567849042-11\">11</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599440e2a047e567849042-12\">12</div><div class=\"crayon-num\" data-line=\"crayon-599440e2a047e567849042-13\">13</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-599440e2a047e567849042-1\"><span class=\"crayon-e\">def </span><span class=\"crayon-e\">predict_value</span><span class=\"crayon-sy\">(</span><span class=\"crayon-r\">self</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">x</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">tree</span><span class=\"crayon-o\">=</span><span class=\"crayon-v\">None</span><span class=\"crayon-sy\">)</span><span class=\"crayon-o\">:</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599440e2a047e567849042-2\"><span class=\"crayon-h\">        </span><span class=\"crayon-p\"># 如果当前节点是叶子节点，直接输出其值</span></div><div class=\"crayon-line\" id=\"crayon-599440e2a047e567849042-3\"><span class=\"crayon-h\">        </span><span class=\"crayon-st\">if</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">tree</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">value </span><span class=\"crayon-st\">is</span><span class=\"crayon-h\"> </span><span class=\"crayon-st\">not</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">None</span><span class=\"crayon-o\">:</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599440e2a047e567849042-4\"><span class=\"crayon-h\">            </span><span class=\"crayon-st\">return</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">tree</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">value</span></div><div class=\"crayon-line\" id=\"crayon-599440e2a047e567849042-5\"><span class=\"crayon-h\">        </span><span class=\"crayon-p\"># 否则将x按照当前节点的规则进行判决</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599440e2a047e567849042-6\"><span class=\"crayon-h\">        </span><span class=\"crayon-p\"># 如果判决为true选择左子树，否则选择右子树，</span></div><div class=\"crayon-line\" id=\"crayon-599440e2a047e567849042-7\"><span class=\"crayon-h\">        </span><span class=\"crayon-v\">feature_value</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">x</span><span class=\"crayon-sy\">[</span><span class=\"crayon-v\">tree</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">feature_i</span><span class=\"crayon-sy\">]</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599440e2a047e567849042-8\"><span class=\"crayon-h\">        </span><span class=\"crayon-st\">if</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">feature_value</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">&gt;=</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">tree</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">threshold</span><span class=\"crayon-o\">:</span></div><div class=\"crayon-line\" id=\"crayon-599440e2a047e567849042-9\"><span class=\"crayon-h\">            </span><span class=\"crayon-v\">branch</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">tree</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">true_branch</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599440e2a047e567849042-10\"><span class=\"crayon-e\">        </span><span class=\"crayon-st\">else</span><span class=\"crayon-o\">:</span></div><div class=\"crayon-line\" id=\"crayon-599440e2a047e567849042-11\"><span class=\"crayon-h\">            </span><span class=\"crayon-v\">branch</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">tree</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">false_branch</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599440e2a047e567849042-12\"><span class=\"crayon-h\">        </span><span class=\"crayon-p\"># 在选中的子树上递归进行判断</span></div><div class=\"crayon-line\" id=\"crayon-599440e2a047e567849042-13\"><span class=\"crayon-h\">        </span><span class=\"crayon-st\">return</span><span class=\"crayon-h\"> </span><span class=\"crayon-r\">self</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">predict_value</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">x</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">branch</span><span class=\"crayon-sy\">)</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0021 seconds] -->\r\n<p></p>\n<h1>5. 总结</h1>\n<p>决策树是一种简单常用的分类器，通过训练好的决策树可以实现对未知的数据进行高效分类。从我们的例子中也可以看出，决策树模型具有较好的可读性和描述性，有助于辅助人工分析；此外，决策树的分类效率高，一次构建后可以反复使用，而且每一次预测的计算次数不超过决策树的深度。</p>\n<p>当然，决策树也有其缺点。对于连续的特征，比较难以处理，对于多分类问题，计算量和准确率都不理想。此外，在实际应用中，由于其最底层叶子节点是通过父节点中的单一规则生成的，所以通过手动修改样本特征比较容易欺骗分类器，比如在拦击邮件识别系统中，用户可能通过修改某一个关键特征，就可以骗过垃圾邮件识别系统。从实现上来讲，由于树的生成采用的是递归，随着样本规模的增大，计算量以及内存消耗会变得越来越大。</p>\n<p>此外，过拟合也是决策树面临的一个问题，完全训练的决策树(未进行剪纸，未限制Gain的阈值)能够100%准确地预测训练样本，因为其是对训练样本的完全拟合，但是，对与训练样本以外的样本，其预测效果可能会不理想，这就是过拟合。解决决策树的过拟合，除了上文说到的通过设置Gain的阈值作为停止条件之外，通常还需要对决策树进行剪枝，常用的剪枝策略有：</p>\n<ol>\n<li>Pessimistic Error Pruning：悲观错误剪枝</li>\n<li>Minimum Error Pruning：最小误差剪枝</li>\n<li>Cost-Complexity Pruning：代价复杂剪枝</li>\n<li> Error-Based Pruning：基于错误的剪枝，即对每一个节点，都用一组测试数据集进行测试，如果分裂之后，能够降低错误率，再继续分裂为两棵子树，否则直接作为叶子节点。</li>\n<li>Critical Value Pruning：关键值剪枝，这就是上文中提到的设置Gain的阈值作为停止条件。</li>\n</ol>\n<p>我们以最简单的方式展示了ID3决策树的实现方式，如果想要了解不同类型的决策树的差别，可以参考<a href=\"https://www.quora.com/What-are-the-differences-between-ID3-C4-5-and-CART\" target=\"_blank\">这个链接</a>。</p>\n<p>另外，关于各种机器学习算法的实现，强烈推荐参考Github仓库<a href=\"https://github.com/eriklindernoren/ML-From-Scratch.git\" target=\"_blank\">ML-From-Scratch</a>，下载代码之后，通过<strong><span style=\"color: #ff0000\"><code>pip install -r requirements.txt</code></span></strong>安装依赖库即可运行代码。</p>\n\r\n        \r\n        \r\n        \n    <div class=\"post-adds\">\n        <span data-post-id=\"112206\" class=\" btn-bluet-bigger href-style vote-post-up   register-user-only \"><i class=\"fa  fa-thumbs-o-up\"></i> <h10 id=\"112206votetotal\">1</h10> 赞</span>\n        <span data-book-type=\"1\" data-site-id=\"2\" data-item-id=\"112206\" data-item-type=\"1\" class=\" btn-bluet-bigger href-style bookmark-btn  register-user-only \"><i class=\"fa fa-bookmark-o  \"></i>  收藏</span>\n\n                    <a href=\"#article-comment\"><span class=\"btn-bluet-bigger href-style hide-on-480\"><i class=\"fa fa-comments-o\"></i>  评论</span></a>\n        \n        \n        \n        <!-- JiaThis Button BEGIN -->\n        <div class=\"jiathis_style_24x24\" style=\"display: inline-flex; position: relative; margin: 0; clear: both;float: right;\">\n            <a class=\"jiathis_button_tsina\"></a>\n            <a class=\"jiathis_button_weixin\"></a>\n            <a class=\"jiathis_button_qzone\"></a>\n            <a class=\"jiathis_button_fb hide-on-480\"></a>\n            <a href=\"http://www.jiathis.com/share?uid=1745061\" class=\"jiathis jiathis_txt jiathis_separator jtico jtico_jiathis\" target=\"_blank\"></a>\n        </div>\n\n    </div>\n\n\n\n\r\n        <!-- BEGIN #author-bio -->\r\n\r\n\r\n<!-- END #author-bio -->\r\n\t</div>", "front_image_path": ["full/1e981633d3d633f8ac4523b786bb76f0251e8b5e.jpg"]},
  {"title": "6 个理由，为什么 GNOME 仍然是最好的 Linux 桌面环境", "url": "http://blog.jobbole.com/112167/", "url_object_id": "85bd8601e0edbec62fafb940f1ad7501", "create_date": "2017/08/16", "front_image_url": ["http://wx1.sinaimg.cn/mw690/7cc829d3gy1filbc2mwdfj218g0nywhd.jpg"], "praise_nums": "1", "fav_nums": 0, "comment_nums": 0, "tags": "IT技术,GNOME,Linux", "content": "<div class=\"entry\">\r\n\r\n        \t\t\t<div class=\"textwidget\"></div>\n\t\t\r\n\t\t<div class=\"copyright-area\">原文出处： <a ref=\"nofollow\" target=\"_blank\" href=\"https://opensource.com/article/17/8/reasons-i-come-back-gnome\">Jay LaCroix</a>   译文出处：<a target=\"_blank\" href=\"https://my.oschina.net/editorial-story/blog/1510722\">开源中国</a>   </div><p>摘要: 一位资深 Linux 用户告诉你为什么 GNOME 仍然是最好的 Linux 桌面环境</p>\n<p><img class=\"alignnone\" src=\"http://wx1.sinaimg.cn/mw690/7cc829d3gy1filbc2mwdfj218g0nywhd.jpg\" width=\"690\" height=\"372\"></p>\n<blockquote><p>关于本文作者 Jay LaCroix</p>\n<p>Jay LaCroix 是来自密歇根州的技术专家，专注于 Linux 和开源软件。自 2002 年使用 Linux 以来，Jay 一直是它的“死忠粉”。他目前是云计算系统工程师和自由的咨询顾问，乐于教授他人使用 Linux，以充分利用这个优秀的系统。在空闲时间，Jay 会撰写图书，他是 Linux Mint Essentials, Mastering Linux Network Administration 这些书的作者，最近他成为了 Ubuntu Server 的会员。</p></blockquote>\n<p>我使用 Linux 大概已经有 15 年的时间了，在这期间一直都在尝试使用各种桌面环境。在我职业生涯的大部分时间里，我一直是一个坚定的 KDE Plasma 用户（从 2.x 版开始使用），一直坚持使用 Plasma 至 4.x 系列的大部分版本，最终由于稳定性问题，选择了迁移到其他的桌面环境。此后，我尝试过使用 Xfce, MATE, Openbox 等桌面环境。但自从我选择投入 <a href=\"https://www.gnome.org/gnome-3/\" target=\"_blank\" rel=\"nofollow\">GNOME 3</a> 的怀抱后，我就再没有离开过它了。GNOME 是一个稳定且反应灵敏的桌面环境，它使得我可以专注于自己的工作而尽可能少地受到干扰。</p>\n<p>下面说一下我彻底沉醉于 GNOME 3 Shell 的六个原因。</p>\n<h3 id=\"h2_0\">1. 智能且稳定</h3>\n<p>自从切换到 GNOME 3 以来，我并没有遇到过任何稳定性方面的问题。我已经在三台 System76 机器和两台戴尔 Latitude 笔记本电脑上运行 GNOME 3 了，而且它在每台机器上的表现都十分优秀。总之，在 GNOME 上的体验不能更好了 —— 它十分稳定并且永远不会崩溃，这是十分重要的。</p>\n<p>虽然我使用 GNOME 3 的体验一直都很稳定，但在使用测试的 beta 版时，仍然会遇到一些崩溃的场景。当出现这些通常由错误的 beta 版驱动引起的崩溃时（而不是 GNOME 本身），GNOME 3 的恢复功能仍能允许我从锁定中恢复。如果 shell 已经停止响应，我所要做的是按下 ALT+F2，然后按下 R 和 Enter 来重新启动会话，而这不会丢失正在运行的应用程序。事实上，即使强制重新启动 GNOME Shell，它不仅会把应用程序带回来，还会把它们放回到重新启动之前的同一个显示器/工作区上。</p>\n<p>上面的案例只是想告诉大家 GNOME 是如此的智能和稳定 —— 使用它的期间，我确实没遇到过崩溃的场景。而且 GNOME 内置的恢复功能，使得我可以重启整个会话而不用担心丢失正在运行的作业。</p>\n<h3 id=\"h2_1\">2. 不影响我的使用体验</h3>\n<p>我听过对于 GNOME 3 的一个抱怨是它的桌面组件太大，并且在显示器上占用了太多的空间。但我认为，相比其他的桌面环境，GNOME 3 拥有一个更干净的界面。它的大多数桌面组件都包含在 Activities 的概览中，屏幕顶部只有一个非常窄的面板，让桌面的其余部分用于任何正在进行的工作。GNOME 2.x 和 MATE 的默认布局都有两个面板，因此占用了两倍的空间。虽然可以像 MATE 一样自定义环境来使用单个面板。但 GNOME 3.x 不使用旧的两个面板的布局，为应用程序留出了更多的空间。</p>\n<p>由于 GNOME 的大部分桌面组件都包含在 Activities 概览中，所以它永远不会影响我的使用。如果我想更加专注于某些东西，我可以在使用 GNOME 的终端时按下 F11，使其占满整个屏幕。如果我想再次访问 GNOME 界面，我只需按下 <a href=\"https://help.gnome.org/users/gnome-help/stable/keyboard-key-super.html.en\" target=\"_blank\" rel=\"nofollow\">Super</a> 键。在我尝试过的所有桌面环境中（事实上我已经尝试过所有的桌面环境），GNOME 更能提高我的生产力，并且给我的显示屏留下更多的空间这个特性对我来说真的十分重要。</p>\n<h3>3. 显示器的切换能保持正常工作</h3>\n<p>多年以来，我都是使用一个带有扩展坞的笔记本电脑连接到双显示器，这是使用 Linux 唯一的最令人沮丧的地方。我也数不清丢失作业的次数了，因为我的笔记本电脑使用扩展坞与显示器进行连接时会出现死机的情况，或 Xorg Server 崩溃。我几乎习惯了 Linux 上混乱的扩展坞使用体验，直到切换至 GNOEM 3。</p>\n<p>到目前为止，GNOME 3 是我使用过的唯一一个对扩展坞是完全可靠的桌面环境。当我卸下扩展坞时，GNOME 会切换回笔记本电脑，并将所有在两个显示器上运行的应用程序移至单个的内置显示器上，GNOME 不仅可以在不锁定的情况下处理扩展坞，还可以在锁定前十分智能地将应用程序重新移动至启动的显示器上。对我而言，这是十分完美的 —— 没有死机或崩溃。因为我使用扩展坞，所以 GNOME 似乎是我最好的选择。</p>\n<h3 id=\"h2_3\">4. 大量的扩展</h3>\n<p>有人说 GNOME 3 的默认界面是十分有限的，你不能做太多的工作来进行定制。但是默认的设置已经可以很好地为我服务了，不能说 GNOME 不可以定制。它的界面可以通过扩展进行自定义，允许你按照自己的喜欢的方式调整桌面环境。这些扩展可以显示当前的天气状况，在 NetworkManager 的无线网络列表中添加一个刷新图标，插入新菜单，以及更多的其他事情。可通过 <a href=\"https://extensions.gnome.org/\" target=\"_blank\" rel=\"nofollow\">extensions.gnome.org</a> 获取扩展，也可以通过 <a href=\"https://git.gnome.org/browse/gnome-tweak-tool/\" target=\"_blank\" rel=\"nofollow\">GNOME Tweak</a> 工具来管理他们。</p>\n<p>但扩展既是天使也是魔鬼，因为不同的扩展有不同的程度的稳定性和质量。<a href=\"https://opensource.com/article/17/2/top-gnome-shell-extensions\" target=\"_blank\" rel=\"nofollow\">最好的扩展</a>能帮助你完成一些通常不能完成的事情，而糟糕的扩展可能会拖慢桌面环境的运行速度或导致其崩溃。我的建议是适量地使用扩展（质量比数量重要），因为太多的扩展可能会导致稳定性问题或混论的桌面环境。平均来说，我尽量不会安装超过三个以上的扩展。因为我发现大多数扩展只是稍微增强了使用的体验，并不是必需品。我个人最喜欢的三个扩展是 OpenWeather, TopIcons Plus, 和 Workspace Indicator。虽然 Dash to Dock 可能是最受欢迎的扩展，但我不使用它，因为 GNOME 3 默认的体验已经足够满足我的使用需求。</p>\n<p>虽然扩展可以使得体验更好，但在大多数情况下，我并不是真的需要它们。GNOME 3 的默认布局不仅适合我的需要，而且我安装的任何扩展只是增强了体验，但不是我完成工作所必需的。</p>\n<h3 id=\"h2_4\">5. 动态的工作区</h3>\n<p>动态的工作区(workspaces)是使我离不开 GNOME 3 的功能之一。它的概念十分简单，你可以从单个工作区开始，然后会根据需要自动添加更多的工作区。你可以通过按下 Super 键轻松查看在工作区上运行的所有应用程序。看起来这并没解决什么大的问题，但如果你是那种在将一个又一个的窗口叠加在一起的人，你可以使用此功能轻松查看正在运行的内容，并关闭未使用的应用程序。按住 Ctrl+Alt 键并同时按向上或向下的箭头可以在活动的工作区之间切换。当在工作区上打开应用时，会自动创建一个新的空白工作区以便开始使用。当关闭工作区中的所有应用程序时，它们也将被删除。</p>\n<p>这似乎与我们一直以来管理运行的应用程序的方式有很大的区别，但如果你尝试过之后，你可能会喜欢这种方式。我通常在每个工作区中运行一个应用程序，因为我发现使用 Ctrl+Alt+上/下箭头来进行切换比单击面板中的应用程序要快得多，而且效率更高。如果我需要在工作区中运行多个应用程序，我会将它们贴在显示器的左右边缘。</p>\n<p>关于 GNOME 3 处理工作区的方式的另一件事是，如果有多个显示器连接到计算机，默认情况下只有一个显示器启用了工作区。这意味着当我切换工作区时，只有左侧的显示器在它们之间循环，右侧的显示器则保持静止。这允许我在右边的显示器打开一个终端窗口，当我想检查我的消息时，我可以切换工作区以使用我的电子邮件客户端，而不会错过终端中发生的情况。</p>\n<h3 id=\"h2_5\">6. 自定义主题</h3>\n<p>老实说，GNOME 3 的默认主题不是我用过的桌面环境中最好看的（当然也不是最差的）。它的简洁性很好，但对于像我这种喜欢主题并修饰主题的人，可以自定义视觉效果以适应我的口味是十分重要的。</p>\n<p>幸运的是，在 GNOME 中安装主题十分容易。要安装新的主题，只需下载主题（<a href=\"https://www.opendesktop.org/s/Gnome\" target=\"_blank\" rel=\"nofollow\">gnome-look.org</a> 是一个不错的下载源），并将下载的文件解压到主目录的 <strong>.themes </strong>目录中。通过使用 GNOME Tweak 工具，可以在安装的主题之间进行循环。它允许你更改应用程序的外观以及 GNOME Shell 本身。</p>\n<p>最近还没有太多可用的 GNOME 3 主题，Arc 和 Numix 主题几乎占据了所有的焦点。这些主题当然是很好的，但有更多的选择就更好了。幸运的是，自从 Ubuntu 宣布将 GNOME 切换为默认的桌面环境之后，主题社区似乎正在加班工作，现在出现了更多的主题。我个人最喜欢的主题是 Vimix Dark，你的是什么？</p>\n<p>虽然我通常会尝试其他的桌面环境以与桌面 Linux 的发展同步，但我最后总会回归到 GNOME。GNOME 3.x 可能不适用于每个人，但我建议可以给它一次尝试的机会。GNOME 处理某些问题的方式初次看起来可能很奇怪，但它是一个很好的桌面环境，与其他我使用过的任何图形用户界面相比，它使得我更高效地完成我的工作。</p>\n\r\n        \r\n        \r\n        \n    <div class=\"post-adds\">\n        <span data-post-id=\"112167\" class=\" btn-bluet-bigger href-style vote-post-up   register-user-only \"><i class=\"fa  fa-thumbs-o-up\"></i> <h10 id=\"112167votetotal\">1</h10> 赞</span>\n        <span data-book-type=\"1\" data-site-id=\"2\" data-item-id=\"112167\" data-item-type=\"1\" class=\" btn-bluet-bigger href-style bookmark-btn  register-user-only \"><i class=\"fa fa-bookmark-o  \"></i>  收藏</span>\n\n                    <a href=\"#article-comment\"><span class=\"btn-bluet-bigger href-style hide-on-480\"><i class=\"fa fa-comments-o\"></i>  评论</span></a>\n        \n        \n        \n        <!-- JiaThis Button BEGIN -->\n        <div class=\"jiathis_style_24x24\" style=\"display: inline-flex; position: relative; margin: 0; clear: both;float: right;\">\n            <a class=\"jiathis_button_tsina\"></a>\n            <a class=\"jiathis_button_weixin\"></a>\n            <a class=\"jiathis_button_qzone\"></a>\n            <a class=\"jiathis_button_fb hide-on-480\"></a>\n            <a href=\"http://www.jiathis.com/share?uid=1745061\" class=\"jiathis jiathis_txt jiathis_separator jtico jtico_jiathis\" target=\"_blank\"></a>\n        </div>\n\n    </div>\n\n\n\n\r\n        <!-- BEGIN #author-bio -->\r\n\r\n\r\n<!-- END #author-bio -->\r\n\t</div>", "front_image_path": ["full/92195357d24493250ceca135476203662d9775e6.jpg"]},
  {"title": "150 多个 ML、NLP 和 Python 相关的教程", "url": "http://blog.jobbole.com/112185/", "url_object_id": "ce3a7725a878dcf107e5503031e8e276", "create_date": "2017/08/15", "front_image_url": ["http://jbcdn2.b0.upaiyun.com/2017/08/dbe885c03af6141ab8f7f68f5778895d.png"], "praise_nums": "1", "fav_nums": "4", "comment_nums": 0, "tags": "工具与资源,nlp,Python,人工智能,机器学习,深度学习", "content": "<div class=\"entry\">\r\n\r\n        \t\t\t<div class=\"textwidget\"></div>\n\t\t\r\n\t\t<div class=\"copyright-area\">本文由 <a href=\"http://blog.jobbole.com\">伯乐在线</a> - <a href=\"http://www.jobbole.com/members/shaozhengjiang\">iPytLab</a> 翻译。未经许可，禁止转载！<br>英文出处：<a target=\"_blank\" href=\"https://unsupervisedmethods.com/over-150-of-the-best-machine-learning-nlp-and-python-tutorials-ive-found-ffce2939bd78\">Robbie Allen</a>。欢迎加入<a target=\"_blank\" href=\"http://group.jobbole.com/category/feedback/trans-team/\">翻译组</a>。</div><p>机器学习已经发展了很久，它的<a href=\"https://en.wikipedia.org/wiki/Machine_learning#History_and_relationships_to_other_fields\" target=\"_blank\" rel=\"external\">历史</a>可以追溯到1959年，但是如今此领域的发展速度可以说是空前的。在最近的几篇文章中，我讨论了人工智能领域为何会在现在以及不久的将来持续蓬勃发展。如今很多对机器学习感兴趣的同学都普遍表示入门很难。</p>\n<p>在准备博士课题的期间，我尝试在网络上搜索与机器学习和自然语言处理相关的优秀资源。当我找了一个有趣的教程或者视频，从这个教程或者视频出发我又可以找到三四个更多的教程或视频，最终就会出现的画面就是我还没有开始认真研究第一个找到的教程，浏览器已经打开了 20 个标签等待我去浏览了。（注: <a href=\"https://www.tabbundler.com/\" target=\"_blank\" rel=\"external\">Tab Bundler</a> 可以帮助让我们的标签更有条理）。</p>\n<p>在找到了超过 25 个与机器学习相关的速查表后，<a href=\"http://blog.jobbole.com/112009/\" target=\"_blank\">我写了篇文章, 在里面整理了所有优秀的速查表</a>。</p>\n<p>为了给后面学习的童鞋铺路，我将我找到的最好的一些教程内容整理成了一份列表。这份列表并没有包含所有网上能找到的与机器学习相关的教程，否则这份列表将会过于臃肿。我的目标就是将我在机器学习和自然语言处理领域各个方面找到的我认为最好的教程整理出来。</p>\n<p>在教程中，为了能够更好的让读者理解其中的概念，我将避免罗列书中每章的详细内容，而是总结一些概念性的介绍内容。为什么不直接去买本书？当你想要对某些特定的主题或者不同方面进行了初步了解时，我相信这些教程对你可能帮助更大。</p>\n<p>本文中我将分四个主题进行整理：机器学习、自然语言处理、Python 和数学。在每个主题中我将包含一个例子和多个资源。当然我不可能完全覆盖所有的主题啦。</p>\n<p>在将来，我也将会整理一系列类似的资源列表，包括书籍，视频和代码项目等。因为我目前也的确正在编译这些资源。</p>\n<p>如果你发现我在这里遗漏了好的教程资源，请联系告诉我。为了避免资源重复罗列，我在每个主题下只列出了5、6个教程。下面的每个链接都应该链接了和其他链接不同的资源，也会通过不同的方式（例如幻灯片代码段)或者不同的角度呈现出这些内容。</p>\n<h3 id=\"机器学习\">机器学习</h3>\n<ul>\n<li><a href=\"https://medium.com/@ageitgey/machine-learning-is-fun-80ea3ec3c471\" target=\"_blank\" rel=\"external\">Machine Learning is Fun!</a> (medium.com/@ageitgey)</li>\n<li>Machine Learning Crash Course: <a href=\"https://ml.berkeley.edu/blog/2016/11/06/tutorial-1/\" target=\"_blank\" rel=\"external\">Part I</a>, <a href=\"https://ml.berkeley.edu/blog/2016/12/24/tutorial-2/\" target=\"_blank\" rel=\"external\">Part II</a>, <a href=\"https://ml.berkeley.edu/blog/2017/02/04/tutorial-3/\" target=\"_blank\" rel=\"external\">Part III</a> (Machine Learning at Berkeley)</li>\n<li><a href=\"https://www.toptal.com/machine-learning/machine-learning-theory-an-introductory-primer\" target=\"_blank\" rel=\"external\">An Introduction to Machine Learning Theory and Its Applications: A Visual Tutorial with Examples</a>(toptal.com)</li>\n<li><a href=\"https://monkeylearn.com/blog/a-gentle-guide-to-machine-learning/\" target=\"_blank\" rel=\"external\">A Gentle Guide to Machine Learning</a> (monkeylearn.com)</li>\n<li><a href=\"https://blogs.sas.com/content/subconsciousmusings/2017/04/12/machine-learning-algorithm-use/\" target=\"_blank\" rel=\"external\">Which machine learning algorithm should I use?</a> (sas.com)</li>\n</ul>\n<h4 id=\"激活函数和损失函数\">激活函数和损失函数</h4>\n<ul>\n<li><a href=\"http://neuralnetworksanddeeplearning.com/chap1.html#sigmoid_neurons\" target=\"_blank\" rel=\"external\">Sigmoid neurons</a> (neuralnetworksanddeeplearning.com)</li>\n<li><a href=\"https://www.quora.com/What-is-the-role-of-the-activation-function-in-a-neural-network\" target=\"_blank\" rel=\"external\">What is the role of the activation function in a neural network?</a> (quora.com)</li>\n<li><a href=\"https://stats.stackexchange.com/questions/115258/comprehensive-list-of-activation-functions-in-neural-networks-with-pros-cons\" target=\"_blank\" rel=\"external\">Comprehensive list of activation functions in neural networks with pros/cons</a> (stats.stackexchange.com)</li>\n<li><a href=\"https://medium.com/towards-data-science/activation-functions-and-its-types-which-is-better-a9a5310cc8f\" target=\"_blank\" rel=\"external\">Activation functions and it’s types-Which is better?</a> (medium.com)</li>\n<li><a href=\"http://www.exegetic.biz/blog/2015/12/making-sense-logarithmic-loss/\" target=\"_blank\" rel=\"external\">Making Sense of Logarithmic Loss</a> (exegetic.biz)</li>\n<li><a href=\"http://cs231n.github.io/neural-networks-2/#losses\" target=\"_blank\" rel=\"external\">Loss Functions</a> (Stanford CS231n)</li>\n<li><a href=\"http://rishy.github.io/ml/2015/07/28/l1-vs-l2-loss/\" target=\"_blank\" rel=\"external\">L1 vs. L2 Loss function</a> (rishy.github.io)</li>\n<li><a href=\"http://neuralnetworksanddeeplearning.com/chap3.html#the_cross-entropy_cost_function\" target=\"_blank\" rel=\"external\">The cross-entropy cost function</a> (neuralnetworksanddeeplearning.com)</li>\n</ul>\n<h4 id=\"偏差\">偏差</h4>\n<ul>\n<li><a href=\"https://stackoverflow.com/questions/2480650/role-of-bias-in-neural-networks/2499936#2499936\" target=\"_blank\" rel=\"external\">Role of Bias in Neural Networks</a> (stackoverflow.com)</li>\n<li><a href=\"http://makeyourownneuralnetwork.blogspot.com/2016/06/bias-nodes-in-neural-networks.html\" target=\"_blank\" rel=\"external\">Bias Nodes in Neural Networks</a> (makeyourownneuralnetwork.blogspot.com)</li>\n<li><a href=\"https://www.quora.com/What-is-bias-in-artificial-neural-network\" target=\"_blank\" rel=\"external\">What is bias in artificial neural network?</a> (quora.com)</li>\n</ul>\n<h4 id=\"感知器\">感知器</h4>\n<ul>\n<li><a href=\"http://neuralnetworksanddeeplearning.com/chap1.html#perceptrons\" target=\"_blank\" rel=\"external\">Perceptrons</a> (neuralnetworksanddeeplearning.com)</li>\n<li><a href=\"http://natureofcode.com/book/chapter-10-neural-networks/#chapter10_figure3\" target=\"_blank\" rel=\"external\">The Perception</a> (natureofcode.com)</li>\n<li><a href=\"http://computing.dcu.ie/~humphrys/Notes/Neural/single.neural.html\" target=\"_blank\" rel=\"external\">Single-layer Neural Networks (Perceptrons)</a> (dcu.ie)</li>\n<li><a href=\"https://www.toptal.com/machine-learning/an-introduction-to-deep-learning-from-perceptrons-to-deep-networks\" target=\"_blank\" rel=\"external\">From Perceptrons to Deep Networks</a> (toptal.com)</li>\n</ul>\n<h4 id=\"回归\">回归</h4>\n<ul>\n<li><a href=\"http://people.duke.edu/~rnau/regintro.htm\" target=\"_blank\" rel=\"external\">Introduction to linear regression analysis</a> (duke.edu)</li>\n<li><a href=\"http://ufldl.stanford.edu/tutorial/supervised/LinearRegression/\" target=\"_blank\" rel=\"external\">Linear Regression</a> (ufldl.stanford.edu)</li>\n<li><a href=\"http://ml-cheatsheet.readthedocs.io/en/latest/linear_regression.html\" target=\"_blank\" rel=\"external\">Linear Regression</a> (readthedocs.io)</li>\n<li><a href=\"http://ml-cheatsheet.readthedocs.io/en/latest/logistic_regression.html\" target=\"_blank\" rel=\"external\">Logistic Regression</a> (readthedocs.io)</li>\n<li><a href=\"http://machinelearningmastery.com/simple-linear-regression-tutorial-for-machine-learning/\" target=\"_blank\" rel=\"external\">Simple Linear Regression Tutorial for Machine Learning</a> (machinelearningmastery.com)</li>\n<li><a href=\"http://machinelearningmastery.com/logistic-regression-tutorial-for-machine-learning/\" target=\"_blank\" rel=\"external\">Logistic Regression Tutorial for Machine Learning</a> (machinelearningmastery.com)</li>\n<li><a href=\"http://ufldl.stanford.edu/tutorial/supervised/SoftmaxRegression/\" target=\"_blank\" rel=\"external\">Softmax Regression</a> (ufldl.stanford.edu)</li>\n</ul>\n<h4 id=\"梯度下降\">梯度下降</h4>\n<ul>\n<li><a href=\"http://neuralnetworksanddeeplearning.com/chap1.html#learning_with_gradient_descent\" target=\"_blank\" rel=\"external\">Learning with gradient descent</a> (neuralnetworksanddeeplearning.com)</li>\n<li><a href=\"http://iamtrask.github.io/2015/07/27/python-network-part2/\" target=\"_blank\" rel=\"external\">Gradient Descent</a> (iamtrask.github.io)</li>\n<li><a href=\"http://www.kdnuggets.com/2017/04/simple-understand-gradient-descent-algorithm.html\" target=\"_blank\" rel=\"external\">How to understand Gradient Descent algorithm</a> (kdnuggets.com)</li>\n<li><a href=\"http://sebastianruder.com/optimizing-gradient-descent/\" target=\"_blank\" rel=\"external\">An overview of gradient descent optimization algorithms</a> (sebastianruder.com)</li>\n<li><a href=\"http://cs231n.github.io/optimization-1/\" target=\"_blank\" rel=\"external\">Optimization: Stochastic Gradient Descent</a> (Stanford CS231n)</li>\n</ul>\n<h4 id=\"生成学习\">生成学习</h4>\n<ul>\n<li><a href=\"http://cs229.stanford.edu/notes/cs229-notes2.pdf\" target=\"_blank\" rel=\"external\">Generative Learning Algorithms</a> (Stanford CS229)</li>\n<li><a href=\"https://monkeylearn.com/blog/practical-explanation-naive-bayes-classifier/\" target=\"_blank\" rel=\"external\">A practical explanation of a Naive Bayes classifier</a> (monkeylearn.com)</li>\n</ul>\n<h4 id=\"支持向量机\">支持向量机</h4>\n<ul>\n<li><a href=\"https://monkeylearn.com/blog/introduction-to-support-vector-machines-svm/\" target=\"_blank\" rel=\"external\">An introduction to Support Vector Machines (SVM)</a> (monkeylearn.com)</li>\n<li><a href=\"http://cs229.stanford.edu/notes/cs229-notes3.pdf\" target=\"_blank\" rel=\"external\">Support Vector Machines</a> (Stanford CS229)</li>\n<li><a href=\"http://cs231n.github.io/linear-classify/\" target=\"_blank\" rel=\"external\">Linear classification: Support Vector Machine, Softmax</a> (Stanford 231n)</li>\n</ul>\n<h4 id=\"反向传播\">反向传播</h4>\n<ul>\n<li><a href=\"https://medium.com/@karpathy/yes-you-should-understand-backprop-e2f06eab496b\" target=\"_blank\" rel=\"external\">Yes you should understand backprop</a> (medium.com/@karpathy)</li>\n<li><a href=\"https://github.com/rasbt/python-machine-learning-book/blob/master/faq/visual-backpropagation.md\" target=\"_blank\" rel=\"external\">Can you give a visual explanation for the back propagation algorithm for neural networks?</a>(github.com/rasbt)</li>\n<li><a href=\"http://neuralnetworksanddeeplearning.com/chap2.html\" target=\"_blank\" rel=\"external\">How the backpropagation algorithm works</a> (neuralnetworksanddeeplearning.com)</li>\n<li><a href=\"http://www.wildml.com/2015/10/recurrent-neural-networks-tutorial-part-3-backpropagation-through-time-and-vanishing-gradients/\" target=\"_blank\" rel=\"external\">Backpropagation Through Time and Vanishing Gradients</a> (wildml.com)</li>\n<li><a href=\"http://machinelearningmastery.com/gentle-introduction-backpropagation-time/\" target=\"_blank\" rel=\"external\">A Gentle Introduction to Backpropagation Through Time</a> (machinelearningmastery.com)</li>\n<li><a href=\"http://cs231n.github.io/optimization-2/\" target=\"_blank\" rel=\"external\">Backpropagation, Intuitions</a> (Stanford CS231n)</li>\n</ul>\n<h4 id=\"深度学习\">深度学习</h4>\n<ul>\n<li><a href=\"http://nikhilbuduma.com/2014/12/29/deep-learning-in-a-nutshell/\" target=\"_blank\" rel=\"external\">Deep Learning in a Nutshell</a> (nikhilbuduma.com)</li>\n<li><a href=\"http://ai.stanford.edu/~quocle/tutorial1.pdf\" target=\"_blank\" rel=\"external\">A Tutorial on Deep Learning</a> (Quoc V. Le)</li>\n<li><a href=\"http://machinelearningmastery.com/what-is-deep-learning/\" target=\"_blank\" rel=\"external\">What is Deep Learning?</a> (machinelearningmastery.com)</li>\n<li><a href=\"https://blogs.nvidia.com/blog/2016/07/29/whats-difference-artificial-intelligence-machine-learning-deep-learning-ai/\" target=\"_blank\" rel=\"external\">What’s the Difference Between Artificial Intelligence, Machine Learning, and Deep Learning?</a> (nvidia.com)</li>\n</ul>\n<h4 id=\"优化和降维\">优化和降维</h4>\n<ul>\n<li><a href=\"https://www.knime.org/blog/seven-techniques-for-data-dimensionality-reduction\" target=\"_blank\" rel=\"external\">Seven Techniques for Data Dimensionality Reduction</a> (knime.org)</li>\n<li><a href=\"http://cs229.stanford.edu/notes/cs229-notes10.pdf\" target=\"_blank\" rel=\"external\">Principal components analysis</a> (Stanford CS229)</li>\n<li><a href=\"http://videolectures.net/site/normal_dl/tag=741100/nips2012_hinton_networks_01.pdf\" target=\"_blank\" rel=\"external\">Dropout: A simple way to improve neural networks</a> (Hinton @ NIPS 2012)</li>\n<li><a href=\"http://rishy.github.io/ml/2017/01/05/how-to-train-your-dnn/\" target=\"_blank\" rel=\"external\">How to train your Deep Neural Network</a> (rishy.github.io)</li>\n</ul>\n<h4 id=\"长短期记忆-LSTM\">长短期记忆(LSTM)</h4>\n<ul>\n<li><a href=\"http://machinelearningmastery.com/gentle-introduction-long-short-term-memory-networks-experts/\" target=\"_blank\" rel=\"external\">A Gentle Introduction to Long Short-Term Memory Networks by the Experts</a> (machinelearningmastery.com)</li>\n<li><a href=\"http://colah.github.io/posts/2015-08-Understanding-LSTMs/\" target=\"_blank\" rel=\"external\">Understanding LSTM Networks</a> (colah.github.io)</li>\n<li><a href=\"http://blog.echen.me/2017/05/30/exploring-lstms/\" target=\"_blank\" rel=\"external\">Exploring LSTMs</a> (echen.me)</li>\n<li><a href=\"http://iamtrask.github.io/2015/11/15/anyone-can-code-lstm/\" target=\"_blank\" rel=\"external\">Anyone Can Learn To Code an LSTM-RNN in Python</a> (iamtrask.github.io)</li>\n</ul>\n<h4 id=\"卷积神经网络-CNNs\">卷积神经网络(CNNs)</h4>\n<ul>\n<li><a href=\"http://neuralnetworksanddeeplearning.com/chap6.html#introducing_convolutional_networks\" target=\"_blank\" rel=\"external\">Introducing convolutional networks</a> (neuralnetworksanddeeplearning.com)</li>\n<li><a href=\"https://medium.com/@ageitgey/machine-learning-is-fun-part-3-deep-learning-and-convolutional-neural-networks-f40359318721\" target=\"_blank\" rel=\"external\">Deep Learning and Convolutional Neural Networks</a> (medium.com/@ageitgey)</li>\n<li><a href=\"http://colah.github.io/posts/2014-07-Conv-Nets-Modular/\" target=\"_blank\" rel=\"external\">Conv Nets: A Modular Perspective</a> (colah.github.io)</li>\n<li><a href=\"http://colah.github.io/posts/2014-07-Understanding-Convolutions/\" target=\"_blank\" rel=\"external\">Understanding Convolutions</a> (colah.github.io)</li>\n</ul>\n<h4 id=\"循环神经网络-RNNs\">循环神经网络(RNNs)</h4>\n<p><a href=\"http://www.wildml.com/2015/09/recurrent-neural-networks-tutorial-part-1-introduction-to-rnns/\" target=\"_blank\" rel=\"external\">Recurrent Neural Networks Tutorial</a> (wildml.com)<br>\n<a href=\"http://distill.pub/2016/augmented-rnns/\" target=\"_blank\" rel=\"external\">Attention and Augmented Recurrent Neural Networks</a> (distill.pub)<br>\n<a href=\"http://karpathy.github.io/2015/05/21/rnn-effectiveness/\" target=\"_blank\" rel=\"external\">The Unreasonable Effectiveness of Recurrent Neural Networks</a> (karpathy.github.io)<br>\n<a href=\"http://nikhilbuduma.com/2015/01/11/a-deep-dive-into-recurrent-neural-networks/\" target=\"_blank\" rel=\"external\">A Deep Dive into Recurrent Neural Nets</a> (nikhilbuduma.com)</p>\n<h4 id=\"增强学习\">增强学习</h4>\n<ul>\n<li><a href=\"https://www.analyticsvidhya.com/blog/2017/01/introduction-to-reinforcement-learning-implementation/\" target=\"_blank\" rel=\"external\">Simple Beginner’s guide to Reinforcement Learning &amp; its implementation</a> (analyticsvidhya.com)</li>\n<li><a href=\"https://web.mst.edu/~gosavia/tutorial.pdf\" target=\"_blank\" rel=\"external\">A Tutorial for Reinforcement Learning</a> (mst.edu)</li>\n<li><a href=\"http://www.wildml.com/2016/10/learning-reinforcement-learning/\" target=\"_blank\" rel=\"external\">Learning Reinforcement Learning</a> (wildml.com)</li>\n<li><a href=\"http://karpathy.github.io/2016/05/31/rl/\" target=\"_blank\" rel=\"external\">Deep Reinforcement Learning: Pong from Pixels</a> (karpathy.github.io)</li>\n</ul>\n<h4 id=\"生成对抗网络-GANs\">生成对抗网络(GANs)</h4>\n<ul>\n<li><a href=\"https://blogs.nvidia.com/blog/2017/05/17/generative-adversarial-network/\" target=\"_blank\" rel=\"external\">What’s a Generative Adversarial Network?</a> (nvidia.com)</li>\n<li><a href=\"https://medium.com/@ageitgey/abusing-generative-adversarial-networks-to-make-8-bit-pixel-art-e45d9b96cee7\" target=\"_blank\" rel=\"external\">Abusing Generative Adversarial Networks to Make 8-bit Pixel Art</a> (medium.com/@ageitgey)</li>\n<li><a href=\"http://blog.aylien.com/introduction-generative-adversarial-networks-code-tensorflow/\" target=\"_blank\" rel=\"external\">An introduction to Generative Adversarial Networks (with code in TensorFlow)</a> (aylien.com)</li>\n<li><a href=\"https://www.oreilly.com/learning/generative-adversarial-networks-for-beginners\" target=\"_blank\" rel=\"external\">Generative Adversarial Networks for Beginners</a> (oreilly.com)</li>\n</ul>\n<h4 id=\"多任务学习\">多任务学习</h4>\n<ul>\n<li><a href=\"http://sebastianruder.com/multi-task/index.html\" target=\"_blank\" rel=\"external\">An Overview of Multi-Task Learning in Deep Neural Networks</a> (sebastianruder.com)</li>\n</ul>\n<h3 id=\"自然语言处理-NLP\">自然语言处理(NLP)</h3>\n<ul>\n<li><a href=\"http://u.cs.biu.ac.il/~yogo/nnlp.pdf\" target=\"_blank\" rel=\"external\">A Primer on Neural Network Models for Natural Language Processing</a> (Yoav Goldberg)</li>\n<li><a href=\"https://monkeylearn.com/blog/the-definitive-guide-to-natural-language-processing/\" target=\"_blank\" rel=\"external\">The Definitive Guide to Natural Language Processing</a> (monkeylearn.com)</li>\n<li><a href=\"https://blog.algorithmia.com/introduction-natural-language-processing-nlp/\" target=\"_blank\" rel=\"external\">Introduction to Natural Language Processing</a> (algorithmia.com)</li>\n<li><a href=\"http://www.vikparuchuri.com/blog/natural-language-processing-tutorial/\" target=\"_blank\" rel=\"external\">Natural Language Processing Tutorial</a> (vikparuchuri.com)</li>\n<li><a href=\"https://arxiv.org/pdf/1103.0398.pdf\" target=\"_blank\" rel=\"external\">Natural Language Processing (almost) from Scratch</a> (arxiv.org)</li>\n</ul>\n<h4 id=\"深度学习与NLP\">深度学习与NLP</h4>\n<ul>\n<li><a href=\"https://arxiv.org/pdf/1703.03091.pdf\" target=\"_blank\" rel=\"external\">Deep Learning applied to NLP</a> (arxiv.org)</li>\n<li><a href=\"https://nlp.stanford.edu/courses/NAACL2013/NAACL2013-Socher-Manning-DeepLearning.pdf\" target=\"_blank\" rel=\"external\">Deep Learning for NLP (without Magic)</a> (Richard Socher)</li>\n<li><a href=\"http://www.wildml.com/2015/11/understanding-convolutional-neural-networks-for-nlp/\" target=\"_blank\" rel=\"external\">Understanding Convolutional Neural Networks for NLP</a> (wildml.com)</li>\n<li><a href=\"http://colah.github.io/posts/2014-07-NLP-RNNs-Representations/\" target=\"_blank\" rel=\"external\">Deep Learning, NLP, and Representations</a> (colah.github.io)</li>\n<li><a href=\"https://explosion.ai/blog/deep-learning-formula-nlp\" target=\"_blank\" rel=\"external\">Embed, encode, attend, predict: The new deep learning formula for state-of-the-art NLP models</a>(explosion.ai)</li>\n<li><a href=\"https://devblogs.nvidia.com/parallelforall/understanding-natural-language-deep-neural-networks-using-torch/\" target=\"_blank\" rel=\"external\">Understanding Natural Language with Deep Neural Networks Using Torch</a> (nvidia.com)</li>\n<li><a href=\"http://pytorch.org/tutorials/beginner/deep_learning_nlp_tutorial.html\" target=\"_blank\" rel=\"external\">Deep Learning for NLP with Pytorch</a> (pytorich.org)</li>\n</ul>\n<h4 id=\"词向量\">词向量</h4>\n<ul>\n<li><a href=\"https://www.kaggle.com/c/word2vec-nlp-tutorial\" target=\"_blank\" rel=\"external\">Bag of Words Meets Bags of Popcorn</a> (kaggle.com)</li>\n<li>On word embeddings <a href=\"http://sebastianruder.com/word-embeddings-1/index.html\" target=\"_blank\" rel=\"external\">Part I</a>, <a href=\"http://sebastianruder.com/word-embeddings-softmax/index.html\" target=\"_blank\" rel=\"external\">Part II</a>, <a href=\"http://sebastianruder.com/secret-word2vec/index.html\" target=\"_blank\" rel=\"external\">Part III</a> (sebastianruder.com)</li>\n<li><a href=\"https://blog.acolyer.org/2016/04/21/the-amazing-power-of-word-vectors/\" target=\"_blank\" rel=\"external\">The amazing power of word vectors</a> (acolyer.org)</li>\n<li><a href=\"https://arxiv.org/pdf/1411.2738.pdf\" target=\"_blank\" rel=\"external\">word2vec Parameter Learning Explained</a> (arxiv.org)</li>\n<li>Word2Vec Tutorial — <a href=\"http://mccormickml.com/2016/04/19/word2vec-tutorial-the-skip-gram-model/\" target=\"_blank\" rel=\"external\">The Skip-Gram Model</a>, <a href=\"http://mccormickml.com/2017/01/11/word2vec-tutorial-part-2-negative-sampling/\" target=\"_blank\" rel=\"external\">Negative Sampling</a> (mccormickml.com)</li>\n</ul>\n<h4 id=\"编码器-解码器\">编码器-解码器</h4>\n<ul>\n<li><a href=\"http://www.wildml.com/2016/01/attention-and-memory-in-deep-learning-and-nlp/\" target=\"_blank\" rel=\"external\">Attention and Memory in Deep Learning and NLP</a> (wildml.com)</li>\n<li><a href=\"https://www.tensorflow.org/tutorials/seq2seq\" target=\"_blank\" rel=\"external\">Sequence to Sequence Models</a> (tensorflow.org)</li>\n<li><a href=\"https://papers.nips.cc/paper/5346-sequence-to-sequence-learning-with-neural-networks.pdf\" target=\"_blank\" rel=\"external\">Sequence to Sequence Learning with Neural Networks</a> (NIPS 2014)</li>\n<li><a href=\"https://medium.com/@ageitgey/machine-learning-is-fun-part-5-language-translation-with-deep-learning-and-the-magic-of-sequences-2ace0acca0aa\" target=\"_blank\" rel=\"external\">Machine Learning is Fun Part 5: Language Translation with Deep Learning and the Magic of Sequences</a>(medium.com/@ageitgey)</li>\n<li><a href=\"http://machinelearningmastery.com/how-to-use-an-encoder-decoder-lstm-to-echo-sequences-of-random-integers/\" target=\"_blank\" rel=\"external\">How to use an Encoder-Decoder LSTM to Echo Sequences of Random Integers</a>(machinelearningmastery.com)</li>\n<li><a href=\"https://google.github.io/seq2seq/\" target=\"_blank\" rel=\"external\">tf-seq2seq</a> (google.github.io)</li>\n</ul>\n<h3 id=\"Python\">Python</h3>\n<ul>\n<li><a href=\"http://www.kdnuggets.com/2015/11/seven-steps-machine-learning-python.html\" target=\"_blank\" rel=\"external\">7 Steps to Mastering Machine Learning With Python</a> (kdnuggets.com)</li>\n<li><a href=\"http://nbviewer.jupyter.org/github/rhiever/Data-Analysis-and-Machine-Learning-Projects/blob/master/example-data-science-notebook/Example%20Machine%20Learning%20Notebook.ipynb\" target=\"_blank\" rel=\"external\">An example machine learning notebook</a> (nbviewer.jupyter.org)</li>\n</ul>\n<h4 id=\"例子\">例子</h4>\n<ul>\n<li><a href=\"http://machinelearningmastery.com/implement-perceptron-algorithm-scratch-python/\" target=\"_blank\" rel=\"external\">How To Implement The Perceptron Algorithm From Scratch In Python</a> (machinelearningmastery.com)</li>\n<li><a href=\"http://www.wildml.com/2015/09/implementing-a-neural-network-from-scratch/\" target=\"_blank\" rel=\"external\">Implementing a Neural Network from Scratch in Python</a> (wildml.com)</li>\n<li><a href=\"http://iamtrask.github.io/2015/07/12/basic-python-network/\" target=\"_blank\" rel=\"external\">A Neural Network in 11 lines of Python</a> (iamtrask.github.io)</li>\n<li><a href=\"http://www.kdnuggets.com/2016/01/implementing-your-own-knn-using-python.html\" target=\"_blank\" rel=\"external\">Implementing Your Own k-Nearest Neighbour Algorithm Using Python</a> (kdnuggets.com)</li>\n<li><a href=\"http://machinelearningmastery.com/memory-in-a-long-short-term-memory-network/\" target=\"_blank\" rel=\"external\">Demonstration of Memory with a Long Short-Term Memory Network in Python</a>(machinelearningmastery.com)</li>\n<li><a href=\"http://machinelearningmastery.com/learn-echo-random-integers-long-short-term-memory-recurrent-neural-networks/\" target=\"_blank\" rel=\"external\">How to Learn to Echo Random Integers with Long Short-Term Memory Recurrent Neural Networks</a>(machinelearningmastery.com)</li>\n<li><a href=\"http://pytlab.org/2017/08/12/%E8%B6%85%E8%BF%87150%E4%B8%AA%E6%9C%80%E5%A5%BD%E7%9A%84%E4%B8%8E%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0-%E8%87%AA%E7%84%B6%E8%AF%AD%E8%A8%80%E5%A4%84%E7%90%86%E5%92%8CPython%E7%9B%B8%E5%85%B3%E7%9A%84%E6%95%99%E7%A8%8B/How%20to%20Learn%20to%20Add%20Numbers%20with%20seq2seq%20Recurrent%20Neural%20Networks\">How to Learn to Add Numbers with seq2seq Recurrent Neural Networks</a> (machinelearningmastery.com)</li>\n</ul>\n<h4 id=\"Numpy和Scipy\">Numpy和Scipy</h4>\n<ul>\n<li><a href=\"http://www.scipy-lectures.org/\" target=\"_blank\" rel=\"external\">Scipy Lecture Notes</a> (scipy-lectures.org)</li>\n<li><a href=\"http://cs231n.github.io/python-numpy-tutorial/\" target=\"_blank\" rel=\"external\">Python Numpy Tutorial</a> (Stanford CS231n)</li>\n<li><a href=\"https://engineering.ucsb.edu/~shell/che210d/numpy.pdf\" target=\"_blank\" rel=\"external\">An introduction to Numpy and Scipy</a> (UCSB CHE210D)</li>\n<li><a href=\"http://nbviewer.jupyter.org/gist/rpmuller/5920182#ii.-numpy-and-scipy\" target=\"_blank\" rel=\"external\">A Crash Course in Python for Scientists</a> (nbviewer.jupyter.org)</li>\n</ul>\n<h4 id=\"scikit-learn\">scikit-learn</h4>\n<ul>\n<li><a href=\"http://nbviewer.jupyter.org/github/jakevdp/sklearn_pycon2015/blob/master/notebooks/Index.ipynb\" target=\"_blank\" rel=\"external\">PyCon scikit-learn Tutorial Index</a> (nbviewer.jupyter.org)</li>\n<li><a href=\"https://github.com/mmmayo13/scikit-learn-classifiers/blob/master/sklearn-classifiers-tutorial.ipynb\" target=\"_blank\" rel=\"external\">scikit-learn Classification Algorithms</a> (github.com/mmmayo13)</li>\n<li><a href=\"http://scikit-learn.org/stable/tutorial/index.html\" target=\"_blank\" rel=\"external\">scikit-learn Tutorials</a> (scikit-learn.org)</li>\n<li><a href=\"https://github.com/mmmayo13/scikit-learn-beginners-tutorials\" target=\"_blank\" rel=\"external\">Abridged scikit-learn Tutorials</a> (github.com/mmmayo13)</li>\n</ul>\n<h4 id=\"Tensorflow\">Tensorflow</h4>\n<ul>\n<li><a href=\"https://www.tensorflow.org/tutorials/\" target=\"_blank\" rel=\"external\">Tensorflow Tutorials</a> (tensorflow.org)</li>\n<li><a href=\"https://medium.com/@erikhallstrm/hello-world-tensorflow-649b15aed18c\" target=\"_blank\" rel=\"external\">Introduction to TensorFlow — CPU vs GPU</a> (medium.com/@erikhallstrm)</li>\n<li><a href=\"https://blog.metaflow.fr/tensorflow-a-primer-4b3fa0978be3\" target=\"_blank\" rel=\"external\">TensorFlow: A primer</a> (metaflow.fr)</li>\n<li><a href=\"http://www.wildml.com/2016/08/rnns-in-tensorflow-a-practical-guide-and-undocumented-features/\" target=\"_blank\" rel=\"external\">RNNs in Tensorflow</a> (wildml.com)</li>\n<li><a href=\"http://www.wildml.com/2015/12/implementing-a-cnn-for-text-classification-in-tensorflow/\" target=\"_blank\" rel=\"external\">Implementing a CNN for Text Classification in TensorFlow</a> (wildml.com)</li>\n<li><a href=\"http://pavel.surmenok.com/2016/10/15/how-to-run-text-summarization-with-tensorflow/\" target=\"_blank\" rel=\"external\">How to Run Text Summarization with TensorFlow</a> (surmenok.com)</li>\n</ul>\n<h4 id=\"PyTorch\">PyTorch</h4>\n<ul>\n<li><a href=\"http://pytorch.org/tutorials/\" target=\"_blank\" rel=\"external\">PyTorch Tutorials</a> (pytorch.org)</li>\n<li><a href=\"http://blog.gaurav.im/2017/04/24/a-gentle-intro-to-pytorch/\" target=\"_blank\" rel=\"external\">A Gentle Intro to PyTorch</a> (gaurav.im)</li>\n<li><a href=\"https://iamtrask.github.io/2017/01/15/pytorch-tutorial/\" target=\"_blank\" rel=\"external\">Tutorial: Deep Learning in PyTorch</a> (iamtrask.github.io)</li>\n<li><a href=\"https://github.com/jcjohnson/pytorch-examples\" target=\"_blank\" rel=\"external\">PyTorch Examples</a> (github.com/jcjohnson)</li>\n<li><a href=\"https://github.com/MorvanZhou/PyTorch-Tutorial\" target=\"_blank\" rel=\"external\">PyTorch Tutorial</a> (github.com/MorvanZhou)</li>\n<li><a href=\"http://pytlab.org/2017/08/12/%E8%B6%85%E8%BF%87150%E4%B8%AA%E6%9C%80%E5%A5%BD%E7%9A%84%E4%B8%8E%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0-%E8%87%AA%E7%84%B6%E8%AF%AD%E8%A8%80%E5%A4%84%E7%90%86%E5%92%8CPython%E7%9B%B8%E5%85%B3%E7%9A%84%E6%95%99%E7%A8%8B/PyTorch%20Tutorial%20for%20Deep%20Learning%20Researchers\">PyTorch Tutorial for Deep Learning Researchers</a> (github.com/yunjey)</li>\n</ul>\n<h3 id=\"Math\">Math</h3>\n<ul>\n<li><a href=\"https://people.ucsc.edu/~praman1/static/pub/math-for-ml.pdf\" target=\"_blank\" rel=\"external\">Math for Machine Learning</a> (ucsc.edu)</li>\n<li><a href=\"http://www.umiacs.umd.edu/~hal/courses/2013S_ML/math4ml.pdf\" target=\"_blank\" rel=\"external\">Math for Machine Learning</a> (UMIACS CMSC422)</li>\n</ul>\n<h4 id=\"线性代数\">线性代数</h4>\n<ul>\n<li><a href=\"https://betterexplained.com/articles/linear-algebra-guide/\" target=\"_blank\" rel=\"external\">An Intuitive Guide to Linear Algebra</a> (betterexplained.com)</li>\n<li><a href=\"https://betterexplained.com/articles/matrix-multiplication/\" target=\"_blank\" rel=\"external\">A Programmer’s Intuition for Matrix Multiplication</a> (betterexplained.com)</li>\n<li><a href=\"https://betterexplained.com/articles/cross-product/\" target=\"_blank\" rel=\"external\">Understanding the Cross Product</a> (betterexplained.com)</li>\n<li><a href=\"https://betterexplained.com/articles/vector-calculus-understanding-the-dot-product/\" target=\"_blank\" rel=\"external\">Understanding the Dot Product</a> (betterexplained.com)</li>\n<li><a href=\"http://www.cedar.buffalo.edu/~srihari/CSE574/Chap1/LinearAlgebra.pdf\" target=\"_blank\" rel=\"external\">Linear Algebra for Machine Learning</a> (U. of Buffalo CSE574)</li>\n<li><a href=\"https://medium.com/towards-data-science/linear-algebra-cheat-sheet-for-deep-learning-cd67aba4526c\" target=\"_blank\" rel=\"external\">Linear algebra cheat sheet for deep learning</a> (medium.com)</li>\n<li><a href=\"http://cs229.stanford.edu/section/cs229-linalg.pdf\" target=\"_blank\" rel=\"external\">Linear Algebra Review and Reference</a> (Stanford CS229)</li>\n</ul>\n<h4 id=\"概率论\">概率论</h4>\n<ul>\n<li><a href=\"https://betterexplained.com/articles/understanding-bayes-theorem-with-ratios/\" target=\"_blank\" rel=\"external\">Understanding Bayes Theorem With Ratios</a> (betterexplained.com)</li>\n<li><a href=\"http://cs229.stanford.edu/section/cs229-prob.pdf\" target=\"_blank\" rel=\"external\">Review of Probability Theory</a> (Stanford CS229)</li>\n<li><a href=\"https://see.stanford.edu/materials/aimlcs229/cs229-prob.pdf\" target=\"_blank\" rel=\"external\">Probability Theory Review for Machine Learning</a> (Stanford CS229)</li>\n<li><a href=\"http://www.cedar.buffalo.edu/~srihari/CSE574/Chap1/Probability-Theory.pdf\" target=\"_blank\" rel=\"external\">Probability Theory</a> (U. of Buffalo CSE574)</li>\n<li><a href=\"http://www.cs.toronto.edu/~urtasun/courses/CSC411_Fall16/tutorial1.pdf\" target=\"_blank\" rel=\"external\">Probability Theory for Machine Learning</a> (U. of Toronto CSC411)</li>\n</ul>\n<h4 id=\"微积分\">微积分</h4>\n<ul>\n<li><a href=\"https://betterexplained.com/articles/how-to-understand-derivatives-the-quotient-rule-exponents-and-logarithms/\" target=\"_blank\" rel=\"external\">How To Understand Derivatives: The Quotient Rule, Exponents, and Logarithms</a> (betterexplained.com)</li>\n<li><a href=\"https://betterexplained.com/articles/derivatives-product-power-chain/\" target=\"_blank\" rel=\"external\">How To Understand Derivatives: The Product, Power &amp; Chain Rules</a> (betterexplained.com)</li>\n<li><a href=\"https://betterexplained.com/articles/vector-calculus-understanding-the-gradient/\" target=\"_blank\" rel=\"external\">Vector Calculus: Understanding the Gradient</a> (betterexplained.com)</li>\n<li><a href=\"http://web.stanford.edu/class/cs224n/lecture_notes/cs224n-2017-review-differential-calculus.pdf\" target=\"_blank\" rel=\"external\">Differential Calculus</a> (Stanford CS224n)</li>\n<li><a href=\"http://ml-cheatsheet.readthedocs.io/en/latest/calculus.html\" target=\"_blank\" rel=\"external\">Calculus Overview</a> (readthedocs.io)</li>\n</ul>\n\r\n        \r\n            <blockquote class=\"rewards\">\n        <p><strong>打赏支持我翻译更多好文章，谢谢！</strong></p>\n        <a href=\"#rewardbox\" id=\"rewards-button\" class=\"fancybox\"><span class=\"btn-bluet-blue href-style\"><i class=\"fa fa-jpy\"></i> 打赏译者</span></a>\n    </blockquote>\n\n    <div id=\"rewardbox\">\n        <h4>打赏支持我翻译更多好文章，谢谢！</h4>\n                <p>\n                        <img src=\"http://jbcdn2.b0.upaiyun.com/2016/05/c3d3aeee3e50259c10c3524201fc68db.jpg\">\n            \n                    </p>\n    </div>\n\n    \r\n        \n    <div class=\"post-adds\">\n        <span data-post-id=\"112185\" class=\" btn-bluet-bigger href-style vote-post-up   register-user-only \"><i class=\"fa  fa-thumbs-o-up\"></i> <h10 id=\"112185votetotal\">1</h10> 赞</span>\n        <span data-book-type=\"1\" data-site-id=\"2\" data-item-id=\"112185\" data-item-type=\"1\" class=\" btn-bluet-bigger href-style bookmark-btn  register-user-only \"><i class=\"fa fa-bookmark-o  \"></i> 4 收藏</span>\n\n                    <a href=\"#article-comment\"><span class=\"btn-bluet-bigger href-style hide-on-480\"><i class=\"fa fa-comments-o\"></i>  评论</span></a>\n        \n        \n        \n        <!-- JiaThis Button BEGIN -->\n        <div class=\"jiathis_style_24x24\" style=\"display: inline-flex; position: relative; margin: 0; clear: both;float: right;\">\n            <a class=\"jiathis_button_tsina\"></a>\n            <a class=\"jiathis_button_weixin\"></a>\n            <a class=\"jiathis_button_qzone\"></a>\n            <a class=\"jiathis_button_fb hide-on-480\"></a>\n            <a href=\"http://www.jiathis.com/share?uid=1745061\" class=\"jiathis jiathis_txt jiathis_separator jtico jtico_jiathis\" target=\"_blank\"></a>\n        </div>\n\n    </div>\n\n\n\n\r\n        <!-- BEGIN #author-bio -->\r\n\r\n<div id=\"author-bio\">\r\n\t\r\n\t<h3 class=\"widget-title\">\r\n\t关于作者：<a target=\"_blank\" href=\"http://www.jobbole.com/members/shaozhengjiang\">iPytLab</a>\r\n\t</h3>\r\n\t<div class=\"alignleft\">\r\n\t\t<a target=\"_blank\" href=\"http://www.jobbole.com/members/shaozhengjiang\">\r\n\t\t\t<img src=\"http://jbcdn2.b0.upaiyun.com/2017/07/d3f741a9dd5c4194b365e95b06a56c09.jpeg\">\r\n\t\t</a>\r\n\t</div>\r\n\r\n    <div class=\"author-bio-info\">\r\n\r\n        <span class=\"author-bio-info-block\">\r\n            喜欢写程序的计算化学狗，Python/C/C++/Fortran, 个人博客 http://pytlab.org        </span>\r\n        <span class=\"author-bio-info-block\">\r\n            <a href=\"http://www.jobbole.com/members/shaozhengjiang\" target=\"_blank\"><i class=\"fa fa-user\"></i> 个人主页</a> ·\r\n            <a href=\"http://blog.jobbole.com/author/shaozhengjiang/\" target=\"_blank\"><i class=\"fa fa-file-text-o\"></i> 我的文章</a>\r\n\r\n             · <a title=\"声望值\" target=\"_blank\" href=\"http://www.jobbole.com/members/shaozhengjiang/reputation/\"><i class=\"fa fa-graduation-cap\"></i> 11</a> · <a title=\"我的网站\" target=\"_blank\" href=\"http://pytlab.org\"><i class=\"fa fa-link\"></i></a> <a title=\"微博主页\" target=\"_blank\" href=\"http://weibo.com/shaowugui\"><i class=\"fa fa-weibo\"></i></a> <a title=\"GitHub主页\" target=\"_blank\" href=\"https://github.com/PytLab\"><i class=\"fa fa-github\"></i></a> <a title=\"Stack Overflow主页\" target=\"_blank\" href=\"http://stackoverflow.com/users/4014840/pytlab\"><i class=\"fa fa-stack-overflow\"></i></a>         </span>\r\n    </div>\r\n\t<div class=\"clear\"></div>\r\n</div>\r\n\r\n<!-- END #author-bio -->\r\n\t</div>", "front_image_path": ["full/f02d2e7eb1184040c7a09a8a14f24d219b467b39.jpg"]},{"title": "cp 命令两个高效的用法", "url": "http://blog.jobbole.com/112170/", "url_object_id": "0b8ff310585249119a5b31d70bda767d", "create_date": "2017/08/12", "front_image_url": ["http://jbcdn2.b0.upaiyun.com/2017/08/0f3b1cf0b9d183fb000f5687784e8852.png"], "praise_nums": "1", "fav_nums": "4", "comment_nums": 0, "tags": "IT技术,命令行", "content": "<div class=\"entry\">\r\n\r\n        \t\t\t<div class=\"textwidget\"></div>\n\t\t\r\n\t\t<div class=\"copyright-area\">原文出处： <a ref=\"nofollow\" target=\"_blank\" href=\"https://opensource.com/article/17/7/two-great-uses-cp-command\">Chris Hermansen</a>   译文出处：<a target=\"_blank\" href=\"https://linux.cn/article-8766-1.html\">bigdimple</a>   </div><blockquote><p>Linux 中高效的备份拷贝命令</p></blockquote>\n<p>在 Linux 上能使用鼠标点来点去的图形化界面是一件很美妙的事……但是如果你喜欢的开发交互环境和编译器是终端窗口、Bash 和 Vim，那你应该像我一样经常和终端打交道。</p>\n<p>即使是不经常使用终端的人，如果对终端环境深入了解也能获益良多。举个例子—— <span style=\"color: #ff0000\"><strong>cp</strong></span> 命令，据 <a href=\"https://en.wikipedia.org/wiki/Cp_(Unix)\">维基百科</a> 的解释，<span style=\"color: #ff0000\"><strong>cp</strong></span> （意即 copy）命令是第一个版本的 <a href=\"https://en.wikipedia.org/wiki/Unix\">Unix</a> 系统的一部分。连同一组其它的命令 <span style=\"color: #ff0000\"><strong>ls</strong></span>、<span style=\"color: #ff0000\"><strong>mv</strong>、<strong>cd</strong>、<strong>pwd</strong>、<strong>mkdir</strong>、<strong>vi</strong>、<strong>sh</strong>、<strong>sed</strong></span> 和<span style=\"color: #ff0000\"> <strong>awk</strong></span> ，还有提到的<span style=\"color: #ff0000\"> <strong>cp</strong> </span>都是我在 1984 年接触 System V Unix 系统时所学习的命令之一。<span style=\"color: #ff0000\"><strong>cp</strong></span> 命令最常见的用法是制作文件副本。像这样：</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-59942a168d661600130921\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-always\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"复制代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\ncp sourcefile destfile</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-59942a168d661600130921-1\">1</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-59942a168d661600130921-1\"><span class=\"crayon-e\">cp </span><span class=\"crayon-e\">sourcefile </span><span class=\"crayon-v\">destfile</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0003 seconds] -->\r\n<p>在终端中执行此命令，上述命令将名为 <span style=\"color: #ff0000\"><strong>sourcefile</strong></span> 的文件复制到名为<span style=\"color: #ff0000\"> <strong>destfile</strong></span> 的文件中。如果在执行命令之前 <span style=\"color: #ff0000\"><strong>destfile</strong></span> 文件不存在，那将会创建此文件，如果已经存在，那就会覆盖此文件。</p>\n<p>这个命令我不知道自己用了多少次了（我也不想知道），但是我知道在我编写测试代码的时候，我经常用，为了保留当前正常的版本，而且又能继续修改，我会输入这个命令：</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-59942a168d66b269827612\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-always\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"复制代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\ncp test1.py test1.bak</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-59942a168d66b269827612-1\">1</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-59942a168d66b269827612-1\"><span class=\"crayon-e\">cp </span><span class=\"crayon-v\">test1</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">py </span><span class=\"crayon-v\">test1</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">bak</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0004 seconds] -->\r\n<p>在过去的30多年里，我使用了无数次这个命令。另外，当我决定编写我的第二个版本的测试程序时，我会输入这个命令：</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-59942a168d674546932330\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-always\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"复制代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\ncp test1.py test2.py</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-59942a168d674546932330-1\">1</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-59942a168d674546932330-1\"><span class=\"crayon-e\">cp </span><span class=\"crayon-v\">test1</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">py </span><span class=\"crayon-v\">test2</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">py</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0004 seconds] -->\r\n<p>这样就完成了修改程序的第一步。</p>\n<p>我通常很少查看 <span style=\"color: #ff0000\"><strong>cp</strong></span> 命令的参考文档，但是当我在备份我的图片文件夹的时候（在 GUI 环境下使用 “file” 应用），我开始思考“在 <span style=\"color: #ff0000\"><strong>cp</strong></span> 命令中是否有个参数支持只复制新文件或者是修改过的文件。”果然，真的有！</p>\n<h1 id=\"toc_1\">高效用法 1：更新你的文件夹</h1>\n<p>比如说在我的电脑上有一个存放各种文件的文件夹，另外我要不时的往里面添加一些新文件，而且我会不时地修改一些文件，例如我手机里下载的照片或者是音乐。</p>\n<p>假设我收集的这些文件对我而言都很有价值，我有时候会想做个拷贝，就像是“快照”一样将文件保存在其它媒体。当然目前有很多程序都支持备份，但是我想更为精确的将目录结构复制到可移动设备中，方便于我经常使用这些离线设备或者连接到其它电脑上。</p>\n<p><span style=\"color: #ff0000\"><strong>cp</strong></span> 命令提供了一个易如反掌的方法。例子如下：</p>\n<p>在我的 <span style=\"color: #ff0000\"><strong>Pictures</strong></span> 文件夹下，我有这样一个文件夹名字为 <span style=\"color: #ff0000\"><strong>Misc</strong></span>。为了方便说明，我把文件拷贝到 USB 存储设备上。让我们开始吧！</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-59942a168d679313655767\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-always\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"复制代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\nme@desktop:~/Pictures$ cp -r Misc /media/clh/4388-D5FE\r\nme@desktop:~/Pictures$</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-59942a168d679313655767-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59942a168d679313655767-2\">2</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-59942a168d679313655767-1\"><span class=\"crayon-v\">me</span><span class=\"crayon-sy\">@</span><span class=\"crayon-v\">desktop</span><span class=\"crayon-o\">:</span><span class=\"crayon-o\">~</span><span class=\"crayon-o\">/</span><span class=\"crayon-v\">Pictures</span><span class=\"crayon-sy\">$</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">cp</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-</span><span class=\"crayon-i\">r</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Misc</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">/</span><span class=\"crayon-v\">media</span><span class=\"crayon-o\">/</span><span class=\"crayon-v\">clh</span><span class=\"crayon-o\">/</span><span class=\"crayon-cn\">4388</span><span class=\"crayon-o\">-</span><span class=\"crayon-e\">D5FE</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59942a168d679313655767-2\"><span class=\"crayon-v\">me</span><span class=\"crayon-sy\">@</span><span class=\"crayon-v\">desktop</span><span class=\"crayon-o\">:</span><span class=\"crayon-o\">~</span><span class=\"crayon-o\">/</span><span class=\"crayon-v\">Pictures</span><span class=\"crayon-sy\">$</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0008 seconds] -->\r\n<p>上面的命令是我从按照终端窗口中完整复制下来的。对于有些人来说不是很适应这种环境，在我们输入命令或者执行命令之前，需要注意的是 <span style=\"color: #ff0000\"><strong>me@mydesktop:~/Pictures</strong></span> 这个前缀，<span style=\"color: #ff0000\"><strong>me</strong></span> 这个是当前用户，<span style=\"color: #ff0000\"><strong>mydesktop</strong></span> 这是电脑名称，<span style=\"color: #ff0000\"><strong>~/Pictures</strong></span> 这个是当前工作目录，是 <span style=\"color: #ff0000\"><strong>/home/me/Pictures</strong></span> 完整路径的缩写。</p>\n<p>我输入这个命令 <span style=\"color: #ff0000\"><strong>cp -r Misc /media/clh/4388-D5FE</strong></span> 并执行后 ，拷贝<span style=\"color: #ff0000\"> <strong>Misc</strong></span> 目录下所有文件（这个 <span style=\"color: #ff0000\"><strong>-r</strong></span> 参数，全称 “recursive”，递归处理，意思为本目录下所有文件及子目录一起处理）到我的 USB 设备的挂载目录<span style=\"color: #ff0000\"> <strong>/media/clh/4388-D5FE</strong></span>。</p>\n<p>执行命令后回到之前的提示，大多数命令继承了 Unix 的特性，在命令执行后，如果没有任何异常什么都不显示，在任务结束之前不会显示像 “execution succeeded” 这样的提示消息。如果想获取更多的反馈，就使用 <span style=\"color: #ff0000\"><strong>-v</strong></span> 参数让执行结果更详细。</p>\n<p>下图中是我的 USB 设备中刚刚拷贝过来的文件夹 <span style=\"color: #ff0000\"><strong>Misc</strong></span> ，里面总共有 9 张图片。</p>\n<p><a href=\"http://jbcdn2.b0.upaiyun.com/2017/08/0f3b1cf0b9d183fb000f5687784e8852.png\"><img class=\"aligncenter wp-image-112174 size-full\" src=\"http://jbcdn2.b0.upaiyun.com/2017/08/0f3b1cf0b9d183fb000f5687784e8852.png\" alt=\"134531uhe4siy48m1t4goo\" width=\"232\" height=\"197\"></a></p>\n<p>假设我要在原始拷贝路径下 <span style=\"color: #ff0000\"><strong>~/Pictures/Misc</strong></span> 下添加一些新文件，就像这样：</p>\n<p><a href=\"http://jbcdn2.b0.upaiyun.com/2017/08/ac252c3c4d39bb62fd126ffce53ed5d1.png\"><img class=\"aligncenter wp-image-112172 size-full\" src=\"http://jbcdn2.b0.upaiyun.com/2017/08/ac252c3c4d39bb62fd126ffce53ed5d1.png\" alt=\"134531uhe4siy48m1t4goo\" width=\"272\" height=\"333\"></a></p>\n<p>现在我想只拷贝新的文件到我的存储设备上，我就使用 <span style=\"color: #ff0000\"><strong>cp</strong> </span>的“更新”和“详细”选项。</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-59942a168d67d854852929\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-always\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"复制代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\nme@desktop:~/Pictures$ cp -r -u -v Misc /media/clh/4388-D5FE\r\n'Misc/asunder.png' -&gt; '/media/clh/4388-D5FE/Misc/asunder.png'\r\n'Misc/editing tags guayadeque.png' -&gt; '/media/clh/4388-D5FE/Misc/editing tags guayadeque.png'\r\n'Misc/misc on usb.png' -&gt; '/media/clh/4388-D5FE/Misc/misc on usb.png'\r\nme@desktop:~/Pictures$</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-59942a168d67d854852929-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59942a168d67d854852929-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-59942a168d67d854852929-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59942a168d67d854852929-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-59942a168d67d854852929-5\">5</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-59942a168d67d854852929-1\"><span class=\"crayon-v\">me</span><span class=\"crayon-sy\">@</span><span class=\"crayon-v\">desktop</span><span class=\"crayon-o\">:</span><span class=\"crayon-o\">~</span><span class=\"crayon-o\">/</span><span class=\"crayon-v\">Pictures</span><span class=\"crayon-sy\">$</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">cp</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-</span><span class=\"crayon-v\">r</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-</span><span class=\"crayon-v\">u</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-</span><span class=\"crayon-i\">v</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Misc</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">/</span><span class=\"crayon-v\">media</span><span class=\"crayon-o\">/</span><span class=\"crayon-v\">clh</span><span class=\"crayon-o\">/</span><span class=\"crayon-cn\">4388</span><span class=\"crayon-o\">-</span><span class=\"crayon-i\">D5FE</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59942a168d67d854852929-2\"><span class=\"crayon-s\">'Misc/asunder.png'</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">'/media/clh/4388-D5FE/Misc/asunder.png'</span></div><div class=\"crayon-line\" id=\"crayon-59942a168d67d854852929-3\"><span class=\"crayon-s\">'Misc/editing tags guayadeque.png'</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">'/media/clh/4388-D5FE/Misc/editing tags guayadeque.png'</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59942a168d67d854852929-4\"><span class=\"crayon-s\">'Misc/misc on usb.png'</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">'/media/clh/4388-D5FE/Misc/misc on usb.png'</span></div><div class=\"crayon-line\" id=\"crayon-59942a168d67d854852929-5\"><span class=\"crayon-v\">me</span><span class=\"crayon-sy\">@</span><span class=\"crayon-v\">desktop</span><span class=\"crayon-o\">:</span><span class=\"crayon-o\">~</span><span class=\"crayon-o\">/</span><span class=\"crayon-v\">Pictures</span><span class=\"crayon-sy\">$</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0013 seconds] -->\r\n<p>上面的第一行中是<span style=\"color: #ff0000\"> <strong>cp</strong></span> 命令和具体的参数（<span style=\"color: #ff0000\"><strong>-r</strong></span> 是“递归”， <span style=\"color: #ff0000\"><strong>-u</strong></span> 是“更新”，<span style=\"color: #ff0000\"><strong>-v</strong></span> 是“详细”）。接下来的三行显示被复制文件的信息，最后一行显示命令行提示符。</p>\n<p>通常来说，参数 <span style=\"color: #ff0000\"><strong>-r</strong></span> 也可用更详细的风格 <span style=\"color: #ff0000\"><strong>–recursive</strong></span>。但是以简短的方式，也可以这么连用 <span style=\"color: #ff0000\"><strong>-ruv</strong></span>。</p>\n<h1 id=\"toc_2\">高效用法 2：版本备份</h1>\n<p>回到一开始的例子中，我在开发的时候定期给我的代码版本进行备份。然后我找到了另一种更好用的 <span style=\"color: #ff0000\"><strong>cp</strong></span> 参数。</p>\n<p>假设我正在编写一个非常有用的 Python 程序，作为一个喜欢不断修改代码的开发者，我会在一开始编写一个程序简单版本，然后不停的往里面添加各种功能直到它能成功的运行起来。比方说我的第一个版本就是用 Python 程序打印出 “hello world”。这只有一行代码的程序就像这样：</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-59942a168d684819016332\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-always\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"复制代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\nprint 'hello world'</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-59942a168d684819016332-1\">1</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-59942a168d684819016332-1\"><span class=\"crayon-i\">print</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">'hello world'</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0003 seconds] -->\r\n<p>然后我将这个代码保存成文件命名为 <span style=\"color: #ff0000\"><strong>test1.py</strong></span>。我可以这么运行它：</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-59942a168d688095407946\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-always\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"复制代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\nme@desktop:~/Test$ python test1.py\r\nhello world\r\nme@desktop:~/Test$</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-59942a168d688095407946-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59942a168d688095407946-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-59942a168d688095407946-3\">3</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-59942a168d688095407946-1\"><span class=\"crayon-v\">me</span><span class=\"crayon-sy\">@</span><span class=\"crayon-v\">desktop</span><span class=\"crayon-o\">:</span><span class=\"crayon-o\">~</span><span class=\"crayon-o\">/</span><span class=\"crayon-v\">Test</span><span class=\"crayon-sy\">$</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">python </span><span class=\"crayon-v\">test1</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">py</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59942a168d688095407946-2\"><span class=\"crayon-e\">hello </span><span class=\"crayon-e\">world</span></div><div class=\"crayon-line\" id=\"crayon-59942a168d688095407946-3\"><span class=\"crayon-v\">me</span><span class=\"crayon-sy\">@</span><span class=\"crayon-v\">desktop</span><span class=\"crayon-o\">:</span><span class=\"crayon-o\">~</span><span class=\"crayon-o\">/</span><span class=\"crayon-v\">Test</span><span class=\"crayon-sy\">$</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0006 seconds] -->\r\n<p>现在程序可以运行了，我想在添加新的内容之前进行备份。我决定使用带编号的备份选项，如下：</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-59942a168d68b365663489\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-always\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"复制代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\nclh@vancouver:~/Test$ cp --force --backup=numbered test1.py test1.py\r\nclh@vancouver:~/Test$ ls\r\ntest1.py &amp;nbsp;test1.py.~1~\r\nclh@vancouver:~/Test$</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-59942a168d68b365663489-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59942a168d68b365663489-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-59942a168d68b365663489-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59942a168d68b365663489-4\">4</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-59942a168d68b365663489-1\"><span class=\"crayon-v\">clh</span><span class=\"crayon-sy\">@</span><span class=\"crayon-v\">vancouver</span><span class=\"crayon-o\">:</span><span class=\"crayon-o\">~</span><span class=\"crayon-o\">/</span><span class=\"crayon-v\">Test</span><span class=\"crayon-sy\">$</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">cp</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">--</span><span class=\"crayon-v\">force</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">--</span><span class=\"crayon-v\">backup</span><span class=\"crayon-o\">=</span><span class=\"crayon-e\">numbered </span><span class=\"crayon-v\">test1</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">py </span><span class=\"crayon-v\">test1</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">py</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59942a168d68b365663489-2\"><span class=\"crayon-v\">clh</span><span class=\"crayon-sy\">@</span><span class=\"crayon-v\">vancouver</span><span class=\"crayon-o\">:</span><span class=\"crayon-o\">~</span><span class=\"crayon-o\">/</span><span class=\"crayon-v\">Test</span><span class=\"crayon-sy\">$</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">ls</span></div><div class=\"crayon-line\" id=\"crayon-59942a168d68b365663489-3\"><span class=\"crayon-v\">test1</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">py</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">&amp;</span><span class=\"crayon-v\">nbsp</span><span class=\"crayon-sy\">;</span><span class=\"crayon-v\">test1</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">py</span><span class=\"crayon-sy\">.</span><span class=\"crayon-o\">~</span><span class=\"crayon-cn\">1</span><span class=\"crayon-o\">~</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59942a168d68b365663489-4\"><span class=\"crayon-v\">clh</span><span class=\"crayon-sy\">@</span><span class=\"crayon-v\">vancouver</span><span class=\"crayon-o\">:</span><span class=\"crayon-o\">~</span><span class=\"crayon-o\">/</span><span class=\"crayon-v\">Test</span><span class=\"crayon-sy\">$</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0013 seconds] -->\r\n<p>所以，上面的做法是什么意思呢？</p>\n<p>第一，这个<span style=\"color: #ff0000\"> <strong>–backup=numbered</strong></span> 参数意思为“我要做个备份，而且是带编号的连续备份”。所以一个备份就是 1 号，第二个就是 2 号，等等。</p>\n<p>第二，如果源文件和目标文件名字是一样的。通常我们使用 <span style=\"color: #ff0000\"><strong>cp</strong></span> 命令去拷贝成自己，会得到这样的报错信息：</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-59942a168d68e265147873\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-always\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"复制代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\ncp: 'test1.py' and 'test1.py' are the same file</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-59942a168d68e265147873-1\">1</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-59942a168d68e265147873-1\"><span class=\"crayon-v\">cp</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">'test1.py'</span><span class=\"crayon-h\"> </span><span class=\"crayon-st\">and</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">'test1.py'</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">are </span><span class=\"crayon-e\">the </span><span class=\"crayon-e\">same </span><span class=\"crayon-v\">file</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0005 seconds] -->\r\n<p>在特殊情况下，如果我们想备份的源文件和目标文件名字相同，我们使用<span style=\"color: #ff0000\"> <strong>–force</strong></span> 参数。</p>\n<p>第三，我使用 <span style=\"color: #ff0000\"><strong>ls</strong> </span>（意即 “list”）命令来显示现在目录下的文件，名字为 <span style=\"color: #ff0000\"><strong>test1.py</strong></span> 的是原始文件，名字为 <span style=\"color: #ff0000\"><strong>test1.py.~1~</strong></span> 的是备份文件</p>\n<p>假如现在我要加上第二个功能，在程序里加上另一行代码，可以打印 “Kilroy was here.”。现在程序文件 <span style=\"color: #ff0000\"><strong>test1.py</strong></span> 的内容如下：</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-59942a168d692921621262\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-always\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"复制代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\nprint 'hello world'\r\nprint 'Kilroy was here'</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-59942a168d692921621262-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59942a168d692921621262-2\">2</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-59942a168d692921621262-1\"><span class=\"crayon-i\">print</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">'hello world'</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59942a168d692921621262-2\"><span class=\"crayon-i\">print</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">'Kilroy was here'</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0004 seconds] -->\r\n<p>看到 Python 编程多么简单了吗？不管怎样，如果我再次执行备份的步骤，结果如下：</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-59942a168d697257092451\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-always\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"复制代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\nclh@vancouver:~/Test$ cp --force --backup=numbered test1.py test1.py\r\nclh@vancouver:~/Test$ ls\r\ntest1.py test1.py.~1~ test1.py.~2~\r\nclh@vancouver:~/Test$</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-59942a168d697257092451-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59942a168d697257092451-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-59942a168d697257092451-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59942a168d697257092451-4\">4</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-59942a168d697257092451-1\"><span class=\"crayon-v\">clh</span><span class=\"crayon-sy\">@</span><span class=\"crayon-v\">vancouver</span><span class=\"crayon-o\">:</span><span class=\"crayon-o\">~</span><span class=\"crayon-o\">/</span><span class=\"crayon-v\">Test</span><span class=\"crayon-sy\">$</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">cp</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">--</span><span class=\"crayon-v\">force</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">--</span><span class=\"crayon-v\">backup</span><span class=\"crayon-o\">=</span><span class=\"crayon-e\">numbered </span><span class=\"crayon-v\">test1</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">py </span><span class=\"crayon-v\">test1</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">py</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59942a168d697257092451-2\"><span class=\"crayon-v\">clh</span><span class=\"crayon-sy\">@</span><span class=\"crayon-v\">vancouver</span><span class=\"crayon-o\">:</span><span class=\"crayon-o\">~</span><span class=\"crayon-o\">/</span><span class=\"crayon-v\">Test</span><span class=\"crayon-sy\">$</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">ls</span></div><div class=\"crayon-line\" id=\"crayon-59942a168d697257092451-3\"><span class=\"crayon-v\">test1</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">py </span><span class=\"crayon-v\">test1</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">py</span><span class=\"crayon-sy\">.</span><span class=\"crayon-o\">~</span><span class=\"crayon-cn\">1</span><span class=\"crayon-o\">~</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">test1</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">py</span><span class=\"crayon-sy\">.</span><span class=\"crayon-o\">~</span><span class=\"crayon-cn\">2</span><span class=\"crayon-o\">~</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59942a168d697257092451-4\"><span class=\"crayon-v\">clh</span><span class=\"crayon-sy\">@</span><span class=\"crayon-v\">vancouver</span><span class=\"crayon-o\">:</span><span class=\"crayon-o\">~</span><span class=\"crayon-o\">/</span><span class=\"crayon-v\">Test</span><span class=\"crayon-sy\">$</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0014 seconds] -->\r\n<p>现在我有有两个备份文件：<span style=\"color: #ff0000\"> <strong>test1.py.~1~</strong></span> 包含了一行代码的程序，和<span style=\"color: #ff0000\"> <strong>test1.py.~2~</strong></span> 包含两行代码的程序。</p>\n<p>这个很好用的功能，我考虑做个 shell 函数让它变得更简单。</p>\n<h1 id=\"toc_3\">最后总结</h1>\n<p>第一，Linux 手册页，它在大多数桌面和服务器发行版都默认安装了，它提供了更为详细的使用方法和例子，对于 <span style=\"color: #ff0000\"><strong>cp</strong> </span>命令，在终端中输入如下命令：</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-59942a168d69b346574793\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-always\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"复制代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\nman cp</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-59942a168d69b346574793-1\">1</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-59942a168d69b346574793-1\"><span class=\"crayon-e\">man </span><span class=\"crayon-v\">cp</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0003 seconds] -->\r\n<p>对于那些想学习如何使用这些命令，但不清楚如何使用的用户应该首先看一下这些说明，然后我建议创建一个测试目录和文件来尝试使用命令和选项。</p>\n<p>第二，兴趣是最好的老师。在你最喜欢的搜索引擎中搜索 “linux shell tutorial”，你会获得很多有趣和有用的资源。</p>\n<p>第三，你是不是在想，“为什么我要用这么麻烦的方法，图形化界面中有相同的功能，只用点击几下岂不是更简单？”，关于这个问题我有两个理由。首先，在我们工作中需要中断其他工作流程以及大量使用点击动作时，点击动作可就不简单了。其次，如果我们要完成流水线般的重复性工作，通过使用 shell 脚本和 shell 函数以及 shell 重命名等功能就能很轻松的实现。</p>\n<p>你还知道关于 <span style=\"color: #ff0000\"><strong>cp</strong></span> 命令其他更棒的使用方式吗？请在留言中积极回复哦～</p>\n<hr>\n<p><strong>作者简介：</strong></p>\n<p>Chris Hermansen – 1978 年毕业于英国哥伦比亚大学后一直从事计算机相关职业，我从 2005 年开始一直使用 Linux、Solaris、SunOS，在那之前我就是 Unix 系统管理员了，在技术方面，我的大量的职业生涯都是在做数据分析，尤其是空间数据分析，我有大量的编程经验与数据分析经验，熟练使用 awk、Python、PostgreSQL、PostGIS 和 Groovy。</p>\n\r\n        \r\n        \r\n        \n    <div class=\"post-adds\">\n        <span data-post-id=\"112170\" class=\" btn-bluet-bigger href-style vote-post-up   register-user-only \"><i class=\"fa  fa-thumbs-o-up\"></i> <h10 id=\"112170votetotal\">1</h10> 赞</span>\n        <span data-book-type=\"1\" data-site-id=\"2\" data-item-id=\"112170\" data-item-type=\"1\" class=\" btn-bluet-bigger href-style bookmark-btn  register-user-only \"><i class=\"fa fa-bookmark-o  \"></i> 4 收藏</span>\n\n                    <a href=\"#article-comment\"><span class=\"btn-bluet-bigger href-style hide-on-480\"><i class=\"fa fa-comments-o\"></i>  评论</span></a>\n        \n        \n        \n        <!-- JiaThis Button BEGIN -->\n        <div class=\"jiathis_style_24x24\" style=\"display: inline-flex; position: relative; margin: 0; clear: both;float: right;\">\n            <a class=\"jiathis_button_tsina\"></a>\n            <a class=\"jiathis_button_weixin\"></a>\n            <a class=\"jiathis_button_qzone\"></a>\n            <a class=\"jiathis_button_fb hide-on-480\"></a>\n            <a href=\"http://www.jiathis.com/share?uid=1745061\" class=\"jiathis jiathis_txt jiathis_separator jtico jtico_jiathis\" target=\"_blank\"></a>\n        </div>\n\n    </div>\n\n\n\n\r\n        <!-- BEGIN #author-bio -->\r\n\r\n\r\n<!-- END #author-bio -->\r\n\t</div>", "front_image_path": ["full/7b24293fbe6045a1275fe33c8ba3bdde76732dbb.jpg"]},{"title": "如何做有效的Code Review？我有这些建议", "url": "http://blog.jobbole.com/112050/", "url_object_id": "5eda13472020b0a94aa6bc350676f012", "create_date": "2017/08/15", "front_image_url": ["http://jbcdn2.b0.upaiyun.com/2016/04/8d67b7db1e9704c55aad01b886ec4c46.jpg"], "praise_nums": "1", "fav_nums": 0, "comment_nums": 0, "tags": "IT技术,Code Review", "content": "<div class=\"entry\">\r\n\r\n        \t\t\t<div class=\"textwidget\"></div>\n\t\t\r\n\t\t<div class=\"copyright-area\">本文由 <a href=\"http://blog.jobbole.com\">伯乐在线</a> - <a href=\"http://www.jobbole.com/members/maifansnet\">maifans</a> 翻译，<a href=\"http://www.jobbole.com/members/hearingdog\">BEASTQ</a> 校稿。未经许可，禁止转载！<br>英文出处：<a target=\"_blank\" href=\"https://codeahoy.com/2016/04/03/effective-code-reviews/\">codeahoy</a>。欢迎加入<a target=\"_blank\" href=\"http://group.jobbole.com/category/feedback/trans-team/\">翻译组</a>。</div><p>代码评审（Code review）是保证代码质量的一种有效手段，做得好的话，对公司来讲是一笔收益颇高的时间投资。但实践起来往往变成了炫耀编程技能、固执己见、恶言相向、同事关系恶化的事，这该如何是好？</p>\n<p>往往代码评审过程中，评审者（Reviewer）往往会过于关心旁枝末节，而忽视主要问题，也就是所谓的自行车棚效应。在批准价值百亿的核电站的建设提案中，专家们往往会浪费大量时间纠结于厂内自行车棚（bikeshed）的颜色；因为核电站太大、太复杂，“专家们”未必真懂，但总不能不说话啊，那就从无关痛痒的自行车棚挑毛病吧。</p>\n<p><img class=\"alignnone aligncenter\" src=\"http://jbcdn2.b0.upaiyun.com/2013/02/how-to-code-review.jpg\" width=\"400\" height=\"649\"></p>\n<h3>有效的代码评审</h3>\n<p>代码评审是开发人员编写的代码由另一个人检查以查找缺陷和改进的过程。换句话说，开发人员大部分都是独立编写代码的，当代码完成之后，他们会召集一次评审。</p>\n<p>代码评审是提高软件质量的有效途径。在Google，所有代码都要经过同行评审。引用《<a href=\"https://www.amazon.cn/gp/product/B0061XKRXA/ref=as_li_qf_sp_asin_il_tl?ie=UTF8&amp;camp=536&amp;creative=3200&amp;creativeASIN=B0061XKRXA&amp;linkCode=as2&amp;tag=vastwork-23\" target=\"_blank\">代码大全（第2版）</a>》中的几个例子：</p>\n<blockquote>\n<ul>\n<li>IBM 的 Orbit 项目有 50 万行代码，使用了 11 级的检查。它提前交付，并且只有通常预期错误的百分之一。</li>\n<li>一份对 AT＆T 的一个 200 多人组织的研究报告显示，在引入评审后，生产率提高了14％，缺陷减少了90％。</li>\n<li>喷气推进实验室估计，通过早期发现和修复缺陷，每次评审节省约 25,000 美元。</li>\n</ul>\n</blockquote>\n<p>然而，不少团队在有效的代码评审争论中，失去了原本的效益。在功能失调的团队和组织中，对所有参与者来说它可以迅速变成一个<b>令人不快的经历</b>：</p>\n<ul>\n<li>它成为评审人员来展示技能的平台。他们在别人的代码中指出“错误”，并强加自己没有价值的“意见”。</li>\n<li>在代码完全就绪前，开发人员会非常抗拒别人审查他们的代码 ——可以说这可能是一件好事，但他没有真正理解评审的意义。</li>\n<li>开发人员放弃代码所有权，并开始依赖他人查找问题。</li>\n</ul>\n<p>在这篇文章中，我将讨论团队和组织可以做的一些事情，让代码评审为所有参与者带来愉快的体验。</p>\n<h3>对管理层的建议：营造健康文化</h3>\n<p><strong>有效的代码评审，需要一个重视质量和卓越的健康文化。</strong>如果团队不以提供高质量的产品为信仰，代码评审将不会给您所期望的结果。你需要一个人人参与的积极文化—立足于建设性批评，智者胜。</p>\n<p><strong>除了创造一个健康文化，并允许花时间和资源进行评审，管理者在代码评审中应保持低姿态。</strong>大多数人不想在上司面前暴露自己的秘密，这已是一种文化。代码评审最好由同行进行，管理层不应该询问可以用来评价人的细节<span style=\"font-family: Helvetica, sans-serif;\">。</span>的确有一些管理人员索要检查表和成绩，以便他们可以<span style=\"font-family: Helvetica, sans-serif;\">“</span>衡量<span style=\"font-family: Helvetica, sans-serif;\">”</span>并评价人。</p>\n<p><strong>可能你已经有一个健康的文化（算你幸运）。</strong>这还不够，营造健康的文化取决于许多因素（团队和组织内部）。这是非常具有挑战性的，没有灵丹妙药。没有正确的文化，代码评审不会带来期望的收获，甚至在极端情况下可能会适得其反。</p>\n<h3>对个人的建议：换位思考</h3>\n<p>Karl Wiegers 在他的《Peer Reviews in Software: A Practical Guide》中写道：</p>\n<blockquote><p>产品的作者与评审者之间的互动至关重要。<span style=\"color: #515151;\">作者必须足够信任和尊重评审者才能接受他们的意见。</span> <span style=\"color: #515151;\">同样，评审者必须尊重作者的才华和辛勤工作。评审者应谨慎选择他们用来提出问题的词汇，重点关注他们对产品的观察。说『我没有看到这些变量被初始化</span> <span style=\"color: #515151;\">』可能会引发建设性的反馈</span>， 而『你没有初始化这些变量』可能会让作者非常不爽。</p></blockquote>\n<p>关注代码很容易，但不要忘记，桌子（或计算机）的另一端有一个人。他有主见有<span style=\"font-family: Helvetica, sans-serif;\">“</span>自我<span style=\"font-family: Helvetica, sans-serif;\">”</span>。请记住，解决问题的方式有很多。</p>\n<ul>\n<li><strong>要谦虚。</strong>我既见过非常高效的评审，也见过因为吹毛求疵而非常低效的评审<span style=\"font-family: Helvetica, sans-serif;\">。</span>不要吹毛求疵<span style=\"font-family: Helvetica, sans-serif;\">！！！</span></li>\n<li><strong>确保您有编码标准<span style=\"font-family: Helvetica, sans-serif;\">。</span></strong>编码标准是在组织中共享的人人都认同的一套准则。如果你没有编码标准，那么不要让讨论变成一个比较编码风格的比赛（大括号 <span style=\"font-family: Helvetica, sans-serif;\"><strong><span style=\"color: #ff0000;\">{</span></strong> </span>在同一行还是下一行！）如果你遇到这样的情况，请在编码标准论坛上离线讨论<span style=\"font-family: Helvetica, sans-serif;\">。</span></li>\n<li><strong>学会良好地沟通。</strong>你必须能够清楚地表达想法和理由。</li>\n<li><strong>编程策略是一个仁者见仁智者见智的问题。</strong>评审者和开发人员应该寻求理解彼此的观点，而不应该成为哲学辩论</li>\n</ul>\n<h3>对评审者的建议：谦虚</h3>\n<ul>\n<li><strong>开发者不是冤大头。</strong>评审的目的不是证明谁是更优秀的程序员而是查找缺陷，并确保代码是简单和可维护的。</li>\n<li><strong>问问题。</strong>不要提出可能听起来带指责的要求或言论。例如，不要说：『你没有遵循标准<span style=\"font-family: Helvetica, sans-serif;\">XYZ</span>』。更好的方式是真正寻求理解开发者的观点：『你对标准 <span style=\"font-family: Helvetica, sans-serif;\">XYZ </span>有什么看法，它是否适用于这里？』，这可以引到我的下一个观点。</li>\n<li><strong>避免『你为什么』，『你为什么不』风格的问题。</strong>它会使人对立。 『为什么把它声明为全局变量？』可以更好地表达为『我不明白为什么这里用一个全局变量』。寻找方法来简化代码。代码评审的目标之一是创建<span style=\"font-family: Helvetica, sans-serif;\">“</span>可维护<span style=\"font-family: Helvetica, sans-serif;\">”</span>软件。</li>\n<li><strong>记住要欣赏并感谢对方。</strong>人们经常忘记一句简单的『干得好』或『它看起来很棒』的影响有多大。</li>\n</ul>\n<p>有些事情，如果看起来像排练过的或以讽刺的语气说出来，就不会奏效。像正常对话一样对待代码评审。你正在聆听他人，应该真正寻求理解他们的观点。需要时提供建议和提示。如果代码很棒，不要强迫找一些消极的来说。</p>\n<h3>对开发者的建议：它不是个人的事情</h3>\n<ul>\n<li><strong>不要感情用事。</strong>记住，别人说的不是，是代码中的缺陷或不足，而不是你。</li>\n<li><strong>意识到你和你的代码是捆绑在一起是正常的事情。</strong>如果你为自己的工作感到自豪，那是一个很好的迹象，说明你是一个关心作品的人。</li>\n<li><strong>有适当的自我。</strong><span style=\"font-family: Helvetica, sans-serif;\">足够信任和捍卫自己的观点，但又不至于盲目拒绝对方的好建议和意见</span>。</li>\n<li><strong>人非圣贤孰能无过。</strong>评审者作为第二双眼，可以指出你可能忽略的事情。问题与具体建议一样有价值。</li>\n<li><strong>提问题要有针对性。</strong>『将所有这些类纳入它们自己的软件包中是否更有意义』</li>\n<li><strong>感谢审稿人的时间和他们可能提供的任何反馈。</strong></li>\n</ul>\n<h3>总结</h3>\n<p><span style=\"font-family: Helvetica, sans-serif;\">同行评审是人们互相交流，而无效（ineffectiveness）则源于社会学问题。然而，管理者花费大量时间在操心使用哪些惊艳的工具。</span>工具会有所帮助，但只有工具并不会神奇地带来结果。立足于正确的文化同时<span style=\"font-family: Helvetica, sans-serif;\">…</span>换位思考，以人为本！<span style=\"font-family: Helvetica, sans-serif;\"> :-)</span></p>\n\r\n        \r\n        \r\n        \n    <div class=\"post-adds\">\n        <span data-post-id=\"112050\" class=\" btn-bluet-bigger href-style vote-post-up   register-user-only \"><i class=\"fa  fa-thumbs-o-up\"></i> <h10 id=\"112050votetotal\">1</h10> 赞</span>\n        <span data-book-type=\"1\" data-site-id=\"2\" data-item-id=\"112050\" data-item-type=\"1\" class=\" btn-bluet-bigger href-style bookmark-btn  register-user-only \"><i class=\"fa fa-bookmark-o  \"></i>  收藏</span>\n\n                    <a href=\"#article-comment\"><span class=\"btn-bluet-bigger href-style hide-on-480\"><i class=\"fa fa-comments-o\"></i>  评论</span></a>\n        \n        \n        \n        <!-- JiaThis Button BEGIN -->\n        <div class=\"jiathis_style_24x24\" style=\"display: inline-flex; position: relative; margin: 0; clear: both;float: right;\">\n            <a class=\"jiathis_button_tsina\"></a>\n            <a class=\"jiathis_button_weixin\"></a>\n            <a class=\"jiathis_button_qzone\"></a>\n            <a class=\"jiathis_button_fb hide-on-480\"></a>\n            <a href=\"http://www.jiathis.com/share?uid=1745061\" class=\"jiathis jiathis_txt jiathis_separator jtico jtico_jiathis\" target=\"_blank\"></a>\n        </div>\n\n    </div>\n\n\n\n\r\n        <!-- BEGIN #author-bio -->\r\n\r\n<div id=\"author-bio\">\r\n\t\r\n\t<h3 class=\"widget-title\">\r\n\t关于作者：<a target=\"_blank\" href=\"http://www.jobbole.com/members/maifansnet\">maifans</a>\r\n\t</h3>\r\n\t<div class=\"alignleft\">\r\n\t\t<a target=\"_blank\" href=\"http://www.jobbole.com/members/maifansnet\">\r\n\t\t\t<img src=\"http://jbcdn2.b0.upaiyun.com/2015/04/8fbdaaa5ea6d3b49c8c1c825aafeb5d9.png\">\r\n\t\t</a>\r\n\t</div>\r\n\r\n    <div class=\"author-bio-info\">\r\n\r\n        <span class=\"author-bio-info-block\">\r\n            软件工程师，关注人工智能，关注医疗器械。        </span>\r\n        <span class=\"author-bio-info-block\">\r\n            <a href=\"http://www.jobbole.com/members/maifansnet\" target=\"_blank\"><i class=\"fa fa-user\"></i> 个人主页</a> ·\r\n            <a href=\"http://blog.jobbole.com/author/maifansnet/\" target=\"_blank\"><i class=\"fa fa-file-text-o\"></i> 我的文章</a>\r\n\r\n             · <a title=\"声望值\" target=\"_blank\" href=\"http://www.jobbole.com/members/maifansnet/reputation/\"><i class=\"fa fa-graduation-cap\"></i> 13</a>        </span>\r\n    </div>\r\n\t<div class=\"clear\"></div>\r\n</div>\r\n\r\n<!-- END #author-bio -->\r\n\t</div>", "front_image_path": ["full/dfa8fff3b99c7011381e1666d2c2ba0015a7c34f.jpg"]},{"title": "优秀的程序员都有哪些习惯？", "url": "http://blog.jobbole.com/112067/", "url_object_id": "ac282b4e104c307d34b2e97c8a8a1aa6", "create_date": "2017/08/01", "front_image_url": ["http://jbcdn2.b0.upaiyun.com/2016/11/68569d6253986872f6d708b3c9fb1426.jpeg"], "praise_nums": "1", "fav_nums": "1", "comment_nums": 0, "tags": "开发,程序员", "content": "<div class=\"entry\">\r\n\r\n        \t\t\t<div class=\"textwidget\"></div>\n\t\t\r\n\t\t<div class=\"copyright-area\">本文由 <a href=\"http://blog.jobbole.com\">伯乐在线</a> - <a href=\"http://www.jobbole.com/members/qingfeng6438\">阿慧</a> 翻译，<a href=\"http://www.jobbole.com/members/young605867996\">Lada</a> 校稿。未经许可，禁止转载！<br>英文出处：<a target=\"_blank\" href=\"https://news.ycombinator.com/item?id=14709076\">nostrademons</a>。欢迎加入<a target=\"_blank\" href=\"http://group.jobbole.com/category/feedback/trans-team/\">翻译组</a>。</div><p>【伯乐在线导读】：「我不是卓越的程序员，我只不过是一个有着卓越习惯的程序员。」技术大牛 Kent Beck 曾这样说过自己。</p>\n<p>7月初，nostrademons 在 Hacker News 发起一个讨论，是哪些习惯成就了优秀/卓越的程序员？</p>\n<hr>\n<p>可变的习惯：学习着在不同的情况中采用不同的习惯。考虑到这一点，我总结了一些适用于不同情况的通用技巧：</p>\n<h3>为了数据科学类问题研究新领域的发展：</h3>\n<p>1.尽量亲自动手去完成事情。你将会有一种直觉，知道如何去处理该事物。</p>\n<p>2.积累案例，从数据表中标注着你已获得的数据开始。</p>\n<p style=\"padding-left: 30px;\"><span style=\"color: #999999;\">（关于这一点：rluhar 评论补充说，这不仅适用于数据科学，也适用于解决任何数值问题。用一个电子表格（或一个R／Python Notebook）来实现算法并获得一些结果，在过去帮助我真正理解了问题，避免走死胡同。例如，在建立一个外汇定价系统时，我能够使用电子表格来描述定价算法是如何工作的，并向交易者（最终用户）解释它。在执行和部署算法之前，我们可以调整计算并确保一切都清楚。很好的建议！）</span></p>\n<p>3.在找到通用办法之前，先找到一种能解决当前问题的办法。</p>\n<p>4.让算法本身输出调试信息。你应该能够转储每一步的中间结果，并用文本编辑器或是 Web 浏览器手动检查它们。</p>\n<p>5.不要为单元测试操心，定义出正确行为才是首要的。</p>\n<h3>维护大的、不熟悉的代码库程序：</h3>\n<p>1.检查文件的大小。最大的文件总是包含了程序的实体部分，至少是指向程序实体内容的分派程序。 main.cc  通常很小，并且对寻找代码结构毫无用处。</p>\n<p>2.从主循环调度开始单步调试程序。可以学到很多关于控制流的东西。</p>\n<p>3.寻找数据结构，特别是做为参数传递到许多函数中的那些。大多数程序具有一个小的关键数据结构集合，找到它们，理解代码的其余部分会变得容易的多。</p>\n<p>4.写单元测试。这是确认你所理解的代码与真实代码工作方式无误的最好方法。</p>\n<p>5.移除代码，看看什么出问题了。（但不要 check in！）</p>\n<h3>性能工作：</h3>\n<p>0.一般不需要做，除非你所构建的东西对用户来说太慢了。制定出需要提高的性能目标，达成这个目标即可。</p>\n<p>1.在开始所有工作之前，甚至是在剖析（profile）之前，建立一套代表典型现实世界的使用基准。别让性能倒退，除非你确信已经登峰造极，高处不胜寒，并且更好的解决方法还藏在世界的某个角落里无人发现（如果出现了那种情况，在版本控制系统（VCS）中标记你的分支，以便在发现错误之后回来更改。）。</p>\n<p>2.许多性能瓶颈都出现在系统的交叉处。在所有 RPC 框架中搜集时间统计数据，并且有一些方式来传播和可视化每个服务器的请求时间，以及哪些部分的请求是并行的，哪里是关键路径。</p>\n<p>3.剖析（Profile）。</p>\n<p>4.通常，避免不必要的工作可使你赢在起跑线上。缓存最大的计算结果，粗略评估不常用的东西。</p>\n<p>5.不要忽视常量因素。有时候一个渐进性更差的算法在实践中执行的很好，原因是其具有更好的缓存局部性。为此，你可以在多次调用的函数中识别出威胁。</p>\n<p>6.当你获得了程序大致剖析之后，更改数据结构往往会获得更多收益。注意内存的使用，时常缩小内存需求来减小缓存压力，可显著地提高系统的速度。注意局部性，将常用数据放到一起。如果你的编程语言允许（为 Java 感到遗憾 ），可以消除指针雕镂（pointer-chasing）来支持值控制。</p>\n<blockquote><p>译注：指针雕镂（Pointer-chasing）程序：该程序中会遍历一个由指针链在一起的数据结构，即一个链表。但是在遍历的过程中会不断的引起内存操作。因为下一个元素总不在 Cache 中。</p></blockquote>\n<h3>编码常规</h3>\n<p>1.不要想当然地去构建，确保你所加入的每个特性都有客户在用。</p>\n<p>2.谨慎地控制依赖。为了某个效果而引入的库，可能会帮你节省一个小时，但也会导致更多地方被破坏——部署、版本控制、安全性、日志记录、意外的进程死亡。</p>\n<p>3.当为个人或小团体开发的时候，把出现的问题累积起来，然后一次性全部解决（或者扔掉代码库，然后重新启动）。当为大型团队开发时，永远都不要让问题堆积，代码库应该始终处于新的开发人员可以看懂的状态，他们会说：“我知道这是做什么的，也知道如何更改它”（代码的）阅读者/编写者的比例结果是这样的：初始代码的编写多过阅读，因此可读性不那么重要，但成熟代码的阅读多过编写。（当你要求开发前一种初始代码去获得用户、资金和存活了，转换到后一种成熟代码中去就是给阅读者留下的操练了。）</p>\n<p> </p>\n<p>欢迎大家补充。</p>\n\r\n        \r\n            <blockquote class=\"rewards\">\n        <p><strong>打赏支持我翻译更多好文章，谢谢！</strong></p>\n        <a href=\"#rewardbox\" id=\"rewards-button\" class=\"fancybox\"><span class=\"btn-bluet-blue href-style\"><i class=\"fa fa-jpy\"></i> 打赏译者</span></a>\n    </blockquote>\n\n    <div id=\"rewardbox\">\n        <h4>打赏支持我翻译更多好文章，谢谢！</h4>\n                <p>任选一种支付方式</p>\n                <p>\n                        <img src=\"http://jbcdn2.b0.upaiyun.com/2017/02/f9e94e087837b17681c87206c9d540dd.png\">\n            \n                            <img src=\"http://jbcdn2.b0.upaiyun.com/2017/02/748ed21a8038cdafa65b3b4ab9a0185a.jpg\">\n                    </p>\n    </div>\n\n    \r\n        \n    <div class=\"post-adds\">\n        <span data-post-id=\"112067\" class=\" btn-bluet-bigger href-style vote-post-up   register-user-only \"><i class=\"fa  fa-thumbs-o-up\"></i> <h10 id=\"112067votetotal\">1</h10> 赞</span>\n        <span data-book-type=\"1\" data-site-id=\"2\" data-item-id=\"112067\" data-item-type=\"1\" class=\" btn-bluet-bigger href-style bookmark-btn  register-user-only \"><i class=\"fa fa-bookmark-o  \"></i> 1 收藏</span>\n\n                    <a href=\"#article-comment\"><span class=\"btn-bluet-bigger href-style hide-on-480\"><i class=\"fa fa-comments-o\"></i>  评论</span></a>\n        \n        \n        \n        <!-- JiaThis Button BEGIN -->\n        <div class=\"jiathis_style_24x24\" style=\"display: inline-flex; position: relative; margin: 0; clear: both;float: right;\">\n            <a class=\"jiathis_button_tsina\"></a>\n            <a class=\"jiathis_button_weixin\"></a>\n            <a class=\"jiathis_button_qzone\"></a>\n            <a class=\"jiathis_button_fb hide-on-480\"></a>\n            <a href=\"http://www.jiathis.com/share?uid=1745061\" class=\"jiathis jiathis_txt jiathis_separator jtico jtico_jiathis\" target=\"_blank\"></a>\n        </div>\n\n    </div>\n\n\n\n\r\n        <!-- BEGIN #author-bio -->\r\n\r\n<div id=\"author-bio\">\r\n\t\r\n\t<h3 class=\"widget-title\">\r\n\t关于作者：<a target=\"_blank\" href=\"http://www.jobbole.com/members/qingfeng6438\">阿慧</a>\r\n\t</h3>\r\n\t<div class=\"alignleft\">\r\n\t\t<a target=\"_blank\" href=\"http://www.jobbole.com/members/qingfeng6438\">\r\n\t\t\t<img src=\"http://jbcdn2.b0.upaiyun.com/2017/02/c169e93746e89947e9a2f0fce3f937cc.jpg\">\r\n\t\t</a>\r\n\t</div>\r\n\r\n    <div class=\"author-bio-info\">\r\n\r\n        <span class=\"author-bio-info-block\">\r\n            什么东西没头没尾没中间？        </span>\r\n        <span class=\"author-bio-info-block\">\r\n            <a href=\"http://www.jobbole.com/members/qingfeng6438\" target=\"_blank\"><i class=\"fa fa-user\"></i> 个人主页</a> ·\r\n            <a href=\"http://blog.jobbole.com/author/qingfeng6438/\" target=\"_blank\"><i class=\"fa fa-file-text-o\"></i> 我的文章</a>\r\n\r\n             · <a title=\"声望值\" target=\"_blank\" href=\"http://www.jobbole.com/members/qingfeng6438/reputation/\"><i class=\"fa fa-graduation-cap\"></i> 14</a> · <a title=\"QQ：1305735677\" target=\"_blank\" href=\"#\"><i class=\"fa fa-qq\"></i></a> <a title=\"个人微信：chenahui1996\" target=\"_blank\" href=\"#\"><i class=\"fa fa-weixin\"></i></a>         </span>\r\n    </div>\r\n\t<div class=\"clear\"></div>\r\n</div>\r\n\r\n<!-- END #author-bio -->\r\n\t</div>", "front_image_path": ["full/21812d9d62b935e7b375b95677300b715fa3a48f.jpg"]},{"title": "使用 Kdump 检查 Linux 内核崩溃", "url": "http://blog.jobbole.com/112099/", "url_object_id": "8e038afd8794ddc5ae01ab185cacbf44", "create_date": "2017/08/02", "front_image_url": ["http://jbcdn2.b0.upaiyun.com/2016/11/59d49abe8909a122bc2c9aa43b71e3bb.png"], "praise_nums": "1", "fav_nums": "1", "comment_nums": 0, "tags": "IT技术,dump,Linux", "content": "<div class=\"entry\">\r\n\r\n        \t\t\t<div class=\"textwidget\"></div>\n\t\t\r\n\t\t<div class=\"copyright-area\">原文出处： <a ref=\"nofollow\" target=\"_blank\" href=\"https://opensource.com/article/17/6/kdump-usage-and-internals\">opensource</a>   译文出处：<a target=\"_blank\" href=\"https://linux.cn/article-8737-1.html\">Linux中国/firmianay</a>   </div><div>\n<blockquote><p>让我们先看一下 kdump 的基本使用方法，和 kdump/kexec 在内核中是如何实现。</p></blockquote>\n<p><a href=\"https://www.kernel.org/doc/Documentation/kdump/kdump.txt\">kdump</a> 是获取崩溃的 Linux 内核转储的一种方法，但是想找到解释其使用和内部结构的文档可能有点困难。在本文中，我将研究 kdump 的基本使用方法，和 kdump/kexec 在内核中是如何实现。</p>\n<p><a href=\"https://linux.die.net/man/8/kexec\">kexec</a> 是一个 Linux 内核到内核的引导加载程序，可以帮助从第一个内核的上下文引导到第二个内核。kexec 会关闭第一个内核，绕过 BIOS 或固件阶段，并跳转到第二个内核。因此，在没有 BIOS 阶段的情况下，重新启动变得更快。</p>\n<p>kdump 可以与 kexec 应用程序一起使用 —— 例如，当第一个内核崩溃时第二个内核启动，第二个内核用于复制第一个内核的内存转储，可以使用 <span style=\"color: #ff6600;\"><code>gdb</code></span> 和 <span style=\"color: #ff6600;\"><code>crash</code></span> 等工具分析崩溃的原因。（在本文中，我将使用术语“第一内核”作为当前运行的内核，“第二内核” 作为使用 kexec 运行的内核，“捕获内核” 表示在当前内核崩溃时运行的内核。）</p>\n<p>kexec 机制在内核以及用户空间中都有组件。内核提供了几个用于 kexec 重启功能的系统调用。名为 kexec-tools 的用户空间工具使用这些调用，并提供可执行文件来加载和引导“第二内核”。有的发行版还会在 kexec-tools 上添加封装器，这有助于捕获并保存各种转储目标配置的转储。在本文中，我将使用名为 distro-kexec-tools 的工具来避免上游 kexec 工具和特定于发行版的 kexec-tools 代码之间的混淆。我的例子将使用 Fedora Linux 发行版。</p>\n<h3 id=\"toc_1\">Fedora kexec-tools 工具</h3>\n<p>使用 <span style=\"color: #ff6600;\"><code>dnf install kexec-tools</code></span> 命令在 Fedora 机器上安装 fedora-kexec-tools。在安装 fedora-kexec-tools 后可以执行 <span style=\"color: #ff6600;\"><code>systemctl start kdump</code></span> 命令来启动 kdump 服务。当此服务启动时，它将创建一个根文件系统（initramfs），其中包含了要挂载到目标位置的资源，以保存 vmcore，以及用来复制和转储 vmcore 到目标位置的命令。然后，该服务将内核和 initramfs 加载到崩溃内核区域内的合适位置，以便在内核崩溃时可以执行它们。</p>\n<p>Fedora 封装器提供了两个用户配置文件：</p>\n<ol>\n<li><span style=\"color: #ff6600;\"><code>/etc/kdump.conf</code></span> 指定修改后需要重建 initramfs 的配置参数。例如，如果将转储目标从本地磁盘更改为 NFS 挂载的磁盘，则需要由“捕获内核”所加载的 NFS 相关的内核模块。</li>\n<li><span style=\"color: #ff6600;\"><code>/etc/sysconfig/kdump</code></span> 指定修改后不需要重新构建 initramfs 的配置参数。例如，如果只需修改传递给“捕获内核”的命令行参数，则不需要重新构建 initramfs。</li>\n</ol>\n<p>如果内核在 kdump 服务启动之后出现故障，那么“捕获内核”就会执行，其将进一步执行 initramfs 中的 vmcore 保存过程，然后重新启动到稳定的内核。</p>\n<h3 id=\"toc_2\">kexec-tools 工具</h3>\n<p>编译 kexec-tools 的源代码得到了一个名为 <span style=\"color: #ff6600;\"><code>kexec</code></span> 的可执行文件。这个同名的可执行文件可用于加载和执行“第二内核”，或加载“捕获内核”，它可以在内核崩溃时执行。</p>\n<p>加载“第二内核”的命令：</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-599373d7e5563673348677\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" touchscreen minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\n# kexec -l kernel.img --initrd=initramfs-image.img –reuse-cmdline</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-599373d7e5563673348677-1\">1</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-599373d7e5563673348677-1\"><span class=\"crayon-p\"># kexec -l kernel.img --initrd=initramfs-image.img –reuse-cmdline</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0003 seconds] -->\r\n<p><span style=\"color: #ff6600;\"><code>--reuse-command</code></span> 参数表示使用与“第一内核”相同的命令行。使用 <span style=\"color: #ff6600;\"><code>--initrd</code></span> 传递 initramfs。 <span style=\"color: #ff6600;\"><code>-l</code></span> 表明你正在加载“第二内核”，其可以由 <span style=\"color: #ff6600;\"><code>kexec</code></span> 应用程序本身执行（<span style=\"color: #ff6600;\"><code>kexec -e</code></span>）。使用 <span style=\"color: #ff6600;\"><code>-l</code></span> 加载的内核不能在内核崩溃时执行。为了加载可以在内核崩溃时执行的“捕获内核”，必须传递参数 <span style=\"color: #ff6600;\"><code>-p</code></span> 取代 <span style=\"color: #ff6600;\"><code>-l</code></span>。</p>\n<p>加载捕获内核的命令：</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-599373d7e556e221348871\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" touchscreen minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\n# kexec -p kernel.img --initrd=initramfs-image.img –reuse-cmdline</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-599373d7e556e221348871-1\">1</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-599373d7e556e221348871-1\"><span class=\"crayon-p\"># kexec -p kernel.img --initrd=initramfs-image.img –reuse-cmdline</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0003 seconds] -->\r\n<p><span style=\"color: #ff6600;\"><code>echo c &gt; /pros/sysrq-trigger</code></span> 可用于使内核崩溃以进行测试。有关 kexec-tools 提供的选项的详细信息，请参阅 <span style=\"color: #ff6600;\"><code>man kexec</code></span>。在转到下一个部分之前，请看这个 kexec_dump 的演示：</p>\n<p style=\"text-align: center;\"><a href=\"https://v.qq.com/x/page/k0531jsbps7.html\" target=\"_blank\">https://v.qq.com/x/page/k0531jsbps7.html</a></p>\n<h3 id=\"toc_3\">kdump: 端到端流</h3>\n<p>下图展示了流程图。必须在引导“第一内核”期间为捕获内核保留 crashkernel 的内存。您可以在内核命令行中传递 <span style=\"color: #ff6600;\"><code>crashkernel=Y@X</code></span>，其中 <span style=\"color: #ff6600;\"><code>@X</code></span> 是可选的。<span style=\"color: #ff6600;\"><code>crashkernel=256M</code></span> 适用于大多数 x86_64 系统；然而，为崩溃内核选择适当的内存取决于许多因素，如内核大小和 initramfs，以及 initramfs 中包含的模块和应用程序运行时的内存需求。有关传递崩溃内核参数的更多方法，请参阅 <a href=\"https://github.com/torvalds/linux/blob/master/Documentation/admin-guide/kernel-parameters.txt\">kernel-parameters 文档</a>。</p>\n<p><img src=\"http://jbcdn2.b0.upaiyun.com/2017/08/673c86f0c1d5d2c8ade8526b1370a25f.png\" alt=\"pratyush_f1.png\"></p>\n<p>您可以将内核和 initramfs 镜像传递给 <span style=\"color: #ff6600;\"><code>kexec</code></span> 可执行文件，如（<span style=\"color: #ff6600;\"><code>kexec-tools</code></span>）部分的命令所示。“捕获内核”可以与“第一内核”相同，也可以不同。通常，一样即可。Initramfs 是可选的；例如，当内核使用 <span style=\"color: #ff6600;\"><code>CONFIG_INITRAMFS_SOURCE</code></span> 编译时，您不需要它。通常，从第一个 initramfs 中保存一个不一样的捕获 initramfs，因为在捕获 initramfs 中自动执行 vmcore 的副本能获得更好的效果。当执行 <span style=\"color: #ff6600;\"><code>kexec</code></span> 时，它还加载了 <span style=\"color: #ff6600;\"><code>elfcorehdr</code></span> 数据和 purgatory 可执行文件（LCTT 译注：purgatory 就是一个引导加载程序，是为 kdump 定作的。它被赋予了“炼狱”这样一个古怪的名字应该只是一种调侃）。 <span style=\"color: #ff6600;\"><code>elfcorehdr</code></span> 具有关于系统内存组织的信息，而 purgatory 可以在“捕获内核”执行之前执行并验证第二阶段的二进制或数据是否具有正确的 SHA。purgatory 也是可选的。</p>\n<p>当“第一内核”崩溃时，它执行必要的退出过程并切换到 purgatory（如果存在）。purgatory 验证加载二进制文件的 SHA256，如果是正确的，则将控制权传递给“捕获内核”。“捕获内核”根据从 <span style=\"color: #ff6600;\"><code>elfcorehdr</code></span> 接收到的系统内存信息创建 vmcore。因此，“捕获内核”启动后，您将看到 <span style=\"color: #ff6600;\"><code>/proc/vmcore</code></span> 中“第一内核”的转储。根据您使用的 initramfs，您现在可以分析转储，将其复制到任何磁盘，也可以是自动复制的，然后重新启动到稳定的内核。</p>\n<h3 id=\"toc_4\">内核系统调用</h3>\n<p>内核提供了两个系统调用：<span style=\"color: #ff6600;\"><code>kexec_load()</code></span> 和 <span style=\"color: #ff6600;\"><code>kexec_file_load()</code></span>，可以用于在执行 <span style=\"color: #ff6600;\"><code>kexec -l</code></span> 时加载“第二内核”。它还为 <span style=\"color: #ff6600;\"><code>reboot()</code></span> 系统调用提供了一个额外的标志，可用于使用 <span style=\"color: #ff6600;\"><code>kexec -e</code></span> 引导到“第二内核”。</p>\n<p><span style=\"color: #ff6600;\"><code>kexec_load()</code></span>：<span style=\"color: #ff6600;\"><code>kexec_load()</code></span> 系统调用加载一个可以在之后通过 <span style=\"color: #ff6600;\"><code>reboot()</code></span> 执行的新的内核。其原型定义如下：</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-599373d7e5574546246988\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" touchscreen minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\nlong kexec_load(unsigned long entry, unsigned long nr_segments,\r\nstruct kexec_segment *segments, unsigned long flags);</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-599373d7e5574546246988-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599373d7e5574546246988-2\">2</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-599373d7e5574546246988-1\"><span class=\"crayon-t\">long</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">kexec_load</span><span class=\"crayon-sy\">(</span><span class=\"crayon-t\">unsigned</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">long</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">entry</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">unsigned</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">long</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">nr_segments</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599373d7e5574546246988-2\"><span class=\"crayon-t\">struct</span><span class=\"crayon-h\"> </span><span class=\"crayon-e \">kexec_segment *</span><span class=\"crayon-v\">segments</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">unsigned</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">long</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">flags</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0009 seconds] -->\r\n<p>用户空间需要为不同的组件传递不同的段，如内核，initramfs 等。因此，<span style=\"color: #ff6600;\"><code>kexec</code></span> 可执行文件有助于准备这些段。<span style=\"color: #ff6600;\"><code>kexec_segment</code></span> 的结构如下所示：</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-599373d7e5578436036413\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" touchscreen minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\nstruct kexec_segment {\r\n    void *buf;\r\n    /* 用户空间缓冲区 */\r\n    size_t bufsz;\r\n    /* 用户空间中的缓冲区长度 */\r\n    void *mem;\r\n    /* 内核的物理地址 */\r\n    size_t memsz;\r\n    /* 物理地址长度 */\r\n};</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-599373d7e5578436036413-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599373d7e5578436036413-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-599373d7e5578436036413-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599373d7e5578436036413-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-599373d7e5578436036413-5\">5</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599373d7e5578436036413-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-599373d7e5578436036413-7\">7</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599373d7e5578436036413-8\">8</div><div class=\"crayon-num\" data-line=\"crayon-599373d7e5578436036413-9\">9</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599373d7e5578436036413-10\">10</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-599373d7e5578436036413-1\"><span class=\"crayon-t\">struct</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">kexec_segment</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599373d7e5578436036413-2\"><span class=\"crayon-h\">    </span><span class=\"crayon-t\">void</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">*</span><span class=\"crayon-v\">buf</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-599373d7e5578436036413-3\"><span class=\"crayon-h\">    </span><span class=\"crayon-c\">/* 用户空间缓冲区 */</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599373d7e5578436036413-4\"><span class=\"crayon-h\">    </span><span class=\"crayon-e\">size_t </span><span class=\"crayon-v\">bufsz</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-599373d7e5578436036413-5\"><span class=\"crayon-h\">    </span><span class=\"crayon-c\">/* 用户空间中的缓冲区长度 */</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599373d7e5578436036413-6\"><span class=\"crayon-h\">    </span><span class=\"crayon-t\">void</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">*</span><span class=\"crayon-v\">mem</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-599373d7e5578436036413-7\"><span class=\"crayon-h\">    </span><span class=\"crayon-c\">/* 内核的物理地址 */</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599373d7e5578436036413-8\"><span class=\"crayon-h\">    </span><span class=\"crayon-e\">size_t </span><span class=\"crayon-v\">memsz</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-599373d7e5578436036413-9\"><span class=\"crayon-h\">    </span><span class=\"crayon-c\">/* 物理地址长度 */</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599373d7e5578436036413-10\"><span class=\"crayon-sy\">}</span><span class=\"crayon-sy\">;</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0011 seconds] -->\r\n<p>当使用 <span style=\"color: #ff6600;\"><code>LINUX_REBOOT_CMD_KEXEC</code></span> 调用 <span style=\"color: #ff6600;\"><code>reboot()</code></span> 时，它会引导进入由 <span style=\"color: #ff6600;\"><code>kexec_load</code></span> 加载的内核。如果标志 <span style=\"color: #ff6600;\"><code>KEXEC_ON_CRASH</code></span> 被传递给 <span style=\"color: #ff6600;\"><code>kexec_load()</code></span>，则加载的内核将不会使用 <span style=\"color: #ff6600;\"><code>reboot(LINUX_REBOOT_CMD_KEXEC)</code></span> 来启动；相反，这将在内核崩溃中执行。必须定义 <span style=\"color: #ff6600;\"><code>CONFIG_KEXEC</code></span> 才能使用 <span style=\"color: #ff6600;\"><code>kexec</code></span>，并且为 <span style=\"color: #ff6600;\"><code>kdump</code></span> 定义 <span style=\"color: #ff6600;\"><code>CONFIG_CRASH_DUMP</code></span>。</p>\n<p><span style=\"color: #ff6600;\"><code>kexec_file_load()</code></span>：作为用户，你只需传递两个参数（即 <span style=\"color: #ff6600;\"><code>kernel</code></span> 和 <span style=\"color: #ff6600;\"><code>initramfs</code></span>）到 <span style=\"color: #ff6600;\"><code>kexec</code></span> 可执行文件。然后，<span style=\"color: #ff6600;\"><code>kexec</code></span> 从 sysfs 或其他内核信息源中读取数据，并创建所有段。所以使用 <span style=\"color: #ff6600;\"><code>kexec_file_load()</code></span> 可以简化用户空间，只传递内核和 initramfs 的文件描述符。其余部分由内核本身完成。使用此系统调用时应该启用 <span style=\"color: #ff6600;\"><code>CONFIG_KEXEC_FILE</code></span>。它的原型如下：</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-599373d7e557d598377689\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" touchscreen minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\nlong kexec_file_load(int kernel_fd, int initrd_fd, unsigned long\r\ncmdline_len, const char __user * cmdline_ptr, unsigned long\r\nflags);</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-599373d7e557d598377689-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599373d7e557d598377689-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-599373d7e557d598377689-3\">3</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-599373d7e557d598377689-1\"><span class=\"crayon-t\">long</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">kexec_file_load</span><span class=\"crayon-sy\">(</span><span class=\"crayon-t\">int</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">kernel_fd</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">int</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">initrd_fd</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">unsigned</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">long</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599373d7e557d598377689-2\"><span class=\"crayon-v\">cmdline_len</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-m\">const</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">char</span><span class=\"crayon-h\"> </span><span class=\"crayon-e \">__user *</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">cmdline_ptr</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">unsigned</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">long</span></div><div class=\"crayon-line\" id=\"crayon-599373d7e557d598377689-3\"><span class=\"crayon-v\">flags</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0010 seconds] -->\r\n<p>请注意，<span style=\"color: #ff6600;\"><code>kexec_file_load</code></span> 也可以接受命令行，而 <span style=\"color: #ff6600;\"><code>kexec_load()</code></span> 不行。内核根据不同的系统架构来接受和执行命令行。因此，在 <span style=\"color: #ff6600;\"><code>kexec_load()</code></span> 的情况下，<span style=\"color: #ff6600;\"><code>kexec-tools</code></span> 将通过其中一个段（如在 dtb 或 ELF 引导注释等）中传递命令行。</p>\n<p>目前，<span style=\"color: #ff6600;\"><code>kexec_file_load()</code></span> 仅支持 x86 和 PowerPC。</p>\n<h4 id=\"toc_5\">当内核崩溃时会发生什么</h4>\n<p>当第一个内核崩溃时，在控制权传递给 purgatory 或“捕获内核”之前，会执行以下操作：</p>\n<ul>\n<li>准备 CPU 寄存器（参见内核代码中的 <span style=\"color: #ff6600;\"><code>crash_setup_regs()</code></span>）;</li>\n<li>更新 vmcoreinfo 备注（请参阅 <span style=\"color: #ff6600;\"><code>crash_save_vmcoreinfo()</code></span>）;</li>\n<li>关闭非崩溃的 CPU 并保存准备好的寄存器（请参阅 <span style=\"color: #ff6600;\"><code>machine_crash_shutdown()</code></span> 和 <span style=\"color: #ff6600;\"><code>crash_save_cpu()</code></span>）;</li>\n<li>您可能需要在此处禁用中断控制器；</li>\n<li>最后，它执行 kexec 重新启动（请参阅 <span style=\"color: #ff6600;\"><code>machine_kexec()</code></span>），它将加载或刷新 kexec 段到内存，并将控制权传递给进入段的执行文件。输入段可以是下一个内核的 purgatory 或开始地址。</li>\n</ul>\n<h4 id=\"toc_6\">ELF 程序头</h4>\n<p>kdump 中涉及的大多数转储核心都是 ELF 格式。因此，理解 ELF 程序头部很重要，特别是当您想要找到 vmcore 准备的问题。每个 ELF 文件都有一个程序头：</p>\n<ul>\n<li>由系统加载器读取，</li>\n<li>描述如何将程序加载到内存中，</li>\n<li>可以使用 <span style=\"color: #ff6600;\"><code>Objdump -p elf_file</code></span> 来查看程序头。</li>\n</ul>\n<p>vmcore 的 ELF 程序头的示例如下：</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-599373d7e5581935490106\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" touchscreen minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\n# objdump -p vmcore\r\nvmcore:\r\nfile format elf64-littleaarch64\r\nProgram Header:\r\nNOTE off 0x0000000000010000 vaddr 0x0000000000000000 paddr 0x0000000000000000 align 2**0 filesz\r\n0x00000000000013e8 memsz 0x00000000000013e8 flags ---\r\nLOAD off 0x0000000000020000 vaddr 0xffff000008080000 paddr 0x0000004000280000 align 2**0 filesz\r\n0x0000000001460000 memsz 0x0000000001460000 flags rwx\r\nLOAD off 0x0000000001480000 vaddr 0xffff800000200000 paddr 0x0000004000200000 align 2**0 filesz\r\n0x000000007fc00000 memsz 0x000000007fc00000 flags rwx\r\nLOAD off 0x0000000081080000 vaddr 0xffff8000ffe00000 paddr 0x00000040ffe00000 align 2**0 filesz\r\n0x00000002fa7a0000 memsz 0x00000002fa7a0000 flags rwx\r\nLOAD off 0x000000037b820000 vaddr 0xffff8003fa9e0000 paddr 0x00000043fa9e0000 align 2**0 filesz\r\n0x0000000004fc0000 memsz 0x0000000004fc0000 flags rwx\r\nLOAD off 0x00000003807e0000 vaddr 0xffff8003ff9b0000 paddr 0x00000043ff9b0000 align 2**0 filesz\r\n0x0000000000010000 memsz 0x0000000000010000 flags rwx\r\nLOAD off 0x00000003807f0000 vaddr 0xffff8003ff9f0000 paddr 0x00000043ff9f0000 align 2**0 filesz\r\n0x0000000000610000 memsz 0x0000000000610000 flags rwx</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-599373d7e5581935490106-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599373d7e5581935490106-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-599373d7e5581935490106-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599373d7e5581935490106-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-599373d7e5581935490106-5\">5</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599373d7e5581935490106-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-599373d7e5581935490106-7\">7</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599373d7e5581935490106-8\">8</div><div class=\"crayon-num\" data-line=\"crayon-599373d7e5581935490106-9\">9</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599373d7e5581935490106-10\">10</div><div class=\"crayon-num\" data-line=\"crayon-599373d7e5581935490106-11\">11</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599373d7e5581935490106-12\">12</div><div class=\"crayon-num\" data-line=\"crayon-599373d7e5581935490106-13\">13</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599373d7e5581935490106-14\">14</div><div class=\"crayon-num\" data-line=\"crayon-599373d7e5581935490106-15\">15</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599373d7e5581935490106-16\">16</div><div class=\"crayon-num\" data-line=\"crayon-599373d7e5581935490106-17\">17</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599373d7e5581935490106-18\">18</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-599373d7e5581935490106-1\"><span class=\"crayon-p\"># objdump -p vmcore</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599373d7e5581935490106-2\"><span class=\"crayon-v\">vmcore</span><span class=\"crayon-o\">:</span></div><div class=\"crayon-line\" id=\"crayon-599373d7e5581935490106-3\"><span class=\"crayon-e\">file </span><span class=\"crayon-e\">format </span><span class=\"crayon-v\">elf64</span><span class=\"crayon-o\">-</span><span class=\"crayon-e\">littleaarch64</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599373d7e5581935490106-4\"><span class=\"crayon-e\">Program </span><span class=\"crayon-v\">Header</span><span class=\"crayon-o\">:</span></div><div class=\"crayon-line\" id=\"crayon-599373d7e5581935490106-5\"><span class=\"crayon-e\">NOTE </span><span class=\"crayon-i\">off</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0x0000000000010000</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">vaddr</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0x0000000000000000</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">paddr</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0x0000000000000000</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">align</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">2</span><span class=\"crayon-o\">*</span><span class=\"crayon-o\">*</span><span class=\"crayon-cn\">0</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">filesz</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599373d7e5581935490106-6\"><span class=\"crayon-cn\">0x00000000000013e8</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">memsz</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0x00000000000013e8</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">flags</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">-</span></div><div class=\"crayon-line\" id=\"crayon-599373d7e5581935490106-7\"><span class=\"crayon-e\">LOAD </span><span class=\"crayon-i\">off</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0x0000000000020000</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">vaddr</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0xffff000008080000</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">paddr</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0x0000004000280000</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">align</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">2</span><span class=\"crayon-o\">*</span><span class=\"crayon-o\">*</span><span class=\"crayon-cn\">0</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">filesz</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599373d7e5581935490106-8\"><span class=\"crayon-cn\">0x0000000001460000</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">memsz</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0x0000000001460000</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">flags </span><span class=\"crayon-e\">rwx</span></div><div class=\"crayon-line\" id=\"crayon-599373d7e5581935490106-9\"><span class=\"crayon-e\">LOAD </span><span class=\"crayon-i\">off</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0x0000000001480000</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">vaddr</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0xffff800000200000</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">paddr</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0x0000004000200000</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">align</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">2</span><span class=\"crayon-o\">*</span><span class=\"crayon-o\">*</span><span class=\"crayon-cn\">0</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">filesz</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599373d7e5581935490106-10\"><span class=\"crayon-cn\">0x000000007fc00000</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">memsz</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0x000000007fc00000</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">flags </span><span class=\"crayon-e\">rwx</span></div><div class=\"crayon-line\" id=\"crayon-599373d7e5581935490106-11\"><span class=\"crayon-e\">LOAD </span><span class=\"crayon-i\">off</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0x0000000081080000</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">vaddr</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0xffff8000ffe00000</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">paddr</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0x00000040ffe00000</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">align</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">2</span><span class=\"crayon-o\">*</span><span class=\"crayon-o\">*</span><span class=\"crayon-cn\">0</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">filesz</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599373d7e5581935490106-12\"><span class=\"crayon-cn\">0x00000002fa7a0000</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">memsz</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0x00000002fa7a0000</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">flags </span><span class=\"crayon-e\">rwx</span></div><div class=\"crayon-line\" id=\"crayon-599373d7e5581935490106-13\"><span class=\"crayon-e\">LOAD </span><span class=\"crayon-i\">off</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0x000000037b820000</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">vaddr</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0xffff8003fa9e0000</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">paddr</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0x00000043fa9e0000</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">align</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">2</span><span class=\"crayon-o\">*</span><span class=\"crayon-o\">*</span><span class=\"crayon-cn\">0</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">filesz</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599373d7e5581935490106-14\"><span class=\"crayon-cn\">0x0000000004fc0000</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">memsz</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0x0000000004fc0000</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">flags </span><span class=\"crayon-e\">rwx</span></div><div class=\"crayon-line\" id=\"crayon-599373d7e5581935490106-15\"><span class=\"crayon-e\">LOAD </span><span class=\"crayon-i\">off</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0x00000003807e0000</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">vaddr</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0xffff8003ff9b0000</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">paddr</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0x00000043ff9b0000</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">align</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">2</span><span class=\"crayon-o\">*</span><span class=\"crayon-o\">*</span><span class=\"crayon-cn\">0</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">filesz</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599373d7e5581935490106-16\"><span class=\"crayon-cn\">0x0000000000010000</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">memsz</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0x0000000000010000</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">flags </span><span class=\"crayon-e\">rwx</span></div><div class=\"crayon-line\" id=\"crayon-599373d7e5581935490106-17\"><span class=\"crayon-e\">LOAD </span><span class=\"crayon-i\">off</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0x00000003807f0000</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">vaddr</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0xffff8003ff9f0000</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">paddr</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0x00000043ff9f0000</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">align</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">2</span><span class=\"crayon-o\">*</span><span class=\"crayon-o\">*</span><span class=\"crayon-cn\">0</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">filesz</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599373d7e5581935490106-18\"><span class=\"crayon-cn\">0x0000000000610000</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">memsz</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0x0000000000610000</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">flags </span><span class=\"crayon-v\">rwx</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0051 seconds] -->\r\n<p>在这个例子中，有一个 note 段，其余的是 load 段。note 段提供了有关 CPU 信息，load 段提供了关于复制的系统内存组件的信息。</p>\n<p>vmcore 从 <span style=\"color: #ff6600;\"><code>elfcorehdr</code></span> 开始，它具有与 ELF 程序头相同的结构。参见下图中 <span style=\"color: #ff6600;\"><code>elfcorehdr</code></span> 的表示：</p>\n<p><img src=\"http://jbcdn2.b0.upaiyun.com/2017/08/85d3f4c654785d18b750564db21ded7b.png\" alt=\"pratyush_f2.png\"></p>\n<p><span style=\"color: #ff6600;\"><code>kexec-tools</code></span> 读取 <span style=\"color: #ff6600;\"><code>/sys/devices/system/cpu/cpu%d/crash_notes</code></span> 并准备 <span style=\"color: #ff6600;\"><code>CPU PT_NOTE</code></span> 的标头。同样，它读取 <span style=\"color: #ff6600;\"><code>/sys/kernel/vmcoreinfo</code></span> 并准备 <span style=\"color: #ff6600;\"><code>vmcoreinfo PT_NOTE</code></span> 的标头，从 <span style=\"color: #ff6600;\"><code>/proc/iomem</code></span> 读取系统内存并准备存储器 <span style=\"color: #ff6600;\"><code>PT_LOAD</code></span> 标头。当“捕获内核”接收到 <span style=\"color: #ff6600;\"><code>elfcorehdr</code></span> 时，它从标头中提到的地址中读取数据，并准备 vmcore。</p>\n<h4 id=\"toc_7\">Crash note</h4>\n<p>Crash notes 是每个 CPU 中用于在系统崩溃的情况下存储 CPU 状态的区域；它有关于当前 PID 和 CPU 寄存器的信息。</p>\n<h4 id=\"toc_8\">vmcoreinfo</h4>\n<p>该 note 段具有各种内核调试信息，如结构体大小、符号值、页面大小等。这些值由捕获内核解析并嵌入到 <span style=\"color: #ff6600;\"><code>/proc/vmcore</code></span> 中。 <span style=\"color: #ff6600;\"><code>vmcoreinfo</code></span> 主要由 <span style=\"color: #ff6600;\"><code>makedumpfile</code></span> 应用程序使用。在 Linux 内核，<span style=\"color: #ff6600;\"><code>include/linux/kexec.h</code></span> 宏定义了一个新的 <span style=\"color: #ff6600;\"><code>vmcoreinfo</code></span>。 一些示例宏如下所示：</p>\n<ul>\n<li><span style=\"color: #ff6600;\"><code>VMCOREINFO_PAGESIZE()</code></span></li>\n<li><span style=\"color: #ff6600;\"><code>VMCOREINFO_SYMBOL()</code></span></li>\n<li><span style=\"color: #ff6600;\"><code>VMCOREINFO_SIZE()</code></span></li>\n<li><span style=\"color: #ff6600;\"><code>VMCOREINFO_STRUCT_SIZE()</code></span></li>\n</ul>\n<h4 id=\"toc_9\">makedumpfile</h4>\n<p>vmcore 中的许多信息（如可用页面）都没有用处。<span style=\"color: #ff6600;\"><code>makedumpfile</code></span> 是一个用于排除不必要的页面的应用程序，如：</p>\n<ul>\n<li>填满零的页面；</li>\n<li>没有私有标志的缓存页面（非专用缓存）;</li>\n<li>具有私有标志的缓存页面（专用缓存）;</li>\n<li>用户进程数据页；</li>\n<li>可用页面。</li>\n</ul>\n<p>此外，<span style=\"color: #ff6600;\"><code>makedumpfile</code></span> 在复制时压缩 <span style=\"color: #ff6600;\"><code>/proc/vmcore</code></span> 的数据。它也可以从转储中删除敏感的符号信息； 然而，为了做到这一点，它首先需要内核的调试信息。该调试信息来自 <span style=\"color: #ff6600;\"><code>VMLINUX</code></span> 或 <span style=\"color: #ff6600;\"><code>vmcoreinfo</code></span>，其输出可以是 ELF 格式或 kdump 压缩格式。</p>\n<p>典型用法：</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-599373d7e5587270860637\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" touchscreen minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\n# makedumpfile -l --message-level 1 -d 31 /proc/vmcore makedumpfilecore</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-599373d7e5587270860637-1\">1</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-599373d7e5587270860637-1\"><span class=\"crayon-p\"># makedumpfile -l --message-level 1 -d 31 /proc/vmcore makedumpfilecore</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0003 seconds] -->\r\n<p>详细信息请参阅 <span style=\"color: #ff6600;\"><code>man makedumpfile</code></span>。</p>\n<h3 id=\"toc_10\">kdump 调试</h3>\n<p>新手在使用 kdump 时可能会遇到的问题：</p>\n<h4 id=\"toc_11\"><span style=\"color: #ff6600;\"><code>kexec -p kernel_image</code></span>  没有成功</h4>\n<ul>\n<li>检查是否分配了崩溃内存。</li>\n<li><span style=\"color: #ff6600;\"><code>cat /sys/kernel/kexec_crash_size</code></span> 不应该有零值。</li>\n<li><span style=\"color: #ff6600;\"><code>cat /proc/iomem | grep \"Crash kernel\"</code></span> 应该有一个分配的范围。</li>\n<li>如果未分配，则在命令行中传递正确的 <span style=\"color: #ff6600;\"><code>crashkernel=</code></span> 参数。</li>\n<li>如果没有显示，则在 <span style=\"color: #ff6600;\"><code>kexec</code></span> 命令中传递参数 <span style=\"color: #ff6600;\"><code>-d</code></span>，并将输出信息发送到 kexec-tools 邮件列表。</li>\n</ul>\n<h4 id=\"toc_12\">在“第一内核”的最后一个消息之后，在控制台上看不到任何东西（比如“bye”）</h4>\n<ul>\n<li>检查 <span style=\"color: #ff6600;\"><code>kexec -e</code></span> 之后的 <span style=\"color: #ff6600;\"><code>kexec -l kernel_image</code></span> 命令是否工作。</li>\n<li>可能缺少支持的体系结构或特定机器的选项。</li>\n<li>可能是 purgatory 的 SHA 验证失败。如果您的体系结构不支持 purgatory 中的控制台，则很难进行调试。</li>\n<li>可能是“第二内核”早已崩溃。</li>\n<li>将您的系统的 <span style=\"color: #ff6600;\"><code>earlycon</code></span> 或 <span style=\"color: #ff6600;\"><code>earlyprintk</code></span> 选项传递给“第二内核”的命令行。</li>\n<li>使用 kexec-tools 邮件列表共享第一个内核和捕获内核的 <span style=\"color: #ff6600;\"><code>dmesg</code></span> 日志。</li>\n</ul>\n<h3 id=\"toc_13\">资源</h3>\n<h4 id=\"toc_14\">fedora-kexec-tools</h4>\n<ul>\n<li>GitHub 仓库：<span style=\"color: #ff6600;\"><code>git://pkgs.fedoraproject.org/kexec-tools</code></span></li>\n<li>邮件列表：<a href=\"mailto:kexec@lists.fedoraproject.org\">kexec@lists.fedoraproject.org</a></li>\n<li>说明：Specs 文件和脚本提供了用户友好的命令和服务，以便 <span style=\"color: #ff6600;\"><code>kexec-tools</code></span> 可以在不同的用户场景下实现自动化。</li>\n</ul>\n<h4 id=\"toc_15\">kexec-tools</h4>\n<ul>\n<li>GitHub 仓库：git://git.kernel.org/pub/scm/utils/kernel/kexec/kexec-tools.git</li>\n<li>邮件列表：<a href=\"mailto:kexec@lists.infradead.org\">kexec@lists.infradead.org</a></li>\n<li>说明：使用内核系统调用并提供用户命令 <span style=\"color: #ff6600;\"><code>kexec</code></span>。</li>\n</ul>\n<h4 id=\"toc_16\">Linux kernel</h4>\n<ul>\n<li>GitHub 仓库： <span style=\"color: #ff6600;\"><code>git://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git</code></span></li>\n<li>邮件列表：<a href=\"mailto:kexec@lists.infradead.org\">kexec@lists.infradead.org</a></li>\n<li>说明：实现了 <span style=\"color: #ff6600;\"><code>kexec_load()</code></span>、<span style=\"color: #ff6600;\"><code>kexec_file_load()</code></span>、<span style=\"color: #ff6600;\"><code>reboot()</code></span> 系统调用和特定体系结构的代码，例如 <span style=\"color: #ff6600;\"><code>machine_kexec()</code></span> 和 <span style=\"color: #ff6600;\"><code>machine_crash_shutdown()</code></span>。</li>\n</ul>\n<h4 id=\"toc_17\">Makedumpfile</h4>\n<ul>\n<li>GitHub 仓库： <span style=\"color: #ff6600;\"><code>git://git.code.sf.net/p/makedumpfile/code</code></span></li>\n<li>邮件列表：<a href=\"mailto:kexec@lists.infradead.org\">kexec@lists.infradead.org</a></li>\n<li>说明：从转储文件中压缩和过滤不必要的组件。</li>\n</ul>\n<p>（题图：<a href=\"https://pixabay.com/en/penguins-emperor-antarctic-life-429136/\">Penguin</a>、 <a href=\"https://pixabay.com/en/shoe-boots-home-boots-house-1519804/\">Boot</a>，修改：Opensource.com. <a href=\"https://creativecommons.org/licenses/by-sa/4.0/\">CC BY-SA 4.0</a>）</p>\n<hr>\n<p>作者简介：</p>\n<p>Pratyush Anand – Pratyush 正在以以为 Linux 内核专家的身份与 Red Hat 合作。他主要负责 Red Hat 产品和上游所面临的几个 kexec/kdump 问题。他还处理 Red Hat 支持的 ARM64 平台周围的其他内核调试、跟踪和性能问题。除了 Linux 内核，他还在上游的 kexec-tools 和 makedumpfile 项目中做出了贡献。他是一名开源爱好者，并在教育机构举办志愿者讲座，促进了 FOSS。</p>\n</div>\n\r\n        \r\n        \r\n        \n    <div class=\"post-adds\">\n        <span data-post-id=\"112099\" class=\" btn-bluet-bigger href-style vote-post-up   register-user-only \"><i class=\"fa  fa-thumbs-o-up\"></i> <h10 id=\"112099votetotal\">1</h10> 赞</span>\n        <span data-book-type=\"1\" data-site-id=\"2\" data-item-id=\"112099\" data-item-type=\"1\" class=\" btn-bluet-bigger href-style bookmark-btn  register-user-only \"><i class=\"fa fa-bookmark-o  \"></i> 1 收藏</span>\n\n                    <a href=\"#article-comment\"><span class=\"btn-bluet-bigger href-style hide-on-480\"><i class=\"fa fa-comments-o\"></i>  评论</span></a>\n        \n        \n        \n        <!-- JiaThis Button BEGIN -->\n        <div class=\"jiathis_style_24x24\" style=\"display: inline-flex; position: relative; margin: 0; clear: both;float: right;\">\n            <a class=\"jiathis_button_tsina\"></a>\n            <a class=\"jiathis_button_weixin\"></a>\n            <a class=\"jiathis_button_qzone\"></a>\n            <a class=\"jiathis_button_fb hide-on-480\"></a>\n            <a href=\"http://www.jiathis.com/share?uid=1745061\" class=\"jiathis jiathis_txt jiathis_separator jtico jtico_jiathis\" target=\"_blank\"></a>\n        </div>\n\n    </div>\n\n\n\n\r\n        <!-- BEGIN #author-bio -->\r\n\r\n\r\n<!-- END #author-bio -->\r\n\t</div>", "front_image_path": ["full/d3d1a5ad957de059084690efae6fdfaa3527e1c3.jpg"]},{"title": "系统管理员应该知道的 20 条 Linux 命令", "url": "http://blog.jobbole.com/112085/", "url_object_id": "c7e0ae15f1eab36a802669e93f9b1844", "create_date": "2017/08/02", "front_image_url": ["http://jbcdn2.b0.upaiyun.com/2017/08/7599b213c6d67d39e4bb2391c276fbb5.png"], "praise_nums": "1", "fav_nums": "4", "comment_nums": "1", "tags": "IT技术,Linux,命令,系统管理员", "content": "<div class=\"entry\">\r\n\r\n        \t\t\t<div class=\"textwidget\"></div>\n\t\t\r\n\t\t<div class=\"copyright-area\">原文出处： <a ref=\"nofollow\" target=\"_blank\" href=\"https://opensource.com\">OpenSource</a>   译文出处：<a target=\"_blank\" href=\"https://my.oschina.net/editorial-story/blog/1499026\">开源中国/局长</a>   </div><p><a href=\"http://jbcdn2.b0.upaiyun.com/2017/08/7599b213c6d67d39e4bb2391c276fbb5.png\"><img class=\"aligncenter wp-image-112080 size-full\" src=\"http://jbcdn2.b0.upaiyun.com/2017/08/7599b213c6d67d39e4bb2391c276fbb5.png\" alt=\"203755_92u8_2918182\" width=\"520\" height=\"292\"></a></p>\n<p>在这个全新的工具和多样化的开发环境井喷的大环境下，任何开发者和工程师都有必要学习一些基本的系统管理命令。特定的命令和工具包可帮助开发者组织、排查故障并优化他们的应用程序，而且当出现错误时，也可以为运维人员和系统管理员提供有价值的分类信息。</p>\n<p>无论你是新手开发者还是希望管理自己的应用程序，下面 20 条基本的系统管理命令都可以帮助您更好地了解您的应用程序。它们还可以帮助解决为什么应用程序可在本地正常工作但不能在远程主机上工作这类的系统故障。这些命令适用于 Linux 开发环境、容器和虚拟机。</p>\n<h1>1. curl</h1>\n<p>curl 用于传输一个 URL。可以使用这条命令用于测试应用程序的端点或与上游服务端点的连接。curl 还可用于检查你的应用程序是否能连接到其他服务，例如数据库，或检查您的服务是否处于健康的状态。</p>\n<p>举个例子，假如你的应用程序抛出一个 HTTP 500 错误，表示无法访问 MongoDB 数据库：</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-599373d8a84dd782816267\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" touchscreen minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\n$ curl -I -s myapplication:5000\r\n\r\nHTTP/1.0 500 INTERNAL SERVER ERROR</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-599373d8a84dd782816267-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599373d8a84dd782816267-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-599373d8a84dd782816267-3\">3</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-599373d8a84dd782816267-1\"><span class=\"crayon-sy\">$</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">curl</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-</span><span class=\"crayon-v\">I</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-</span><span class=\"crayon-i\">s</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">myapplication</span><span class=\"crayon-o\">:</span><span class=\"crayon-cn\">5000</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599373d8a84dd782816267-2\"> </div><div class=\"crayon-line\" id=\"crayon-599373d8a84dd782816267-3\"><span class=\"crayon-v\">HTTP</span><span class=\"crayon-o\">/</span><span class=\"crayon-cn\">1.0</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">500</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">INTERNAL </span><span class=\"crayon-e\">SERVER </span><span class=\"crayon-v\">ERROR</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0008 seconds] -->\r\n<p><strong>-I </strong>选项用于显示头信息，<strong>-s </strong>选项表示使用静默模式，不显示错误和进度。检查数据库的端点是否正确：</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-599373d8a84e8640091314\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" touchscreen minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\n$ curl -I -s database:27017\r\n\r\nHTTP/1.0 200 OK</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-599373d8a84e8640091314-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599373d8a84e8640091314-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-599373d8a84e8640091314-3\">3</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-599373d8a84e8640091314-1\"><span class=\"crayon-sy\">$</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">curl</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-</span><span class=\"crayon-v\">I</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-</span><span class=\"crayon-i\">s</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">database</span><span class=\"crayon-o\">:</span><span class=\"crayon-cn\">27017</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599373d8a84e8640091314-2\"> </div><div class=\"crayon-line\" id=\"crayon-599373d8a84e8640091314-3\"><span class=\"crayon-v\">HTTP</span><span class=\"crayon-o\">/</span><span class=\"crayon-cn\">1.0</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">200</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">OK</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0006 seconds] -->\r\n<p>那么可能是什么问题呢？ 检查您的应用程序是否可以访问数据库以外的其他位置：</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-599373d8a84ec984903601\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" touchscreen minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\n$ curl -I -s https://opensource.com\r\n\r\nHTTP/1.1 200 OK</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-599373d8a84ec984903601-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599373d8a84ec984903601-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-599373d8a84ec984903601-3\">3</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-599373d8a84ec984903601-1\"><span class=\"crayon-sy\">$</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">curl</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-</span><span class=\"crayon-v\">I</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-</span><span class=\"crayon-i\">s</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">https</span><span class=\"crayon-o\">:</span><span class=\"crayon-c\">//opensource.com</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599373d8a84ec984903601-2\"> </div><div class=\"crayon-line\" id=\"crayon-599373d8a84ec984903601-3\"><span class=\"crayon-v\">HTTP</span><span class=\"crayon-o\">/</span><span class=\"crayon-cn\">1.1</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">200</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">OK</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0006 seconds] -->\r\n<p>看起来这没问题，现在尝试访问数据库。您的应用程序正在使用数据库的主机名，因此请先尝试：</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-599373d8a84f0639758657\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" touchscreen minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\n$ curl database:27017\r\n\r\ncurl: (6) Couldn't resolve host 'database'</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-599373d8a84f0639758657-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599373d8a84f0639758657-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-599373d8a84f0639758657-3\">3</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-599373d8a84f0639758657-1\"><span class=\"crayon-sy\">$</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">curl </span><span class=\"crayon-v\">database</span><span class=\"crayon-o\">:</span><span class=\"crayon-cn\">27017</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599373d8a84f0639758657-2\"> </div><div class=\"crayon-line\" id=\"crayon-599373d8a84f0639758657-3\"><span class=\"crayon-v\">curl</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-cn\">6</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">Couldn</span><span class=\"crayon-s\">'t resolve host '</span><span class=\"crayon-i\">database</span>'</div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0006 seconds] -->\r\n<p>这表示您的应用程序无法解析数据库，因为数据库的 URL 不可用或主机（容器或VM）没有可用于解析主机名的域名服务器。</p>\n<h1>2. python -m json.tool / jq</h1>\n<p>使用 curl 后，API 调用的输出可读性可能较差。有时候，你希望将生成的 JSON 数据格式化输出以查找特定的条目。Python 有一个内置的库可帮助您实现这个需求。可以使用 <strong>python -m json.tool </strong>来缩进和组织 JSON。要使用 Python 的 JSON 模块，需要使用管道机制，将 JSON 文件的输出作为输入，写入到 <strong>python -m json.tool</strong> 命令行。</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-599373d8a84f3905446253\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" touchscreen minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\n$ cat test.json\r\n{\"title\":\"Person\",\"type\":\"object\",\"properties\":{\"firstName\":{\"type\":\"string\"},\"lastName\":{\"type\":\"string\"},\"age\":{\"description\":\"Age in years\",\"type\":\"integer\",\"minimum\":0}},\"required\":[\"firstName\",\"lastName\"]}</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-599373d8a84f3905446253-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599373d8a84f3905446253-2\">2</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-599373d8a84f3905446253-1\"><span class=\"crayon-sy\">$</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">cat </span><span class=\"crayon-v\">test</span><span class=\"crayon-sy\">.</span><span class=\"crayon-i\">json</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599373d8a84f3905446253-2\"><span class=\"crayon-sy\">{</span><span class=\"crayon-s\">\"title\"</span><span class=\"crayon-o\">:</span><span class=\"crayon-s\">\"Person\"</span><span class=\"crayon-sy\">,</span><span class=\"crayon-s\">\"type\"</span><span class=\"crayon-o\">:</span><span class=\"crayon-s\">\"object\"</span><span class=\"crayon-sy\">,</span><span class=\"crayon-s\">\"properties\"</span><span class=\"crayon-o\">:</span><span class=\"crayon-sy\">{</span><span class=\"crayon-s\">\"firstName\"</span><span class=\"crayon-o\">:</span><span class=\"crayon-sy\">{</span><span class=\"crayon-s\">\"type\"</span><span class=\"crayon-o\">:</span><span class=\"crayon-s\">\"string\"</span><span class=\"crayon-sy\">}</span><span class=\"crayon-sy\">,</span><span class=\"crayon-s\">\"lastName\"</span><span class=\"crayon-o\">:</span><span class=\"crayon-sy\">{</span><span class=\"crayon-s\">\"type\"</span><span class=\"crayon-o\">:</span><span class=\"crayon-s\">\"string\"</span><span class=\"crayon-sy\">}</span><span class=\"crayon-sy\">,</span><span class=\"crayon-s\">\"age\"</span><span class=\"crayon-o\">:</span><span class=\"crayon-sy\">{</span><span class=\"crayon-s\">\"description\"</span><span class=\"crayon-o\">:</span><span class=\"crayon-s\">\"Age in years\"</span><span class=\"crayon-sy\">,</span><span class=\"crayon-s\">\"type\"</span><span class=\"crayon-o\">:</span><span class=\"crayon-s\">\"integer\"</span><span class=\"crayon-sy\">,</span><span class=\"crayon-s\">\"minimum\"</span><span class=\"crayon-o\">:</span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">}</span><span class=\"crayon-sy\">}</span><span class=\"crayon-sy\">,</span><span class=\"crayon-s\">\"required\"</span><span class=\"crayon-o\">:</span><span class=\"crayon-sy\">[</span><span class=\"crayon-s\">\"firstName\"</span><span class=\"crayon-sy\">,</span><span class=\"crayon-s\">\"lastName\"</span><span class=\"crayon-sy\">]</span><span class=\"crayon-sy\">}</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0013 seconds] -->\r\n<p>要使用 Python 库，使用 <strong>-m</strong> (module) 选项将输出内容和 Python 库组合成管道。</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-599373d8a84f6643810676\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" touchscreen minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\n$ cat test.json | python -m json.tool\r\n{\r\n    \"properties\": {\r\n        \"age\": {\r\n            \"description\": \"Age in years\",\r\n            \"minimum\": 0,\r\n            \"type\": \"integer\"\r\n        },\r\n        \"firstName\": {\r\n            \"type\": \"string\"\r\n        },\r\n        \"lastName\": {\r\n            \"type\": \"string\"\r\n        }\r\n    },\r\n    \"required\": [\r\n        \"firstName\",\r\n        \"lastName\"\r\n    ],\r\n    \"title\": \"Person\",\r\n    \"type\": \"object\"\r\n}</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-599373d8a84f6643810676-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599373d8a84f6643810676-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-599373d8a84f6643810676-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599373d8a84f6643810676-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-599373d8a84f6643810676-5\">5</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599373d8a84f6643810676-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-599373d8a84f6643810676-7\">7</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599373d8a84f6643810676-8\">8</div><div class=\"crayon-num\" data-line=\"crayon-599373d8a84f6643810676-9\">9</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599373d8a84f6643810676-10\">10</div><div class=\"crayon-num\" data-line=\"crayon-599373d8a84f6643810676-11\">11</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599373d8a84f6643810676-12\">12</div><div class=\"crayon-num\" data-line=\"crayon-599373d8a84f6643810676-13\">13</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599373d8a84f6643810676-14\">14</div><div class=\"crayon-num\" data-line=\"crayon-599373d8a84f6643810676-15\">15</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599373d8a84f6643810676-16\">16</div><div class=\"crayon-num\" data-line=\"crayon-599373d8a84f6643810676-17\">17</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599373d8a84f6643810676-18\">18</div><div class=\"crayon-num\" data-line=\"crayon-599373d8a84f6643810676-19\">19</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599373d8a84f6643810676-20\">20</div><div class=\"crayon-num\" data-line=\"crayon-599373d8a84f6643810676-21\">21</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599373d8a84f6643810676-22\">22</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-599373d8a84f6643810676-1\"><span class=\"crayon-sy\">$</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">cat </span><span class=\"crayon-v\">test</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">json</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">|</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">python</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-</span><span class=\"crayon-i\">m</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">json</span><span class=\"crayon-sy\">.</span><span class=\"crayon-i\">tool</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599373d8a84f6643810676-2\"><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-599373d8a84f6643810676-3\"><span class=\"crayon-h\">    </span><span class=\"crayon-s\">\"properties\"</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599373d8a84f6643810676-4\"><span class=\"crayon-h\">        </span><span class=\"crayon-s\">\"age\"</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-599373d8a84f6643810676-5\"><span class=\"crayon-h\">            </span><span class=\"crayon-s\">\"description\"</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">\"Age in years\"</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599373d8a84f6643810676-6\"><span class=\"crayon-h\">            </span><span class=\"crayon-s\">\"minimum\"</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line\" id=\"crayon-599373d8a84f6643810676-7\"><span class=\"crayon-h\">            </span><span class=\"crayon-s\">\"type\"</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">\"integer\"</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599373d8a84f6643810676-8\"><span class=\"crayon-h\">        </span><span class=\"crayon-sy\">}</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line\" id=\"crayon-599373d8a84f6643810676-9\"><span class=\"crayon-h\">        </span><span class=\"crayon-s\">\"firstName\"</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599373d8a84f6643810676-10\"><span class=\"crayon-h\">            </span><span class=\"crayon-s\">\"type\"</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">\"string\"</span></div><div class=\"crayon-line\" id=\"crayon-599373d8a84f6643810676-11\"><span class=\"crayon-h\">        </span><span class=\"crayon-sy\">}</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599373d8a84f6643810676-12\"><span class=\"crayon-h\">        </span><span class=\"crayon-s\">\"lastName\"</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-599373d8a84f6643810676-13\"><span class=\"crayon-h\">            </span><span class=\"crayon-s\">\"type\"</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">\"string\"</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599373d8a84f6643810676-14\"><span class=\"crayon-h\">        </span><span class=\"crayon-sy\">}</span></div><div class=\"crayon-line\" id=\"crayon-599373d8a84f6643810676-15\"><span class=\"crayon-h\">    </span><span class=\"crayon-sy\">}</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599373d8a84f6643810676-16\"><span class=\"crayon-h\">    </span><span class=\"crayon-s\">\"required\"</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">[</span></div><div class=\"crayon-line\" id=\"crayon-599373d8a84f6643810676-17\"><span class=\"crayon-h\">        </span><span class=\"crayon-s\">\"firstName\"</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599373d8a84f6643810676-18\"><span class=\"crayon-h\">        </span><span class=\"crayon-s\">\"lastName\"</span></div><div class=\"crayon-line\" id=\"crayon-599373d8a84f6643810676-19\"><span class=\"crayon-h\">    </span><span class=\"crayon-sy\">]</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599373d8a84f6643810676-20\"><span class=\"crayon-h\">    </span><span class=\"crayon-s\">\"title\"</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">\"Person\"</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line\" id=\"crayon-599373d8a84f6643810676-21\"><span class=\"crayon-h\">    </span><span class=\"crayon-s\">\"type\"</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">\"object\"</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599373d8a84f6643810676-22\"><span class=\"crayon-sy\">}</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0021 seconds] -->\r\n<p>对于更高级的 JSON 解析，可以安装 <strong><a href=\"https://stedolan.github.io/jq/download/\" target=\"_blank\" rel=\"nofollow\">jq</a>。j</strong><strong>q </strong>提供了一些从 JSON 输入中提取特定值的选项。要像上面的 Python 模块一样将 JSON 输出格式化，只需将 jq 应用到输出即可。</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-599373d8a84fa551443128\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" touchscreen minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\n$ cat test.json | jq\r\n{\r\n  \"title\": \"Person\",\r\n  \"type\": \"object\",\r\n  \"properties\": {\r\n    \"firstName\": {\r\n      \"type\": \"string\"\r\n    },\r\n    \"lastName\": {\r\n      \"type\": \"string\"\r\n    },\r\n    \"age\": {\r\n      \"description\": \"Age in years\",\r\n      \"type\": \"integer\",\r\n      \"minimum\": 0\r\n    }\r\n  },\r\n  \"required\": [\r\n    \"firstName\",\r\n    \"lastName\"\r\n  ]\r\n}</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-599373d8a84fa551443128-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599373d8a84fa551443128-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-599373d8a84fa551443128-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599373d8a84fa551443128-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-599373d8a84fa551443128-5\">5</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599373d8a84fa551443128-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-599373d8a84fa551443128-7\">7</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599373d8a84fa551443128-8\">8</div><div class=\"crayon-num\" data-line=\"crayon-599373d8a84fa551443128-9\">9</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599373d8a84fa551443128-10\">10</div><div class=\"crayon-num\" data-line=\"crayon-599373d8a84fa551443128-11\">11</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599373d8a84fa551443128-12\">12</div><div class=\"crayon-num\" data-line=\"crayon-599373d8a84fa551443128-13\">13</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599373d8a84fa551443128-14\">14</div><div class=\"crayon-num\" data-line=\"crayon-599373d8a84fa551443128-15\">15</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599373d8a84fa551443128-16\">16</div><div class=\"crayon-num\" data-line=\"crayon-599373d8a84fa551443128-17\">17</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599373d8a84fa551443128-18\">18</div><div class=\"crayon-num\" data-line=\"crayon-599373d8a84fa551443128-19\">19</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599373d8a84fa551443128-20\">20</div><div class=\"crayon-num\" data-line=\"crayon-599373d8a84fa551443128-21\">21</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599373d8a84fa551443128-22\">22</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-599373d8a84fa551443128-1\"><span class=\"crayon-sy\">$</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">cat </span><span class=\"crayon-v\">test</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">json</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">|</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">jq</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599373d8a84fa551443128-2\"><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-599373d8a84fa551443128-3\"><span class=\"crayon-h\">  </span><span class=\"crayon-s\">\"title\"</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">\"Person\"</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599373d8a84fa551443128-4\"><span class=\"crayon-h\">  </span><span class=\"crayon-s\">\"type\"</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">\"object\"</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line\" id=\"crayon-599373d8a84fa551443128-5\"><span class=\"crayon-h\">  </span><span class=\"crayon-s\">\"properties\"</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599373d8a84fa551443128-6\"><span class=\"crayon-h\">    </span><span class=\"crayon-s\">\"firstName\"</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-599373d8a84fa551443128-7\"><span class=\"crayon-h\">      </span><span class=\"crayon-s\">\"type\"</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">\"string\"</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599373d8a84fa551443128-8\"><span class=\"crayon-h\">    </span><span class=\"crayon-sy\">}</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line\" id=\"crayon-599373d8a84fa551443128-9\"><span class=\"crayon-h\">    </span><span class=\"crayon-s\">\"lastName\"</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599373d8a84fa551443128-10\"><span class=\"crayon-h\">      </span><span class=\"crayon-s\">\"type\"</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">\"string\"</span></div><div class=\"crayon-line\" id=\"crayon-599373d8a84fa551443128-11\"><span class=\"crayon-h\">    </span><span class=\"crayon-sy\">}</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599373d8a84fa551443128-12\"><span class=\"crayon-h\">    </span><span class=\"crayon-s\">\"age\"</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-599373d8a84fa551443128-13\"><span class=\"crayon-h\">      </span><span class=\"crayon-s\">\"description\"</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">\"Age in years\"</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599373d8a84fa551443128-14\"><span class=\"crayon-h\">      </span><span class=\"crayon-s\">\"type\"</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">\"integer\"</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line\" id=\"crayon-599373d8a84fa551443128-15\"><span class=\"crayon-h\">      </span><span class=\"crayon-s\">\"minimum\"</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599373d8a84fa551443128-16\"><span class=\"crayon-h\">    </span><span class=\"crayon-sy\">}</span></div><div class=\"crayon-line\" id=\"crayon-599373d8a84fa551443128-17\"><span class=\"crayon-h\">  </span><span class=\"crayon-sy\">}</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599373d8a84fa551443128-18\"><span class=\"crayon-h\">  </span><span class=\"crayon-s\">\"required\"</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">[</span></div><div class=\"crayon-line\" id=\"crayon-599373d8a84fa551443128-19\"><span class=\"crayon-h\">    </span><span class=\"crayon-s\">\"firstName\"</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599373d8a84fa551443128-20\"><span class=\"crayon-h\">    </span><span class=\"crayon-s\">\"lastName\"</span></div><div class=\"crayon-line\" id=\"crayon-599373d8a84fa551443128-21\"><span class=\"crayon-h\">  </span><span class=\"crayon-sy\">]</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599373d8a84fa551443128-22\"><span class=\"crayon-sy\">}</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0020 seconds] -->\r\n<p></p>\n<h1>3. ls</h1>\n<p><strong>ls </strong>用于列出目录中的文件，系统管理员和开发者会经常使用这个命令。在容器空间中，这条命令可以帮助确定容器镜像中的目录和文件。除了查找文件，<strong>ls </strong>还可以用于检查权限。下面的示例中，由于权限问题，你不能运行 myapp。当你使用 <strong>ls -l </strong>检查权限时，你会发现它的权限在 <strong>-rw-r–r–</strong> 中没有”x”，只有读写的权限。</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-599373d8a84fe093798682\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" touchscreen minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\n$ ./myapp\r\nbash: ./myapp: Permission denied\r\n$ ls -l myapp\r\n-rw-r--r--. 1 root root 33 Jul 21 18:36 myapp</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-599373d8a84fe093798682-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599373d8a84fe093798682-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-599373d8a84fe093798682-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599373d8a84fe093798682-4\">4</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-599373d8a84fe093798682-1\"><span class=\"crayon-sy\">$</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">.</span><span class=\"crayon-o\">/</span><span class=\"crayon-e\">myapp</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599373d8a84fe093798682-2\"><span class=\"crayon-v\">bash</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">.</span><span class=\"crayon-o\">/</span><span class=\"crayon-v\">myapp</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">Permission </span><span class=\"crayon-i\">denied</span></div><div class=\"crayon-line\" id=\"crayon-599373d8a84fe093798682-3\"><span class=\"crayon-sy\">$</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">ls</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-</span><span class=\"crayon-i\">l</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">myapp</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599373d8a84fe093798682-4\"><span class=\"crayon-o\">-</span><span class=\"crayon-v\">rw</span><span class=\"crayon-o\">-</span><span class=\"crayon-v\">r</span><span class=\"crayon-o\">--</span><span class=\"crayon-v\">r</span><span class=\"crayon-o\">--</span><span class=\"crayon-sy\">.</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">1</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">root </span><span class=\"crayon-i\">root</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">33</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">Jul</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">21</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">18</span><span class=\"crayon-o\">:</span><span class=\"crayon-cn\">36</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">myapp</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0011 seconds] -->\r\n<p></p>\n<h1>4. tail</h1>\n<p><strong>tail </strong>显示文件的最后一部分内容。通常情况下，你不需要浏览每行日志以进行故障排除。而是需要检查日志中对应用程序的最新请求的说明。例如，当你向 Apache HTTP 服务器发起请求时，可以使用 <strong>tail</strong> 来检查日志中发生的情况。</p>\n<p><a href=\"http://jbcdn2.b0.upaiyun.com/2017/08/d3bb1474cbffe499ef82ea809c54c078.png\"><img class=\"aligncenter wp-image-112081 size-full\" src=\"http://jbcdn2.b0.upaiyun.com/2017/08/d3bb1474cbffe499ef82ea809c54c078.png\" alt=\"205506_GAYc_2918182\" width=\"800\" height=\"321\"></a></p>\n<p><em>使用 <strong>tail -f </strong>来跟踪日志文件并在发起请求时查看它们。</em></p>\n<p><strong>-f</strong> 选项表示跟随的意思，它可在日志被写入文件时输出它们。下面的示例具有每隔几秒访问端点的后台脚本，日志会记录请求。除了实时跟踪日志，还可以使用 <strong>tail </strong>带上 <strong>-n </strong>选项来查看文件的最后 100 行。</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-599373d8a8502152220229\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" touchscreen minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\n$ tail -n 100 /var/log/httpd/access_log</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-599373d8a8502152220229-1\">1</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-599373d8a8502152220229-1\"><span class=\"crayon-sy\">$</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">tail</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-</span><span class=\"crayon-i\">n</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">100</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">/</span><span class=\"crayon-t\">var</span><span class=\"crayon-o\">/</span><span class=\"crayon-v\">log</span><span class=\"crayon-o\">/</span><span class=\"crayon-v\">httpd</span><span class=\"crayon-o\">/</span><span class=\"crayon-v\">access_log</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0006 seconds] -->\r\n<p></p>\n<h1>5. cat</h1>\n<p><strong>cat </strong>主要用于查看文件内容和合并文件。你可能会使用 <strong>cat </strong>来检查依赖项文件的内容，或确认已在本地构建的应用程序的版本。</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-599373d8a8505960488008\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" touchscreen minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\n$ cat requirements.txt\r\nflask\r\nflask_pymongo</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-599373d8a8505960488008-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599373d8a8505960488008-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-599373d8a8505960488008-3\">3</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-599373d8a8505960488008-1\"><span class=\"crayon-sy\">$</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">cat </span><span class=\"crayon-v\">requirements</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">txt</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599373d8a8505960488008-2\"><span class=\"crayon-e\">flask</span></div><div class=\"crayon-line\" id=\"crayon-599373d8a8505960488008-3\"><span class=\"crayon-v\">flask_pymongo</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0004 seconds] -->\r\n<p>上面的示例检查您的 Python Flask 应用程序是否已将 Flask 列为依赖项。</p>\n<h1>6. grep</h1>\n<p>grep 能使用特定模式匹配（包括正则表达式）搜索文本。如果你在另一条命令的输出中寻找特定的模式，<strong>grep </strong>会高亮显示相关的行。可使用这条命令来搜索日志文件以及特定的进程等。如果想查看 Apache Tomcat 是否启动，你可能会命令行的数量给淹没。但讲输出的内容和 <strong>grep </strong>命令组合成管道，可以将表示服务器已启动的行独立出来。</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-599373d8a8508571351506\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" touchscreen minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\n$ cat tomcat.log | grep org.apache.catalina.startup.Catalina.start\r\n01-Jul-2017 18:03:47.542 INFO [main] org.apache.catalina.startup.Catalina.start Server startup in 681 ms</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-599373d8a8508571351506-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599373d8a8508571351506-2\">2</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-599373d8a8508571351506-1\"><span class=\"crayon-sy\">$</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">cat </span><span class=\"crayon-v\">tomcat</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">log</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">|</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">grep </span><span class=\"crayon-v\">org</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">apache</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">catalina</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">startup</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">Catalina</span><span class=\"crayon-sy\">.</span><span class=\"crayon-i\">start</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599373d8a8508571351506-2\"><span class=\"crayon-cn\">01</span><span class=\"crayon-o\">-</span><span class=\"crayon-v\">Jul</span><span class=\"crayon-o\">-</span><span class=\"crayon-cn\">2017</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">18</span><span class=\"crayon-o\">:</span><span class=\"crayon-cn\">03</span><span class=\"crayon-o\">:</span><span class=\"crayon-cn\">47.542</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">INFO</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">[</span><span class=\"crayon-v\">main</span><span class=\"crayon-sy\">]</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">org</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">apache</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">catalina</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">startup</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">Catalina</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">start </span><span class=\"crayon-e\">Server </span><span class=\"crayon-e\">startup </span><span class=\"crayon-st\">in</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">681</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">ms</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0014 seconds] -->\r\n<p></p>\n<h1>7. ps</h1>\n<p><strong>ps </strong>用于查看进程的各种状态信息。使用该命令可确定正在运行的应用程序或确认预期的进程。例如，如果要检查正在运行的 Tomcat Web 服务器，可使用带有选项的 <strong>ps </strong>来获取 Tomcat 的进程 ID。</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-599373d8a850c312248839\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" touchscreen minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\n$ ps -ef\r\nUID        PID  PPID  C STIME TTY          TIME CMD\r\nroot         1     0  2 18:55 ?        00:00:02 /docker-java-home/jre/bi\r\nroot        59     0  0 18:55 pts/0    00:00:00 /bin/sh\r\nroot        75    59  0 18:57 pts/0    00:00:00 ps -ef</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-599373d8a850c312248839-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599373d8a850c312248839-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-599373d8a850c312248839-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599373d8a850c312248839-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-599373d8a850c312248839-5\">5</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-599373d8a850c312248839-1\"><span class=\"crayon-sy\">$</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">ps</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-</span><span class=\"crayon-e\">ef</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599373d8a850c312248839-2\"><span class=\"crayon-e\">UID        </span><span class=\"crayon-e\">PID  </span><span class=\"crayon-i\">PPID</span><span class=\"crayon-h\">  </span><span class=\"crayon-i\">C</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">STIME </span><span class=\"crayon-e\">TTY          </span><span class=\"crayon-e\">TIME </span><span class=\"crayon-e\">CMD</span></div><div class=\"crayon-line\" id=\"crayon-599373d8a850c312248839-3\"><span class=\"crayon-i\">root</span><span class=\"crayon-h\">         </span><span class=\"crayon-cn\">1</span><span class=\"crayon-h\">     </span><span class=\"crayon-cn\">0</span><span class=\"crayon-h\">  </span><span class=\"crayon-cn\">2</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">18</span><span class=\"crayon-o\">:</span><span class=\"crayon-cn\">55</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">?</span><span class=\"crayon-h\">        </span><span class=\"crayon-cn\">00</span><span class=\"crayon-o\">:</span><span class=\"crayon-cn\">00</span><span class=\"crayon-o\">:</span><span class=\"crayon-cn\">02</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">/</span><span class=\"crayon-v\">docker</span><span class=\"crayon-o\">-</span><span class=\"crayon-v\">java</span><span class=\"crayon-o\">-</span><span class=\"crayon-v\">home</span><span class=\"crayon-o\">/</span><span class=\"crayon-v\">jre</span><span class=\"crayon-o\">/</span><span class=\"crayon-e\">bi</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599373d8a850c312248839-4\"><span class=\"crayon-i\">root</span><span class=\"crayon-h\">        </span><span class=\"crayon-cn\">59</span><span class=\"crayon-h\">     </span><span class=\"crayon-cn\">0</span><span class=\"crayon-h\">  </span><span class=\"crayon-cn\">0</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">18</span><span class=\"crayon-o\">:</span><span class=\"crayon-cn\">55</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">pts</span><span class=\"crayon-o\">/</span><span class=\"crayon-cn\">0</span><span class=\"crayon-h\">    </span><span class=\"crayon-cn\">00</span><span class=\"crayon-o\">:</span><span class=\"crayon-cn\">00</span><span class=\"crayon-o\">:</span><span class=\"crayon-cn\">00</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">/</span><span class=\"crayon-v\">bin</span><span class=\"crayon-o\">/</span><span class=\"crayon-e\">sh</span></div><div class=\"crayon-line\" id=\"crayon-599373d8a850c312248839-5\"><span class=\"crayon-i\">root</span><span class=\"crayon-h\">        </span><span class=\"crayon-cn\">75</span><span class=\"crayon-h\">    </span><span class=\"crayon-cn\">59</span><span class=\"crayon-h\">  </span><span class=\"crayon-cn\">0</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">18</span><span class=\"crayon-o\">:</span><span class=\"crayon-cn\">57</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">pts</span><span class=\"crayon-o\">/</span><span class=\"crayon-cn\">0</span><span class=\"crayon-h\">    </span><span class=\"crayon-cn\">00</span><span class=\"crayon-o\">:</span><span class=\"crayon-cn\">00</span><span class=\"crayon-o\">:</span><span class=\"crayon-cn\">00</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">ps</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-</span><span class=\"crayon-v\">ef</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0021 seconds] -->\r\n<p>为了更好的易读性，可使用 <strong>grep </strong>和 <strong>ps </strong>组合成管道。</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-599373d8a850f564805825\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" touchscreen minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\n$ ps -ef | grep tomcat\r\nroot         1     0  1 18:55 ?        00:00:02 /docker-java-home/jre/bi</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-599373d8a850f564805825-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599373d8a850f564805825-2\">2</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-599373d8a850f564805825-1\"><span class=\"crayon-sy\">$</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">ps</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-</span><span class=\"crayon-v\">ef</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">|</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">grep </span><span class=\"crayon-e\">tomcat</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599373d8a850f564805825-2\"><span class=\"crayon-i\">root</span><span class=\"crayon-h\">         </span><span class=\"crayon-cn\">1</span><span class=\"crayon-h\">     </span><span class=\"crayon-cn\">0</span><span class=\"crayon-h\">  </span><span class=\"crayon-cn\">1</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">18</span><span class=\"crayon-o\">:</span><span class=\"crayon-cn\">55</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">?</span><span class=\"crayon-h\">        </span><span class=\"crayon-cn\">00</span><span class=\"crayon-o\">:</span><span class=\"crayon-cn\">00</span><span class=\"crayon-o\">:</span><span class=\"crayon-cn\">02</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">/</span><span class=\"crayon-v\">docker</span><span class=\"crayon-o\">-</span><span class=\"crayon-v\">java</span><span class=\"crayon-o\">-</span><span class=\"crayon-v\">home</span><span class=\"crayon-o\">/</span><span class=\"crayon-v\">jre</span><span class=\"crayon-o\">/</span><span class=\"crayon-v\">bi</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0010 seconds] -->\r\n<p></p>\n<h1>8. env</h1>\n<p><strong>env </strong>用于列出所有环境变量及为其赋值。在故障排除期间，你可能会发现需要检查是否有错误的环境变量来阻止应用程序启动。在下面的示例中，该命令用于检查程序主机上设置的环境变量。</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-599373d8a8512644190585\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" touchscreen minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\n$ env\r\nPYTHON_PIP_VERSION=9.0.1\r\nHOME=/root\r\nDB_NAME=test\r\nPATH=/usr/local/bin:/usr/local/sbin\r\nLANG=C.UTF-8\r\nPYTHON_VERSION=3.4.6\r\nPWD=/\r\nDB_URI=mongodb://database:27017/test</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-599373d8a8512644190585-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599373d8a8512644190585-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-599373d8a8512644190585-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599373d8a8512644190585-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-599373d8a8512644190585-5\">5</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599373d8a8512644190585-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-599373d8a8512644190585-7\">7</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599373d8a8512644190585-8\">8</div><div class=\"crayon-num\" data-line=\"crayon-599373d8a8512644190585-9\">9</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-599373d8a8512644190585-1\"><span class=\"crayon-sy\">$</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">env</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599373d8a8512644190585-2\"><span class=\"crayon-v\">PYTHON_PIP_VERSION</span><span class=\"crayon-o\">=</span><span class=\"crayon-cn\">9.0.1</span></div><div class=\"crayon-line\" id=\"crayon-599373d8a8512644190585-3\"><span class=\"crayon-v\">HOME</span><span class=\"crayon-o\">=</span><span class=\"crayon-o\">/</span><span class=\"crayon-e\">root</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599373d8a8512644190585-4\"><span class=\"crayon-v\">DB_NAME</span><span class=\"crayon-o\">=</span><span class=\"crayon-e\">test</span></div><div class=\"crayon-line\" id=\"crayon-599373d8a8512644190585-5\"><span class=\"crayon-v\">PATH</span><span class=\"crayon-o\">=</span><span class=\"crayon-o\">/</span><span class=\"crayon-v\">usr</span><span class=\"crayon-o\">/</span><span class=\"crayon-v\">local</span><span class=\"crayon-o\">/</span><span class=\"crayon-v\">bin</span><span class=\"crayon-o\">:</span><span class=\"crayon-o\">/</span><span class=\"crayon-v\">usr</span><span class=\"crayon-o\">/</span><span class=\"crayon-v\">local</span><span class=\"crayon-o\">/</span><span class=\"crayon-e\">sbin</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599373d8a8512644190585-6\"><span class=\"crayon-v\">LANG</span><span class=\"crayon-o\">=</span><span class=\"crayon-v\">C</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">UTF</span><span class=\"crayon-o\">-</span><span class=\"crayon-cn\">8</span></div><div class=\"crayon-line\" id=\"crayon-599373d8a8512644190585-7\"><span class=\"crayon-v\">PYTHON_VERSION</span><span class=\"crayon-o\">=</span><span class=\"crayon-cn\">3.4.6</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599373d8a8512644190585-8\"><span class=\"crayon-v\">PWD</span><span class=\"crayon-o\">=</span><span class=\"crayon-o\">/</span></div><div class=\"crayon-line\" id=\"crayon-599373d8a8512644190585-9\"><span class=\"crayon-v\">DB_URI</span><span class=\"crayon-o\">=</span><span class=\"crayon-v\">mongodb</span><span class=\"crayon-o\">:</span><span class=\"crayon-c\">//database:27017/test</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0012 seconds] -->\r\n<p>请注意，该应用程序正在使用 Python 3，并具有连接到 MongoDB 数据库的环境变量。</p>\n<h1>9. top</h1>\n<p><strong>top </strong>用于显示系统中各个进程的信息和资源占用状况，类似于 Windows 的任务管理器。使用该命令可确定哪些进程正在运行，以及它们消耗了多少的内存和 CPU。一种常见的情况是当你运行一个应用程序时，它在一分钟后挂掉。这时，你首先检查应用程序的返回错误，发现是一个内存错误。</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-599373d8a8515401668450\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" touchscreen minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\n$ tail myapp.log\r\nTraceback (most recent call last):\r\nMemoryError</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-599373d8a8515401668450-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599373d8a8515401668450-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-599373d8a8515401668450-3\">3</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-599373d8a8515401668450-1\"><span class=\"crayon-sy\">$</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">tail </span><span class=\"crayon-v\">myapp</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">log</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599373d8a8515401668450-2\"><span class=\"crayon-e\">Traceback</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-e\">most </span><span class=\"crayon-e\">recent </span><span class=\"crayon-e\">call </span><span class=\"crayon-v\">last</span><span class=\"crayon-sy\">)</span><span class=\"crayon-o\">:</span></div><div class=\"crayon-line\" id=\"crayon-599373d8a8515401668450-3\"><span class=\"crayon-v\">MemoryError</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0006 seconds] -->\r\n<p>你的应用是否真的内存不足？要确认这个问题，可使用 <strong>top </strong>来查看应用程序消耗多少 CPU 和内存。当使用 <strong>top </strong>命令后，您注意到一个 Python 应用程序使用了大部分的 CPU，其内存使用量也迅速攀升。当它运行时，如果进程是你的应用程序，则按”C”键来查看完整命令并进行逆向工程。发现原来是你的内存密集型应用程序(<strong>memeater.py</strong>)。当你的应用程序已经用尽内存，系统会杀掉它并返回一个内存不足(OOM)的错误。</p>\n<p><a href=\"http://jbcdn2.b0.upaiyun.com/2017/08/eeb3863a3e031513712e9556d1c6eeed.png\"><img class=\"aligncenter wp-image-112086 size-full\" src=\"http://jbcdn2.b0.upaiyun.com/2017/08/eeb3863a3e031513712e9556d1c6eeed.png\" alt=\"205506_GAYc_2918182\" width=\"800\" height=\"332\"></a></p>\n<p><em>应用程序的内存和 CPU 使用量增加，最终因为内存不足而被杀掉。</em></p>\n<p><a href=\"http://jbcdn2.b0.upaiyun.com/2017/08/8cef41f3180be447f1405efebfc8420c.png\"><img class=\"aligncenter wp-image-112087 size-full\" src=\"http://jbcdn2.b0.upaiyun.com/2017/08/8cef41f3180be447f1405efebfc8420c.png\" alt=\"205506_GAYc_2918182\" width=\"800\" height=\"290\"></a></p>\n<p><em>通过按下”C”键，可以看到启动该应用程序的完整命令</em></p>\n<p>除了检查应用程序，还可以使用 <strong>top </strong>来调试其他使用 CPU 或内存的进程。</p>\n<h1>10. netstat</h1>\n<p><strong>netstat </strong>用于显示网络状态信息。该命令可显示正在使用的网络端口及其传入连接。但是，<strong>netstat </strong>在 Linux 中不能开箱即用。如果需要安装它，需要在 <strong><a href=\"https://wiki.linuxfoundation.org/networking/net-tools\" target=\"_blank\" rel=\"nofollow\">net-tools</a> </strong>包中找到它。作为在本地进行试验或将应用程序推送到主机的开发者，可能会收到端口已被分配或地址已被使用的错误。使用 <strong>netstat</strong> 得到协议、进程和端口这些信息，下图表明 Apache HTTP 服务器已经在下面的主机上使用了 80 端口。</p>\n<p><a href=\"http://jbcdn2.b0.upaiyun.com/2017/08/da463bd1dfe1c75df76fff92f6fa4842.png\"><img class=\"aligncenter wp-image-112088 size-full\" src=\"http://jbcdn2.b0.upaiyun.com/2017/08/da463bd1dfe1c75df76fff92f6fa4842.png\" alt=\"205506_GAYc_2918182\" width=\"800\" height=\"284\"></a></p>\n<p><em>使用 <strong>netstat -tulpn </strong>表明 Apache 已经在这台机器上使用了 80 端口。</em></p>\n<h1>11. ip address</h1>\n<p>如果 <strong>ip address </strong>在你的主机上不能使用，必须使用 <strong><a href=\"https://wiki.linuxfoundation.org/networking/iproute2\" target=\"_blank\" rel=\"nofollow\">iproute2</a> </strong>包进行安装。<strong>i</strong><strong>p address </strong>用于显示应用程序的主机接口和 IP 地址。可使用 <strong>i</strong><strong>p address </strong>来验证你的容器或主机的 IP 地址。例如，当你的容器连接到两个网络时，<strong>i</strong><strong>p address </strong>可显示哪个接口连接到了哪个网络。对于简单的检查，可以随时使用 <strong>ip address </strong>命令获取主机的 IP 地址。下面的示例展示了在接口 eth0 上的 Web 层容器的 IP 地址为 172.17.0.2</p>\n<p><a href=\"http://jbcdn2.b0.upaiyun.com/2017/08/f47acafef2423ba78048bffb330f5a06.png\"><img class=\"aligncenter wp-image-112089 size-full\" src=\"http://jbcdn2.b0.upaiyun.com/2017/08/f47acafef2423ba78048bffb330f5a06.png\" alt=\"205506_GAYc_2918182\" width=\"800\" height=\"89\"></a></p>\n<p><em>使用 <strong>ip address </strong>显示 eth0 接口的 IP 地址为 172.17.0.2</em></p>\n<h1>12. lsof</h1>\n<p><strong>lsof </strong>用于列出当前系统打开的文件(list open files)。在某些 Linux 系统中，可能需要使用 <a href=\"http://www.linuxfromscratch.org/blfs/view/svn/general/lsof.html\" target=\"_blank\" rel=\"nofollow\">lsof</a> 包来安装<strong>lsof</strong>。在 Linux 中，几乎任何和系统的交互都被视为一个文件。因此，如果你的应用程序写入文件或代开网络连接，<strong>lsof </strong>将会把这个交互映射为一个文件。与 <strong>netstat </strong>类似，可使用 <strong>lsof </strong>来检查侦听端口。例如，如果要检查 80 端口是否正在被使用，可使用 <strong>lsof </strong>来检查哪个进程正在使用它。下面的示例中，可以看到 httpd (Apache) 在 80 端口上侦听。还可以使用 <strong>lsof </strong>来检查 httpd 的进程ID，检查 Web 服务器的二进制文件所在位置(<strong>/usr/sbin/httpd</strong>)。</p>\n<p><a href=\"http://jbcdn2.b0.upaiyun.com/2017/08/c03a535f9ce77f7c52d661cbdd907bfe.png\"><img class=\"aligncenter wp-image-112090 size-full\" src=\"http://jbcdn2.b0.upaiyun.com/2017/08/c03a535f9ce77f7c52d661cbdd907bfe.png\" alt=\"205506_GAYc_2918182\" width=\"800\" height=\"252\"></a></p>\n<p><em><strong>Lsof </strong>表明了 httpd 在 80 端口上侦听。检查 httpd 的进程ID还可以显示所有需要运行的文件httpd。</em></p>\n<p>打开文件列表中的打开文件的名称有助于确定进程的来源，特别是 Apache。</p>\n<h1>13. df</h1>\n<p>可以使用 <strong>df</strong> 显示空闲的磁盘空间(display free disk space)以排查磁盘空间问题。挡在容器管理器上运行应用程序时，可能会收到一条错误信息，提示容器主机上缺少可用空间。虽然磁盘空间应该由系统管理程序来管理和优化，你仍可以使用 <strong>df </strong>找出目录中的现有空间并确认是否没有空间。</p>\n<p><a href=\"http://jbcdn2.b0.upaiyun.com/2017/08/d4981e341da22b6f3dd72ffc98003b59.png\"><img class=\"aligncenter wp-image-112091 size-full\" src=\"http://jbcdn2.b0.upaiyun.com/2017/08/d4981e341da22b6f3dd72ffc98003b59.png\" alt=\"205506_GAYc_2918182\" width=\"800\" height=\"258\"></a></p>\n<p><em><strong>Df</strong> 显示每个文件系统的磁盘空间、绝对空间以及其可用性。</em></p>\n<p><strong>-h </strong>选项表示以可读性较高的方式来显示信息，上面的例子表示这个主机具有大量的磁盘空间。</p>\n<h1>14. du</h1>\n<p><strong>du</strong> 命令也是用于查看使用空间的，但是与 df 命令不同的是 du 命令是对文件和目录磁盘使用的空间的查看，要获取有关哪些文件在目录中使用磁盘空间的更多详细信息，可以使用 du 命令，和 df 命令还是有一些区别的。例如，你想了解那个日志文件占用 <strong>/var/log </strong>目录最多的空间，可以使用 <strong>du</strong> 命令加上 <strong>-h</strong> 选项和用于获取总大小的 <strong>-s </strong>选项。</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-599373d8a851c363265754\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" touchscreen minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\n$ du -sh /var/log/*\r\n1.8M  /var/log/anaconda\r\n384K  /var/log/audit\r\n4.0K  /var/log/boot.log\r\n0 /var/log/chrony\r\n4.0K  /var/log/cron\r\n4.0K  /var/log/maillog\r\n64K /var/log/messages</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-599373d8a851c363265754-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599373d8a851c363265754-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-599373d8a851c363265754-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599373d8a851c363265754-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-599373d8a851c363265754-5\">5</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599373d8a851c363265754-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-599373d8a851c363265754-7\">7</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599373d8a851c363265754-8\">8</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-599373d8a851c363265754-1\"><span class=\"crayon-sy\">$</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">du</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-</span><span class=\"crayon-v\">sh</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">/</span><span class=\"crayon-t\">var</span><span class=\"crayon-o\">/</span><span class=\"crayon-v\">log</span><span class=\"crayon-o\">/</span><span class=\"crayon-o\">*</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599373d8a851c363265754-2\"><span class=\"crayon-cn\">1.8M</span><span class=\"crayon-h\">  </span><span class=\"crayon-o\">/</span><span class=\"crayon-t\">var</span><span class=\"crayon-o\">/</span><span class=\"crayon-v\">log</span><span class=\"crayon-o\">/</span><span class=\"crayon-i\">anaconda</span></div><div class=\"crayon-line\" id=\"crayon-599373d8a851c363265754-3\"><span class=\"crayon-cn\">384K</span><span class=\"crayon-h\">  </span><span class=\"crayon-o\">/</span><span class=\"crayon-t\">var</span><span class=\"crayon-o\">/</span><span class=\"crayon-v\">log</span><span class=\"crayon-o\">/</span><span class=\"crayon-i\">audit</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599373d8a851c363265754-4\"><span class=\"crayon-cn\">4.0K</span><span class=\"crayon-h\">  </span><span class=\"crayon-o\">/</span><span class=\"crayon-t\">var</span><span class=\"crayon-o\">/</span><span class=\"crayon-v\">log</span><span class=\"crayon-o\">/</span><span class=\"crayon-v\">boot</span><span class=\"crayon-sy\">.</span><span class=\"crayon-i\">log</span></div><div class=\"crayon-line\" id=\"crayon-599373d8a851c363265754-5\"><span class=\"crayon-cn\">0</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">/</span><span class=\"crayon-t\">var</span><span class=\"crayon-o\">/</span><span class=\"crayon-v\">log</span><span class=\"crayon-o\">/</span><span class=\"crayon-i\">chrony</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599373d8a851c363265754-6\"><span class=\"crayon-cn\">4.0K</span><span class=\"crayon-h\">  </span><span class=\"crayon-o\">/</span><span class=\"crayon-t\">var</span><span class=\"crayon-o\">/</span><span class=\"crayon-v\">log</span><span class=\"crayon-o\">/</span><span class=\"crayon-i\">cron</span></div><div class=\"crayon-line\" id=\"crayon-599373d8a851c363265754-7\"><span class=\"crayon-cn\">4.0K</span><span class=\"crayon-h\">  </span><span class=\"crayon-o\">/</span><span class=\"crayon-t\">var</span><span class=\"crayon-o\">/</span><span class=\"crayon-v\">log</span><span class=\"crayon-o\">/</span><span class=\"crayon-i\">maillog</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599373d8a851c363265754-8\"><span class=\"crayon-cn\">64K</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">/</span><span class=\"crayon-t\">var</span><span class=\"crayon-o\">/</span><span class=\"crayon-v\">log</span><span class=\"crayon-o\">/</span><span class=\"crayon-v\">messages</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0017 seconds] -->\r\n<p>上面的示例中显示了 <strong>/var/log </strong>下的的最大目录为 <strong>/var/log/audit</strong>。可以将 <strong>du</strong> 和 <strong>df</strong> 搭配使用，以确定在应用程序的主机上使用的磁盘空间。</p>\n<h1>15. id</h1>\n<p>要检查运行应用程序的用户，可使用 <strong>id </strong>命令来返回用户身份。<strong>id </strong>命令可以显示真实有效的用户ID(UID)和组ID(GID)。下面的示例使用 <a href=\"https://www.vagrantup.com/\" target=\"_blank\" rel=\"nofollow\">Vagrant</a> 来测试应用程序并隔离其开发环境。登录进 Vagrant 盒子后，如果尝试安装 Apache HTTP Server（依赖关系），系统会提示你需要以 root 身份执行该命令。要检查你的用户ID和组ID，使用 <strong>id </strong>命令，会发现你正在”vagrant”组中以”vagrant”用户身份运行。</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-599373d8a8520089283058\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" touchscreen minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\n$ yum -y install httpd\r\nLoaded plugins: fastestmirror\r\nYou need to be root to perform this command.\r\n$ id\r\nuid=1000(vagrant) gid=1000(vagrant) groups=1000(vagrant) context=unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-599373d8a8520089283058-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599373d8a8520089283058-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-599373d8a8520089283058-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599373d8a8520089283058-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-599373d8a8520089283058-5\">5</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-599373d8a8520089283058-1\"><span class=\"crayon-sy\">$</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">yum</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-</span><span class=\"crayon-i\">y</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">install </span><span class=\"crayon-e\">httpd</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599373d8a8520089283058-2\"><span class=\"crayon-e\">Loaded </span><span class=\"crayon-v\">plugins</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">fastestmirror</span></div><div class=\"crayon-line\" id=\"crayon-599373d8a8520089283058-3\"><span class=\"crayon-e\">You </span><span class=\"crayon-e\">need </span><span class=\"crayon-st\">to</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">be </span><span class=\"crayon-e\">root </span><span class=\"crayon-st\">to</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">perform </span><span class=\"crayon-r\">this</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">command</span><span class=\"crayon-sy\">.</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599373d8a8520089283058-4\"><span class=\"crayon-sy\">$</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">id</span></div><div class=\"crayon-line\" id=\"crayon-599373d8a8520089283058-5\"><span class=\"crayon-v\">uid</span><span class=\"crayon-o\">=</span><span class=\"crayon-cn\">1000</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">vagrant</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">gid</span><span class=\"crayon-o\">=</span><span class=\"crayon-cn\">1000</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">vagrant</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">groups</span><span class=\"crayon-o\">=</span><span class=\"crayon-cn\">1000</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">vagrant</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">context</span><span class=\"crayon-o\">=</span><span class=\"crayon-v\">unconfined_u</span><span class=\"crayon-o\">:</span><span class=\"crayon-v\">unconfined_r</span><span class=\"crayon-o\">:</span><span class=\"crayon-v\">unconfined_t</span><span class=\"crayon-o\">:</span><span class=\"crayon-v\">s0</span><span class=\"crayon-o\">-</span><span class=\"crayon-v\">s0</span><span class=\"crayon-o\">:</span><span class=\"crayon-v\">c0</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">c1023</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0016 seconds] -->\r\n<p>要解决此问题，必须以超级用户的身份运行该命令，这将提供提升的权限。</p>\n<h1>16. chmod</h1>\n<p><strong>c</strong><strong>hmod</strong> 命令用来变更文件或目录的权限。当你在主机上首次运行应用程序的二进制文件时，可能会收到错误提示信息“拒绝访问”。如 <strong>ls </strong>的示例所示，可以用于检查应用程序二进制文件的权限。</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-599373d8a8524517966192\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" touchscreen minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\n$ ls -l\r\ntotal 4\r\n-rw-rw-r--. 1 vagrant vagrant 34 Jul 11 02:17 test.sh</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-599373d8a8524517966192-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599373d8a8524517966192-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-599373d8a8524517966192-3\">3</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-599373d8a8524517966192-1\"><span class=\"crayon-sy\">$</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">ls</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-</span><span class=\"crayon-i\">l</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599373d8a8524517966192-2\"><span class=\"crayon-i\">total</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">4</span></div><div class=\"crayon-line\" id=\"crayon-599373d8a8524517966192-3\"><span class=\"crayon-o\">-</span><span class=\"crayon-v\">rw</span><span class=\"crayon-o\">-</span><span class=\"crayon-v\">rw</span><span class=\"crayon-o\">-</span><span class=\"crayon-v\">r</span><span class=\"crayon-o\">--</span><span class=\"crayon-sy\">.</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">1</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">vagrant </span><span class=\"crayon-i\">vagrant</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">34</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">Jul</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">11</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">02</span><span class=\"crayon-o\">:</span><span class=\"crayon-cn\">17</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">test</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">sh</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0011 seconds] -->\r\n<p>这表明您没有权限（没有“x”）来运行二进制文件。<strong>c</strong><strong>hmod </strong>可以修改权限，使的用户能够运行二进制文件。</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-599373d8a8527871363543\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" touchscreen minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\n$ chmod +x test.sh\r\n[vagrant@localhost ~]$ ls -l\r\ntotal 4\r\n-rwxrwxr-x. 1 vagrant vagrant 34 Jul 11 02:17 test.sh</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-599373d8a8527871363543-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599373d8a8527871363543-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-599373d8a8527871363543-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599373d8a8527871363543-4\">4</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-599373d8a8527871363543-1\"><span class=\"crayon-sy\">$</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">chmod</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">+</span><span class=\"crayon-i\">x</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">test</span><span class=\"crayon-sy\">.</span><span class=\"crayon-i\">sh</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599373d8a8527871363543-2\"><span class=\"crayon-sy\">[</span><span class=\"crayon-v\">vagrant</span><span class=\"crayon-sy\">@</span><span class=\"crayon-v\">localhost</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">~</span><span class=\"crayon-sy\">]</span><span class=\"crayon-sy\">$</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">ls</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-</span><span class=\"crayon-i\">l</span></div><div class=\"crayon-line\" id=\"crayon-599373d8a8527871363543-3\"><span class=\"crayon-i\">total</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">4</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599373d8a8527871363543-4\"><span class=\"crayon-o\">-</span><span class=\"crayon-v\">rwxrwxr</span><span class=\"crayon-o\">-</span><span class=\"crayon-v\">x</span><span class=\"crayon-sy\">.</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">1</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">vagrant </span><span class=\"crayon-i\">vagrant</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">34</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">Jul</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">11</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">02</span><span class=\"crayon-o\">:</span><span class=\"crayon-cn\">17</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">test</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">sh</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0013 seconds] -->\r\n<p>如例子所示，这将更新权限，使其具有可执行的权限。现在当你尝试执行二进制文件时，应用程序不会抛出拒绝访问的错误。当将二进制文件加载到容器时，<strong>Chmod</strong> 可能很有用。它能保证容器具有合适的权限以执行二进制文件。</p>\n<h1>17. dig / nslookup</h1>\n<p><strong>dig </strong>命令是常用的域名查询工具，可以用来测试域名系统工作是否正常。域名服务器(DNS)有助于将 URL 解析为一组应用程序服务器。然而，你会发现有些 URL 不能被解析，这会导致应用程序的连接问题。例如，假如你尝试从应用程序的主机访问你的数据库。你收到一个”不能解析”的错误。要进行故障排查，你尝试使用 <strong>dig</strong>（DNS 查询工具）或 <strong>nslookup</strong>（查询 Internet 域名服务器）来确定应用程序似乎无法解析数据的原因。</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-599373d8a852b115822570\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" touchscreen minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\n$ nslookup mydatabase\r\nServer:   10.0.2.3\r\nAddress:  10.0.2.3#53\r\n\r\n** server can't find mydatabase: NXDOMAIN</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-599373d8a852b115822570-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599373d8a852b115822570-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-599373d8a852b115822570-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599373d8a852b115822570-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-599373d8a852b115822570-5\">5</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-599373d8a852b115822570-1\"><span class=\"crayon-sy\">$</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">nslookup </span><span class=\"crayon-e\">mydatabase</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599373d8a852b115822570-2\"><span class=\"crayon-v\">Server</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\">   </span><span class=\"crayon-cn\">10.0.2.3</span></div><div class=\"crayon-line\" id=\"crayon-599373d8a852b115822570-3\"><span class=\"crayon-v\">Address</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\">  </span><span class=\"crayon-cn\">10.0.2.3</span><span class=\"crayon-p\">#53</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599373d8a852b115822570-4\"> </div><div class=\"crayon-line\" id=\"crayon-599373d8a852b115822570-5\"><span class=\"crayon-o\">*</span><span class=\"crayon-o\">*</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">server </span><span class=\"crayon-i\">can</span>'<span class=\"crayon-i\">t</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">find </span><span class=\"crayon-v\">mydatabase</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">NXDOMAIN</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0008 seconds] -->\r\n<p>使用 <strong>nslookup </strong>显示无法解析 <strong>mydatabase</strong>。尝试使用 <strong>dig </strong>解决，但仍是相同的结果。</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-599373d8a852e645136790\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" touchscreen minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\n$ dig mydatabase\r\n\r\n; &lt;&lt;&gt;&gt; DiG 9.9.4-RedHat-9.9.4-50.el7_3.1 &lt;&lt;&gt;&gt; mydatabase\r\n;; global options: +cmd\r\n;; connection timed out; no servers could be reached</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-599373d8a852e645136790-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599373d8a852e645136790-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-599373d8a852e645136790-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599373d8a852e645136790-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-599373d8a852e645136790-5\">5</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-599373d8a852e645136790-1\"><span class=\"crayon-sy\">$</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">dig </span><span class=\"crayon-i\">mydatabase</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599373d8a852e645136790-2\"> </div><div class=\"crayon-line\" id=\"crayon-599373d8a852e645136790-3\"><span class=\"crayon-sy\">;</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">&lt;&lt;</span><span class=\"crayon-o\">&gt;&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">DiG</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">9.9.4</span><span class=\"crayon-o\">-</span><span class=\"crayon-v\">RedHat</span><span class=\"crayon-o\">-</span><span class=\"crayon-cn\">9.9.4</span><span class=\"crayon-o\">-</span><span class=\"crayon-cn\">50.el7_3.1</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">&lt;&lt;</span><span class=\"crayon-o\">&gt;&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">mydatabase</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599373d8a852e645136790-4\"><span class=\"crayon-sy\">;</span><span class=\"crayon-sy\">;</span><span class=\"crayon-h\"> </span><span class=\"crayon-m\">global</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">options</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">+</span><span class=\"crayon-i\">cmd</span></div><div class=\"crayon-line\" id=\"crayon-599373d8a852e645136790-5\"><span class=\"crayon-sy\">;</span><span class=\"crayon-sy\">;</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">connection </span><span class=\"crayon-e\">timed </span><span class=\"crayon-v\">out</span><span class=\"crayon-sy\">;</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">no </span><span class=\"crayon-e\">servers </span><span class=\"crayon-e\">could </span><span class=\"crayon-e\">be </span><span class=\"crayon-v\">reached</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0012 seconds] -->\r\n<p>这些错误可能是由许多不同的问题引起的。如果无法调试出根本原因，与系统管理员联系以进行更多的调查。对于本地测试，这些问题可能表示你的主机的域名服务器未正确配置。要使用这些命令，需要安装 <strong><a href=\"http://www.linuxfromscratch.org/blfs/view/svn/basicnet/bind-utils.html\" target=\"_blank\" rel=\"nofollow\">BIND Utilities</a> </strong>包<strong>。</strong></p>\n<h1>18. iptables</h1>\n<p>iptables 用于阻止或允许 Linux 主机上的流量，用于 IP 包过滤器管理，类似于网络防火墙。此工具可阻止某些应用程序接收或发送请求。更具体地说，如果您的应用程序难以访问另一个端点，可能已被 iptables 拒绝流量访问该端点。例如，假设您的应用程序的主机无法访问 Opensource.com，您使用 <strong>curl </strong>来测试连接。</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-599373d8a8532299318360\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" touchscreen minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\n$ curl -vvv opensource.com\r\n* About to connect() to opensource.com port 80 (#0)\r\n*   Trying 54.204.39.132...\r\n* Connection timed out\r\n* Failed connect to opensource.com:80; Connection timed out\r\n* Closing connection 0\r\ncurl: (7) Failed connect to opensource.com:80; Connection timed out</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-599373d8a8532299318360-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599373d8a8532299318360-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-599373d8a8532299318360-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599373d8a8532299318360-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-599373d8a8532299318360-5\">5</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599373d8a8532299318360-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-599373d8a8532299318360-7\">7</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-599373d8a8532299318360-1\"><span class=\"crayon-sy\">$</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">curl</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-</span><span class=\"crayon-e\">vvv </span><span class=\"crayon-v\">opensource</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e \">com</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599373d8a8532299318360-2\"><span class=\"crayon-e \">*</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">About </span><span class=\"crayon-st\">to</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">connect</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-st\">to</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">opensource</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">com </span><span class=\"crayon-i\">port</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">80</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-p\">#0)</span></div><div class=\"crayon-line\" id=\"crayon-599373d8a8532299318360-3\"><span class=\"crayon-o\">*</span><span class=\"crayon-h\">   </span><span class=\"crayon-i\">Trying</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">54.204.39.132...</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599373d8a8532299318360-4\"><span class=\"crayon-o\">*</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">Connection </span><span class=\"crayon-e\">timed </span><span class=\"crayon-e \">out</span></div><div class=\"crayon-line\" id=\"crayon-599373d8a8532299318360-5\"><span class=\"crayon-e \">*</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">Failed </span><span class=\"crayon-e\">connect </span><span class=\"crayon-st\">to</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">opensource</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">com</span><span class=\"crayon-o\">:</span><span class=\"crayon-cn\">80</span><span class=\"crayon-sy\">;</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">Connection </span><span class=\"crayon-e\">timed </span><span class=\"crayon-e \">out</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599373d8a8532299318360-6\"><span class=\"crayon-e \">*</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">Closing </span><span class=\"crayon-i\">connection</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span></div><div class=\"crayon-line\" id=\"crayon-599373d8a8532299318360-7\"><span class=\"crayon-v\">curl</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-cn\">7</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">Failed </span><span class=\"crayon-e\">connect </span><span class=\"crayon-st\">to</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">opensource</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">com</span><span class=\"crayon-o\">:</span><span class=\"crayon-cn\">80</span><span class=\"crayon-sy\">;</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">Connection </span><span class=\"crayon-e\">timed </span><span class=\"crayon-v\">out</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0019 seconds] -->\r\n<p>连接超时。您怀疑某些东西可能会阻塞流量，因此您使用 <strong>-S </strong>选项显示 <strong>iptables </strong>规则。</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-599373d8a8535997065915\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" touchscreen minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\n$ iptables -S\r\n-P INPUT DROP\r\n-P FORWARD DROP\r\n-P OUTPUT DROP\r\n-A INPUT -p tcp -m tcp --dport 22 -j ACCEPT\r\n-A INPUT -i eth0 -p udp -m udp --sport 53 -j ACCEPT\r\n-A OUTPUT -p tcp -m tcp --sport 22 -j ACCEPT\r\n-A OUTPUT -o eth0 -p udp -m udp --dport 53 -j ACCEPT</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-599373d8a8535997065915-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599373d8a8535997065915-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-599373d8a8535997065915-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599373d8a8535997065915-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-599373d8a8535997065915-5\">5</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599373d8a8535997065915-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-599373d8a8535997065915-7\">7</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599373d8a8535997065915-8\">8</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-599373d8a8535997065915-1\"><span class=\"crayon-sy\">$</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">iptables</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-</span><span class=\"crayon-v\">S</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599373d8a8535997065915-2\"><span class=\"crayon-o\">-</span><span class=\"crayon-i\">P</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">INPUT </span><span class=\"crayon-v\">DROP</span></div><div class=\"crayon-line\" id=\"crayon-599373d8a8535997065915-3\"><span class=\"crayon-o\">-</span><span class=\"crayon-i\">P</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">FORWARD </span><span class=\"crayon-v\">DROP</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599373d8a8535997065915-4\"><span class=\"crayon-o\">-</span><span class=\"crayon-i\">P</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">OUTPUT </span><span class=\"crayon-v\">DROP</span></div><div class=\"crayon-line\" id=\"crayon-599373d8a8535997065915-5\"><span class=\"crayon-o\">-</span><span class=\"crayon-i\">A</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">INPUT</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-</span><span class=\"crayon-i\">p</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">tcp</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-</span><span class=\"crayon-i\">m</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">tcp</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">--</span><span class=\"crayon-i\">dport</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">22</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-</span><span class=\"crayon-i\">j</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">ACCEPT</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599373d8a8535997065915-6\"><span class=\"crayon-o\">-</span><span class=\"crayon-i\">A</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">INPUT</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-</span><span class=\"crayon-i\">i</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">eth0</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-</span><span class=\"crayon-i\">p</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">udp</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-</span><span class=\"crayon-i\">m</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">udp</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">--</span><span class=\"crayon-i\">sport</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">53</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-</span><span class=\"crayon-i\">j</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">ACCEPT</span></div><div class=\"crayon-line\" id=\"crayon-599373d8a8535997065915-7\"><span class=\"crayon-o\">-</span><span class=\"crayon-i\">A</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">OUTPUT</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-</span><span class=\"crayon-i\">p</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">tcp</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-</span><span class=\"crayon-i\">m</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">tcp</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">--</span><span class=\"crayon-i\">sport</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">22</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-</span><span class=\"crayon-i\">j</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">ACCEPT</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599373d8a8535997065915-8\"><span class=\"crayon-o\">-</span><span class=\"crayon-i\">A</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">OUTPUT</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-</span><span class=\"crayon-i\">o</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">eth0</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-</span><span class=\"crayon-i\">p</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">udp</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-</span><span class=\"crayon-i\">m</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">udp</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">--</span><span class=\"crayon-i\">dport</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">53</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-</span><span class=\"crayon-i\">j</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">ACCEPT</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0029 seconds] -->\r\n<p>前三个规则显示，默认情况下流量已被丢弃。剩下的规则表示允许 SSH 和 DNS 流量。在这种情况下，如果需要允许流量到外部端点的规则，请跟上 sysadmin。如果这是用于本地开发或测试的主机，可使用 <strong>iptables </strong>命令来允许合适的流量。添加允许到主机的流量的规则时一定要谨慎。</p>\n<h1>19. sestatus</h1>\n<p>通常会在企业管理的应用程序主机上使用 SELinux（一个 Linux 安全模块）。SELinux 对主机上运行的进程提供最低权限的访问，防止潜在的恶意进程访问系统上的重要文件。某些情况下，应用程序需要访问特定文件，但可能会发生错误。要检查 SELinux 是否阻止了应用程序，使用 <strong>tail </strong>和 <strong>grep </strong>在 <strong>/var/log/audit </strong>日志记录中查找”denied”（被拒绝）的信息。否则，使用 <strong>sestatus </strong>来检查是否启动了 SELinux。</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-599373d8a8539182934351\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" touchscreen minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\n$ sestatus\r\nSELinux status:                 enabled\r\nSELinuxfs mount:                /sys/fs/selinux\r\nSELinux root directory:         /etc/selinux\r\nLoaded policy name:             targeted\r\nCurrent mode:                   enforcing\r\nMode from config file:          enforcing\r\nPolicy MLS status:              enabled\r\nPolicy deny_unknown status:     allowed\r\nMax kernel policy version:      28</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-599373d8a8539182934351-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599373d8a8539182934351-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-599373d8a8539182934351-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599373d8a8539182934351-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-599373d8a8539182934351-5\">5</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599373d8a8539182934351-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-599373d8a8539182934351-7\">7</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599373d8a8539182934351-8\">8</div><div class=\"crayon-num\" data-line=\"crayon-599373d8a8539182934351-9\">9</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599373d8a8539182934351-10\">10</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-599373d8a8539182934351-1\"><span class=\"crayon-sy\">$</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">sestatus</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599373d8a8539182934351-2\"><span class=\"crayon-e\">SELinux </span><span class=\"crayon-v\">status</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\">                 </span><span class=\"crayon-e\">enabled</span></div><div class=\"crayon-line\" id=\"crayon-599373d8a8539182934351-3\"><span class=\"crayon-e\">SELinuxfs </span><span class=\"crayon-v\">mount</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\">                </span><span class=\"crayon-o\">/</span><span class=\"crayon-v\">sys</span><span class=\"crayon-o\">/</span><span class=\"crayon-v\">fs</span><span class=\"crayon-o\">/</span><span class=\"crayon-e\">selinux</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599373d8a8539182934351-4\"><span class=\"crayon-e\">SELinux </span><span class=\"crayon-e\">root </span><span class=\"crayon-v\">directory</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\">         </span><span class=\"crayon-o\">/</span><span class=\"crayon-v\">etc</span><span class=\"crayon-o\">/</span><span class=\"crayon-e\">selinux</span></div><div class=\"crayon-line\" id=\"crayon-599373d8a8539182934351-5\"><span class=\"crayon-e\">Loaded </span><span class=\"crayon-e\">policy </span><span class=\"crayon-v\">name</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\">             </span><span class=\"crayon-e\">targeted</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599373d8a8539182934351-6\"><span class=\"crayon-e\">Current </span><span class=\"crayon-v\">mode</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\">                   </span><span class=\"crayon-e\">enforcing</span></div><div class=\"crayon-line\" id=\"crayon-599373d8a8539182934351-7\"><span class=\"crayon-e\">Mode </span><span class=\"crayon-e\">from </span><span class=\"crayon-e\">config </span><span class=\"crayon-v\">file</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\">          </span><span class=\"crayon-e\">enforcing</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599373d8a8539182934351-8\"><span class=\"crayon-e\">Policy </span><span class=\"crayon-e\">MLS </span><span class=\"crayon-v\">status</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\">              </span><span class=\"crayon-e\">enabled</span></div><div class=\"crayon-line\" id=\"crayon-599373d8a8539182934351-9\"><span class=\"crayon-e\">Policy </span><span class=\"crayon-e\">deny_unknown </span><span class=\"crayon-v\">status</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\">     </span><span class=\"crayon-e\">allowed</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599373d8a8539182934351-10\"><span class=\"crayon-e\">Max </span><span class=\"crayon-e\">kernel </span><span class=\"crayon-e\">policy </span><span class=\"crayon-v\">version</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\">      </span><span class=\"crayon-cn\">28</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0017 seconds] -->\r\n<p>上面的输出表示应用程序的主机已启用 SELinux。在本地开发环境中，可以更新 <strong>SELinux</strong> 使得权限更宽松。</p>\n<h1>20. history</h1>\n<p>当你使用大量的命令进行测试和调试时，可能会忘记有用的命令。每个 shell 都有一个 <strong>history </strong>命令的变体。它可显示自会话开始以来使用的命令的历史记录。可以使用 <strong>history </strong>来记录用来排除应用程序故障的命令。history 命令用于显示指定数目的指令命令，读取历史命令文件中的目录到历史命令缓冲区和将历史命令缓冲区中的目录写入命令文件。</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-599373d8a853c520468262\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" touchscreen minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\n$ history\r\n    1  clear\r\n    2  df -h\r\n    3  du</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-599373d8a853c520468262-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599373d8a853c520468262-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-599373d8a853c520468262-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599373d8a853c520468262-4\">4</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-599373d8a853c520468262-1\"><span class=\"crayon-sy\">$</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">history</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599373d8a853c520468262-2\"><span class=\"crayon-h\">    </span><span class=\"crayon-cn\">1</span><span class=\"crayon-h\">  </span><span class=\"crayon-i\">clear</span></div><div class=\"crayon-line\" id=\"crayon-599373d8a853c520468262-3\"><span class=\"crayon-h\">    </span><span class=\"crayon-cn\">2</span><span class=\"crayon-h\">  </span><span class=\"crayon-v\">df</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-</span><span class=\"crayon-i\">h</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599373d8a853c520468262-4\"><span class=\"crayon-h\">    </span><span class=\"crayon-cn\">3</span><span class=\"crayon-h\">  </span><span class=\"crayon-v\">du</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0006 seconds] -->\r\n<p>如果希望执行之前历史记录中的命令，但又不想重新输入，该怎么办？使用符号 <strong>!</strong> 即可，可以使用符号 <strong>!</strong> 执行指定序号的历史命令。例如，要执行第 2 个历史命令，则输入<strong>!</strong>2，</p>\n<p><a href=\"http://jbcdn2.b0.upaiyun.com/2017/08/84a8a291f13fb68c3468a03906458adb.png\"><img class=\"aligncenter wp-image-112092 size-full\" src=\"http://jbcdn2.b0.upaiyun.com/2017/08/84a8a291f13fb68c3468a03906458adb.png\" alt=\"205506_GAYc_2918182\" width=\"800\" height=\"121\"></a></p>\n<p>在需要重新执行的命令的指定编号前添加 <strong>! </strong>即可重新执行</p>\n<p>这些基本命令能增强排查故障的专业技能，可检查为什么应用程序可以在一个开发环境中工作，而在另一个开发环境中则不可以。许多系统管理员使用这些命令来调试系统问题。了解一些有用的故障排查命令可帮助解决应用程序的问题。</p>\n<p> </p>\n\r\n        \r\n        \r\n        \n    <div class=\"post-adds\">\n        <span data-post-id=\"112085\" class=\" btn-bluet-bigger href-style vote-post-up   register-user-only \"><i class=\"fa  fa-thumbs-o-up\"></i> <h10 id=\"112085votetotal\">1</h10> 赞</span>\n        <span data-book-type=\"1\" data-site-id=\"2\" data-item-id=\"112085\" data-item-type=\"1\" class=\" btn-bluet-bigger href-style bookmark-btn  register-user-only \"><i class=\"fa fa-bookmark-o  \"></i> 4 收藏</span>\n\n                    <a href=\"#article-comment\"><span class=\"btn-bluet-bigger href-style hide-on-480\"><i class=\"fa fa-comments-o\"></i> 1 评论</span></a>\n        \n        \n        \n        <!-- JiaThis Button BEGIN -->\n        <div class=\"jiathis_style_24x24\" style=\"display: inline-flex; position: relative; margin: 0; clear: both;float: right;\">\n            <a class=\"jiathis_button_tsina\"></a>\n            <a class=\"jiathis_button_weixin\"></a>\n            <a class=\"jiathis_button_qzone\"></a>\n            <a class=\"jiathis_button_fb hide-on-480\"></a>\n            <a href=\"http://www.jiathis.com/share?uid=1745061\" class=\"jiathis jiathis_txt jiathis_separator jtico jtico_jiathis\" target=\"_blank\"></a>\n        </div>\n\n    </div>\n\n\n\n\r\n        <!-- BEGIN #author-bio -->\r\n\r\n\r\n<!-- END #author-bio -->\r\n\t</div>", "front_image_path": ["full/0ef7e28a091392634bf93187b140a9a9a1296cf7.jpg"]},{"title": "C++17 中那些值得关注的特性", "url": "http://blog.jobbole.com/112106/", "url_object_id": "b028ca4da8b8f6fe667bdfe6cff6be5d", "create_date": "2017/08/03", "front_image_url": ["http://jbcdn2.b0.upaiyun.com/2012/08/C-+-+-pit-really-more1l.jpg"], "praise_nums": "1", "fav_nums": "1", "comment_nums": 0, "tags": "C/C++,C++", "content": "<div class=\"entry\">\r\n\r\n        \t\t\t<div class=\"textwidget\"></div>\n\t\t\r\n\t\t<div class=\"copyright-area\">原文出处： <a target=\"_blank\" href=\"http://www.iteye.com/news/32574\">祁宇（首发《程序员》杂志）</a>   </div><div id=\"news_content\">\n<h1><strong>引用</strong></h1>\n<p>C++17标准在2017上半年已经讨论确定，正在形成ISO标准文档，今年晚些时候会正式发布。本文将介绍最新标准中值得开发者关注的新特新和基本用法。</p>\n<p>总的来说C++17相比C++11的新特性来说新特性不算多，做了一些小幅改进。C++17增加了数十项新特性，值得关注的特性大概有下面这些：</p>\n<ul>\n<li>constexpr if</li>\n<li>constexpr lambda</li>\n<li>fold expression</li>\n<li>void_t</li>\n<li>structured binding</li>\n<li>std::apply, std::invoke</li>\n<li>string_view</li>\n<li>parallel STL</li>\n<li>inline variable</li>\n</ul>\n<p>剩下的有一些来自于boost库，比如variant,any、optional和filesystem等特性，string_view其实在boost里也有。还有一些是语法糖，比如if init、deduction guide、guaranteed copy Elision、template、nested namespace、single param static_assert等特性。我接下来会介绍C++17主要的一些特性，介绍它们的基本用法和作用，让读者对C++17的新特性有一个基本的了解。</p>\n<h1><strong>fold expression</strong></h1>\n<p>C++11增加了一个新特性可变模版参数（variadic template）,它可以接受任意个模版参数在参数包中，参数包是三个点…，它不能直接展开，需要通过一些特殊的方法才能展开，导致在使用的时候有点难度。现在C++17解决了这个问题，让参数包的展开变得容易了，Fold expression就是方便展开参数包的。</p>\n<p><strong>fold expression的语义</strong></p>\n<p>fold expression有4种语义：</p>\n<ul>\n<li>unary right fold (pack op …)</li>\n<li>unary left fold (… op pack)</li>\n<li>binary right fold (pack op … op init)</li>\n<li>binary left fold (init op … op pack)</li>\n</ul>\n<p>其中pack代表变参，比如args，op代表操作符，fold expression支持32种操作符：</p>\n<p><strong>引用</strong></p>\n</div>\n<p></p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-599391ca4a395905626422\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-always\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"复制代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\n+ - * / % ^ &amp; | = &gt; += -= *= /= %= ^= &amp;= |= &gt;= == != = &amp;&amp; || , .* -&gt;*</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-599391ca4a395905626422-1\">1</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-599391ca4a395905626422-1\"><span class=\"crayon-o\">+</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">*</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">/</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">%</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">^</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">&amp;</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">|</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">+=</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-=</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">*=</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">/=</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">%=</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">^=</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">&amp;=</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">|=</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">&gt;=</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">==</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">!=</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">&amp;&amp;</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">||</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">.</span><span class=\"crayon-o\">*</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-&gt;</span><span class=\"crayon-o\">*</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0014 seconds] -->\r\n<p></p>\n<h1><strong>unary right fold的含义</strong></h1>\n<p>fold (E op …) 意味着 E1 op (… op (EN-1 op EN)).</p>\n<p>顾名思义，从右边开始fold，看它是left fold还是right fold我们可以根据参数包…所在的位置来判断，当参数包…在操作符右边的时候就是right fold，在左边的时候就是left fold。我们来看一个具体的例子：</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-599391ca4a3a1411239557\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-always\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"复制代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\ntemplate&lt;typename... Args&gt;\r\nauto add_val(Args&amp;&amp;... args) {\r\n    return (args +  ...);\r\n}\r\n\r\nauto t = add_val(1,2,3,4); //10</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-599391ca4a3a1411239557-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599391ca4a3a1411239557-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-599391ca4a3a1411239557-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599391ca4a3a1411239557-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-599391ca4a3a1411239557-5\">5</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599391ca4a3a1411239557-6\">6</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-599391ca4a3a1411239557-1\"><span class=\"crayon-v\">template</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-v\">typename</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Args</span><span class=\"crayon-o\">&gt;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599391ca4a3a1411239557-2\"><span class=\"crayon-e\">auto </span><span class=\"crayon-e\">add_val</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">Args</span><span class=\"crayon-o\">&amp;&amp;</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">args</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-599391ca4a3a1411239557-3\"><span class=\"crayon-h\">    </span><span class=\"crayon-st\">return</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">args</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">+</span><span class=\"crayon-h\">  </span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599391ca4a3a1411239557-4\"><span class=\"crayon-sy\">}</span></div><div class=\"crayon-line\" id=\"crayon-599391ca4a3a1411239557-5\"> </div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599391ca4a3a1411239557-6\"><span class=\"crayon-i\">auto</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">t</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">add_val</span><span class=\"crayon-sy\">(</span><span class=\"crayon-cn\">1</span><span class=\"crayon-sy\">,</span><span class=\"crayon-cn\">2</span><span class=\"crayon-sy\">,</span><span class=\"crayon-cn\">3</span><span class=\"crayon-sy\">,</span><span class=\"crayon-cn\">4</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span><span class=\"crayon-h\"> </span><span class=\"crayon-c\">//10</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0016 seconds] -->\r\n<p>right fold的过程是这样的：(1+(2+(3+4)))，从右边开始fold。</p>\n<h1><strong>unary left fold的含义</strong></h1>\n<p>fold (… op E) 意味着 ((E1 op E2) op …) op EN。</p>\n<p>对于+这种满足交换律的操作符来说left fold和right fold是一样的，比如上面的例子你也可以写成left fold。</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-599391ca4a3a6944440305\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-always\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"复制代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\ntemplate&lt;typename... Args&gt;\r\nauto add_val(Args&amp;&amp;... args) {\r\n    return (... + args);\r\n}\r\n\r\nauto t = add_val(1,2,3,4); //10</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-599391ca4a3a6944440305-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599391ca4a3a6944440305-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-599391ca4a3a6944440305-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599391ca4a3a6944440305-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-599391ca4a3a6944440305-5\">5</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599391ca4a3a6944440305-6\">6</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-599391ca4a3a6944440305-1\"><span class=\"crayon-v\">template</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-v\">typename</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Args</span><span class=\"crayon-o\">&gt;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599391ca4a3a6944440305-2\"><span class=\"crayon-e\">auto </span><span class=\"crayon-e\">add_val</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">Args</span><span class=\"crayon-o\">&amp;&amp;</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">args</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-599391ca4a3a6944440305-3\"><span class=\"crayon-h\">    </span><span class=\"crayon-st\">return</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">+</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">args</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599391ca4a3a6944440305-4\"><span class=\"crayon-sy\">}</span></div><div class=\"crayon-line\" id=\"crayon-599391ca4a3a6944440305-5\"> </div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599391ca4a3a6944440305-6\"><span class=\"crayon-i\">auto</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">t</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">add_val</span><span class=\"crayon-sy\">(</span><span class=\"crayon-cn\">1</span><span class=\"crayon-sy\">,</span><span class=\"crayon-cn\">2</span><span class=\"crayon-sy\">,</span><span class=\"crayon-cn\">3</span><span class=\"crayon-sy\">,</span><span class=\"crayon-cn\">4</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span><span class=\"crayon-h\"> </span><span class=\"crayon-c\">//10</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0016 seconds] -->\r\n<p>对于不满足交换律的操作符来说就要注意了，比如减法。</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-599391ca4a3a9252840111\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-always\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"复制代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\ntemplate&lt;typename... Args&gt;\r\nauto sub_val_right(Args&amp;&amp;... args) {\r\n    return (args - ...);\r\n}\r\n\r\n\r\ntemplate&lt;typename... Args&gt;\r\nauto sub_val_left(Args&amp;&amp;... args) {\r\n    return (... - args);\r\n}\r\n\r\nauto t = sub_val_right(2,3,4); //(2-(3-4)) = 3\r\nauto t1 = sub_val_left(2,3,4); //((2-3)-4) = -5</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-599391ca4a3a9252840111-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599391ca4a3a9252840111-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-599391ca4a3a9252840111-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599391ca4a3a9252840111-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-599391ca4a3a9252840111-5\">5</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599391ca4a3a9252840111-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-599391ca4a3a9252840111-7\">7</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599391ca4a3a9252840111-8\">8</div><div class=\"crayon-num\" data-line=\"crayon-599391ca4a3a9252840111-9\">9</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599391ca4a3a9252840111-10\">10</div><div class=\"crayon-num\" data-line=\"crayon-599391ca4a3a9252840111-11\">11</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599391ca4a3a9252840111-12\">12</div><div class=\"crayon-num\" data-line=\"crayon-599391ca4a3a9252840111-13\">13</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-599391ca4a3a9252840111-1\"><span class=\"crayon-v\">template</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-v\">typename</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Args</span><span class=\"crayon-o\">&gt;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599391ca4a3a9252840111-2\"><span class=\"crayon-e\">auto </span><span class=\"crayon-e\">sub_val_right</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">Args</span><span class=\"crayon-o\">&amp;&amp;</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">args</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-599391ca4a3a9252840111-3\"><span class=\"crayon-h\">    </span><span class=\"crayon-st\">return</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">args</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599391ca4a3a9252840111-4\"><span class=\"crayon-sy\">}</span></div><div class=\"crayon-line\" id=\"crayon-599391ca4a3a9252840111-5\"> </div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599391ca4a3a9252840111-6\"> </div><div class=\"crayon-line\" id=\"crayon-599391ca4a3a9252840111-7\"><span class=\"crayon-v\">template</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-v\">typename</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Args</span><span class=\"crayon-o\">&gt;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599391ca4a3a9252840111-8\"><span class=\"crayon-e\">auto </span><span class=\"crayon-e\">sub_val_left</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">Args</span><span class=\"crayon-o\">&amp;&amp;</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">args</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-599391ca4a3a9252840111-9\"><span class=\"crayon-h\">    </span><span class=\"crayon-st\">return</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">args</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599391ca4a3a9252840111-10\"><span class=\"crayon-sy\">}</span></div><div class=\"crayon-line\" id=\"crayon-599391ca4a3a9252840111-11\"> </div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599391ca4a3a9252840111-12\"><span class=\"crayon-i\">auto</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">t</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">sub_val_right</span><span class=\"crayon-sy\">(</span><span class=\"crayon-cn\">2</span><span class=\"crayon-sy\">,</span><span class=\"crayon-cn\">3</span><span class=\"crayon-sy\">,</span><span class=\"crayon-cn\">4</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span><span class=\"crayon-h\"> </span><span class=\"crayon-c\">//(2-(3-4)) = 3</span></div><div class=\"crayon-line\" id=\"crayon-599391ca4a3a9252840111-13\"><span class=\"crayon-e\">auto </span><span class=\"crayon-v\">t1</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">sub_val_left</span><span class=\"crayon-sy\">(</span><span class=\"crayon-cn\">2</span><span class=\"crayon-sy\">,</span><span class=\"crayon-cn\">3</span><span class=\"crayon-sy\">,</span><span class=\"crayon-cn\">4</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span><span class=\"crayon-h\"> </span><span class=\"crayon-c\">//((2-3)-4) = -5</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0026 seconds] -->\r\n<p>这次right fold和left fold的结果就不一样。</p>\n<h1><strong>binary fold的含义</strong></h1>\n<p>Binary right fold (E op … op I) 意味着 E1 op (… op (EN-1 op (EN op I)))。</p>\n<p>Binary left fold (I op … op E) 意味着 (((I op E1) op E2) op …) op E2。</p>\n<p>其中E代表变参，比如args，op代表操作符，I代表一个初始变量。</p>\n<p>二元fold的语义和一元fold的语义是相同的，看一个二元操作符的例子：</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-599391ca4a3ad649858682\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-always\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"复制代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\ntemplate&lt;typename... Args&gt;\r\nauto sub_one_left(Args&amp;&amp;... args) {\r\n    return (1 - ... - args);\r\n}\r\n\r\ntemplate&lt;typename... Args&gt;\r\nauto sub_one_right(Args&amp;&amp;... args) {\r\n    return (args - ... - 1);\r\n}\r\n\r\nauto t = sub_one_left（2，3，4);// (((1-2)-3)-4) = -8\r\nauto t1 = sub_one_right（2，3，4);//(2-(3-(4-1))) = 2</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-599391ca4a3ad649858682-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599391ca4a3ad649858682-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-599391ca4a3ad649858682-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599391ca4a3ad649858682-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-599391ca4a3ad649858682-5\">5</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599391ca4a3ad649858682-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-599391ca4a3ad649858682-7\">7</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599391ca4a3ad649858682-8\">8</div><div class=\"crayon-num\" data-line=\"crayon-599391ca4a3ad649858682-9\">9</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599391ca4a3ad649858682-10\">10</div><div class=\"crayon-num\" data-line=\"crayon-599391ca4a3ad649858682-11\">11</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599391ca4a3ad649858682-12\">12</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-599391ca4a3ad649858682-1\"><span class=\"crayon-v\">template</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-v\">typename</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Args</span><span class=\"crayon-o\">&gt;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599391ca4a3ad649858682-2\"><span class=\"crayon-e\">auto </span><span class=\"crayon-e\">sub_one_left</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">Args</span><span class=\"crayon-o\">&amp;&amp;</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">args</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-599391ca4a3ad649858682-3\"><span class=\"crayon-h\">    </span><span class=\"crayon-st\">return</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-cn\">1</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">args</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599391ca4a3ad649858682-4\"><span class=\"crayon-sy\">}</span></div><div class=\"crayon-line\" id=\"crayon-599391ca4a3ad649858682-5\"> </div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599391ca4a3ad649858682-6\"><span class=\"crayon-v\">template</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-v\">typename</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Args</span><span class=\"crayon-o\">&gt;</span></div><div class=\"crayon-line\" id=\"crayon-599391ca4a3ad649858682-7\"><span class=\"crayon-e\">auto </span><span class=\"crayon-e\">sub_one_right</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">Args</span><span class=\"crayon-o\">&amp;&amp;</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">args</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599391ca4a3ad649858682-8\"><span class=\"crayon-h\">    </span><span class=\"crayon-st\">return</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">args</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">1</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-599391ca4a3ad649858682-9\"><span class=\"crayon-sy\">}</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599391ca4a3ad649858682-10\"> </div><div class=\"crayon-line\" id=\"crayon-599391ca4a3ad649858682-11\"><span class=\"crayon-i\">auto</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">t</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">sub_one</span><span class=\"crayon-sy\">_</span>left（<span class=\"crayon-cn\">2</span>，<span class=\"crayon-cn\">3</span>，<span class=\"crayon-cn\">4</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span><span class=\"crayon-c\">// (((1-2)-3)-4) = -8</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599391ca4a3ad649858682-12\"><span class=\"crayon-e\">auto </span><span class=\"crayon-v\">t1</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">sub_one</span><span class=\"crayon-sy\">_</span>right（<span class=\"crayon-cn\">2</span>，<span class=\"crayon-cn\">3</span>，<span class=\"crayon-cn\">4</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span><span class=\"crayon-c\">//(2-(3-(4-1))) = 2</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0028 seconds] -->\r\n<p>相信通过这个例子大家应该对C++17的fold expression有了基本的了解。</p>\n<h1><strong>comma fold</strong></h1>\n<p>在C++17之前，我们经常使用逗号表达式和std::initializer_list来将变参一个个传入一个函数。比如像下面这个例子：</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-599391ca4a3b1457747096\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-always\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"复制代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\ntemplate&lt;typename T&gt;\r\nvoid print_arg(T t)\r\n{\r\n    std::cout &lt;&lt; t &lt;&lt; std::endl;\r\n}\r\n\r\ntemplate&lt;typename... Args&gt;\r\nvoid print2(Args... args)\r\n{\r\n    //int a[] = { (printarg(args), 0)... };\r\n    std::initializer_list&lt;int&gt;{(print_arg(args), 0)...};\r\n}</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-599391ca4a3b1457747096-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599391ca4a3b1457747096-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-599391ca4a3b1457747096-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599391ca4a3b1457747096-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-599391ca4a3b1457747096-5\">5</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599391ca4a3b1457747096-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-599391ca4a3b1457747096-7\">7</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599391ca4a3b1457747096-8\">8</div><div class=\"crayon-num\" data-line=\"crayon-599391ca4a3b1457747096-9\">9</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599391ca4a3b1457747096-10\">10</div><div class=\"crayon-num\" data-line=\"crayon-599391ca4a3b1457747096-11\">11</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599391ca4a3b1457747096-12\">12</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-599391ca4a3b1457747096-1\"><span class=\"crayon-v\">template</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-i\">typename</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">T</span><span class=\"crayon-o\">&gt;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599391ca4a3b1457747096-2\"><span class=\"crayon-t\">void</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">print_arg</span><span class=\"crayon-sy\">(</span><span class=\"crayon-i\">T</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">t</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line\" id=\"crayon-599391ca4a3b1457747096-3\"><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599391ca4a3b1457747096-4\"><span class=\"crayon-h\">    </span><span class=\"crayon-v\">std</span><span class=\"crayon-o\">::</span><span class=\"crayon-v\">cout</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">&lt;&lt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">t</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">&lt;&lt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">std</span><span class=\"crayon-o\">::</span><span class=\"crayon-v\">endl</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-599391ca4a3b1457747096-5\"><span class=\"crayon-sy\">}</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599391ca4a3b1457747096-6\"> </div><div class=\"crayon-line\" id=\"crayon-599391ca4a3b1457747096-7\"><span class=\"crayon-v\">template</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-v\">typename</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Args</span><span class=\"crayon-o\">&gt;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599391ca4a3b1457747096-8\"><span class=\"crayon-t\">void</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">print2</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">Args</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">args</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line\" id=\"crayon-599391ca4a3b1457747096-9\"><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599391ca4a3b1457747096-10\"><span class=\"crayon-h\">    </span><span class=\"crayon-c\">//int a[] = { (printarg(args), 0)... };</span></div><div class=\"crayon-line\" id=\"crayon-599391ca4a3b1457747096-11\"><span class=\"crayon-h\">    </span><span class=\"crayon-v\">std</span><span class=\"crayon-o\">::</span><span class=\"crayon-e\">initializer_list</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-t\">int</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-sy\">{</span><span class=\"crayon-sy\">(</span><span class=\"crayon-e\">print_arg</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">args</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">}</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599391ca4a3b1457747096-12\"><span class=\"crayon-sy\">}</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0023 seconds] -->\r\n<p>这种写法比较繁琐，用fold expression就会变得很简单了。</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-599391ca4a3b4347172727\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-always\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"复制代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\ntemplate&lt;typename... Args&gt;\r\nvoid print3(Args... args)\r\n{\r\n    (print_arg(args), ...);\r\n}</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-599391ca4a3b4347172727-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599391ca4a3b4347172727-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-599391ca4a3b4347172727-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599391ca4a3b4347172727-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-599391ca4a3b4347172727-5\">5</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-599391ca4a3b4347172727-1\"><span class=\"crayon-v\">template</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-v\">typename</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Args</span><span class=\"crayon-o\">&gt;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599391ca4a3b4347172727-2\"><span class=\"crayon-t\">void</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">print3</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">Args</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">args</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line\" id=\"crayon-599391ca4a3b4347172727-3\"><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599391ca4a3b4347172727-4\"><span class=\"crayon-h\">    </span><span class=\"crayon-sy\">(</span><span class=\"crayon-e\">print_arg</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">args</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-599391ca4a3b4347172727-5\"><span class=\"crayon-sy\">}</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0010 seconds] -->\r\n<p>这是right fold，你也可以写成left fold，对于comma来说两种写法是一样的，参数都是从左至右传入print_arg函数。</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-599391ca4a3b7934184044\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-always\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"复制代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\ntemplate&lt;typename... Args&gt;\r\nvoid print3(Args... args)\r\n{\r\n    (..., print_arg(args));\r\n}</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-599391ca4a3b7934184044-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599391ca4a3b7934184044-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-599391ca4a3b7934184044-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599391ca4a3b7934184044-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-599391ca4a3b7934184044-5\">5</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-599391ca4a3b7934184044-1\"><span class=\"crayon-v\">template</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-v\">typename</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Args</span><span class=\"crayon-o\">&gt;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599391ca4a3b7934184044-2\"><span class=\"crayon-t\">void</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">print3</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">Args</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">args</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line\" id=\"crayon-599391ca4a3b7934184044-3\"><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599391ca4a3b7934184044-4\"><span class=\"crayon-h\">    </span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">print_arg</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">args</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-599391ca4a3b7934184044-5\"><span class=\"crayon-sy\">}</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0012 seconds] -->\r\n<p>你也可以通过binary fold这样写：</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-599391ca4a3bb962406125\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-always\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"复制代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\ntemplate&lt;typename ...Args&gt;\r\nvoid printer(Args&amp;&amp;... args) {\r\n    (std::cout &lt;&lt; ... &lt;&lt; args) &lt;&lt; '\\n';\r\n}</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-599391ca4a3bb962406125-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599391ca4a3bb962406125-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-599391ca4a3bb962406125-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599391ca4a3bb962406125-4\">4</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-599391ca4a3bb962406125-1\"><span class=\"crayon-v\">template</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-i\">typename</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">Args</span><span class=\"crayon-o\">&gt;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599391ca4a3bb962406125-2\"><span class=\"crayon-t\">void</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">printer</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">Args</span><span class=\"crayon-o\">&amp;&amp;</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">args</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-599391ca4a3bb962406125-3\"><span class=\"crayon-h\">    </span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">std</span><span class=\"crayon-o\">::</span><span class=\"crayon-v\">cout</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">&lt;&lt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">&lt;&lt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">args</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">&lt;&lt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">'\\n'</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599391ca4a3bb962406125-4\"><span class=\"crayon-sy\">}</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0012 seconds] -->\r\n<p>也许你会觉得能写成这样：</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-599391ca4a3c5241397158\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-always\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"复制代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\ntemplate&lt;typename ...Args&gt;\r\nvoid printer(Args&amp;&amp;... args) {\r\n    (std::cout &lt;&lt; args &lt;&lt; ...) &lt;&lt; '\\n';\r\n}</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-599391ca4a3c5241397158-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599391ca4a3c5241397158-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-599391ca4a3c5241397158-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599391ca4a3c5241397158-4\">4</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-599391ca4a3c5241397158-1\"><span class=\"crayon-v\">template</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-i\">typename</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">Args</span><span class=\"crayon-o\">&gt;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599391ca4a3c5241397158-2\"><span class=\"crayon-t\">void</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">printer</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">Args</span><span class=\"crayon-o\">&amp;&amp;</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">args</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-599391ca4a3c5241397158-3\"><span class=\"crayon-h\">    </span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">std</span><span class=\"crayon-o\">::</span><span class=\"crayon-v\">cout</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">&lt;&lt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">args</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">&lt;&lt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">&lt;&lt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">'\\n'</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599391ca4a3c5241397158-4\"><span class=\"crayon-sy\">}</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0013 seconds] -->\r\n<p>但这样写是不合法的，根据binary fold的语法，参数包…必须在操作符中间，因此上面的这种写法不符合语法要求。</p>\n<p>借助comma fold我们可以简化代码，假如我们希望实现tuple的for_each算法，像这样：</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-599391ca4a3c9867148872\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-always\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"复制代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\nfor_each(std::make_tuple(2.5, 10, 'a'),[](auto e) { std::cout &lt;&lt; e&lt;&lt; '\\n'; });</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-599391ca4a3c9867148872-1\">1</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-599391ca4a3c9867148872-1\"><span class=\"crayon-e\">for_each</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">std</span><span class=\"crayon-o\">::</span><span class=\"crayon-e\">make_tuple</span><span class=\"crayon-sy\">(</span><span class=\"crayon-cn\">2.5</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">10</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">'a'</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">,</span><span class=\"crayon-sy\">[</span><span class=\"crayon-sy\">]</span><span class=\"crayon-sy\">(</span><span class=\"crayon-i\">auto</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">e</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">std</span><span class=\"crayon-o\">::</span><span class=\"crayon-v\">cout</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">&lt;&lt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">e</span><span class=\"crayon-o\">&lt;&lt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">'\\n'</span><span class=\"crayon-sy\">;</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">}</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0011 seconds] -->\r\n<p>这个for_each将会遍历tuple的元素并打印出来。在C++17之前我们如果要实现这个算法的话，需要借助逗号表达式和std::initializer_list来实现，类似于这样：</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-599391ca4a3cc553947791\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-always\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"复制代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\ntemplate &lt;typename... Args, typename Func, std::size_t... Idx&gt;\r\nvoid for_each(const std::tuple&amp; t, Func&amp;&amp; f, std::index_sequence&lt;Idx...&gt;) {\r\n    (void)std::initializer_list&lt;int&gt; { (f(std::get&lt;Idx&gt;(t)), void(), 0)...};\r\n}</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-599391ca4a3cc553947791-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599391ca4a3cc553947791-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-599391ca4a3cc553947791-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599391ca4a3cc553947791-4\">4</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-599391ca4a3cc553947791-1\"><span class=\"crayon-v\">template</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-v\">typename</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Args</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">typename </span><span class=\"crayon-v\">Func</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">std</span><span class=\"crayon-o\">::</span><span class=\"crayon-v\">size_t</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Idx</span><span class=\"crayon-o\">&gt;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599391ca4a3cc553947791-2\"><span class=\"crayon-t\">void</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">for_each</span><span class=\"crayon-sy\">(</span><span class=\"crayon-m\">const</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">std</span><span class=\"crayon-o\">::</span><span class=\"crayon-v\">tuple</span><span class=\"crayon-o\">&amp;</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">t</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Func</span><span class=\"crayon-o\">&amp;&amp;</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">f</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">std</span><span class=\"crayon-o\">::</span><span class=\"crayon-v\">index_sequence</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-v\">Idx</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-599391ca4a3cc553947791-3\"><span class=\"crayon-h\">    </span><span class=\"crayon-sy\">(</span><span class=\"crayon-t\">void</span><span class=\"crayon-sy\">)</span><span class=\"crayon-v\">std</span><span class=\"crayon-o\">::</span><span class=\"crayon-e\">initializer_list</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-t\">int</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-e\">f</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">std</span><span class=\"crayon-o\">::</span><span class=\"crayon-v\">get</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-v\">Idx</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">t</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">void</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">}</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599391ca4a3cc553947791-4\"><span class=\"crayon-sy\">}</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0022 seconds] -->\r\n<p>这样写比较繁琐不直观，现在借助fold expression我们可以简化代码了。</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-599391ca4a3cf181236562\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-always\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"复制代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\ntemplate &lt;typename... Args, typename Func, std::size_t... Idx&gt;\r\nvoid for_each(const std::tuple&lt;Args...&gt;&amp; t, Func&amp;&amp; f, std::index_sequence&lt;Idx...&gt;) {\r\n    (f(std::get&lt;Idx&gt;(t)), ...);\r\n}</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-599391ca4a3cf181236562-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599391ca4a3cf181236562-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-599391ca4a3cf181236562-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599391ca4a3cf181236562-4\">4</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-599391ca4a3cf181236562-1\"><span class=\"crayon-v\">template</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-v\">typename</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Args</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">typename </span><span class=\"crayon-v\">Func</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">std</span><span class=\"crayon-o\">::</span><span class=\"crayon-v\">size_t</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Idx</span><span class=\"crayon-o\">&gt;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599391ca4a3cf181236562-2\"><span class=\"crayon-t\">void</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">for_each</span><span class=\"crayon-sy\">(</span><span class=\"crayon-m\">const</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">std</span><span class=\"crayon-o\">::</span><span class=\"crayon-v\">tuple</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-v\">Args</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-o\">&amp;</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">t</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Func</span><span class=\"crayon-o\">&amp;&amp;</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">f</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">std</span><span class=\"crayon-o\">::</span><span class=\"crayon-v\">index_sequence</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-v\">Idx</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-599391ca4a3cf181236562-3\"><span class=\"crayon-h\">    </span><span class=\"crayon-sy\">(</span><span class=\"crayon-e\">f</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">std</span><span class=\"crayon-o\">::</span><span class=\"crayon-v\">get</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-v\">Idx</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">t</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599391ca4a3cf181236562-4\"><span class=\"crayon-sy\">}</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0020 seconds] -->\r\n<p>借助coma fold我们可以写很简洁的代码了。</p>\n<h1><strong>constexpr if</strong></h1>\n<p>constexpr标记一个表达式或一个函数的返回结果是编译期常量，它保证函数会在编译期执行。相比模版来说，实现编译期循环或递归，C++17中的constexpr if会让代码变得更简洁易懂。比如实现一个编译期整数加法：</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-599391ca4a3d3955265752\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-always\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"复制代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\ntemplate&lt;int N&gt;\r\nconstexpr int sum()\r\n{\r\n    return N;\r\n}\r\n\r\ntemplate &lt;int N, int N2, int... Ns&gt;\r\nconstexpr int sum()\r\n{\r\n    return N + sum&lt;N2, Ns...&gt;();\r\n}</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-599391ca4a3d3955265752-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599391ca4a3d3955265752-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-599391ca4a3d3955265752-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599391ca4a3d3955265752-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-599391ca4a3d3955265752-5\">5</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599391ca4a3d3955265752-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-599391ca4a3d3955265752-7\">7</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599391ca4a3d3955265752-8\">8</div><div class=\"crayon-num\" data-line=\"crayon-599391ca4a3d3955265752-9\">9</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599391ca4a3d3955265752-10\">10</div><div class=\"crayon-num\" data-line=\"crayon-599391ca4a3d3955265752-11\">11</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-599391ca4a3d3955265752-1\"><span class=\"crayon-v\">template</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-t\">int</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">N</span><span class=\"crayon-o\">&gt;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599391ca4a3d3955265752-2\"><span class=\"crayon-e\">constexpr </span><span class=\"crayon-t\">int</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">sum</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line\" id=\"crayon-599391ca4a3d3955265752-3\"><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599391ca4a3d3955265752-4\"><span class=\"crayon-h\">    </span><span class=\"crayon-st\">return</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">N</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-599391ca4a3d3955265752-5\"><span class=\"crayon-sy\">}</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599391ca4a3d3955265752-6\"> </div><div class=\"crayon-line\" id=\"crayon-599391ca4a3d3955265752-7\"><span class=\"crayon-v\">template</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-t\">int</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">N</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">int</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">N2</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">int</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Ns</span><span class=\"crayon-o\">&gt;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599391ca4a3d3955265752-8\"><span class=\"crayon-e\">constexpr </span><span class=\"crayon-t\">int</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">sum</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line\" id=\"crayon-599391ca4a3d3955265752-9\"><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599391ca4a3d3955265752-10\"><span class=\"crayon-h\">    </span><span class=\"crayon-st\">return</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">N</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">+</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">sum</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-v\">N2</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Ns</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-599391ca4a3d3955265752-11\"><span class=\"crayon-sy\">}</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0018 seconds] -->\r\n<p>C++17之前你可能需要像上面这样写，但是现在你可以写更简洁的代码了。</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-599391ca4a3d6929933691\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-always\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"复制代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\ntemplate &lt;int N, int... Ns&gt;\r\nconstexpr auto sum17()\r\n{\r\n    if constexpr (sizeof...(Ns) == 0)\r\n        return N;\r\n    else\r\n        return N + sum17&lt;Ns...&gt;();\r\n}</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-599391ca4a3d6929933691-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599391ca4a3d6929933691-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-599391ca4a3d6929933691-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599391ca4a3d6929933691-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-599391ca4a3d6929933691-5\">5</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599391ca4a3d6929933691-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-599391ca4a3d6929933691-7\">7</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599391ca4a3d6929933691-8\">8</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-599391ca4a3d6929933691-1\"><span class=\"crayon-v\">template</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-t\">int</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">N</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">int</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Ns</span><span class=\"crayon-o\">&gt;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599391ca4a3d6929933691-2\"><span class=\"crayon-e\">constexpr </span><span class=\"crayon-e\">auto </span><span class=\"crayon-e\">sum17</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line\" id=\"crayon-599391ca4a3d6929933691-3\"><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599391ca4a3d6929933691-4\"><span class=\"crayon-h\">    </span><span class=\"crayon-st\">if</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">constexpr</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">sizeof</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">Ns</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">==</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line\" id=\"crayon-599391ca4a3d6929933691-5\"><span class=\"crayon-h\">        </span><span class=\"crayon-st\">return</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">N</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599391ca4a3d6929933691-6\"><span class=\"crayon-h\">    </span><span class=\"crayon-st\">else</span></div><div class=\"crayon-line\" id=\"crayon-599391ca4a3d6929933691-7\"><span class=\"crayon-h\">        </span><span class=\"crayon-st\">return</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">N</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">+</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">sum17</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-v\">Ns</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599391ca4a3d6929933691-8\"><span class=\"crayon-sy\">}</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0020 seconds] -->\r\n<p>当然，你也可以用C++17的fold expression：</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-599391ca4a3da193593666\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-always\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"复制代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\ntemplate&lt;typename ...Args&gt;\r\nconstexpr int sum(Args... args) {\r\n    return (0 + ... + args);\r\n}</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-599391ca4a3da193593666-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599391ca4a3da193593666-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-599391ca4a3da193593666-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599391ca4a3da193593666-4\">4</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-599391ca4a3da193593666-1\"><span class=\"crayon-v\">template</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-i\">typename</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">Args</span><span class=\"crayon-o\">&gt;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599391ca4a3da193593666-2\"><span class=\"crayon-e\">constexpr </span><span class=\"crayon-t\">int</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">sum</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">Args</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">args</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-599391ca4a3da193593666-3\"><span class=\"crayon-h\">    </span><span class=\"crayon-st\">return</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-cn\">0</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">+</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">+</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">args</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599391ca4a3da193593666-4\"><span class=\"crayon-sy\">}</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0013 seconds] -->\r\n<p>constexpr还可以用来消除enable_if了，对于讨厌写一长串enable_if的人来说会非常开心。比如我需要根据类型来选择函数的时候：</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-599391ca4a3dd398884264\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-always\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"复制代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\ntemplate&lt;typename T&gt;\r\nstd::enable_if_t&lt;std::is_integral&lt;T&gt;::value, std::string&gt; to_str(T t)\r\n{\r\n    return std::to_string(t);\r\n}\r\n\r\ntemplate&lt;typename T&gt;\r\nstd::enable_if_t&lt;!std::is_integral&lt;T&gt;::value, std::string&gt; to_str(T t)\r\n{\r\n    return t;\r\n}</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-599391ca4a3dd398884264-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599391ca4a3dd398884264-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-599391ca4a3dd398884264-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599391ca4a3dd398884264-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-599391ca4a3dd398884264-5\">5</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599391ca4a3dd398884264-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-599391ca4a3dd398884264-7\">7</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599391ca4a3dd398884264-8\">8</div><div class=\"crayon-num\" data-line=\"crayon-599391ca4a3dd398884264-9\">9</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599391ca4a3dd398884264-10\">10</div><div class=\"crayon-num\" data-line=\"crayon-599391ca4a3dd398884264-11\">11</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-599391ca4a3dd398884264-1\"><span class=\"crayon-v\">template</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-i\">typename</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">T</span><span class=\"crayon-o\">&gt;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599391ca4a3dd398884264-2\"><span class=\"crayon-v\">std</span><span class=\"crayon-o\">::</span><span class=\"crayon-v\">enable_if_t</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-v\">std</span><span class=\"crayon-o\">::</span><span class=\"crayon-v\">is_integral</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-v\">T</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-o\">::</span><span class=\"crayon-v\">value</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">std</span><span class=\"crayon-o\">::</span><span class=\"crayon-t\">string</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">to_str</span><span class=\"crayon-sy\">(</span><span class=\"crayon-i\">T</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">t</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line\" id=\"crayon-599391ca4a3dd398884264-3\"><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599391ca4a3dd398884264-4\"><span class=\"crayon-h\">    </span><span class=\"crayon-st\">return</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">std</span><span class=\"crayon-o\">::</span><span class=\"crayon-e\">to_string</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">t</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-599391ca4a3dd398884264-5\"><span class=\"crayon-sy\">}</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599391ca4a3dd398884264-6\"> </div><div class=\"crayon-line\" id=\"crayon-599391ca4a3dd398884264-7\"><span class=\"crayon-v\">template</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-i\">typename</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">T</span><span class=\"crayon-o\">&gt;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599391ca4a3dd398884264-8\"><span class=\"crayon-v\">std</span><span class=\"crayon-o\">::</span><span class=\"crayon-v\">enable_if_t</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-o\">!</span><span class=\"crayon-v\">std</span><span class=\"crayon-o\">::</span><span class=\"crayon-v\">is_integral</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-v\">T</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-o\">::</span><span class=\"crayon-v\">value</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">std</span><span class=\"crayon-o\">::</span><span class=\"crayon-t\">string</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">to_str</span><span class=\"crayon-sy\">(</span><span class=\"crayon-i\">T</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">t</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line\" id=\"crayon-599391ca4a3dd398884264-9\"><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599391ca4a3dd398884264-10\"><span class=\"crayon-h\">    </span><span class=\"crayon-st\">return</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">t</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-599391ca4a3dd398884264-11\"><span class=\"crayon-sy\">}</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0022 seconds] -->\r\n<p>经常不得不分开几个函数来写，还需要写长长的enable_if，比较繁琐，通过if constexpr可以消除enable_if了。</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-599391ca4a3e0356568033\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-always\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"复制代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\ntemplate&lt;typename T&gt;\r\nauto to_str17(T t)\r\n{\r\n    if constexpr(std::is_integral&lt;T&gt;::value)\r\n        return std::to_string(t);\r\n    else\r\n        return t;\r\n}</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-599391ca4a3e0356568033-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599391ca4a3e0356568033-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-599391ca4a3e0356568033-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599391ca4a3e0356568033-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-599391ca4a3e0356568033-5\">5</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599391ca4a3e0356568033-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-599391ca4a3e0356568033-7\">7</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599391ca4a3e0356568033-8\">8</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-599391ca4a3e0356568033-1\"><span class=\"crayon-v\">template</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-i\">typename</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">T</span><span class=\"crayon-o\">&gt;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599391ca4a3e0356568033-2\"><span class=\"crayon-e\">auto </span><span class=\"crayon-e\">to_str17</span><span class=\"crayon-sy\">(</span><span class=\"crayon-i\">T</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">t</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line\" id=\"crayon-599391ca4a3e0356568033-3\"><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599391ca4a3e0356568033-4\"><span class=\"crayon-h\">    </span><span class=\"crayon-st\">if</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">constexpr</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">std</span><span class=\"crayon-o\">::</span><span class=\"crayon-v\">is_integral</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-v\">T</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-o\">::</span><span class=\"crayon-v\">value</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line\" id=\"crayon-599391ca4a3e0356568033-5\"><span class=\"crayon-h\">        </span><span class=\"crayon-st\">return</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">std</span><span class=\"crayon-o\">::</span><span class=\"crayon-e\">to_string</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">t</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599391ca4a3e0356568033-6\"><span class=\"crayon-h\">    </span><span class=\"crayon-st\">else</span></div><div class=\"crayon-line\" id=\"crayon-599391ca4a3e0356568033-7\"><span class=\"crayon-h\">        </span><span class=\"crayon-st\">return</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">t</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599391ca4a3e0356568033-8\"><span class=\"crayon-sy\">}</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0014 seconds] -->\r\n<p>constexpr if让C++的模版具备if-else if-else功能了，是不是很酷，C++程序员的好日子来了。</p>\n<p>不过需要注意的是下面这种写法是有问题的。</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-599391ca4a3e3039532260\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-always\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"复制代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\ntemplate&lt;typename T&gt;\r\nauto to_str17(T t)\r\n{\r\n    if constexpr(std::is_integral&lt;T&gt;::value)\r\n        return std::to_string(t);\r\n\r\n        return t;\r\n}</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-599391ca4a3e3039532260-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599391ca4a3e3039532260-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-599391ca4a3e3039532260-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599391ca4a3e3039532260-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-599391ca4a3e3039532260-5\">5</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599391ca4a3e3039532260-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-599391ca4a3e3039532260-7\">7</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599391ca4a3e3039532260-8\">8</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-599391ca4a3e3039532260-1\"><span class=\"crayon-v\">template</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-i\">typename</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">T</span><span class=\"crayon-o\">&gt;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599391ca4a3e3039532260-2\"><span class=\"crayon-e\">auto </span><span class=\"crayon-e\">to_str17</span><span class=\"crayon-sy\">(</span><span class=\"crayon-i\">T</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">t</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line\" id=\"crayon-599391ca4a3e3039532260-3\"><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599391ca4a3e3039532260-4\"><span class=\"crayon-h\">    </span><span class=\"crayon-st\">if</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">constexpr</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">std</span><span class=\"crayon-o\">::</span><span class=\"crayon-v\">is_integral</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-v\">T</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-o\">::</span><span class=\"crayon-v\">value</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line\" id=\"crayon-599391ca4a3e3039532260-5\"><span class=\"crayon-h\">        </span><span class=\"crayon-st\">return</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">std</span><span class=\"crayon-o\">::</span><span class=\"crayon-e\">to_string</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">t</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599391ca4a3e3039532260-6\"> </div><div class=\"crayon-line\" id=\"crayon-599391ca4a3e3039532260-7\"><span class=\"crayon-h\">        </span><span class=\"crayon-st\">return</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">t</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599391ca4a3e3039532260-8\"><span class=\"crayon-sy\">}</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0013 seconds] -->\r\n<p>这个代码把else去掉了，当输入如果是非数字类型时代码可以编译过，以为if constexpr在模版实例化的时候会丢弃不满足条件的部分，因此函数体中的前两行代码将失效，只有最后一句有效。当输入的为数字的时候就会产生编译错误了，因为if constexpr满足条件了，这时候就会有两个return了，就会导致编译错误。</p>\n<p>constexpr if还可以用来替换#ifdef宏，看下面的例子:</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-599391ca4a3e7684957305\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-always\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"复制代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\nenum class OS { Linux, Mac, Windows };\r\n\r\n//Translate the macros to C++ at a single point in the application\r\n#ifdef __linux__\r\nconstexpr OS the_os = OS::Linux;\r\n#elif __APPLE__\r\nconstexpr OS the_os = OS::Mac;\r\n#elif __WIN32\r\nconstexpr OS the_os = OS::Windows;\r\n#endif\r\n\r\nvoid do_something() {\r\n     //do something general\r\n\r\n     if constexpr (the_os == OS::Linux) {\r\n         //do something Linuxy\r\n     }\r\n     else if constexpr (the_os == OS::Mac) {\r\n         //do something Appley\r\n     }\r\n     else if constexpr (the_os == OS::Windows) {\r\n         //do something Windowsy\r\n     }\r\n\r\n     //do something general\r\n}</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-599391ca4a3e7684957305-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599391ca4a3e7684957305-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-599391ca4a3e7684957305-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599391ca4a3e7684957305-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-599391ca4a3e7684957305-5\">5</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599391ca4a3e7684957305-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-599391ca4a3e7684957305-7\">7</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599391ca4a3e7684957305-8\">8</div><div class=\"crayon-num\" data-line=\"crayon-599391ca4a3e7684957305-9\">9</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599391ca4a3e7684957305-10\">10</div><div class=\"crayon-num\" data-line=\"crayon-599391ca4a3e7684957305-11\">11</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599391ca4a3e7684957305-12\">12</div><div class=\"crayon-num\" data-line=\"crayon-599391ca4a3e7684957305-13\">13</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599391ca4a3e7684957305-14\">14</div><div class=\"crayon-num\" data-line=\"crayon-599391ca4a3e7684957305-15\">15</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599391ca4a3e7684957305-16\">16</div><div class=\"crayon-num\" data-line=\"crayon-599391ca4a3e7684957305-17\">17</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599391ca4a3e7684957305-18\">18</div><div class=\"crayon-num\" data-line=\"crayon-599391ca4a3e7684957305-19\">19</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599391ca4a3e7684957305-20\">20</div><div class=\"crayon-num\" data-line=\"crayon-599391ca4a3e7684957305-21\">21</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599391ca4a3e7684957305-22\">22</div><div class=\"crayon-num\" data-line=\"crayon-599391ca4a3e7684957305-23\">23</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599391ca4a3e7684957305-24\">24</div><div class=\"crayon-num\" data-line=\"crayon-599391ca4a3e7684957305-25\">25</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599391ca4a3e7684957305-26\">26</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-599391ca4a3e7684957305-1\"><span class=\"crayon-t\">enum</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">class</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">OS</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Linux</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Mac</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">Windows</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">}</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599391ca4a3e7684957305-2\"> </div><div class=\"crayon-line\" id=\"crayon-599391ca4a3e7684957305-3\"><span class=\"crayon-c\">//Translate the macros to C++ at a single point in the application</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599391ca4a3e7684957305-4\"><span class=\"crayon-p\">#ifdef __linux__</span></div><div class=\"crayon-line\" id=\"crayon-599391ca4a3e7684957305-5\"><span class=\"crayon-e\">constexpr </span><span class=\"crayon-e\">OS </span><span class=\"crayon-v\">the_os</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">OS</span><span class=\"crayon-o\">::</span><span class=\"crayon-v\">Linux</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599391ca4a3e7684957305-6\"><span class=\"crayon-p\">#elif __APPLE__</span></div><div class=\"crayon-line\" id=\"crayon-599391ca4a3e7684957305-7\"><span class=\"crayon-e\">constexpr </span><span class=\"crayon-e\">OS </span><span class=\"crayon-v\">the_os</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">OS</span><span class=\"crayon-o\">::</span><span class=\"crayon-v\">Mac</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599391ca4a3e7684957305-8\"><span class=\"crayon-p\">#elif __WIN32</span></div><div class=\"crayon-line\" id=\"crayon-599391ca4a3e7684957305-9\"><span class=\"crayon-e\">constexpr </span><span class=\"crayon-e\">OS </span><span class=\"crayon-v\">the_os</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">OS</span><span class=\"crayon-o\">::</span><span class=\"crayon-v\">Windows</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599391ca4a3e7684957305-10\"><span class=\"crayon-p\">#endif</span></div><div class=\"crayon-line\" id=\"crayon-599391ca4a3e7684957305-11\"> </div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599391ca4a3e7684957305-12\"><span class=\"crayon-t\">void</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">do_something</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-599391ca4a3e7684957305-13\"><span class=\"crayon-h\">     </span><span class=\"crayon-c\">//do something general</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599391ca4a3e7684957305-14\"> </div><div class=\"crayon-line\" id=\"crayon-599391ca4a3e7684957305-15\"><span class=\"crayon-h\">     </span><span class=\"crayon-st\">if</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">constexpr</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">the_os</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">==</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">OS</span><span class=\"crayon-o\">::</span><span class=\"crayon-v\">Linux</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599391ca4a3e7684957305-16\"><span class=\"crayon-h\">         </span><span class=\"crayon-c\">//do something Linuxy</span></div><div class=\"crayon-line\" id=\"crayon-599391ca4a3e7684957305-17\"><span class=\"crayon-h\">     </span><span class=\"crayon-sy\">}</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599391ca4a3e7684957305-18\"><span class=\"crayon-h\">     </span><span class=\"crayon-st\">else</span><span class=\"crayon-h\"> </span><span class=\"crayon-st\">if</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">constexpr</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">the_os</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">==</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">OS</span><span class=\"crayon-o\">::</span><span class=\"crayon-v\">Mac</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-599391ca4a3e7684957305-19\"><span class=\"crayon-h\">         </span><span class=\"crayon-c\">//do something Appley</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599391ca4a3e7684957305-20\"><span class=\"crayon-h\">     </span><span class=\"crayon-sy\">}</span></div><div class=\"crayon-line\" id=\"crayon-599391ca4a3e7684957305-21\"><span class=\"crayon-h\">     </span><span class=\"crayon-st\">else</span><span class=\"crayon-h\"> </span><span class=\"crayon-st\">if</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">constexpr</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">the_os</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">==</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">OS</span><span class=\"crayon-o\">::</span><span class=\"crayon-v\">Windows</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599391ca4a3e7684957305-22\"><span class=\"crayon-h\">         </span><span class=\"crayon-c\">//do something Windowsy</span></div><div class=\"crayon-line\" id=\"crayon-599391ca4a3e7684957305-23\"><span class=\"crayon-h\">     </span><span class=\"crayon-sy\">}</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599391ca4a3e7684957305-24\"> </div><div class=\"crayon-line\" id=\"crayon-599391ca4a3e7684957305-25\"><span class=\"crayon-h\">     </span><span class=\"crayon-c\">//do something general</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599391ca4a3e7684957305-26\"><span class=\"crayon-sy\">}</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0031 seconds] -->\r\n<p>代码变得更清爽了，再也不需要像以前一样写#ifdef那样难看的代码块了。</p>\n<h1><strong>constexpr lambda</strong></h1>\n<p>constexpr lambda其实很简单，它的意思就是可以在constexpr 函数中用lambda表达式了，这在C++17之前是不允许的。这样使用constexpr函数和普通函数没多大区别了，使用起来非常舒服。下面是constexpr lambda的例子：</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-599391ca4a3eb603165480\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-always\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"复制代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\ntemplate &lt;typename I&gt;\r\nconstexpr auto func(I i) {\r\n  //use a lambda in constexpr context\r\n  return [i](auto j){ return i + j; }; \r\n}</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-599391ca4a3eb603165480-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599391ca4a3eb603165480-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-599391ca4a3eb603165480-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599391ca4a3eb603165480-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-599391ca4a3eb603165480-5\">5</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-599391ca4a3eb603165480-1\"><span class=\"crayon-v\">template</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-i\">typename</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">I</span><span class=\"crayon-o\">&gt;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599391ca4a3eb603165480-2\"><span class=\"crayon-e\">constexpr </span><span class=\"crayon-e\">auto </span><span class=\"crayon-e\">func</span><span class=\"crayon-sy\">(</span><span class=\"crayon-i\">I</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">i</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-599391ca4a3eb603165480-3\"><span class=\"crayon-h\">  </span><span class=\"crayon-c\">//use a lambda in constexpr context</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599391ca4a3eb603165480-4\"><span class=\"crayon-h\">  </span><span class=\"crayon-st\">return</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">[</span><span class=\"crayon-v\">i</span><span class=\"crayon-sy\">]</span><span class=\"crayon-sy\">(</span><span class=\"crayon-i\">auto</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">j</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">{</span><span class=\"crayon-h\"> </span><span class=\"crayon-st\">return</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">i</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">+</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">j</span><span class=\"crayon-sy\">;</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">}</span><span class=\"crayon-sy\">;</span><span class=\"crayon-h\"> </span></div><div class=\"crayon-line\" id=\"crayon-599391ca4a3eb603165480-5\"><span class=\"crayon-sy\">}</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0013 seconds] -->\r\n<p>constexpr if和constexpr lambda是C++17提供的非常棒的特性，enjoy it.</p>\n<h1><strong>string_view</strong></h1>\n<p><strong>string_view的基本用法</strong></p>\n<p>C++17中的string_view是一个char数据的视图或者说引用，它并不拥有该数据，是为了避免拷贝，因此使用string_view可以用来做性能优化。你应该用string_view来代替const char和const string了。string_view的方法和string类似，用法很简单：</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-599391ca4a3ee016644108\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-always\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"复制代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\nconst char* data = \"test\";\r\nstd::string_view str1(data, 4);\r\nstd::cout&lt;&lt;str1.length()&lt;&lt;'\\n'; //4\r\nif(data==str1)\r\n    std::cout&lt;&lt;\"ok\"&lt;&lt;'\\n';\r\n\r\nconst std::string str2 = \"test\";\r\nstd::string_view str3(str2, str2.size());</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-599391ca4a3ee016644108-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599391ca4a3ee016644108-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-599391ca4a3ee016644108-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599391ca4a3ee016644108-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-599391ca4a3ee016644108-5\">5</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599391ca4a3ee016644108-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-599391ca4a3ee016644108-7\">7</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599391ca4a3ee016644108-8\">8</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-599391ca4a3ee016644108-1\"><span class=\"crayon-m\">const</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">char</span><span class=\"crayon-o\">*</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">data</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">\"test\"</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599391ca4a3ee016644108-2\"><span class=\"crayon-v\">std</span><span class=\"crayon-o\">::</span><span class=\"crayon-e\">string_view </span><span class=\"crayon-e\">str1</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">data</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">4</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-599391ca4a3ee016644108-3\"><span class=\"crayon-v\">std</span><span class=\"crayon-o\">::</span><span class=\"crayon-v\">cout</span><span class=\"crayon-o\">&lt;&lt;</span><span class=\"crayon-v\">str1</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">length</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">)</span><span class=\"crayon-o\">&lt;&lt;</span><span class=\"crayon-s\">'\\n'</span><span class=\"crayon-sy\">;</span><span class=\"crayon-h\"> </span><span class=\"crayon-c\">//4</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599391ca4a3ee016644108-4\"><span class=\"crayon-st\">if</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">data</span><span class=\"crayon-o\">==</span><span class=\"crayon-v\">str1</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line\" id=\"crayon-599391ca4a3ee016644108-5\"><span class=\"crayon-h\">    </span><span class=\"crayon-v\">std</span><span class=\"crayon-o\">::</span><span class=\"crayon-v\">cout</span><span class=\"crayon-o\">&lt;&lt;</span><span class=\"crayon-s\">\"ok\"</span><span class=\"crayon-o\">&lt;&lt;</span><span class=\"crayon-s\">'\\n'</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599391ca4a3ee016644108-6\"> </div><div class=\"crayon-line\" id=\"crayon-599391ca4a3ee016644108-7\"><span class=\"crayon-m\">const</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">std</span><span class=\"crayon-o\">::</span><span class=\"crayon-t\">string</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">str2</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">\"test\"</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599391ca4a3ee016644108-8\"><span class=\"crayon-v\">std</span><span class=\"crayon-o\">::</span><span class=\"crayon-e\">string_view </span><span class=\"crayon-e\">str3</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">str2</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">str2</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">size</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0019 seconds] -->\r\n<p>构造string_view的时候用char*和长度来构造，这个长度可以自由确定，它表示string_view希望引用的字符串的长度。因为它只是引用其他字符串，所以它不会分配内存，不会像string那样容易产生临时变量。我们通过一个测试程序来看看string_view如何来帮我们优化性能的。</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-599391ca4a3f2777394888\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-always\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"复制代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\nusing namespace std::literals;\r\n\r\nconstexpr auto s = \"it is a test\"sv;\r\nauto str = \"it is a test\"s;\r\n\r\nconstexpr int LEN = 1000000;\r\nboost::timer t;\r\nfor (int i = 0; i &lt; LEN; ++i) {\r\n    constexpr auto s1 = s.substr(3);\r\n}\r\nstd::cout&lt;&lt;t.elapsed()&lt;&lt;'\\n';\r\nt.restart();\r\nfor (int i = 0; i &lt; LEN; ++i) {\r\n    auto s2 = str.substr(3);\r\n}\r\nstd::cout&lt;&lt;t.elapsed()&lt;&lt;'\\n';\r\n\r\n//output\r\n0.004197\r\n0.231505</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-599391ca4a3f2777394888-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599391ca4a3f2777394888-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-599391ca4a3f2777394888-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599391ca4a3f2777394888-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-599391ca4a3f2777394888-5\">5</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599391ca4a3f2777394888-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-599391ca4a3f2777394888-7\">7</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599391ca4a3f2777394888-8\">8</div><div class=\"crayon-num\" data-line=\"crayon-599391ca4a3f2777394888-9\">9</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599391ca4a3f2777394888-10\">10</div><div class=\"crayon-num\" data-line=\"crayon-599391ca4a3f2777394888-11\">11</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599391ca4a3f2777394888-12\">12</div><div class=\"crayon-num\" data-line=\"crayon-599391ca4a3f2777394888-13\">13</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599391ca4a3f2777394888-14\">14</div><div class=\"crayon-num\" data-line=\"crayon-599391ca4a3f2777394888-15\">15</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599391ca4a3f2777394888-16\">16</div><div class=\"crayon-num\" data-line=\"crayon-599391ca4a3f2777394888-17\">17</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599391ca4a3f2777394888-18\">18</div><div class=\"crayon-num\" data-line=\"crayon-599391ca4a3f2777394888-19\">19</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599391ca4a3f2777394888-20\">20</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-599391ca4a3f2777394888-1\"><span class=\"crayon-e\">using </span><span class=\"crayon-t\">namespace</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">std</span><span class=\"crayon-o\">::</span><span class=\"crayon-v\">literals</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599391ca4a3f2777394888-2\"> </div><div class=\"crayon-line\" id=\"crayon-599391ca4a3f2777394888-3\"><span class=\"crayon-e\">constexpr </span><span class=\"crayon-i\">auto</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">s</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">\"it is a test\"</span><span class=\"crayon-v\">sv</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599391ca4a3f2777394888-4\"><span class=\"crayon-e\">auto </span><span class=\"crayon-v\">str</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">\"it is a test\"</span><span class=\"crayon-v\">s</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-599391ca4a3f2777394888-5\"> </div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599391ca4a3f2777394888-6\"><span class=\"crayon-e\">constexpr </span><span class=\"crayon-t\">int</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">LEN</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">1000000</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-599391ca4a3f2777394888-7\"><span class=\"crayon-v\">boost</span><span class=\"crayon-o\">::</span><span class=\"crayon-i\">timer</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">t</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599391ca4a3f2777394888-8\"><span class=\"crayon-st\">for</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-t\">int</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">i</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">;</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">i</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">LEN</span><span class=\"crayon-sy\">;</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">++</span><span class=\"crayon-v\">i</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-599391ca4a3f2777394888-9\"><span class=\"crayon-h\">    </span><span class=\"crayon-e\">constexpr </span><span class=\"crayon-e\">auto </span><span class=\"crayon-v\">s1</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">s</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">substr</span><span class=\"crayon-sy\">(</span><span class=\"crayon-cn\">3</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599391ca4a3f2777394888-10\"><span class=\"crayon-sy\">}</span></div><div class=\"crayon-line\" id=\"crayon-599391ca4a3f2777394888-11\"><span class=\"crayon-v\">std</span><span class=\"crayon-o\">::</span><span class=\"crayon-v\">cout</span><span class=\"crayon-o\">&lt;&lt;</span><span class=\"crayon-v\">t</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">elapsed</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">)</span><span class=\"crayon-o\">&lt;&lt;</span><span class=\"crayon-s\">'\\n'</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599391ca4a3f2777394888-12\"><span class=\"crayon-v\">t</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">restart</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-599391ca4a3f2777394888-13\"><span class=\"crayon-st\">for</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-t\">int</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">i</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">;</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">i</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">LEN</span><span class=\"crayon-sy\">;</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">++</span><span class=\"crayon-v\">i</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599391ca4a3f2777394888-14\"><span class=\"crayon-h\">    </span><span class=\"crayon-e\">auto </span><span class=\"crayon-v\">s2</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">str</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">substr</span><span class=\"crayon-sy\">(</span><span class=\"crayon-cn\">3</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-599391ca4a3f2777394888-15\"><span class=\"crayon-sy\">}</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599391ca4a3f2777394888-16\"><span class=\"crayon-v\">std</span><span class=\"crayon-o\">::</span><span class=\"crayon-v\">cout</span><span class=\"crayon-o\">&lt;&lt;</span><span class=\"crayon-v\">t</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">elapsed</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">)</span><span class=\"crayon-o\">&lt;&lt;</span><span class=\"crayon-s\">'\\n'</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-599391ca4a3f2777394888-17\"> </div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599391ca4a3f2777394888-18\"><span class=\"crayon-c\">//output</span></div><div class=\"crayon-line\" id=\"crayon-599391ca4a3f2777394888-19\"><span class=\"crayon-cn\">0.004197</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599391ca4a3f2777394888-20\"><span class=\"crayon-cn\">0.231505</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0035 seconds] -->\r\n<p>我们可以通过字面量””sv来初始化string_view。string_view的substr和string的substr相比，快了50多倍，根本原因是它不会分配内存。</p>\n<p><strong>string_view的生命周期</strong></p>\n<p>由于string_vew并不拥有锁引用的字符串，所以它也不会去关注被引用字符串的生命周期，用户在使用的时候需要注意，不要将一个临时变量给一个string_view，那样会导致string_view引用的内容也失效。</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-599391ca4a3f6814545372\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-always\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"复制代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\nstd::string_view str_v;\r\n{\r\n    std::string temp = \"test\";\r\n    str_v = {temp};\r\n}</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-599391ca4a3f6814545372-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599391ca4a3f6814545372-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-599391ca4a3f6814545372-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599391ca4a3f6814545372-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-599391ca4a3f6814545372-5\">5</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-599391ca4a3f6814545372-1\"><span class=\"crayon-v\">std</span><span class=\"crayon-o\">::</span><span class=\"crayon-e\">string_view </span><span class=\"crayon-v\">str_v</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599391ca4a3f6814545372-2\"><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-599391ca4a3f6814545372-3\"><span class=\"crayon-h\">    </span><span class=\"crayon-v\">std</span><span class=\"crayon-o\">::</span><span class=\"crayon-t\">string</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">temp</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">\"test\"</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599391ca4a3f6814545372-4\"><span class=\"crayon-h\">    </span><span class=\"crayon-v\">str_v</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span><span class=\"crayon-v\">temp</span><span class=\"crayon-sy\">}</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-599391ca4a3f6814545372-5\"><span class=\"crayon-sy\">}</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0009 seconds] -->\r\n<p>这样的代码是有问题的，因为出了作用域之后，string_view引用的内容已经失效了。</p>\n<h1><strong>总结</strong></h1>\n<p>本文介绍了C++17的fold expression、constexpr if、constexpr lambda和string_view。fold expression为了简化可变模板参数的展开，让可以模板参数的使用变得更简单直观；constexpr if让模板具备if-else功能，非常强大。它也避免了写冗长的enable_if代码，让代码变得简洁易懂了；string_view则是用来做性能优化的，应该用它来代替const char*和const string。 这些特性对之前的C++14和C++11做了改进和增强，非常酷。</p>\n<p><strong>作者</strong>：祁宇，《深入应用C++11》作者，C++开源社区purecpp.org创始人，致力于C++11/14的应用、研究和推广。乐于研究和分享技术，爱好C++，爱好开源。</p>\n\r\n        \r\n        \r\n        \n    <div class=\"post-adds\">\n        <span data-post-id=\"112106\" class=\" btn-bluet-bigger href-style vote-post-up   register-user-only \"><i class=\"fa  fa-thumbs-o-up\"></i> <h10 id=\"112106votetotal\">1</h10> 赞</span>\n        <span data-book-type=\"1\" data-site-id=\"2\" data-item-id=\"112106\" data-item-type=\"1\" class=\" btn-bluet-bigger href-style bookmark-btn  register-user-only \"><i class=\"fa fa-bookmark-o  \"></i> 1 收藏</span>\n\n                    <a href=\"#article-comment\"><span class=\"btn-bluet-bigger href-style hide-on-480\"><i class=\"fa fa-comments-o\"></i>  评论</span></a>\n        \n        \n        \n        <!-- JiaThis Button BEGIN -->\n        <div class=\"jiathis_style_24x24\" style=\"display: inline-flex; position: relative; margin: 0; clear: both;float: right;\">\n            <a class=\"jiathis_button_tsina\"></a>\n            <a class=\"jiathis_button_weixin\"></a>\n            <a class=\"jiathis_button_qzone\"></a>\n            <a class=\"jiathis_button_fb hide-on-480\"></a>\n            <a href=\"http://www.jiathis.com/share?uid=1745061\" class=\"jiathis jiathis_txt jiathis_separator jtico jtico_jiathis\" target=\"_blank\"></a>\n        </div>\n\n    </div>\n\n\n\n\r\n        <!-- BEGIN #author-bio -->\r\n\r\n\r\n<!-- END #author-bio -->\r\n\t</div>", "front_image_path": ["full/9a6b1eab17892544dfe9124f1a91b9757cf15bc5.jpg"]},{"title": "从集装箱历史看 DevOps 的发展进程", "url": "http://blog.jobbole.com/112115/", "url_object_id": "9f79bbbba452d169cfed3aaf6bb30e46", "create_date": "2017/08/07", "front_image_url": ["http://insights.thoughtworkers.org/wp-content/uploads/2017/08/productivity-technology-1024x564.jpg"], "praise_nums": "1", "fav_nums": "1", "comment_nums": 0, "tags": "IT技术,DevOps", "content": "<div class=\"entry\">\r\n\r\n        \t\t\t<div class=\"textwidget\"></div>\n\t\t\r\n\t\t<div class=\"copyright-area\">本文作者： <a href=\"http://blog.jobbole.com\">伯乐在线</a> - <a href=\"http://www.jobbole.com/members/thoughtworkschina\">ThoughtWorks</a> 。未经作者许可，禁止转载！<br>欢迎加入伯乐在线 <a href=\"http://blog.jobbole.com/99322\" target=\"_blank\">专栏作者</a>。</div><p>什么样的技术会带来生产力的极大提升？技术含量是否与生产力提升成正比关系？</p>\n<p><a href=\"http://insights.thoughtworkers.org/wp-content/uploads/2017/08/productivity-technology.jpg\"><img class=\"aligncenter\" src=\"http://insights.thoughtworkers.org/wp-content/uploads/2017/08/productivity-technology-1024x564.jpg\" alt=\"\" width=\"700\" height=\"386\"></a></p>\n<p>带着问题，我们先看一个例子：在工业革命时期，瓦特用于“改良”蒸汽机的技术，就是极大提升效率的技术。</p>\n<p>这里有一个误解，有人认为瓦特发明了蒸汽机。其实不然，瓦特只是改良了纽卡门蒸汽机，通过橡胶增加密闭性同时优化机械结构，使得原本只能用于提水的笨重机器，变得能被广泛应用，为第一次工业革命的兴起奠定了重要基础。</p>\n<p>从上面的例子可以看出技术含量的高低与带来生产力的大小并没有直接关系。</p>\n<h3>传奇的集装箱</h3>\n<p>我们来看另外一个有趣的故事，希望你能从中得到启发。那就是改变运输业、对制造业有着深远影响的一项革命性技术——集装箱（英文container，你没看错，它的名字和现在火的一塌糊涂的“容器技术”同名 ）。</p>\n<p>说到集装箱不能不提马尔科姆·麦克莱恩（1915—2001），20世纪四十年代美国一家运输公司的老板，由于改造（改造不是发明）了集装箱、提高了集装箱的便利性，推动了整个运输行业的巨大变革，而被尊称为“集装箱运输之父”。</p>\n<p>那么问题来了：改造蒸汽机也许有些技术含量，但是技术含量连罐头都不如（抽真空和密封技术）的集装箱怎么可能有这么大的影响呢？</p>\n<p style=\"text-align: center;\"><a href=\"http://insights.thoughtworkers.org/wp-content/uploads/2017/08/1-Malcolm-McDowell-1.png\"><img src=\"http://insights.thoughtworkers.org/wp-content/uploads/2017/08/1-Malcolm-McDowell-1.png\" alt=\"\" width=\"482\" height=\"325\"></a></p>\n<p style=\"text-align: center;\">（集装箱之父麦克莱恩：改造不仅限于集装箱本身，还包括港口和货轮等运输环节）</p>\n<p>我们知道工业社会最重要的竞争来自于节约成本，如果一个技术可以节省95%的成本就相当于带来20倍的效率提升。这种技术可以说是颠覆性的，而集装箱就是这样的技术。</p>\n<p>麦克莱恩在纽约港第一次做的集装箱运输实验就实现了20倍的效率提升：使用集装箱运输啤酒，将每吨啤酒的运输成本从4美金变成20美分。</p>\n<p>过程是这样的：从啤酒工厂把啤酒装入集装箱开始，通过陆路转海路运输到目的地，省去了工厂到陆路运输、再到海洋运输的中间人力搬运过程，因此从工厂到码头的装卸时间大大缩短，由数天压缩到数小时，从而使得美国到欧洲的货运时间足足减少了4周。并且由于集装箱的堆叠使得每一艘船只的储运量比以前提高了6倍。</p>\n<p>在传统运输过程，货物没有统一的包装标准，这既限制了运输工具的运载量，又增加了货物在从陆路运输到海路运输低效的手工搬运过程。集装箱这个标准化的运输单元，就为在整个运输系统优化中间流转效率提供了一种可能。</p>\n<p><a href=\"http://insights.thoughtworkers.org/wp-content/uploads/2017/08/2-transportation-system.jpg\"><img src=\"http://insights.thoughtworkers.org/wp-content/uploads/2017/08/2-transportation-system.jpg\" alt=\"\" width=\"975\" height=\"198\"></a></p>\n<p>（运输体系中间环节）</p>\n<p>看到这里，我不由得联想到传统软件研发测试与发布的过程。虽然每个过程内部自动化程度很高，但是部门之间的流转却依靠低效的手工操作，这些过程大大降低了整体效率。</p>\n<h3>系统性创新的窘境</h3>\n<p>但是非常意外的是，麦克莱恩在接下来10多年的航运生意中不仅没赚到钱，反而是亏损了。这就太奇怪了，一个能让效率提升20倍的技术，为什么会不赚钱呢？</p>\n<p>原因在于，在当时的运输行业，大部分货物并没有使用集装箱，大量的手工搬运使得船只装卸货物并没有节省多少时间，还有集装箱运到目的地后，箱内的货物需要分别运到不同的地方等等。</p>\n<p>因此集装箱技术并不在于“箱子”本身，而在于需要整个运输系统的创新——在道路、桥梁、卡车、码头和吊装设备等基础设施没有针对“箱子”进行优化的情况下，集装箱技术无法发挥出原有的效能。</p>\n<p>让我们回到最开始的问题：“什么样的技术会带来生产力的极大提升呢?”</p>\n<p><strong>那些创新了人与事物连接方式，且极大降低这种连接成本的技术，才能真正促进生产力的提升。</strong></p>\n<p><strong><a href=\"https://baike.baidu.com/item/devops/2613029?fr=aladdin\">DevOps</a>正是这样的技术，它是针对研发系统的一次系统性创新。其创新性在于针对整个研发系统中的各个子系统进行交付与反馈的优化，从而有效提升整体效率。</strong></p>\n<p>相对于传统软件6个月发布一次，2009年<a href=\"https://conferences.oreilly.com/velocity/velocity2009/public/schedule/detail/7641\">John Allspaw 和Paul Hammond在Flickr</a>可以实现每天发布10次，将软件发布频率提升了将近两千倍，极大地降低了软件发布的成本。</p>\n<p>但是大部分公司在实施DevOps的过程中，并没有有效提升发布频率，这一点与集装箱在最开始的10年内并不赚钱的道理是相似的。</p>\n<p><a href=\"http://insights.thoughtworkers.org/wp-content/uploads/2017/08/3-development-platform.jpg\"><img src=\"http://insights.thoughtworkers.org/wp-content/uploads/2017/08/3-development-platform.jpg\" alt=\"\" width=\"975\" height=\"208\"></a></p>\n<p>（应用研发平台：描述构建软件包，在不同的环境进行测试、最终发布生产环境的过程）</p>\n<p>问题在于系统性创新初期，各个环节没有对新技术进行优化，部分环节甚至会阻碍新技术发展，导致新技术无法提升效能。</p>\n<h3>转机带来的启示</h3>\n<p>一切直到1967年才出现转机。美国发动了越南战争，美军需要将大量物资运输到亚洲。在长期的优化实践中，美军得出高效运用集装箱的3C原则：<strong>一种货物、一个地址、一个客户</strong>。</p>\n<p>从此，集装箱的时代到来了。只在1967年一年的时间里，麦克莱恩就从美国国防部赚了4.5亿美金。低廉的海运成本、大大缩短的运输时间以及到货时间的可预期，让全球制造业的分工协作效率得到极大的提高。行驶在大洋上的货轮，就像在生产车间里运输原材料的叉车一样，使得制造业不必大量囤积原材料，后来丰田的“零库存”计划更是将原料的管控能力发挥到了极致。</p>\n<p>为什么3C原则可以极大提升效率？它正是通过解决运输“中间环节”过程的低效问题，使得总体效率得到极大提升。下面分别加以说明：</p>\n<ul>\n<li><strong>一种货物</strong>：在货物“装箱”过程，统一货物的来源与种类，标准化货物装箱过程。</li>\n<li><strong>一个地址：</strong>在货物“分拣”过程中，不会打开集装箱，只做一次装箱。</li>\n<li><strong>一个客户：</strong>在货物“送货”过程，只有一个客户，简化送货的过程。</li>\n</ul>\n<h3>DevOps流程的3D原则</h3>\n<p>与如何高效利用集装箱类似，在DevOps实施过程中，通过优化流水线中间流转过程，提升总体效率。</p>\n<p><a href=\"http://insights.thoughtworkers.org/wp-content/uploads/2017/08/0%E7%9A%84%E5%89%AF%E6%9C%AC-1.jpeg\"><img src=\"http://insights.thoughtworkers.org/wp-content/uploads/2017/08/0%E7%9A%84%E5%89%AF%E6%9C%AC-1-1024x557.jpeg\" alt=\"\" width=\"700\" height=\"381\"></a></p>\n<p>下面举出与3C原则对应的3D原则：</p>\n<ul>\n<li><strong>一键式部署(Automatic Deploy)：</strong>部署过程中，标准化部署过程，实现一键式部署</li>\n<li><strong>一次构建打包（Automatic Delivery）：</strong>在测试环境、UAT环境和生产环境的流转过程中，只打包一次，软件包按顺序自动交付到各个环境，最终发布到生产环境</li>\n<li><strong>一次配置分发（Automatic Distribution)：</strong>在生产环境发布过程，建立统一的配置分发管理，将繁琐的分布式环境配置一次分发到各个数据中心，简化发布过程。</li>\n</ul>\n<p>“科技是第一生产力！”如果我们以技术含量来衡量一个创新会很容易走入误区。集装箱发展历史告诉我们，从状态的流转环节入手，降低流转成本是提高总体效能的另外一个途径。</p>\n<p>集装箱发展历史的前十年完成了道路、桥梁、隧道、卡车、码头设施、吊装设备的优化，以适应集装箱的发展。这个进程的难点在于，以一家运输企业推进整个运输体系针对集装箱的优化。</p>\n<p>随着技术的发展，DevOps的周边环节正在逐步完善，DevOps实施的3D原则，也让我们走入故事的后半段，就像集装箱的故事那样。</p>\n\r\n        \r\n        \r\n        \n    <div class=\"post-adds\">\n        <span data-post-id=\"112115\" class=\" btn-bluet-bigger href-style vote-post-up   register-user-only \"><i class=\"fa  fa-thumbs-o-up\"></i> <h10 id=\"112115votetotal\">1</h10> 赞</span>\n        <span data-book-type=\"1\" data-site-id=\"2\" data-item-id=\"112115\" data-item-type=\"1\" class=\" btn-bluet-bigger href-style bookmark-btn  register-user-only \"><i class=\"fa fa-bookmark-o  \"></i> 1 收藏</span>\n\n                    <a href=\"#article-comment\"><span class=\"btn-bluet-bigger href-style hide-on-480\"><i class=\"fa fa-comments-o\"></i>  评论</span></a>\n        \n        \n        \n        <!-- JiaThis Button BEGIN -->\n        <div class=\"jiathis_style_24x24\" style=\"display: inline-flex; position: relative; margin: 0; clear: both;float: right;\">\n            <a class=\"jiathis_button_tsina\"></a>\n            <a class=\"jiathis_button_weixin\"></a>\n            <a class=\"jiathis_button_qzone\"></a>\n            <a class=\"jiathis_button_fb hide-on-480\"></a>\n            <a href=\"http://www.jiathis.com/share?uid=1745061\" class=\"jiathis jiathis_txt jiathis_separator jtico jtico_jiathis\" target=\"_blank\"></a>\n        </div>\n\n    </div>\n\n\n\n\r\n        <!-- BEGIN #author-bio -->\r\n\r\n<div id=\"author-bio\">\r\n\t\r\n\t<h3 class=\"widget-title\">\r\n\t关于作者：<a target=\"_blank\" href=\"http://www.jobbole.com/members/thoughtworkschina\">ThoughtWorks</a>\r\n\t</h3>\r\n\t<div class=\"alignleft\">\r\n\t\t<a target=\"_blank\" href=\"http://www.jobbole.com/members/thoughtworkschina\">\r\n\t\t\t<img src=\"http://tp3.sinaimg.cn/1774908135/180/0/1\">\r\n\t\t</a>\r\n\t</div>\r\n\r\n    <div class=\"author-bio-info\">\r\n\r\n        <span class=\"author-bio-info-block\">\r\n            ThoughtWorks是一家全球IT咨询公司，追求卓越软件质量，致力于科技驱动商业变革。擅长构建定制化软件产品，帮助客户快速将概念转化为价值。同时为客户提供用户体验设计、技术战略咨询、组织转型等咨询服务。        </span>\r\n        <span class=\"author-bio-info-block\">\r\n            <a href=\"http://www.jobbole.com/members/thoughtworkschina\" target=\"_blank\"><i class=\"fa fa-user\"></i> 个人主页</a> ·\r\n            <a href=\"http://blog.jobbole.com/author/thoughtworkschina/\" target=\"_blank\"><i class=\"fa fa-file-text-o\"></i> 我的文章</a>\r\n\r\n             · <a title=\"声望值\" target=\"_blank\" href=\"http://www.jobbole.com/members/thoughtworkschina/reputation/\"><i class=\"fa fa-graduation-cap\"></i> 70</a> · <a title=\"我的网站\" target=\"_blank\" href=\"http://insights.thoughtworkers.org/\"><i class=\"fa fa-link\"></i></a> <a title=\"微博主页\" target=\"_blank\" href=\"http://weibo.com/thoughtworkschina\"><i class=\"fa fa-weibo\"></i></a>         </span>\r\n    </div>\r\n\t<div class=\"clear\"></div>\r\n</div>\r\n\r\n<!-- END #author-bio -->\r\n\t</div>", "front_image_path": ["full/77cacb13fcb61bdce7d62e488894ff75c84ce4b4.jpg"]},{"title": "什么是现代化编程？", "url": "http://blog.jobbole.com/112071/", "url_object_id": "cfe9e0fcb78f856f786852ad925f1603", "create_date": "2017/08/07", "front_image_url": ["http://wx3.sinaimg.cn/large/7cc829d3gy1fi7r4f1txqj20hs0cmq4r.jpg"], "praise_nums": "1", "fav_nums": 0, "comment_nums": "4", "tags": "开发,IDE,编程", "content": "<div class=\"entry\">\r\n\r\n        \t\t\t<div class=\"textwidget\"></div>\n\t\t\r\n\t\t<div class=\"copyright-area\">本文由 <a href=\"http://blog.jobbole.com\">伯乐在线</a> - <a href=\"http://www.jobbole.com/members/young605867996\">Lada</a> 翻译。未经许可，禁止转载！<br>英文出处：<a target=\"_blank\" href=\"http://lemire.me/blog/2017/07/15/what-is-modern-programming/\">lemire</a>。欢迎加入<a target=\"_blank\" href=\"http://group.jobbole.com/category/feedback/trans-team/\">翻译组</a>。</div><p>【导读】：现代化编程应该是：不强制用相同的 IDE，统一的代码风格，方便的依赖管理，持续集成，版本控制等。</p>\n<hr>\n<p class=\"\">在我的青少年时期，我涉猎了编程基础和一些汇编。当我学习了 Turbo Pascal 之后这事更进了一步，它<a href=\"https://photos.app.goo.gl/WcxNIutwtWmFTdzL2\">提供了一种最早期的集成开发环境（IDE）</a>。我觉得这下合我心意了。实际上，IDE 是一种让你在一个友好的环境内，方便地编写、编译、调试和运行代码的程序。Turbo Pascal 没有太多的图形界面（它基于文本），但它有菜单和窗口。你可以进入调试模式，跟踪变量的值等等。</p>\n<p class=\"\"><img id=\"pic\" class=\"\" src=\"http://wx3.sinaimg.cn/large/7cc829d3gy1fi7r4f1txqj20hs0cmq4r.jpg\"></p>\n<p>然后我转到了 <a href=\"https://photos.app.goo.gl/QnCWPHDcp4Drzev12\">Delphi</a> （一种图形化的 Turbo Pascal），它拥有到今天看来仍然不错的出色 IDE。我用  <a href=\"https://www.youtube.com/watch?v=TgIrzFqGIKM\">Visual Basic</a> 设计了一个“会报时的钟”，当时发表在 Bulletin Board Systems（使用 Windows 3.1 的一个系统）。那之后我发现了 Visual Studio。有好几年我的 C++ 编程都是借用的 Visual Studio。以上就是我一直使用的所有 IDE。</p>\n<p>早在八十年代初，Smalltalk 就有了著名的强大图形化 IDE<a href=\"https://www.youtube.com/watch?v=e0LfndNxqZg\">（Youtube 视频）</a>。</p>\n<p>我认为，使用 IDE 并不代表着“现代化”。现在的 IDE 和过去的 IDE 非常相像。虽然我们编程的内容改变了，但在很多情况下，我们如何编程却没有改变。在我的 Dell 笔记本电脑里装着最新版 Visual Studio。换做 20 年前的我，也能完美地轻松上手它。调试、代码补全、远程代码执行，它和以前很像。事实上，Visual Studio 从未与 Turbo Pascal 相差很大过。而我发现这非常令人沮丧。我以为我们应该取得比这更快的进步。</p>\n<p>我提出了现代化编程在桌面外观上难有作为的观点。图形化用户界面（GUI）只是表层。现代化编程技术都是关于流程和实际工具的，而不是它们之上的表层。我不在乎你是否使用 Eclipse 或 Emacs，这和你如何现代化毫不相关。</p>\n<h2>那么，什么是“现代化”？</h2>\n<h3>编码是社会化的</h3>\n<p>在 20 年前，要求你公司里的每个人都使用相同的 IDE，并且要唯一依赖于这种 IDE 来构建、测试和部署代码，这是很明智的。但在你公司外有很多聪明的人，他们往往不使用你这种 IDE。如今，你可以触及他们了。这意味着对于所采用的工具和流程你必须明智。</p>\n<p>如果你嘲弄使用 Atom 文本编辑器、Visual Studio 或者 Emacs 编程的人，那你就不是社会化的。你需要尽可能的包容，否则就会付出代价。</p>\n<h3>Go 语言有自己的格式化工具</h3>\n<p>我不在乎在你保存的时候，是不是自动重新格式化代码，或者有没有点击重新格式化按钮，或者是不是输入 go fmt，这些都一样。但它无疑是一个卓越的现代化的想法。这就是进步。所有的编程语言都应该为用户强加一个唯一的代码格式。别再 bikeshedding（过于关心旁枝末节，而忽视主要问题）。</p>\n<p>我们很清楚 Java 拥有规范，但规范是不够的。我们需要一个工具，能把代码作为输入，并生成一个唯一定义了的输出，它能处理从行长度到空格的所有问题。</p>\n<p>这个工具的目标是对于应该如何格式化代码，不再有任何可能有的争议，而且产生正确的格式不费吹灰之力。我简直无法告诉你这是多么的重要。</p>\n<h3>像 Rust、Go、Swift 这样的编程语言有自己的程序包管理系统</h3>\n<p>因此，例如在 Swift 中，我可以创建一个名为 Package.swift 的小文本文件，并把它放入我项目的根文件，在那里声明我的依赖。</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-59942d9040dfe651448426\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-always\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"复制代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div><span class=\"crayon-language\">Swift</span></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\nimport PackageDescription\r\n\r\nlet package = Package(\r\n    name: \"SwiftBitsetBenchmark\",\r\n    dependencies: [\r\n   .Package(url: \"https://github.com/lemire/SwiftBitset.git\",  \r\n          majorVersion: 0),\r\n   .Package(url: \"https://github.com/lemire/Swimsuit.git\",  \r\n          majorVersion: 0)\r\n    ]\r\n)</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-59942d9040dfe651448426-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59942d9040dfe651448426-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-59942d9040dfe651448426-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59942d9040dfe651448426-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-59942d9040dfe651448426-5\">5</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59942d9040dfe651448426-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-59942d9040dfe651448426-7\">7</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59942d9040dfe651448426-8\">8</div><div class=\"crayon-num\" data-line=\"crayon-59942d9040dfe651448426-9\">9</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59942d9040dfe651448426-10\">10</div><div class=\"crayon-num\" data-line=\"crayon-59942d9040dfe651448426-11\">11</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-59942d9040dfe651448426-1\"><span class=\"crayon-r\">import</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">PackageDescription</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59942d9040dfe651448426-2\"> </div><div class=\"crayon-line\" id=\"crayon-59942d9040dfe651448426-3\"><span class=\"crayon-r\">let</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">package</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-e \">Package</span><span class=\"crayon-sy\">(</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59942d9040dfe651448426-4\"><span class=\"crayon-h\">    </span><span class=\"crayon-v\">name</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">\"SwiftBitsetBenchmark\"</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line\" id=\"crayon-59942d9040dfe651448426-5\"><span class=\"crayon-h\">    </span><span class=\"crayon-v\">dependencies</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">[</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59942d9040dfe651448426-6\"><span class=\"crayon-h\">   </span><span class=\"crayon-sy\">.</span><span class=\"crayon-e \">Package</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">url</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">\"https://github.com/lemire/SwiftBitset.git\"</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\">  </span></div><div class=\"crayon-line\" id=\"crayon-59942d9040dfe651448426-7\"><span class=\"crayon-h\">          </span><span class=\"crayon-v\">majorVersion</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59942d9040dfe651448426-8\"><span class=\"crayon-h\">   </span><span class=\"crayon-sy\">.</span><span class=\"crayon-e \">Package</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">url</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">\"https://github.com/lemire/Swimsuit.git\"</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\">  </span></div><div class=\"crayon-line\" id=\"crayon-59942d9040dfe651448426-9\"><span class=\"crayon-h\">          </span><span class=\"crayon-v\">majorVersion</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59942d9040dfe651448426-10\"><span class=\"crayon-h\">    </span><span class=\"crayon-sy\">]</span></div><div class=\"crayon-line\" id=\"crayon-59942d9040dfe651448426-11\"><span class=\"crayon-sy\">)</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0018 seconds] -->\r\n<p></p>\n<p style=\"text-align: center;\"><span style=\"color: #999999;\">（源码实例）</span></p>\n<p>然后我可以输入 swift build，软件会自动抓取依赖代码，并构建我的程序。这在 Swift 运行的所有地方通用。你使用哪种文本编辑器和 IDE 都没关系。</p>\n<p>你不想使用文本编辑器，而更喜欢图形界面？可以。都没有区别。</p>\n<p>为什么那样显得现代化？因为自动地解决依赖关系而不费吹灰之力，对于 20 年前的我来说就像魔术。并且自动地、系统地解决依赖关系是极其重要的。我不想永远都不得不手动安装和部署一个依赖项。我希望其他人能够在几秒内把我的库添加到他们项目中，而不是几分钟或是几小时。</p>\n<p>是的,你可以将它添加到现有的语言(如：Java 的 Maven 或是 IED)但需要有一个唯一的方法让它起效。</p>\n<h3>像 Rust、Go、Swift 这样的编程语言，在一开始就支持单元测试。</h3>\n<p>比如在 Go 里，创建一个 filemyproject_test.go，然后添加 func TestMyStuff（t * testing.T）这样的函数，然后输入 go test 既可。</p>\n<p>在 20 年前，几乎没有人测试他们的代码，而今天已经是一个必要要求，您和它需要以一种唯一的方式来做，这样你就可以在项目之间移动，还总是知道如何测试了。</p>\n<p>如果不能在你的代码中立刻认出健全的单元测试，我会设想你的代码严重损坏了。</p>\n<h3>持续集成</h3>\n<p>代码更改时，你想要一个远程工具来获取新代码，并测试它，以便可以提前停止回归。人们可以在你的代码上运行测试还不够，他们还需要看到自动化测试的结果，自行检查最终的故障。</p>\n<p>持续集成是较大规模计划的一部分：你必须在你编程的时候疯狂地自动化程序。体力劳动应该最小化。有时候这意味着你真的应该只是点击一个按钮，无论是通过一个图形化用户界面，还是命令窗口，但它不意味着需要反复地遵循一系列复杂的命令。</p>\n<h3>版本控制</h3>\n<p>20 年前，你在桌面上编写代码，并通过电子邮件发送新代码（作为补丁）是讲得通的。但这只在缓慢的合作节奏中有意义。如今，这么做是愚蠢的。任何差于 Git 的都是落后的。注意，如今甚至微软构建 Windows 也使用 Git。</p>\n<p> </p>\n<p>那么，当你共事于从来没有听过现代编程的聪明学生会发生什么呢？他们看一个类似 go get 的命令，只看得到表层（一个命令行）。他们认为这是落后的。漂亮的图形在哪？</p>\n<p>他们使用一个好看的 IDE 工作，像是 Visual Studio 或 Eclipse，并确信自己是现代化的，完全无视 IDE 可以追溯到几十年前的事实。然后并没有使用 IDE 的优势，比如更好的功能可见性和更快的操作，而是在其他地方使用现代化编程技术。他们坚持守旧派编程：</p>\n<ul>\n<li>没有测试。至少，没有自动化和系统化的测试。</li>\n<li>在一个具体的设置上难以处理依赖关系。</li>\n<li>没有自动化。没有持续集成，没有自动化部署。</li>\n</ul>\n<p>他们编程就像我几十年前使用 Turbo Pascal 入门的时候。尽管 Turbo Pascal 有图形化用户界面（GUI），但它是非常古老的学校。</p>\n\r\n        \r\n        \r\n        \n    <div class=\"post-adds\">\n        <span data-post-id=\"112071\" class=\" btn-bluet-bigger href-style vote-post-up   register-user-only \"><i class=\"fa  fa-thumbs-o-up\"></i> <h10 id=\"112071votetotal\">1</h10> 赞</span>\n        <span data-book-type=\"1\" data-site-id=\"2\" data-item-id=\"112071\" data-item-type=\"1\" class=\" btn-bluet-bigger href-style bookmark-btn  register-user-only \"><i class=\"fa fa-bookmark-o  \"></i>  收藏</span>\n\n                    <a href=\"#article-comment\"><span class=\"btn-bluet-bigger href-style hide-on-480\"><i class=\"fa fa-comments-o\"></i> 4 评论</span></a>\n        \n        \n        \n        <!-- JiaThis Button BEGIN -->\n        <div class=\"jiathis_style_24x24\" style=\"display: inline-flex; position: relative; margin: 0; clear: both;float: right;\">\n            <a class=\"jiathis_button_tsina\"></a>\n            <a class=\"jiathis_button_weixin\"></a>\n            <a class=\"jiathis_button_qzone\"></a>\n            <a class=\"jiathis_button_fb hide-on-480\"></a>\n            <a href=\"http://www.jiathis.com/share?uid=1745061\" class=\"jiathis jiathis_txt jiathis_separator jtico jtico_jiathis\" target=\"_blank\"></a>\n        </div>\n\n    </div>\n\n\n\n\r\n        <!-- BEGIN #author-bio -->\r\n\r\n<div id=\"author-bio\">\r\n\t\r\n\t<h3 class=\"widget-title\">\r\n\t关于作者：<a target=\"_blank\" href=\"http://www.jobbole.com/members/young605867996\">Lada</a>\r\n\t</h3>\r\n\t<div class=\"alignleft\">\r\n\t\t<a target=\"_blank\" href=\"http://www.jobbole.com/members/young605867996\">\r\n\t\t\t<img src=\"http://q.qlogo.cn/qqapp/208656/B77EEB9D520DE9C7BD42E89DC348FEC7/100\">\r\n\t\t</a>\r\n\t</div>\r\n\r\n    <div class=\"author-bio-info\">\r\n\r\n        <span class=\"author-bio-info-block\">\r\n            希望了解更多互联网、创业管理、创新思维、前沿技术和设计的知识。渐进明细，持续改进。        </span>\r\n        <span class=\"author-bio-info-block\">\r\n            <a href=\"http://www.jobbole.com/members/young605867996\" target=\"_blank\"><i class=\"fa fa-user\"></i> 个人主页</a> ·\r\n            <a href=\"http://blog.jobbole.com/author/young605867996/\" target=\"_blank\"><i class=\"fa fa-file-text-o\"></i> 我的文章</a>\r\n\r\n             · <a title=\"声望值\" target=\"_blank\" href=\"http://www.jobbole.com/members/young605867996/reputation/\"><i class=\"fa fa-graduation-cap\"></i> 12</a> · <a title=\"我的网站\" target=\"_blank\" href=\"http://littlejanery.blog.163.com/\"><i class=\"fa fa-link\"></i></a> <a title=\"QQ：605867996\" target=\"_blank\" href=\"#\"><i class=\"fa fa-qq\"></i></a> <a title=\"个人微信：yao605867996\" target=\"_blank\" href=\"#\"><i class=\"fa fa-weixin\"></i></a>         </span>\r\n    </div>\r\n\t<div class=\"clear\"></div>\r\n</div>\r\n\r\n<!-- END #author-bio -->\r\n\t</div>", "front_image_path": ["full/5f238582dbf0b714b52f3962d63e9366875164d0.jpg"]},{"title": "文件系统层次标准（FHS）简介", "url": "http://blog.jobbole.com/112121/", "url_object_id": "64bab342f98a484b9b0d9637e345bc4d", "create_date": "2017/08/07", "front_image_url": ["http://jbcdn2.b0.upaiyun.com/2016/11/59d49abe8909a122bc2c9aa43b71e3bb.png"], "praise_nums": "1", "fav_nums": "4", "comment_nums": 0, "tags": "IT技术,Linux,文件系统", "content": "<div class=\"entry\">\r\n\r\n        \t\t\t<div class=\"textwidget\"></div>\n\t\t\r\n\t\t<div class=\"copyright-area\">原文出处： <a ref=\"nofollow\" target=\"_blank\" href=\"http://www.linuxinsider.com/story/84658.html\">Jonathan Terrasi</a>   译文出处：<a target=\"_blank\" href=\"https://linux.cn/article-8757-1.html\">Linux中国/firmianay</a>   </div><p>当你好奇地看着系统的根目录（<code>/</code>）的时候，可能会发现自己有点不知所措。大多数三个字母的目录名称并没有告诉你它们是做什么的，如果你需要做出一些重要的修改，那就很难知道在哪里可以查看。</p>\n<p>我想给那些没有深入了解过自己的根目录的人简单地介绍下它。</p>\n<h3 id=\"toc_1\">有用的工具</h3>\n<p>在我们开始之前，这里有几个需要熟悉的工具，它们可以让您随时挖掘那些您自己找到的有趣的东西。这些程序都不会对您的文件进行任何更改。</p>\n<p>最有用的工具是 <code>ls</code> — 它列出了使用完整路径或相对路径（即从当前目录开始的路径）作为参数给出的任何目录的内容。</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-599373d594314450630980\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" touchscreen minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\n$ ls 路径\r\n</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-599373d594314450630980-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599373d594314450630980-2\">2</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-599373d594314450630980-1\"><span class=\"crayon-sy\">$</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">ls</span><span class=\"crayon-h\"> </span>路径</div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599373d594314450630980-2\"> </div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0004 seconds] -->\r\n<p>当您进一步深入文件系统时，重复输入长路径可能会变得很麻烦，所以如果您想简化这一操作，可以用 <code>cd</code> 替换 <code>ls</code> 来更改当前的工作目录到该目录。与 <code>ls</code> 一样，只需将目录路径作为 <code>cd</code> 的参数。</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-599373d59431f434078505\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" touchscreen minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\n$ cd 路径\r\n</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-599373d59431f434078505-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599373d59431f434078505-2\">2</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-599373d59431f434078505-1\"><span class=\"crayon-sy\">$</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">cd</span><span class=\"crayon-h\"> </span>路径</div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599373d59431f434078505-2\"> </div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0003 seconds] -->\r\n<p>如果您不确定某个文件是什么文件类型的，可以通过运行 <code>file</code> 并且将文件名作为 <code>file</code> 命令的参数。</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-599373d594323962605542\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" touchscreen minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\n$ file 文件名\r\n</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-599373d594323962605542-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599373d594323962605542-2\">2</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-599373d594323962605542-1\"><span class=\"crayon-sy\">$</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">file</span><span class=\"crayon-h\"> </span>文件名</div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599373d594323962605542-2\"> </div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0003 seconds] -->\r\n<p>最后，如果这个文件看起来像是适宜阅读的，那么用 <code>less</code> 来看看（不用担心文件有改变）。与最后一个工具一样，给出一个文件名作为参数来查看它。</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-599373d594326494309533\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" touchscreen minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\n$ less 文件名\r\n</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-599373d594326494309533-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599373d594326494309533-2\">2</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-599373d594326494309533-1\"><span class=\"crayon-sy\">$</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">less</span><span class=\"crayon-h\"> </span>文件名</div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599373d594326494309533-2\"> </div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0003 seconds] -->\r\n<p>完成文件翻阅后，点击 <code>q</code> 键退出，即可返回到您的终端。</p>\n<h3 id=\"toc_2\">根目录之旅</h3>\n<p>现在就开始我们的旅程。我将按照字母顺序介绍直接放在根目录下的目录。这里并没有介绍所有的目录，但到最后，我们会突出其中的亮点。</p>\n<p>我们所有要遍历的目录的分类及功能都基于 Linux 的文件系统层次标准（FHS）。<a href=\"http://www.linuxfoundation.org/\">Linux 基金会</a>维护的 Linux FHS 帮助发行版和程序的设计者和开发人员来规划他们的工具的各个组件应该存放的位置。</p>\n<p>通过将各个程序的所有文件、二进制文件和帮助手册保存在一致的组织结构中，FHS 让对它们的学习、调试或修改更加容易。想象一下，如果不是使用 <code>man</code> 命令找到使用指南，那么你就得对每个程序分别寻找其手册。</p>\n<p>按照字母顺序和结构顺序，我们从 <code>/bin</code> 开始。该目录是存放所有核心系统二进制文件的地方，其包含的命令可以在 shell （解释终端指令的程序）中使用。没有这个目录的内容，你的系统就基本没法使用。</p>\n<p>接下来是 <code>/boot</code> 目录，它存储了您的计算机启动所需的所有东西。其中最重要的是引导程序和内核。引导程序是一个通过初始化一些基础工具，使引导过程得以继续的程序。在初始化结束时，引导程序会加载内核，内核允许计算机与所有其它硬件和固件进行接口。从这一点看，它可以使整个操作系统工作起来。</p>\n<p><code>/dev</code> 目录用于存储类似文件的对象来表示被系统识别为“设备”的各种东西。这里包括许多显式的设备，如计算机的硬件组件：键盘、屏幕、硬盘驱动器等。</p>\n<p>此外，<code>/dev</code> 还包含被系统视为“设备”的数据流的伪文件。一个例子是流入和流出您的终端的数据，可以分为三个“流”。它读取的信息被称为“标准输入”。命令或进程的输出是“标准输出”。最后，被分类为调试信息的辅助性输出指向到“标准错误”。终端本身作为文件也可以在这里找到。</p>\n<p><code>/etc</code>（发音类似工艺商业网站 “Etsy”，如果你想让 Linux 老用户惊艳一下的话，囧），许多程序在这里存储它们的配置文件，用于改变它们的设置。一些程序存储这里的是默认配置的副本，这些副本将在修改之前复制到另一个位置。其它的程序在这里存储配置的唯一副本，并期望用户可以直接修改。为 root 用户保留的许多程序常用一种配置模式。</p>\n<p><code>/home</code> 目录是用户个人文件所在的位置。对于桌面用户来说，这是您花费大部分时间的地方。对于每个非特权用户，这里都有一个具有相应名称的目录。</p>\n<p><code>/lib</code> 是您的系统赖以运行的许多库的所在地。许多程序都会重复使用一个或多个功能或子程序，它们经常会出现在几十上百个程序中。所以，如果每个程序在其二进制文件中重复写它需要的每一个组件，结果会是产生出一些大而无当的程序，作为更好的替代方案，我们可以通过进行“库调用”来引用这些库中的一个或多个。</p>\n<p>在 <code>/media</code> 目录中可以访问像 USB 闪存驱动器或摄像机这样的可移动媒体。虽然它并不是所有系统上都有，但在一些专注于直观的桌面系统中还是比较普遍的，如 Ubuntu。具有存储能力的媒体在此处被“挂载”，这意味着当设备中的原始位流位于 <code>/dev</code> 目录下时，用户通常可以在这里访问那些可交互的文件对象。</p>\n<p><code>/proc</code> 目录是一个动态显示系统数据的虚拟文件系统。这意味着系统可以即时地创建 <code>/proc</code> 的内容，用包含运行时生成的系统信息（如硬件统计信息）的文件进行填充。</p>\n<p><code>/tmp</code> 正如其名字，用于放置缓存数据等临时信息。这个目录不做其他更多的事情。</p>\n<p>现代 Linux 系统上大多数程序的二进制文件保存在 <code>/usr</code> 目录中。为了统一包含二进制文件的各种目录，<code>/usr</code> 包含 <code>/bin</code>、<code>/sbin</code> 和 <code>/lib</code> 中的所有内容的副本。</p>\n<p>最后，<code>/var</code> 里保存“可变variable”长度的数据。这里的可变长度数据的类型通常是会累积的数据，就像日志和缓存一样。一个例子是你的内核保留的日志。</p>\n<p>为了避免硬盘空间用尽和崩溃的情况，<code>/var</code> 内置了“日志旋转”功能，可删除旧信息，为新信息腾出空间，维持固定的最大大小。</p>\n<h3 id=\"toc_3\">结尾</h3>\n<p>正如我所说，这里介绍的绝对不是您在根目录中可以找到的一切，但是确定系统核心功能所在地是一个很好的开始，而且可以更深入地研究这些功能是什么。</p>\n<p>所以，如果你不知道要学习什么，就可能有很多的想法。如果你想得到一个更好的想法，就在这些目录中折腾自己吧！</p>\n<hr>\n<p>作者简介：</p>\n<p>自 2017 年以来 Jonathan Terrasi 一直是 ECT 新闻网的专栏作家。他的主要兴趣是计算机安全（特别是 Linux 桌面），加密和分析政治和时事。他是全职自由作家和音乐家。他的背景包括在芝加哥委员会发表的保卫人权法案文章中提供技术评论和分析。</p>\n\r\n        \r\n        \r\n        \n    <div class=\"post-adds\">\n        <span data-post-id=\"112121\" class=\" btn-bluet-bigger href-style vote-post-up   register-user-only \"><i class=\"fa  fa-thumbs-o-up\"></i> <h10 id=\"112121votetotal\">1</h10> 赞</span>\n        <span data-book-type=\"1\" data-site-id=\"2\" data-item-id=\"112121\" data-item-type=\"1\" class=\" btn-bluet-bigger href-style bookmark-btn  register-user-only \"><i class=\"fa fa-bookmark-o  \"></i> 4 收藏</span>\n\n                    <a href=\"#article-comment\"><span class=\"btn-bluet-bigger href-style hide-on-480\"><i class=\"fa fa-comments-o\"></i>  评论</span></a>\n        \n        \n        \n        <!-- JiaThis Button BEGIN -->\n        <div class=\"jiathis_style_24x24\" style=\"display: inline-flex; position: relative; margin: 0; clear: both;float: right;\">\n            <a class=\"jiathis_button_tsina\"></a>\n            <a class=\"jiathis_button_weixin\"></a>\n            <a class=\"jiathis_button_qzone\"></a>\n            <a class=\"jiathis_button_fb hide-on-480\"></a>\n            <a href=\"http://www.jiathis.com/share?uid=1745061\" class=\"jiathis jiathis_txt jiathis_separator jtico jtico_jiathis\" target=\"_blank\"></a>\n        </div>\n\n    </div>\n\n\n\n\r\n        <!-- BEGIN #author-bio -->\r\n\r\n\r\n<!-- END #author-bio -->\r\n\t</div>", "front_image_path": ["full/d3d1a5ad957de059084690efae6fdfaa3527e1c3.jpg"]},{"title": "用 C 语言写一个简单的 Unix Shell（2）", "url": "http://blog.jobbole.com/112126/", "url_object_id": "faa6574efe8657b757ee0f2971764f70", "create_date": "2017/08/08", "front_image_url": ["https://indradhanush.github.io/images/shell-part-2/execvp.jpg"], "praise_nums": "2", "fav_nums": "5", "comment_nums": 0, "tags": "C/C++,其他,shell,Unix", "content": "<div class=\"entry\">\r\n\r\n        \t\t\t<div class=\"textwidget\"></div>\n\t\t\r\n\t\t<div class=\"copyright-area\">本文由 <a href=\"http://blog.jobbole.com\">伯乐在线</a> - <a href=\"http://www.jobbole.com/members/qdoverture\">效楚</a> 翻译，<a href=\"http://www.jobbole.com/members/upanblack\">Panblack</a> 校稿。未经许可，禁止转载！<br>英文出处：<a target=\"_blank\" href=\"https://indradhanush.github.io/blog/writing-a-unix-shell-part-2/\">indradhanush.github.io</a>。欢迎加入<a target=\"_blank\" href=\"http://group.jobbole.com/category/feedback/trans-team/\">翻译组</a>。</div><p><a href=\"http://blog.jobbole.com/111738/\" target=\"_blank\">在第一部分中我们讨论了 <code>fork</code> 系统调用以及它的注意事项</a>。在本文中，我们将研究怎样执行命令。</p>\n<h3>这里将介绍 <code>exec</code> 函数家族。即以下函数：</h3>\n<ul>\n<li><code>execl</code></li>\n<li><code>execv</code></li>\n<li><code>execle</code></li>\n<li><code>execve</code></li>\n<li><code>execlp</code></li>\n<li><code>execvp</code></li>\n</ul>\n<p>为了满足需要，我们将使用 <code>execvp</code>，它的签名看起来像这样：</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-59943aaad243b477242050\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-always\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"复制代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div><span class=\"crayon-language\">C</span></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\nint execvp(const char *file, char *const argv[]);</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-59943aaad243b477242050-1\">1</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-59943aaad243b477242050-1\"><span class=\"crayon-t\">int</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">execvp</span><span class=\"crayon-sy\">(</span><span class=\"crayon-r\">const</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">char</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">*</span><span class=\"crayon-v\">file</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">char</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">*</span><span class=\"crayon-r\">const</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">argv</span><span class=\"crayon-sy\">[</span><span class=\"crayon-sy\">]</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0008 seconds] -->\r\n<p>函数名中的 <code>vp</code> 表明：它接受一个文件名，将在系统 $PATH 变量中搜索此文件名，它还接受将要执行的一组参数。</p>\n<p>你可以阅读 <a href=\"https://linux.die.net/man/3/exec\">exec 的 man 页面</a> 以得到其它函数的更多信息。</p>\n<p>让我们看一下以下代码，它执行命令 <code>ls -l -h -a</code>：</p>\n<p><a href=\"https://indradhanush.github.io/code/shell-part-2/execvp.c\">execvp.c</a></p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-59943aaad2446054478230\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-always\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"复制代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div><span class=\"crayon-language\">C</span></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\n#include &lt;unistd.h&gt;\r\n\r\nint main() {\r\n    char *argv[] = {\"ls\", \"-l\", \"-h\", \"-a\", NULL};\r\n    execvp(argv[0], argv);\r\n\r\n    return 0;\r\n}</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-59943aaad2446054478230-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59943aaad2446054478230-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-59943aaad2446054478230-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59943aaad2446054478230-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-59943aaad2446054478230-5\">5</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59943aaad2446054478230-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-59943aaad2446054478230-7\">7</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59943aaad2446054478230-8\">8</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-59943aaad2446054478230-1\"><span class=\"crayon-p\">#include &lt;unistd.h&gt;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59943aaad2446054478230-2\"> </div><div class=\"crayon-line\" id=\"crayon-59943aaad2446054478230-3\"><span class=\"crayon-t\">int</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">main</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59943aaad2446054478230-4\"><span class=\"crayon-h\">    </span><span class=\"crayon-t\">char</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">*</span><span class=\"crayon-v\">argv</span><span class=\"crayon-sy\">[</span><span class=\"crayon-sy\">]</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span><span class=\"crayon-s\">\"ls\"</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">\"-l\"</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">\"-h\"</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">\"-a\"</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">NULL</span><span class=\"crayon-sy\">}</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-59943aaad2446054478230-5\"><span class=\"crayon-h\">    </span><span class=\"crayon-e\">execvp</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">argv</span><span class=\"crayon-sy\">[</span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">]</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">argv</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59943aaad2446054478230-6\"> </div><div class=\"crayon-line\" id=\"crayon-59943aaad2446054478230-7\"><span class=\"crayon-h\">    </span><span class=\"crayon-st\">return</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59943aaad2446054478230-8\"><span class=\"crayon-sy\">}</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0013 seconds] -->\r\n<p>关于 <code>execvp</code> 函数，有几点需要注意：</p>\n<ol>\n<li>第一个参数是命令名。</li>\n<li>第二个参数由命令名和传递给命令自身的参数组成。并且它必须以 <code>NULL</code> 结束。</li>\n<li>它将当前进程的映像交换为被执行的命令的映像，后面再展开说明。</li>\n</ol>\n<p>如果你编译并执行上面的代码，你会看到类似于下面的输出：</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-59943aaad244b188280959\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-always\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"复制代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\ntotal 32\r\ndrwxr-xr-x  5 dhanush  staff   170B Jun 11 11:32 .\r\ndrwxr-xr-x  4 dhanush  staff   136B Jun 11 11:30 ..\r\n-rwxr-xr-x  1 dhanush  staff   8.7K Jun 11 11:32 a.out\r\ndrwxr-xr-x  3 dhanush  staff   102B Jun 11 11:32 a.out.dSYM\r\n-rw-r--r--  1 dhanush  staff   130B Jun 11 11:32</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-59943aaad244b188280959-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59943aaad244b188280959-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-59943aaad244b188280959-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59943aaad244b188280959-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-59943aaad244b188280959-5\">5</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59943aaad244b188280959-6\">6</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-59943aaad244b188280959-1\"><span class=\"crayon-i\">total</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">32</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59943aaad244b188280959-2\"><span class=\"crayon-v\">drwxr</span><span class=\"crayon-o\">-</span><span class=\"crayon-v\">xr</span><span class=\"crayon-o\">-</span><span class=\"crayon-i\">x</span><span class=\"crayon-h\">  </span><span class=\"crayon-cn\">5</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">dhanush  </span><span class=\"crayon-i\">staff</span><span class=\"crayon-h\">   </span><span class=\"crayon-cn\">170B</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">Jun</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">11</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">11</span><span class=\"crayon-o\">:</span><span class=\"crayon-cn\">32</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">.</span></div><div class=\"crayon-line\" id=\"crayon-59943aaad244b188280959-3\"><span class=\"crayon-v\">drwxr</span><span class=\"crayon-o\">-</span><span class=\"crayon-v\">xr</span><span class=\"crayon-o\">-</span><span class=\"crayon-i\">x</span><span class=\"crayon-h\">  </span><span class=\"crayon-cn\">4</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">dhanush  </span><span class=\"crayon-i\">staff</span><span class=\"crayon-h\">   </span><span class=\"crayon-cn\">136B</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">Jun</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">11</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">11</span><span class=\"crayon-o\">:</span><span class=\"crayon-cn\">30</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59943aaad244b188280959-4\"><span class=\"crayon-o\">-</span><span class=\"crayon-v\">rwxr</span><span class=\"crayon-o\">-</span><span class=\"crayon-v\">xr</span><span class=\"crayon-o\">-</span><span class=\"crayon-i\">x</span><span class=\"crayon-h\">  </span><span class=\"crayon-cn\">1</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">dhanush  </span><span class=\"crayon-i\">staff</span><span class=\"crayon-h\">   </span><span class=\"crayon-cn\">8.7K</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">Jun</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">11</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">11</span><span class=\"crayon-o\">:</span><span class=\"crayon-cn\">32</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">a</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">out</span></div><div class=\"crayon-line\" id=\"crayon-59943aaad244b188280959-5\"><span class=\"crayon-v\">drwxr</span><span class=\"crayon-o\">-</span><span class=\"crayon-v\">xr</span><span class=\"crayon-o\">-</span><span class=\"crayon-i\">x</span><span class=\"crayon-h\">  </span><span class=\"crayon-cn\">3</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">dhanush  </span><span class=\"crayon-i\">staff</span><span class=\"crayon-h\">   </span><span class=\"crayon-cn\">102B</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">Jun</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">11</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">11</span><span class=\"crayon-o\">:</span><span class=\"crayon-cn\">32</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">a</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">out</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">dSYM</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59943aaad244b188280959-6\"><span class=\"crayon-o\">-</span><span class=\"crayon-v\">rw</span><span class=\"crayon-o\">-</span><span class=\"crayon-v\">r</span><span class=\"crayon-o\">--</span><span class=\"crayon-v\">r</span><span class=\"crayon-o\">--</span><span class=\"crayon-h\">  </span><span class=\"crayon-cn\">1</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">dhanush  </span><span class=\"crayon-i\">staff</span><span class=\"crayon-h\">   </span><span class=\"crayon-cn\">130B</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">Jun</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">11</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">11</span><span class=\"crayon-o\">:</span><span class=\"crayon-cn\">32</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0025 seconds] -->\r\n<p>它和你在你的主 shell 中手动执行<code>ls -l -h -a</code>的结果完全相同。</p>\n<p>既然我们能执行命令了，我们需要使用在<a href=\"http://blog.jobbole.com/111738/\">第一部分</a>中学到的<code>fork</code> 系统调用构建有用的东西。事实上我们要做到以下这些：</p>\n<ol>\n<li>当用户输入时接受命令。</li>\n<li>调用 <code>fork</code> 以创建一个子进程。</li>\n<li>在子进程中执行命令，同时父进程等待命令完成。</li>\n<li>回到第一步。</li>\n</ol>\n<p>我们看看下面的函数，它接收一个字符串作为<code>输入</code>。我们使用库函数 <code>strtok</code> 以<code>空格</code>分割该字符串，然后返回一个字符串数组，数组也用 <code>NULL</code>来终结。</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-59943aaad2451046273604\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-always\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"复制代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div><span class=\"crayon-language\">C</span></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\ninclude &lt;stdlib.h&gt;\r\n#include &lt;string.h&gt;\r\n\r\nchar **get_input(char *input) {\r\n    char **command = malloc(8 * sizeof(char *));\r\n    char *separator = \" \";\r\n    char *parsed;\r\n    int index = 0;\r\n\r\n    parsed = strtok(input, separator);\r\n    while (parsed != NULL) {\r\n        command[index] = parsed;\r\n        index++;\r\n\r\n        parsed = strtok(NULL, separator);\r\n    }\r\n\r\n    command[index] = NULL;\r\n    return command;\r\n}</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-59943aaad2451046273604-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59943aaad2451046273604-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-59943aaad2451046273604-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59943aaad2451046273604-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-59943aaad2451046273604-5\">5</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59943aaad2451046273604-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-59943aaad2451046273604-7\">7</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59943aaad2451046273604-8\">8</div><div class=\"crayon-num\" data-line=\"crayon-59943aaad2451046273604-9\">9</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59943aaad2451046273604-10\">10</div><div class=\"crayon-num\" data-line=\"crayon-59943aaad2451046273604-11\">11</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59943aaad2451046273604-12\">12</div><div class=\"crayon-num\" data-line=\"crayon-59943aaad2451046273604-13\">13</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59943aaad2451046273604-14\">14</div><div class=\"crayon-num\" data-line=\"crayon-59943aaad2451046273604-15\">15</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59943aaad2451046273604-16\">16</div><div class=\"crayon-num\" data-line=\"crayon-59943aaad2451046273604-17\">17</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59943aaad2451046273604-18\">18</div><div class=\"crayon-num\" data-line=\"crayon-59943aaad2451046273604-19\">19</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59943aaad2451046273604-20\">20</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-59943aaad2451046273604-1\"><span class=\"crayon-v\">include</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-v\">stdlib</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">h</span><span class=\"crayon-o\">&gt;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59943aaad2451046273604-2\"><span class=\"crayon-p\">#include &lt;string.h&gt;</span></div><div class=\"crayon-line\" id=\"crayon-59943aaad2451046273604-3\"> </div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59943aaad2451046273604-4\"><span class=\"crayon-t\">char</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">*</span><span class=\"crayon-o\">*</span><span class=\"crayon-e\">get_input</span><span class=\"crayon-sy\">(</span><span class=\"crayon-t\">char</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">*</span><span class=\"crayon-v\">input</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-59943aaad2451046273604-5\"><span class=\"crayon-h\">    </span><span class=\"crayon-t\">char</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">*</span><span class=\"crayon-o\">*</span><span class=\"crayon-v\">command</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-r\">malloc</span><span class=\"crayon-sy\">(</span><span class=\"crayon-cn\">8</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">*</span><span class=\"crayon-h\"> </span><span class=\"crayon-r\">sizeof</span><span class=\"crayon-sy\">(</span><span class=\"crayon-t\">char</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">*</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59943aaad2451046273604-6\"><span class=\"crayon-h\">    </span><span class=\"crayon-t\">char</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">*</span><span class=\"crayon-v\">separator</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">\" \"</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-59943aaad2451046273604-7\"><span class=\"crayon-h\">    </span><span class=\"crayon-t\">char</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">*</span><span class=\"crayon-v\">parsed</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59943aaad2451046273604-8\"><span class=\"crayon-h\">    </span><span class=\"crayon-t\">int</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">index</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-59943aaad2451046273604-9\"> </div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59943aaad2451046273604-10\"><span class=\"crayon-h\">    </span><span class=\"crayon-v\">parsed</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">strtok</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">input</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">separator</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-59943aaad2451046273604-11\"><span class=\"crayon-h\">    </span><span class=\"crayon-st\">while</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">parsed</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">!=</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">NULL</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59943aaad2451046273604-12\"><span class=\"crayon-h\">        </span><span class=\"crayon-v\">command</span><span class=\"crayon-sy\">[</span><span class=\"crayon-v\">index</span><span class=\"crayon-sy\">]</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">parsed</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-59943aaad2451046273604-13\"><span class=\"crayon-h\">        </span><span class=\"crayon-v\">index</span><span class=\"crayon-o\">++</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59943aaad2451046273604-14\"> </div><div class=\"crayon-line\" id=\"crayon-59943aaad2451046273604-15\"><span class=\"crayon-h\">        </span><span class=\"crayon-v\">parsed</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">strtok</span><span class=\"crayon-sy\">(</span><span class=\"crayon-t\">NULL</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">separator</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59943aaad2451046273604-16\"><span class=\"crayon-h\">    </span><span class=\"crayon-sy\">}</span></div><div class=\"crayon-line\" id=\"crayon-59943aaad2451046273604-17\"> </div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59943aaad2451046273604-18\"><span class=\"crayon-h\">    </span><span class=\"crayon-v\">command</span><span class=\"crayon-sy\">[</span><span class=\"crayon-v\">index</span><span class=\"crayon-sy\">]</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">NULL</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-59943aaad2451046273604-19\"><span class=\"crayon-h\">    </span><span class=\"crayon-st\">return</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">command</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59943aaad2451046273604-20\"><span class=\"crayon-sy\">}</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0029 seconds] -->\r\n<p>如果该函数的<code>输入</code>是字符串 <code>\"ls -l -h -a\"</code>，那么函数将会创建这样形式的一个数组：<code>[\"ls\", \"-l\", \"-h\", \"-a\", NULL]</code>，并且返回指向此队列的指针。</p>\n<p>现在，我们在<code>主</code>函数中调用 <code>readline</code> 来读取用户的输入，并将它传给我们刚刚在上面定义的 <code>get_input</code>。一旦输入被解析，我们在子进程中调用 <code>fork</code> 和 <code>execvp</code>。在研究代码以前，看一下下面的图片，先理解 <code>execvp</code> 的含义：</p>\n<p><img class=\"aligncenter\" src=\"https://indradhanush.github.io/images/shell-part-2/execvp.jpg\" alt=\"\"></p>\n<p>当 <code>fork</code> 命令完成后，子进程是父进程的一份精确的拷贝。然而，当我们调用 <code>execvp</code> 时，它将当前程序替换为在参数中传递给它的程序。这意味着，虽然进程的当前文本、数据、堆栈段被替换了，进程 id 仍保持不变，但程序完全被覆盖了。如果调用成功了，那么 <code>execvp</code> 将不会返回，并且子进程中在这之后的任何代码都不会被执行。这里是<code>主</code>函数：</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-59943aaad2456853852214\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-always\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"复制代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div><span class=\"crayon-language\">C</span></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\n#include &lt;stdlib.h&gt;\r\n#include &lt;stdio.h&gt;\r\n#include &lt;string.h&gt;\r\n#include &lt;readline/readline.h&gt;\r\n#include &lt;unistd.h&gt;\r\n#include &lt;sys/wait.h&gt;\r\n\r\nint main() {\r\n    char **command;\r\n    char *input;\r\n    pid_t child_pid;\r\n    int stat_loc;\r\n\r\n    while (1) {\r\n        input = readline(\"unixsh&gt; \");\r\n        command = get_input(input);\r\n\r\n        child_pid = fork();\r\n        if (child_pid == 0) {\r\n            /* Never returns if the call is successful */\r\n            execvp(command[0], command);\r\n            printf(\"This won't be printed if execvp is successuln\");\r\n        } else {\r\n            waitpid(child_pid, &amp;stat_loc, WUNTRACED);\r\n        }\r\n\r\n        free(input);\r\n        free(command);\r\n    }\r\n\r\n    return 0;\r\n}</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-59943aaad2456853852214-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59943aaad2456853852214-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-59943aaad2456853852214-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59943aaad2456853852214-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-59943aaad2456853852214-5\">5</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59943aaad2456853852214-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-59943aaad2456853852214-7\">7</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59943aaad2456853852214-8\">8</div><div class=\"crayon-num\" data-line=\"crayon-59943aaad2456853852214-9\">9</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59943aaad2456853852214-10\">10</div><div class=\"crayon-num\" data-line=\"crayon-59943aaad2456853852214-11\">11</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59943aaad2456853852214-12\">12</div><div class=\"crayon-num\" data-line=\"crayon-59943aaad2456853852214-13\">13</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59943aaad2456853852214-14\">14</div><div class=\"crayon-num\" data-line=\"crayon-59943aaad2456853852214-15\">15</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59943aaad2456853852214-16\">16</div><div class=\"crayon-num\" data-line=\"crayon-59943aaad2456853852214-17\">17</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59943aaad2456853852214-18\">18</div><div class=\"crayon-num\" data-line=\"crayon-59943aaad2456853852214-19\">19</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59943aaad2456853852214-20\">20</div><div class=\"crayon-num\" data-line=\"crayon-59943aaad2456853852214-21\">21</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59943aaad2456853852214-22\">22</div><div class=\"crayon-num\" data-line=\"crayon-59943aaad2456853852214-23\">23</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59943aaad2456853852214-24\">24</div><div class=\"crayon-num\" data-line=\"crayon-59943aaad2456853852214-25\">25</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59943aaad2456853852214-26\">26</div><div class=\"crayon-num\" data-line=\"crayon-59943aaad2456853852214-27\">27</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59943aaad2456853852214-28\">28</div><div class=\"crayon-num\" data-line=\"crayon-59943aaad2456853852214-29\">29</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59943aaad2456853852214-30\">30</div><div class=\"crayon-num\" data-line=\"crayon-59943aaad2456853852214-31\">31</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59943aaad2456853852214-32\">32</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-59943aaad2456853852214-1\"><span class=\"crayon-p\">#include &lt;stdlib.h&gt;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59943aaad2456853852214-2\"><span class=\"crayon-p\">#include &lt;stdio.h&gt;</span></div><div class=\"crayon-line\" id=\"crayon-59943aaad2456853852214-3\"><span class=\"crayon-p\">#include &lt;string.h&gt;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59943aaad2456853852214-4\"><span class=\"crayon-p\">#include &lt;readline/readline.h&gt;</span></div><div class=\"crayon-line\" id=\"crayon-59943aaad2456853852214-5\"><span class=\"crayon-p\">#include &lt;unistd.h&gt;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59943aaad2456853852214-6\"><span class=\"crayon-p\">#include &lt;sys/wait.h&gt;</span></div><div class=\"crayon-line\" id=\"crayon-59943aaad2456853852214-7\"> </div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59943aaad2456853852214-8\"><span class=\"crayon-t\">int</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">main</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-59943aaad2456853852214-9\"><span class=\"crayon-h\">    </span><span class=\"crayon-t\">char</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">*</span><span class=\"crayon-o\">*</span><span class=\"crayon-v\">command</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59943aaad2456853852214-10\"><span class=\"crayon-h\">    </span><span class=\"crayon-t\">char</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">*</span><span class=\"crayon-v\">input</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-59943aaad2456853852214-11\"><span class=\"crayon-h\">    </span><span class=\"crayon-e\">pid_t </span><span class=\"crayon-v\">child_pid</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59943aaad2456853852214-12\"><span class=\"crayon-h\">    </span><span class=\"crayon-t\">int</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">stat_loc</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-59943aaad2456853852214-13\"> </div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59943aaad2456853852214-14\"><span class=\"crayon-h\">    </span><span class=\"crayon-st\">while</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-cn\">1</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-59943aaad2456853852214-15\"><span class=\"crayon-h\">        </span><span class=\"crayon-v\">input</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">readline</span><span class=\"crayon-sy\">(</span><span class=\"crayon-s\">\"unixsh&gt; \"</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59943aaad2456853852214-16\"><span class=\"crayon-h\">        </span><span class=\"crayon-v\">command</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">get_input</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">input</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-59943aaad2456853852214-17\"> </div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59943aaad2456853852214-18\"><span class=\"crayon-h\">        </span><span class=\"crayon-v\">child_pid</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">fork</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-59943aaad2456853852214-19\"><span class=\"crayon-h\">        </span><span class=\"crayon-st\">if</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">child_pid</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">==</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59943aaad2456853852214-20\"><span class=\"crayon-h\">            </span><span class=\"crayon-c\">/* Never returns if the call is successful */</span></div><div class=\"crayon-line\" id=\"crayon-59943aaad2456853852214-21\"><span class=\"crayon-h\">            </span><span class=\"crayon-e\">execvp</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">command</span><span class=\"crayon-sy\">[</span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">]</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">command</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59943aaad2456853852214-22\"><span class=\"crayon-h\">            </span><span class=\"crayon-r\">printf</span><span class=\"crayon-sy\">(</span><span class=\"crayon-s\">\"This won't be printed if execvp is successuln\"</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-59943aaad2456853852214-23\"><span class=\"crayon-h\">        </span><span class=\"crayon-sy\">}</span><span class=\"crayon-h\"> </span><span class=\"crayon-st\">else</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59943aaad2456853852214-24\"><span class=\"crayon-h\">            </span><span class=\"crayon-e\">waitpid</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">child_pid</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">&amp;</span><span class=\"crayon-v\">stat_loc</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">WUNTRACED</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-59943aaad2456853852214-25\"><span class=\"crayon-h\">        </span><span class=\"crayon-sy\">}</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59943aaad2456853852214-26\"> </div><div class=\"crayon-line\" id=\"crayon-59943aaad2456853852214-27\"><span class=\"crayon-h\">        </span><span class=\"crayon-e\">free</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">input</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59943aaad2456853852214-28\"><span class=\"crayon-h\">        </span><span class=\"crayon-e\">free</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">command</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-59943aaad2456853852214-29\"><span class=\"crayon-h\">    </span><span class=\"crayon-sy\">}</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59943aaad2456853852214-30\"> </div><div class=\"crayon-line\" id=\"crayon-59943aaad2456853852214-31\"><span class=\"crayon-h\">    </span><span class=\"crayon-st\">return</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59943aaad2456853852214-32\"><span class=\"crayon-sy\">}</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0032 seconds] -->\r\n<p>全部代码可在<a href=\"https://indradhanush.github.io/code/shell-part-2/shell.c\">此处</a>的单个文件中获取。如果你用 <code>gcc -g -lreadline shell.c</code> 编译它，并执行二进制文件，你会得到一个最小的可工作 shell，你可以用它来运行系统命令，比如 <code>pwd</code> 和 <code>ls -lha</code>：</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-59943aaad245a007541585\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-always\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"复制代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\nunixsh&gt; pwd\r\n/Users/dhanush/github.com/indradhanush.github.io/code/shell-part-2\r\nunixsh&gt; ls -lha\r\ntotal 28K\r\ndrwxr-xr-x 6 root root  204 Jun 11 18:27 .\r\ndrwxr-xr-x 3 root root 4.0K Jun 11 16:50 ..\r\n-rwxr-xr-x 1 root root  16K Jun 11 18:27 a.out\r\ndrwxr-xr-x 3 root root  102 Jun 11 15:32 a.out.dSYM\r\n-rw-r--r-- 1 root root  130 Jun 11 15:38 execvp.c\r\n-rw-r--r-- 1 root root  997 Jun 11 18:25 shell.c\r\nunixsh&gt;</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-59943aaad245a007541585-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59943aaad245a007541585-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-59943aaad245a007541585-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59943aaad245a007541585-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-59943aaad245a007541585-5\">5</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59943aaad245a007541585-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-59943aaad245a007541585-7\">7</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59943aaad245a007541585-8\">8</div><div class=\"crayon-num\" data-line=\"crayon-59943aaad245a007541585-9\">9</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59943aaad245a007541585-10\">10</div><div class=\"crayon-num\" data-line=\"crayon-59943aaad245a007541585-11\">11</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-59943aaad245a007541585-1\"><span class=\"crayon-v\">unixsh</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">pwd</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59943aaad245a007541585-2\"><span class=\"crayon-o\">/</span><span class=\"crayon-v\">Users</span><span class=\"crayon-o\">/</span><span class=\"crayon-v\">dhanush</span><span class=\"crayon-o\">/</span><span class=\"crayon-v\">github</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">com</span><span class=\"crayon-o\">/</span><span class=\"crayon-v\">indradhanush</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">github</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">io</span><span class=\"crayon-o\">/</span><span class=\"crayon-v\">code</span><span class=\"crayon-o\">/</span><span class=\"crayon-v\">shell</span><span class=\"crayon-o\">-</span><span class=\"crayon-v\">part</span><span class=\"crayon-o\">-</span><span class=\"crayon-cn\">2</span></div><div class=\"crayon-line\" id=\"crayon-59943aaad245a007541585-3\"><span class=\"crayon-v\">unixsh</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">ls</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-</span><span class=\"crayon-e\">lha</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59943aaad245a007541585-4\"><span class=\"crayon-i\">total</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">28K</span></div><div class=\"crayon-line\" id=\"crayon-59943aaad245a007541585-5\"><span class=\"crayon-v\">drwxr</span><span class=\"crayon-o\">-</span><span class=\"crayon-v\">xr</span><span class=\"crayon-o\">-</span><span class=\"crayon-i\">x</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">6</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">root </span><span class=\"crayon-i\">root</span><span class=\"crayon-h\">  </span><span class=\"crayon-cn\">204</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">Jun</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">11</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">18</span><span class=\"crayon-o\">:</span><span class=\"crayon-cn\">27</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">.</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59943aaad245a007541585-6\"><span class=\"crayon-v\">drwxr</span><span class=\"crayon-o\">-</span><span class=\"crayon-v\">xr</span><span class=\"crayon-o\">-</span><span class=\"crayon-i\">x</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">3</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">root </span><span class=\"crayon-i\">root</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">4.0K</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">Jun</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">11</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">16</span><span class=\"crayon-o\">:</span><span class=\"crayon-cn\">50</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span></div><div class=\"crayon-line\" id=\"crayon-59943aaad245a007541585-7\"><span class=\"crayon-o\">-</span><span class=\"crayon-v\">rwxr</span><span class=\"crayon-o\">-</span><span class=\"crayon-v\">xr</span><span class=\"crayon-o\">-</span><span class=\"crayon-i\">x</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">1</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">root </span><span class=\"crayon-i\">root</span><span class=\"crayon-h\">  </span><span class=\"crayon-cn\">16K</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">Jun</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">11</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">18</span><span class=\"crayon-o\">:</span><span class=\"crayon-cn\">27</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">a</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">out</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59943aaad245a007541585-8\"><span class=\"crayon-v\">drwxr</span><span class=\"crayon-o\">-</span><span class=\"crayon-v\">xr</span><span class=\"crayon-o\">-</span><span class=\"crayon-i\">x</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">3</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">root </span><span class=\"crayon-i\">root</span><span class=\"crayon-h\">  </span><span class=\"crayon-cn\">102</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">Jun</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">11</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">15</span><span class=\"crayon-o\">:</span><span class=\"crayon-cn\">32</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">a</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">out</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">dSYM</span></div><div class=\"crayon-line\" id=\"crayon-59943aaad245a007541585-9\"><span class=\"crayon-o\">-</span><span class=\"crayon-v\">rw</span><span class=\"crayon-o\">-</span><span class=\"crayon-v\">r</span><span class=\"crayon-o\">--</span><span class=\"crayon-v\">r</span><span class=\"crayon-o\">--</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">1</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">root </span><span class=\"crayon-i\">root</span><span class=\"crayon-h\">  </span><span class=\"crayon-cn\">130</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">Jun</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">11</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">15</span><span class=\"crayon-o\">:</span><span class=\"crayon-cn\">38</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">execvp</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">c</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59943aaad245a007541585-10\"><span class=\"crayon-o\">-</span><span class=\"crayon-v\">rw</span><span class=\"crayon-o\">-</span><span class=\"crayon-v\">r</span><span class=\"crayon-o\">--</span><span class=\"crayon-v\">r</span><span class=\"crayon-o\">--</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">1</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">root </span><span class=\"crayon-i\">root</span><span class=\"crayon-h\">  </span><span class=\"crayon-cn\">997</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">Jun</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">11</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">18</span><span class=\"crayon-o\">:</span><span class=\"crayon-cn\">25</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">shell</span><span class=\"crayon-sy\">.</span><span class=\"crayon-i\">c</span></div><div class=\"crayon-line\" id=\"crayon-59943aaad245a007541585-11\"><span class=\"crayon-v\">unixsh</span><span class=\"crayon-o\">&gt;</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0038 seconds] -->\r\n<p>注意：<code>fork</code> 只有在用户输入命令后才被调用，这意味着接受用户输入的用户提示符是父进程。</p>\n<h2>错误处理</h2>\n<p>到目前为止，我们一直假设我们的命令总会完美的运行，还没有处理错误。所以我们要对 <a href=\"https://indradhanush.github.io/code/shell-part-2/shell.c\">shell.c</a>做一点改动：</p>\n<ul>\n<li><strong>fork</strong> – 如果操作系统内存耗尽或是进程数量已经到了允许的最大值，子进程就无法创建，会返回 -1。我们在代码里加上以下内容：</li>\n</ul>\n<p></p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-59943aaad2460938173317\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-always\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"复制代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div><span class=\"crayon-language\">C</span></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\n...\r\n    while (1) {\r\n        input = readline(\"unixsh&gt; \");\r\n        command = get_input(input);\r\n\r\n        child_pid = fork();\r\n        if (child_pid &lt; 0) {\r\n            perror(\"Fork failed\");\r\n            exit(1);\r\n        }\r\n    ...</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-59943aaad2460938173317-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59943aaad2460938173317-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-59943aaad2460938173317-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59943aaad2460938173317-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-59943aaad2460938173317-5\">5</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59943aaad2460938173317-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-59943aaad2460938173317-7\">7</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59943aaad2460938173317-8\">8</div><div class=\"crayon-num\" data-line=\"crayon-59943aaad2460938173317-9\">9</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59943aaad2460938173317-10\">10</div><div class=\"crayon-num\" data-line=\"crayon-59943aaad2460938173317-11\">11</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-59943aaad2460938173317-1\"><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59943aaad2460938173317-2\"><span class=\"crayon-h\">    </span><span class=\"crayon-st\">while</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-cn\">1</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-59943aaad2460938173317-3\"><span class=\"crayon-h\">        </span><span class=\"crayon-v\">input</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">readline</span><span class=\"crayon-sy\">(</span><span class=\"crayon-s\">\"unixsh&gt; \"</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59943aaad2460938173317-4\"><span class=\"crayon-h\">        </span><span class=\"crayon-v\">command</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">get_input</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">input</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-59943aaad2460938173317-5\"> </div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59943aaad2460938173317-6\"><span class=\"crayon-h\">        </span><span class=\"crayon-v\">child_pid</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">fork</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-59943aaad2460938173317-7\"><span class=\"crayon-h\">        </span><span class=\"crayon-st\">if</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">child_pid</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59943aaad2460938173317-8\"><span class=\"crayon-h\">            </span><span class=\"crayon-e\">perror</span><span class=\"crayon-sy\">(</span><span class=\"crayon-s\">\"Fork failed\"</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-59943aaad2460938173317-9\"><span class=\"crayon-h\">            </span><span class=\"crayon-e\">exit</span><span class=\"crayon-sy\">(</span><span class=\"crayon-cn\">1</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59943aaad2460938173317-10\"><span class=\"crayon-h\">        </span><span class=\"crayon-sy\">}</span></div><div class=\"crayon-line\" id=\"crayon-59943aaad2460938173317-11\"><span class=\"crayon-h\">    </span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0017 seconds] -->\r\n<p></p>\n<ul>\n<li><strong>execvp</strong> – 就像上面解释过的，被成功调用后它不会返回。然而，如果执行失败它会返回 -1。同样地，我们修改 <code>execvp</code> 调用：</li>\n<li>\n<!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-59943aaad2464095967320\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-always\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"复制代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div><span class=\"crayon-language\">C</span></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\n    ...\r\n        if (execvp(command[0], command) &lt; 0) {\r\n            perror(command[0]);\r\n            exit(1);\r\n        }\r\n...</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-59943aaad2464095967320-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59943aaad2464095967320-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-59943aaad2464095967320-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59943aaad2464095967320-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-59943aaad2464095967320-5\">5</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59943aaad2464095967320-6\">6</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-59943aaad2464095967320-1\"><span class=\"crayon-h\">    </span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59943aaad2464095967320-2\"><span class=\"crayon-h\">        </span><span class=\"crayon-st\">if</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-e\">execvp</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">command</span><span class=\"crayon-sy\">[</span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">]</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">command</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-59943aaad2464095967320-3\"><span class=\"crayon-h\">            </span><span class=\"crayon-e\">perror</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">command</span><span class=\"crayon-sy\">[</span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">]</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59943aaad2464095967320-4\"><span class=\"crayon-h\">            </span><span class=\"crayon-e\">exit</span><span class=\"crayon-sy\">(</span><span class=\"crayon-cn\">1</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-59943aaad2464095967320-5\"><span class=\"crayon-h\">        </span><span class=\"crayon-sy\">}</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59943aaad2464095967320-6\"><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0011 seconds] -->\r\n<br>\n注意：虽然<code>fork</code>之后的<code>exit</code>调用终止整个程序，但<code>execvp</code>之后的<code>exit</code> 调用只会终止子进程，因为这段代码只属于子进程。</li>\n</ul>\n<ul>\n<li><strong>malloc</strong> – 如果操作系统内存耗尽，它就会失败。在这种情况下，我们应该退出程序：<br>\n<!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-59943aaad2467185647722\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-always\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"复制代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div><span class=\"crayon-language\">C</span></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\nchar **get_input(char *input) {\r\nchar **command = malloc(8 * sizeof(char *));\r\nif (command == NULL) {\r\nperror(\"malloc failed\");\r\nexit(1);\r\n}\r\n...</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-59943aaad2467185647722-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59943aaad2467185647722-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-59943aaad2467185647722-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59943aaad2467185647722-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-59943aaad2467185647722-5\">5</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59943aaad2467185647722-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-59943aaad2467185647722-7\">7</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-59943aaad2467185647722-1\"><span class=\"crayon-t\">char</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">*</span><span class=\"crayon-o\">*</span><span class=\"crayon-e\">get_input</span><span class=\"crayon-sy\">(</span><span class=\"crayon-t\">char</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">*</span><span class=\"crayon-v\">input</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59943aaad2467185647722-2\"><span class=\"crayon-t\">char</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">*</span><span class=\"crayon-o\">*</span><span class=\"crayon-v\">command</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-r\">malloc</span><span class=\"crayon-sy\">(</span><span class=\"crayon-cn\">8</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">*</span><span class=\"crayon-h\"> </span><span class=\"crayon-r\">sizeof</span><span class=\"crayon-sy\">(</span><span class=\"crayon-t\">char</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">*</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-59943aaad2467185647722-3\"><span class=\"crayon-st\">if</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">command</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">==</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">NULL</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59943aaad2467185647722-4\"><span class=\"crayon-e\">perror</span><span class=\"crayon-sy\">(</span><span class=\"crayon-s\">\"malloc failed\"</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-59943aaad2467185647722-5\"><span class=\"crayon-e\">exit</span><span class=\"crayon-sy\">(</span><span class=\"crayon-cn\">1</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59943aaad2467185647722-6\"><span class=\"crayon-sy\">}</span></div><div class=\"crayon-line\" id=\"crayon-59943aaad2467185647722-7\"><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0014 seconds] -->\r\n\n</li>\n<li><strong>动态内存分配</strong> – 目前我们的命令缓冲区只分配了8个块。如果我们输入的命令超过8个单词，命令就无法像预期的那样工作。这么做是为了让例子便于理解，如何解决这个问题留给读者作为一个练习。</li>\n</ul>\n<p>上面带有错误处理的代码可在<a href=\"https://indradhanush.github.io/code/shell-part-2/shell_with_error_handling.c\">这里</a>获取。</p>\n<h2>内建命令</h2>\n<p>如果你试着执行 <code>cd</code> 命令，你会得到这样的错误：</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-59943aaad246b791548672\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-always\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"复制代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\ncd: No such file or directory\r\n</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-59943aaad246b791548672-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59943aaad246b791548672-2\">2</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-59943aaad246b791548672-1\"><span class=\"crayon-v\">cd</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">No </span><span class=\"crayon-e\">such </span><span class=\"crayon-e\">file </span><span class=\"crayon-st\">or</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">directory</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59943aaad246b791548672-2\"> </div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0004 seconds] -->\r\n<p>我们的 shell 现在还不能识别<code>cd</code>命令。这背后的原因是：cd不是<code>ls</code>或<code>pwd</code>这样的系统程序。让我们后退一步，暂时假设<code>cd</code> 也是一个系统程序。你认为执行流程会是什么样？在继续阅读之前，你可能想要思考一下。</p>\n<p>流程是这样的：</p>\n<ol>\n<li>用户输入 <code>cd /</code>。</li>\n<li>shell对当前进程作 <code>fork</code>，并在子进程中执行命令。</li>\n<li>在成功调用后，子进程退出，控制权还给父进程。</li>\n<li>父进程的当前工作目录没有改变，因为命令是在子进程中执行的。因此，<code>cd</code> 命令虽然成功了，但并没有产生我们想要的结果。</li>\n</ol>\n<p>因此，要支持 <code>cd</code>，我们必须自己实现它。我们也需要确保，如果用户输入的命令是 <code>cd</code>（或属于预定义的内建命令），我们根本不要 <code>fork</code> 进程。相反地，我们将执行我们对 <code>cd</code>（或任何其它内建命令）的实现，并继续等待用户的下一次输入。<code></code>，幸运的是我们可以利用 <code>chdir</code> 函数调用，它用起来很简单。它接受路径作为参数，如果成功则返回0，失败则返回 -1。我们定义函数：</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-59943aaad246f169270085\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-always\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"复制代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div><span class=\"crayon-language\">C</span></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\nint cd(char *path) {\r\n        return chdir(path);\r\n    }</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-59943aaad246f169270085-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59943aaad246f169270085-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-59943aaad246f169270085-3\">3</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-59943aaad246f169270085-1\"><span class=\"crayon-t\">int</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">cd</span><span class=\"crayon-sy\">(</span><span class=\"crayon-t\">char</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">*</span><span class=\"crayon-v\">path</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59943aaad246f169270085-2\"><span class=\"crayon-h\">        </span><span class=\"crayon-st\">return</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">chdir</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">path</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-59943aaad246f169270085-3\"><span class=\"crayon-h\">    </span><span class=\"crayon-sy\">}</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0007 seconds] -->\r\n<p>并且在我们的<code>主</code>函数中为它加入一个检查：</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-59943aaad2474695281950\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-always\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"复制代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div><span class=\"crayon-language\">C</span></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\n    while (1) {\r\n        input = readline(\"unixsh&gt; \");\r\n        command = get_input(input);\r\n\r\n            if (strcmp(command[0], \"cd\") == 0) {\r\n            if (cd(command[1]) &lt; 0) {\r\n                perror(command[1]);\r\n            }\r\n\r\n                /* Skip the fork */\r\n            continue;\r\n        }\r\n    ...</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-59943aaad2474695281950-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59943aaad2474695281950-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-59943aaad2474695281950-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59943aaad2474695281950-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-59943aaad2474695281950-5\">5</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59943aaad2474695281950-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-59943aaad2474695281950-7\">7</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59943aaad2474695281950-8\">8</div><div class=\"crayon-num\" data-line=\"crayon-59943aaad2474695281950-9\">9</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59943aaad2474695281950-10\">10</div><div class=\"crayon-num\" data-line=\"crayon-59943aaad2474695281950-11\">11</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59943aaad2474695281950-12\">12</div><div class=\"crayon-num\" data-line=\"crayon-59943aaad2474695281950-13\">13</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-59943aaad2474695281950-1\"><span class=\"crayon-h\">    </span><span class=\"crayon-st\">while</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-cn\">1</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59943aaad2474695281950-2\"><span class=\"crayon-h\">        </span><span class=\"crayon-v\">input</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">readline</span><span class=\"crayon-sy\">(</span><span class=\"crayon-s\">\"unixsh&gt; \"</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-59943aaad2474695281950-3\"><span class=\"crayon-h\">        </span><span class=\"crayon-v\">command</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">get_input</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">input</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59943aaad2474695281950-4\"> </div><div class=\"crayon-line\" id=\"crayon-59943aaad2474695281950-5\"><span class=\"crayon-h\">            </span><span class=\"crayon-st\">if</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-e\">strcmp</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">command</span><span class=\"crayon-sy\">[</span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">]</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">\"cd\"</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">==</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59943aaad2474695281950-6\"><span class=\"crayon-h\">            </span><span class=\"crayon-st\">if</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-e\">cd</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">command</span><span class=\"crayon-sy\">[</span><span class=\"crayon-cn\">1</span><span class=\"crayon-sy\">]</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-59943aaad2474695281950-7\"><span class=\"crayon-h\">                </span><span class=\"crayon-e\">perror</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">command</span><span class=\"crayon-sy\">[</span><span class=\"crayon-cn\">1</span><span class=\"crayon-sy\">]</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59943aaad2474695281950-8\"><span class=\"crayon-h\">            </span><span class=\"crayon-sy\">}</span></div><div class=\"crayon-line\" id=\"crayon-59943aaad2474695281950-9\"> </div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59943aaad2474695281950-10\"><span class=\"crayon-h\">                </span><span class=\"crayon-c\">/* Skip the fork */</span></div><div class=\"crayon-line\" id=\"crayon-59943aaad2474695281950-11\"><span class=\"crayon-h\">            </span><span class=\"crayon-st\">continue</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59943aaad2474695281950-12\"><span class=\"crayon-h\">        </span><span class=\"crayon-sy\">}</span></div><div class=\"crayon-line\" id=\"crayon-59943aaad2474695281950-13\"><span class=\"crayon-h\">    </span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0021 seconds] -->\r\n<p>带有以上更改的代码可从<a href=\"https://indradhanush.github.io/code/shell-part-2/shell_with_builtin.c\">这里</a>获取，如果你编译并执行它，你将能运行 <code>cd</code> 命令。这里是一个示例输出：</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-59943aaad2478512856720\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-always\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"复制代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div><span class=\"crayon-language\">Shell</span></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\nunixsh&gt; pwd\r\n/Users/dhanush/github.com/indradhanush.github.io/code/shell-part-2\r\nunixsh&gt; cd /\r\nunixsh&gt; pwd\r\n/\r\nunixsh&gt;</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-59943aaad2478512856720-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59943aaad2478512856720-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-59943aaad2478512856720-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59943aaad2478512856720-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-59943aaad2478512856720-5\">5</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59943aaad2478512856720-6\">6</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-59943aaad2478512856720-1\"><span class=\"crayon-v\">unixsh</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-r\">pwd</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59943aaad2478512856720-2\"><span class=\"crayon-o\">/</span><span class=\"crayon-v\">Users</span><span class=\"crayon-o\">/</span><span class=\"crayon-v\">dhanush</span><span class=\"crayon-o\">/</span><span class=\"crayon-v\">github</span><span class=\"crayon-e\">.com</span><span class=\"crayon-o\">/</span><span class=\"crayon-v\">indradhanush</span><span class=\"crayon-e\">.github</span><span class=\"crayon-e\">.io</span><span class=\"crayon-o\">/</span><span class=\"crayon-v\">code</span><span class=\"crayon-o\">/</span><span class=\"crayon-v\">shell</span><span class=\"crayon-o\">-</span><span class=\"crayon-v\">part</span><span class=\"crayon-o\">-</span><span class=\"crayon-cn\">2</span></div><div class=\"crayon-line\" id=\"crayon-59943aaad2478512856720-3\"><span class=\"crayon-v\">unixsh</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-r\">cd</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">/</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59943aaad2478512856720-4\"><span class=\"crayon-v\">unixsh</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-r\">pwd</span></div><div class=\"crayon-line\" id=\"crayon-59943aaad2478512856720-5\"><span class=\"crayon-o\">/</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59943aaad2478512856720-6\"><span class=\"crayon-v\">unixsh</span><span class=\"crayon-o\">&gt;</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0012 seconds] -->\r\n<p>第二部分到此结束。这篇博客帖文中的所有代码示例可在<a href=\"https://github.com/indradhanush/indradhanush.github.io/tree/master/code/shell-part-2/\">这里</a>获取。在<a href=\"https://indradhanush.github.io/blog/writing-a-unix-shell-part-3/\">下一篇博客帖文</a>中，我们将探讨信号的主题以及实现对用户中断（Ctrl-C）的处理。敬请期待。</p>\n<h2>致谢</h2>\n<p>谢谢 <a href=\"https://github.com/domspad\">Dominic Spadacene</a>和我搭档写这篇文章，谢谢 <a href=\"https://github.com/saulpw\">Saul Pwanson</a>帮我解决怪异的内存泄漏，当时代码貌似完全不能工作了。</p>\n<p><strong>更新</strong>：Saul提到：按照惯例，用 <code>&lt; 0</code> 来检查错误比用 <code>== -1</code> 更好，因为有些 API 可能返回除了 <code>-1</code> 以外的负值，<code>&lt;0</code> 有助于应对那些情况。我已经据此更新了本帖文和代码示例。</p>\n<p><strong>参考资料</strong></p>\n<ul>\n<li><a href=\"http://amzn.to/2sc0p8o\">UNIX 环境高级编程 – Stephens &amp; Rago</a></li>\n<li><a href=\"http://amzn.to/2sc3TYr\">Linux 系统编程 – Robert Love</a></li>\n<li><a href=\"https://linux.die.net/man/\">Linux man 页面</a></li>\n</ul>\n\r\n        \r\n            <blockquote class=\"rewards\">\n        <p><strong>打赏支持我翻译更多好文章，谢谢！</strong></p>\n        <a href=\"#rewardbox\" id=\"rewards-button\" class=\"fancybox\"><span class=\"btn-bluet-blue href-style\"><i class=\"fa fa-jpy\"></i> 打赏译者</span></a>\n    </blockquote>\n\n    <div id=\"rewardbox\">\n        <h4>打赏支持我翻译更多好文章，谢谢！</h4>\n                <p>任选一种支付方式</p>\n                <p>\n                        <img src=\"http://jbcdn2.b0.upaiyun.com/2017/06/8204a635b9f0335c5b2e27498c3d5c97.jpg\">\n            \n                            <img src=\"http://jbcdn2.b0.upaiyun.com/2017/06/0fbc02d33dc26bbfebc27f81bea9cdf9.jpg\">\n                    </p>\n    </div>\n\n    \r\n        \n    <div class=\"post-adds\">\n        <span data-post-id=\"112126\" class=\" btn-bluet-bigger href-style vote-post-up   register-user-only \"><i class=\"fa  fa-thumbs-o-up\"></i> <h10 id=\"112126votetotal\">2</h10> 赞</span>\n        <span data-book-type=\"1\" data-site-id=\"2\" data-item-id=\"112126\" data-item-type=\"1\" class=\" btn-bluet-bigger href-style bookmark-btn  register-user-only \"><i class=\"fa fa-bookmark-o  \"></i> 5 收藏</span>\n\n                    <a href=\"#article-comment\"><span class=\"btn-bluet-bigger href-style hide-on-480\"><i class=\"fa fa-comments-o\"></i>  评论</span></a>\n        \n        \n        \n        <!-- JiaThis Button BEGIN -->\n        <div class=\"jiathis_style_24x24\" style=\"display: inline-flex; position: relative; margin: 0; clear: both;float: right;\">\n            <a class=\"jiathis_button_tsina\"></a>\n            <a class=\"jiathis_button_weixin\"></a>\n            <a class=\"jiathis_button_qzone\"></a>\n            <a class=\"jiathis_button_fb hide-on-480\"></a>\n            <a href=\"http://www.jiathis.com/share?uid=1745061\" class=\"jiathis jiathis_txt jiathis_separator jtico jtico_jiathis\" target=\"_blank\"></a>\n        </div>\n\n    </div>\n\n\n\n\r\n        <!-- BEGIN #author-bio -->\r\n\r\n<div id=\"author-bio\">\r\n\t\r\n\t<h3 class=\"widget-title\">\r\n\t关于作者：<a target=\"_blank\" href=\"http://www.jobbole.com/members/qdoverture\">效楚</a>\r\n\t</h3>\r\n\t<div class=\"alignleft\">\r\n\t\t<a target=\"_blank\" href=\"http://www.jobbole.com/members/qdoverture\">\r\n\t\t\t<img src=\"http://jbcdn2.b0.upaiyun.com/2017/06/72a13d3690f7c6edc018286f0ae732f6.jpg\">\r\n\t\t</a>\r\n\t</div>\r\n\r\n    <div class=\"author-bio-info\">\r\n\r\n        <span class=\"author-bio-info-block\">\r\n            本职工作是IC设计，工作中也经常做脚本编写、嵌入式编程等，对软件和文字翻译亦有浓厚的兴趣。        </span>\r\n        <span class=\"author-bio-info-block\">\r\n            <a href=\"http://www.jobbole.com/members/qdoverture\" target=\"_blank\"><i class=\"fa fa-user\"></i> 个人主页</a> ·\r\n            <a href=\"http://blog.jobbole.com/author/qdoverture/\" target=\"_blank\"><i class=\"fa fa-file-text-o\"></i> 我的文章</a>\r\n\r\n             · <a title=\"声望值\" target=\"_blank\" href=\"http://www.jobbole.com/members/qdoverture/reputation/\"><i class=\"fa fa-graduation-cap\"></i> 14</a>        </span>\r\n    </div>\r\n\t<div class=\"clear\"></div>\r\n</div>\r\n\r\n<!-- END #author-bio -->\r\n\t</div>", "front_image_path": ["full/4a9c9b00ce4180ed890c67d1dc80aad0cac72679.jpg"]},{"title": "编写高质量代码的思考", "url": "http://blog.jobbole.com/112139/", "url_object_id": "2b39c6050457697bdcf56fe2481a09cf", "create_date": "2017/08/10", "front_image_url": ["http://jbcdn2.b0.upaiyun.com/2012/06/real-programmers-code-in-binary.jpg"], "praise_nums": "1", "fav_nums": "2", "comment_nums": 0, "tags": "开发,代码质量", "content": "<div class=\"entry\">\r\n\r\n        \t\t\t<div class=\"textwidget\"></div>\n\t\t\r\n\t\t<div class=\"copyright-area\">本文作者： <a href=\"http://blog.jobbole.com\">伯乐在线</a> - <a href=\"http://www.jobbole.com/members/Yonah\">肖汉松</a> 。未经作者许可，禁止转载！<br>欢迎加入伯乐在线 <a href=\"http://blog.jobbole.com/99322\" target=\"_blank\">专栏作者</a>。</div><div>\n<h2 id=\"u524D_u8A00\">前言</h2>\n<p>最近在看《代码大全》，可以说是一本软件开发的百科全书，特别厚，但是干货也很多。平时写代码，代码规范是一个最低的要求（很多老代码连最低要求都达不到），为什么要这样规定代码要这么写，而不是那么写？这是一个值得深究的问题。而不是说我照着代码规范写代码就算完了，高质量的代码是一个专业工程师的追求。要知其然知其所以然，最近写发票解析的代码，因为涉及带解析PDF的算法，复杂度比较高，所以花了很多时间在重构，学以致用的时候积累了一些心得。</p>\n<h2 id=\"u4FE1_u606F_u9690_u85CF_u539F_u5219\">信息隐藏原则</h2>\n<p>信息隐藏是面向对象设计的一个原则，是对封装和模块化的一个更高维度的概括。从Java的整个访问限制设计就体现了信息隐藏的原则，各种访问修饰符：<code>public,protect,private</code>，在类设计的时候，我们就要决定什么暴露给外部，什么隐藏起来。</p>\n<p>举一个例子下面的代码表示一个有自增ID的<code>Person</code>类。</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-599400c13717f713971113\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-always\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"复制代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\npublic class Person {\r\n    int id;\r\n    private static int G_MAX_ID = 0;\r\n    public Person() {\r\n      this.id = ++G_MAX_ID;\r\n    }\r\n}</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-599400c13717f713971113-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599400c13717f713971113-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-599400c13717f713971113-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599400c13717f713971113-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-599400c13717f713971113-5\">5</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599400c13717f713971113-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-599400c13717f713971113-7\">7</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-599400c13717f713971113-1\"><span class=\"crayon-m\">public</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">class</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">Person</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599400c13717f713971113-2\"><span class=\"crayon-h\">    </span><span class=\"crayon-t\">int</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">id</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-599400c13717f713971113-3\"><span class=\"crayon-h\">    </span><span class=\"crayon-m\">private</span><span class=\"crayon-h\"> </span><span class=\"crayon-m\">static</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">int</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">G_MAX_ID</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599400c13717f713971113-4\"><span class=\"crayon-h\">    </span><span class=\"crayon-m\">public</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">Person</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-599400c13717f713971113-5\"><span class=\"crayon-h\">      </span><span class=\"crayon-r\">this</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">id</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">++</span><span class=\"crayon-v\">G_MAX_ID</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599400c13717f713971113-6\"><span class=\"crayon-h\">    </span><span class=\"crayon-sy\">}</span></div><div class=\"crayon-line\" id=\"crayon-599400c13717f713971113-7\"><span class=\"crayon-sy\">}</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0013 seconds] -->\r\n<p><span style=\"font-weight: normal;\">上面的类设计有什么问题呢？它违反了信息隐藏的原则，直接将ID分配的方式暴露了，这会给后面的维护带来很多问题：当你想给id的范围做出限制的时候怎么办？当你在所有代码中使用</span><code style=\"font-style: inherit;\">++G_MAX_ID</code><span style=\"font-weight: normal;\">分配ID时突然需要修改ID分配的算法怎么办？是不是需要去改所有</span><code style=\"font-style: inherit;\">++G_MAX_ID</code><span style=\"font-weight: normal;\">出现的地方？更好的设计是将ID的分配算法隐藏起来。</span></p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-599400c13718b731156576\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-always\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"复制代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\npublic class Person {\r\n    int id;\r\n    private static int G_MAX_ID = 0;\r\n    public Person() {\r\n      this.id = NewId();\r\n    }\r\n    private int NewId() {\r\n      return ++G_MAX_ID;\r\n    }\r\n}</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-599400c13718b731156576-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599400c13718b731156576-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-599400c13718b731156576-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599400c13718b731156576-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-599400c13718b731156576-5\">5</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599400c13718b731156576-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-599400c13718b731156576-7\">7</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599400c13718b731156576-8\">8</div><div class=\"crayon-num\" data-line=\"crayon-599400c13718b731156576-9\">9</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599400c13718b731156576-10\">10</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-599400c13718b731156576-1\"><span class=\"crayon-m\">public</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">class</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">Person</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599400c13718b731156576-2\"><span class=\"crayon-h\">    </span><span class=\"crayon-t\">int</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">id</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-599400c13718b731156576-3\"><span class=\"crayon-h\">    </span><span class=\"crayon-m\">private</span><span class=\"crayon-h\"> </span><span class=\"crayon-m\">static</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">int</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">G_MAX_ID</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599400c13718b731156576-4\"><span class=\"crayon-h\">    </span><span class=\"crayon-m\">public</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">Person</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-599400c13718b731156576-5\"><span class=\"crayon-h\">      </span><span class=\"crayon-r\">this</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">id</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">NewId</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599400c13718b731156576-6\"><span class=\"crayon-h\">    </span><span class=\"crayon-sy\">}</span></div><div class=\"crayon-line\" id=\"crayon-599400c13718b731156576-7\"><span class=\"crayon-h\">    </span><span class=\"crayon-m\">private</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">int</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">NewId</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599400c13718b731156576-8\"><span class=\"crayon-h\">      </span><span class=\"crayon-st\">return</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">++</span><span class=\"crayon-v\">G_MAX_ID</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-599400c13718b731156576-9\"><span class=\"crayon-h\">    </span><span class=\"crayon-sy\">}</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599400c13718b731156576-10\"><span class=\"crayon-sy\">}</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0014 seconds] -->\r\n<p><span style=\"font-weight: normal;\">咋一看只是将</span><code style=\"font-style: inherit;\">++G_MAX_ID</code><span style=\"font-weight: normal;\">写到一个方法里面而已，但是它隐藏了ID分配的算法，让调用者不需要关心里面的实现，同时控制了变化，不管ID分配算法怎么变，都不会影响其他的代码。调用者了解的信息越多，受到的影响就越大，信息隐藏可以降低复杂度，控制变化的范围。</span></p>\n<p>上面的例子只是信息隐藏的一个简单应用，下面我们来举几个其他的应用例子：</p>\n<ul>\n<li>为什么不推荐使用魔法值（即未经定义的常量）？：这个明显违反了信息隐藏的原则，当你将字面量直接写在代码里面时，就将信息直接暴露了，后面需要修改的时候，一旦少改了某个地方的字面量，bug就出现了。</li>\n<li>循环依赖（即A调用B，B调用A的情况）：类或方法之间的循环依赖会破坏信息隐藏，一个很直接的影响就是在测试的时候，A，B都需要同时准备好才能进行测试，而无法mock任意一方。</li>\n<li>使用全局变量：这个就不用说了，所有人都可以访问你的时候信息就暴露无疑了，全局变量能不用就不用。</li>\n<li>考虑性能损失：有时候我们为了一些性能上的考虑就破坏信息隐藏原则，将一些变量全局化，这样性能提高得不多，维护成本却上升不少，完全是得不偿失。</li>\n</ul>\n<p>最后总结一下信息隐藏的好处：</p>\n<ul>\n<li>隐藏信息即隐藏了复杂度，降低了编程的负担。</li>\n<li>隐藏信息即隐藏了底层变化，以便于在局部控制变化。</li>\n</ul>\n<h2 id=\"u4E00_u4E9B_u4E0D_u592A_u5E38_u89C1_u7684_u7F16_u7A0B_u6280_u5DE7\">一些不太常见的编程技巧</h2>\n<h3 id=\"u51FD_u6570_28function_29_u4E0E_u8FC7_u7A0B_28procedure_29_u7684_u9009_u62E9\">函数(function)与过程(procedure)的选择</h3>\n<p>我们先来看看函数与过程区别：</p>\n<ul>\n<li>Function：有返回值的方法</li>\n<li>Procedure：没有返回值的方法</li>\n</ul>\n<p>平时我们编程其实没有太区别函数与过程，什么时候用函数，什么时候用过程其实没有过多的考虑，感觉都可以用。一个选择的规则就是<strong>当你的方法的目的是想返回跟你方法名称相符的值的时候用函数，否则用过程</strong></p>\n<p>举个例子，我看过很多<code>XXProcessor</code>接口里面的方法都是<code>XX process()</code>，严格来讲，这样的命名是不符合上面的规则的，<code>process</code>是一个没有含义的命名，但是却有返回值，如果没有返回值那它的命名才是合理的。</p>\n<p>当然了，上面的规则仅供参考，世事无绝对，具体情况具体分析，当你不清楚用函数还是用过程的时候，可以参考这个规则。</p>\n<h3 id=\"u4F7F_u7528boolean_u503C_u6765_u7ED9_u7A0B_u5E8F_u505A_u6CE8_u91CA\">使用boolean值来给程序做注释</h3>\n<p>相信大家看到一个if语句有很多条件的时候都会特别头痛，因为很难理解。例如下面的例子：</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-599400c137191301880125\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-always\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"复制代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\nif ( ( elementIndex &lt; 0 ) || ( MAX_ELEMENTS &lt; elementIndex ) || elementIndex == lastElementIndex) {\r\n  do....\r\n}</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-599400c137191301880125-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599400c137191301880125-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-599400c137191301880125-3\">3</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-599400c137191301880125-1\"><span class=\"crayon-st\">if</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">elementIndex</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">||</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">MAX_ELEMENTS</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">elementIndex</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">||</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">elementIndex</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">==</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">lastElementIndex</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599400c137191301880125-2\"><span class=\"crayon-h\">  </span><span class=\"crayon-st\">do</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span></div><div class=\"crayon-line\" id=\"crayon-599400c137191301880125-3\"><span class=\"crayon-sy\">}</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0011 seconds] -->\r\n<p><span style=\"font-weight: normal;\">但如果换成下面的写法，用boolean值的名字来给if语句注释，看起来就很好理解了。</span></p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-599400c137195838499724\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-always\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"复制代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\nfinished = ( ( elementIndex &lt; 0 ) || ( MAX_ELEMENTS &lt; elementIndex ) );\r\nrepeatedEntry = ( elementIndex == lastElementIndex );\r\nif ( finished || repeatedEntry ) {\r\n...\r\n}</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-599400c137195838499724-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599400c137195838499724-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-599400c137195838499724-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599400c137195838499724-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-599400c137195838499724-5\">5</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-599400c137195838499724-1\"><span class=\"crayon-v\">finished</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">elementIndex</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">||</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">MAX_ELEMENTS</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">elementIndex</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599400c137195838499724-2\"><span class=\"crayon-v\">repeatedEntry</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">elementIndex</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">==</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">lastElementIndex</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-599400c137195838499724-3\"><span class=\"crayon-st\">if</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">finished</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">||</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">repeatedEntry</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599400c137195838499724-4\"><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span></div><div class=\"crayon-line\" id=\"crayon-599400c137195838499724-5\"><span class=\"crayon-sy\">}</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0014 seconds] -->\r\n<p><span style=\"font-family: 'Microsoft YaHei', 宋体, 'Helvetica Neue', Helvetica, Arial, sans-serif; font-size: 24px; font-style: normal; font-weight: normal;\">总结</span></p>\n<p>怎么写高质量的代码是一个很大的话题，这里只是抛砖引玉，其实面向对象设计的很多原则都能够给我们写代码的时候提供指导，写代码的时候要时刻记得学以致用，而不是敷衍了事，专业的软件工程师必然要能写得一手好代码。</p>\n</div>\n\r\n        \r\n            <blockquote class=\"rewards\">\n        <p><strong>打赏支持我写出更多好文章，谢谢！</strong></p>\n        <a href=\"#rewardbox\" id=\"rewards-button\" class=\"fancybox\"><span class=\"btn-bluet-blue href-style\"><i class=\"fa fa-jpy\"></i> 打赏作者</span></a>\n    </blockquote>\n\n    <div id=\"rewardbox\">\n        <h4>打赏支持我写出更多好文章，谢谢！</h4>\n                <p>任选一种支付方式</p>\n                <p>\n                        <img src=\"http://jbcdn2.b0.upaiyun.com/2016/05/5bf123eeb2d2e5d53b487415f6c0555c.png\">\n            \n                            <img src=\"http://jbcdn2.b0.upaiyun.com/2016/05/c7fcb7a46ab889ed5518728242187ab5.jpg\">\n                    </p>\n    </div>\n\n    \r\n        \n    <div class=\"post-adds\">\n        <span data-post-id=\"112139\" class=\" btn-bluet-bigger href-style vote-post-up   register-user-only \"><i class=\"fa  fa-thumbs-o-up\"></i> <h10 id=\"112139votetotal\">1</h10> 赞</span>\n        <span data-book-type=\"1\" data-site-id=\"2\" data-item-id=\"112139\" data-item-type=\"1\" class=\" btn-bluet-bigger href-style bookmark-btn  register-user-only \"><i class=\"fa fa-bookmark-o  \"></i> 2 收藏</span>\n\n                    <a href=\"#article-comment\"><span class=\"btn-bluet-bigger href-style hide-on-480\"><i class=\"fa fa-comments-o\"></i>  评论</span></a>\n        \n        \n        \n        <!-- JiaThis Button BEGIN -->\n        <div class=\"jiathis_style_24x24\" style=\"display: inline-flex; position: relative; margin: 0; clear: both;float: right;\">\n            <a class=\"jiathis_button_tsina\"></a>\n            <a class=\"jiathis_button_weixin\"></a>\n            <a class=\"jiathis_button_qzone\"></a>\n            <a class=\"jiathis_button_fb hide-on-480\"></a>\n            <a href=\"http://www.jiathis.com/share?uid=1745061\" class=\"jiathis jiathis_txt jiathis_separator jtico jtico_jiathis\" target=\"_blank\"></a>\n        </div>\n\n    </div>\n\n\n\n\r\n        <!-- BEGIN #author-bio -->\r\n\r\n<div id=\"author-bio\">\r\n\t\r\n\t<h3 class=\"widget-title\">\r\n\t关于作者：<a target=\"_blank\" href=\"http://www.jobbole.com/members/Yonah\">肖汉松</a>\r\n\t</h3>\r\n\t<div class=\"alignleft\">\r\n\t\t<a target=\"_blank\" href=\"http://www.jobbole.com/members/Yonah\">\r\n\t\t\t<img src=\"http://www.jobbole.com/wp-content/uploads/2015/10/b312ba4ffd5245fa2a1ab819ec0d0347.jpg\">\r\n\t\t</a>\r\n\t</div>\r\n\r\n    <div class=\"author-bio-info\">\r\n\r\n        <span class=\"author-bio-info-block\">\r\n            热爱阅读，喜欢挑战。热衷尝试新的技术，关注技术背后的原理。关注领域：Java 服务端开发，网络编程。关注语言：Java, C, Python。        </span>\r\n        <span class=\"author-bio-info-block\">\r\n            <a href=\"http://www.jobbole.com/members/Yonah\" target=\"_blank\"><i class=\"fa fa-user\"></i> 个人主页</a> ·\r\n            <a href=\"http://blog.jobbole.com/author/yonah/\" target=\"_blank\"><i class=\"fa fa-file-text-o\"></i> 我的文章</a>\r\n\r\n             · <a title=\"声望值\" target=\"_blank\" href=\"http://www.jobbole.com/members/Yonah/reputation/\"><i class=\"fa fa-graduation-cap\"></i> 39</a> · <a title=\"我的网站\" target=\"_blank\" href=\"http://blog.xiaohansong.com\"><i class=\"fa fa-link\"></i></a> <a title=\"微博主页\" target=\"_blank\" href=\"http://weibo.com/xiaohansong\"><i class=\"fa fa-weibo\"></i></a> <a title=\"GitHub主页\" target=\"_blank\" href=\"https://github.com/x-hansong\"><i class=\"fa fa-github\"></i></a>         </span>\r\n    </div>\r\n\t<div class=\"clear\"></div>\r\n</div>\r\n\r\n<!-- END #author-bio -->\r\n\t</div>", "front_image_path": ["full/e4f0172387cbbdb2d04cefa86ba2081b49678dc1.jpg"]},{"title": "用神经网络训练一个文本分类器", "url": "http://blog.jobbole.com/112049/", "url_object_id": "1b94069f855b02965e7341f1f26e4ce2", "create_date": "2017/08/10", "front_image_url": ["http://jbcdn2.b0.upaiyun.com/2017/08/3f0fc87336415b5dec8a04dc523db2ac.png"], "praise_nums": "1", "fav_nums": "2", "comment_nums": 0, "tags": "IT技术,机器学习", "content": "<div class=\"entry\">\r\n\r\n        \t\t\t<div class=\"textwidget\"></div>\n\t\t\r\n\t\t<div class=\"copyright-area\">本文由 <a href=\"http://blog.jobbole.com\">伯乐在线</a> - <a href=\"http://www.jobbole.com/members/2106382253\">Anne90</a> 翻译，<a href=\"http://www.jobbole.com/members/oliverpp\">蒋生武</a> 校稿。未经许可，禁止转载！<br>英文出处：<a target=\"_blank\" href=\"https://machinelearnings.co/text-classification-using-neural-networks-f5cd7b8765c6#.eessps9io\">machinelearnings</a>。欢迎加入<a target=\"_blank\" href=\"http://group.jobbole.com/category/feedback/trans-team/\">翻译组</a>。</div><p>理解聊天机器人的工作原理是非常重要的。聊天机器人内部一个非常重要的组件就是文本分类器。我们看一下文本分类器的神经网络（ANN）的内部工作原理。</p>\n<p style=\"text-align: center;\"><a href=\"http://jbcdn2.b0.upaiyun.com/2017/08/3f0fc87336415b5dec8a04dc523db2ac.png\"><img class=\"alignnone size-full wp-image-112152\" src=\"http://jbcdn2.b0.upaiyun.com/2017/08/3f0fc87336415b5dec8a04dc523db2ac.png\" alt=\"1-DpMaU1p85ZSgamwYDkzL-A\"></a></p>\n<p style=\"text-align: center;\">多层神经网络</p>\n<p>我们将会使用2层网络（1个隐层）和一个“词包”的方法来组织我们的训练数据。文本分类有3个特点：模式匹配、算法、神经网络。虽然使用多项朴素贝叶斯算法的方法非常有效，但是它有3个致命的缺陷：</p>\n<ul>\n<li>这个算法输出一个分数而不是一个概率。我们可以使用概率来忽略特定阈值以下的预测结果。这类似于忽略收音机中的噪声。</li>\n<li>这个算法从一个样本中学习一个分类中包含什么，而不是一个分类中不包含什么。一个分类中不包含什么的的学习模式往往也很重要。</li>\n<li>不成比例的大训练集的分类将会导致扭曲的分类分数，迫使算法相对于分类规模来调整输出分数，这并不理想。</li>\n</ul>\n<p>和它“天真”的对手一样，这种分类器并不试图去理解句子的含义，而仅仅对它进行分类。事实上，所谓的“人工智能聊天机器人”并不理解语言，但那是<a href=\"https://medium.com/@gk_/the-ai-label-is-bullshit-559b171867ff#.cqbwy3eb7\">另一个故事</a>。</p>\n<p>如果你刚接触人工神经网络，这是它的<a href=\"https://medium.com/@gk_/how-neural-networks-work-ff4c7ad371f7\">工作原理</a>。</p>\n<p>理解分类算法，请看<a href=\"https://chatbotslife.com/text-classification-using-algorithms-e4d50dcba45\">这里</a>。</p>\n<p>我们来逐个分析文本分类器的每个部分。我们将按照以下顺序：</p>\n<ol>\n<li><strong>引用需要的库</strong></li>\n<li><strong>提供训练集</strong></li>\n<li>整理数据</li>\n<li>迭代：编写代码+测试预测结果+调整模型</li>\n<li>抽象</li>\n</ol>\n<p>代码在这里，我们使用ipython notebook这个在数据科学项目上非常高效的工具。代码语法是python。</p>\n<p>我们首先导入自然语言工具包。我们需要一个可靠的方法将句子切分成词并且将单词词干化处理。</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-5994286745677884875797\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-always\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"复制代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\n# use natural language toolkit\r\nimport nltk\r\nfrom nltk.stem.lancaster import LancasterStemmer\r\nimport os\r\nimport json\r\nimport datetime\r\nstemmer = LancasterStemmer()</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5994286745677884875797-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5994286745677884875797-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5994286745677884875797-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5994286745677884875797-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-5994286745677884875797-5\">5</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5994286745677884875797-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-5994286745677884875797-7\">7</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5994286745677884875797-1\"><span class=\"crayon-p\"># use natural language toolkit</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5994286745677884875797-2\"><span class=\"crayon-e\">import </span><span class=\"crayon-e\">nltk</span></div><div class=\"crayon-line\" id=\"crayon-5994286745677884875797-3\"><span class=\"crayon-e\">from </span><span class=\"crayon-v\">nltk</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">stem</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">lancaster </span><span class=\"crayon-e\">import </span><span class=\"crayon-e\">LancasterStemmer</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5994286745677884875797-4\"><span class=\"crayon-e\">import </span><span class=\"crayon-e\">os</span></div><div class=\"crayon-line\" id=\"crayon-5994286745677884875797-5\"><span class=\"crayon-e\">import </span><span class=\"crayon-e\">json</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5994286745677884875797-6\"><span class=\"crayon-e\">import </span><span class=\"crayon-e\">datetime</span></div><div class=\"crayon-line\" id=\"crayon-5994286745677884875797-7\"><span class=\"crayon-v\">stemmer</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">LancasterStemmer</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">)</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0008 seconds] -->\r\n<p>下面是我们的训练集，12个句子属于3个类别（“意图”）。</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-5994286745683195010646\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-always\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"复制代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\n# 3 classes of training data\r\ntraining_data = []\r\ntraining_data.append({\"class\":\"greeting\", \"sentence\":\"how are you?\"})\r\ntraining_data.append({\"class\":\"greeting\", \"sentence\":\"how is your day?\"})\r\ntraining_data.append({\"class\":\"greeting\", \"sentence\":\"good day\"})\r\ntraining_data.append({\"class\":\"greeting\", \"sentence\":\"how is it going today?\"})\r\n\r\ntraining_data.append({\"class\":\"goodbye\", \"sentence\":\"have a nice day\"})\r\ntraining_data.append({\"class\":\"goodbye\", \"sentence\":\"see you later\"})\r\ntraining_data.append({\"class\":\"goodbye\", \"sentence\":\"have a nice day\"})\r\ntraining_data.append({\"class\":\"goodbye\", \"sentence\":\"talk to you soon\"})\r\n\r\ntraining_data.append({\"class\":\"sandwich\", \"sentence\":\"make me a sandwich\"})\r\ntraining_data.append({\"class\":\"sandwich\", \"sentence\":\"can you make a sandwich?\"})\r\ntraining_data.append({\"class\":\"sandwich\", \"sentence\":\"having a sandwich today?\"})\r\ntraining_data.append({\"class\":\"sandwich\", \"sentence\":\"what's for lunch?\"})\r\nprint (\"%s sentences in training data\" % len(training_data))</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5994286745683195010646-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5994286745683195010646-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5994286745683195010646-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5994286745683195010646-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-5994286745683195010646-5\">5</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5994286745683195010646-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-5994286745683195010646-7\">7</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5994286745683195010646-8\">8</div><div class=\"crayon-num\" data-line=\"crayon-5994286745683195010646-9\">9</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5994286745683195010646-10\">10</div><div class=\"crayon-num\" data-line=\"crayon-5994286745683195010646-11\">11</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5994286745683195010646-12\">12</div><div class=\"crayon-num\" data-line=\"crayon-5994286745683195010646-13\">13</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5994286745683195010646-14\">14</div><div class=\"crayon-num\" data-line=\"crayon-5994286745683195010646-15\">15</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5994286745683195010646-16\">16</div><div class=\"crayon-num\" data-line=\"crayon-5994286745683195010646-17\">17</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5994286745683195010646-1\"><span class=\"crayon-p\"># 3 classes of training data</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5994286745683195010646-2\"><span class=\"crayon-v\">training_data</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">[</span><span class=\"crayon-sy\">]</span></div><div class=\"crayon-line\" id=\"crayon-5994286745683195010646-3\"><span class=\"crayon-v\">training_data</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">append</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">{</span><span class=\"crayon-s\">\"class\"</span><span class=\"crayon-o\">:</span><span class=\"crayon-s\">\"greeting\"</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">\"sentence\"</span><span class=\"crayon-o\">:</span><span class=\"crayon-s\">\"how are you?\"</span><span class=\"crayon-sy\">}</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5994286745683195010646-4\"><span class=\"crayon-v\">training_data</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">append</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">{</span><span class=\"crayon-s\">\"class\"</span><span class=\"crayon-o\">:</span><span class=\"crayon-s\">\"greeting\"</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">\"sentence\"</span><span class=\"crayon-o\">:</span><span class=\"crayon-s\">\"how is your day?\"</span><span class=\"crayon-sy\">}</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line\" id=\"crayon-5994286745683195010646-5\"><span class=\"crayon-v\">training_data</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">append</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">{</span><span class=\"crayon-s\">\"class\"</span><span class=\"crayon-o\">:</span><span class=\"crayon-s\">\"greeting\"</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">\"sentence\"</span><span class=\"crayon-o\">:</span><span class=\"crayon-s\">\"good day\"</span><span class=\"crayon-sy\">}</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5994286745683195010646-6\"><span class=\"crayon-v\">training_data</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">append</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">{</span><span class=\"crayon-s\">\"class\"</span><span class=\"crayon-o\">:</span><span class=\"crayon-s\">\"greeting\"</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">\"sentence\"</span><span class=\"crayon-o\">:</span><span class=\"crayon-s\">\"how is it going today?\"</span><span class=\"crayon-sy\">}</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line\" id=\"crayon-5994286745683195010646-7\"> </div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5994286745683195010646-8\"><span class=\"crayon-v\">training_data</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">append</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">{</span><span class=\"crayon-s\">\"class\"</span><span class=\"crayon-o\">:</span><span class=\"crayon-s\">\"goodbye\"</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">\"sentence\"</span><span class=\"crayon-o\">:</span><span class=\"crayon-s\">\"have a nice day\"</span><span class=\"crayon-sy\">}</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line\" id=\"crayon-5994286745683195010646-9\"><span class=\"crayon-v\">training_data</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">append</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">{</span><span class=\"crayon-s\">\"class\"</span><span class=\"crayon-o\">:</span><span class=\"crayon-s\">\"goodbye\"</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">\"sentence\"</span><span class=\"crayon-o\">:</span><span class=\"crayon-s\">\"see you later\"</span><span class=\"crayon-sy\">}</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5994286745683195010646-10\"><span class=\"crayon-v\">training_data</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">append</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">{</span><span class=\"crayon-s\">\"class\"</span><span class=\"crayon-o\">:</span><span class=\"crayon-s\">\"goodbye\"</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">\"sentence\"</span><span class=\"crayon-o\">:</span><span class=\"crayon-s\">\"have a nice day\"</span><span class=\"crayon-sy\">}</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line\" id=\"crayon-5994286745683195010646-11\"><span class=\"crayon-v\">training_data</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">append</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">{</span><span class=\"crayon-s\">\"class\"</span><span class=\"crayon-o\">:</span><span class=\"crayon-s\">\"goodbye\"</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">\"sentence\"</span><span class=\"crayon-o\">:</span><span class=\"crayon-s\">\"talk to you soon\"</span><span class=\"crayon-sy\">}</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5994286745683195010646-12\"> </div><div class=\"crayon-line\" id=\"crayon-5994286745683195010646-13\"><span class=\"crayon-v\">training_data</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">append</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">{</span><span class=\"crayon-s\">\"class\"</span><span class=\"crayon-o\">:</span><span class=\"crayon-s\">\"sandwich\"</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">\"sentence\"</span><span class=\"crayon-o\">:</span><span class=\"crayon-s\">\"make me a sandwich\"</span><span class=\"crayon-sy\">}</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5994286745683195010646-14\"><span class=\"crayon-v\">training_data</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">append</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">{</span><span class=\"crayon-s\">\"class\"</span><span class=\"crayon-o\">:</span><span class=\"crayon-s\">\"sandwich\"</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">\"sentence\"</span><span class=\"crayon-o\">:</span><span class=\"crayon-s\">\"can you make a sandwich?\"</span><span class=\"crayon-sy\">}</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line\" id=\"crayon-5994286745683195010646-15\"><span class=\"crayon-v\">training_data</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">append</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">{</span><span class=\"crayon-s\">\"class\"</span><span class=\"crayon-o\">:</span><span class=\"crayon-s\">\"sandwich\"</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">\"sentence\"</span><span class=\"crayon-o\">:</span><span class=\"crayon-s\">\"having a sandwich today?\"</span><span class=\"crayon-sy\">}</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5994286745683195010646-16\"><span class=\"crayon-v\">training_data</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">append</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">{</span><span class=\"crayon-s\">\"class\"</span><span class=\"crayon-o\">:</span><span class=\"crayon-s\">\"sandwich\"</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">\"sentence\"</span><span class=\"crayon-o\">:</span><span class=\"crayon-s\">\"what's for lunch?\"</span><span class=\"crayon-sy\">}</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line\" id=\"crayon-5994286745683195010646-17\"><span class=\"crayon-e\">print</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-s\">\"%s sentences in training data\"</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">%</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">len</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">training_data</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">)</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0039 seconds] -->\r\n<p></p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-5994286745688928469607\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-always\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"复制代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\n12 sentences in training data</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5994286745688928469607-1\">1</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5994286745688928469607-1\"><span class=\"crayon-cn\">12</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">sentences </span><span class=\"crayon-st\">in</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">training </span><span class=\"crayon-v\">data</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0004 seconds] -->\r\n<p>现在我们可以将数据结构组织为：<em>documents</em>, <em>classes</em> 和<em>words</em>.</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-599428674568b965944472\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-always\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"复制代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\nwords = []\r\nclasses = []\r\ndocuments = []\r\nignore_words = ['?']\r\n# loop through each sentence in our training data\r\nfor pattern in training_data:\r\n    # tokenize each word in the sentence\r\n    w = nltk.word_tokenize(pattern['sentence'])\r\n    # add to our words list\r\n    words.extend(w)\r\n    # add to documents in our corpus\r\n    documents.append((w, pattern['class']))\r\n    # add to our classes list\r\n    if pattern['class'] not in classes:\r\n        classes.append(pattern['class'])\r\n\r\n# stem and lower each word and remove duplicates\r\nwords = [stemmer.stem(w.lower()) for w in words if w not in ignore_words]\r\nwords = list(set(words))\r\n\r\n# remove duplicates\r\nclasses = list(set(classes))\r\n\r\nprint (len(documents), \"documents\")\r\nprint (len(classes), \"classes\", classes)\r\nprint (len(words), \"unique stemmed words\", words)</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-599428674568b965944472-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599428674568b965944472-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-599428674568b965944472-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599428674568b965944472-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-599428674568b965944472-5\">5</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599428674568b965944472-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-599428674568b965944472-7\">7</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599428674568b965944472-8\">8</div><div class=\"crayon-num\" data-line=\"crayon-599428674568b965944472-9\">9</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599428674568b965944472-10\">10</div><div class=\"crayon-num\" data-line=\"crayon-599428674568b965944472-11\">11</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599428674568b965944472-12\">12</div><div class=\"crayon-num\" data-line=\"crayon-599428674568b965944472-13\">13</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599428674568b965944472-14\">14</div><div class=\"crayon-num\" data-line=\"crayon-599428674568b965944472-15\">15</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599428674568b965944472-16\">16</div><div class=\"crayon-num\" data-line=\"crayon-599428674568b965944472-17\">17</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599428674568b965944472-18\">18</div><div class=\"crayon-num\" data-line=\"crayon-599428674568b965944472-19\">19</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599428674568b965944472-20\">20</div><div class=\"crayon-num\" data-line=\"crayon-599428674568b965944472-21\">21</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599428674568b965944472-22\">22</div><div class=\"crayon-num\" data-line=\"crayon-599428674568b965944472-23\">23</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599428674568b965944472-24\">24</div><div class=\"crayon-num\" data-line=\"crayon-599428674568b965944472-25\">25</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-599428674568b965944472-26\">26</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-599428674568b965944472-1\"><span class=\"crayon-v\">words</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">[</span><span class=\"crayon-sy\">]</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599428674568b965944472-2\"><span class=\"crayon-v\">classes</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">[</span><span class=\"crayon-sy\">]</span></div><div class=\"crayon-line\" id=\"crayon-599428674568b965944472-3\"><span class=\"crayon-v\">documents</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">[</span><span class=\"crayon-sy\">]</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599428674568b965944472-4\"><span class=\"crayon-v\">ignore_words</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">[</span><span class=\"crayon-s\">'?'</span><span class=\"crayon-sy\">]</span></div><div class=\"crayon-line\" id=\"crayon-599428674568b965944472-5\"><span class=\"crayon-p\"># loop through each sentence in our training data</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599428674568b965944472-6\"><span class=\"crayon-st\">for</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">pattern </span><span class=\"crayon-st\">in</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">training_data</span><span class=\"crayon-o\">:</span></div><div class=\"crayon-line\" id=\"crayon-599428674568b965944472-7\"><span class=\"crayon-h\">    </span><span class=\"crayon-p\"># tokenize each word in the sentence</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599428674568b965944472-8\"><span class=\"crayon-h\">    </span><span class=\"crayon-v\">w</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">nltk</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">word_tokenize</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">pattern</span><span class=\"crayon-sy\">[</span><span class=\"crayon-s\">'sentence'</span><span class=\"crayon-sy\">]</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line\" id=\"crayon-599428674568b965944472-9\"><span class=\"crayon-h\">    </span><span class=\"crayon-p\"># add to our words list</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599428674568b965944472-10\"><span class=\"crayon-h\">    </span><span class=\"crayon-v\">words</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">extend</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">w</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line\" id=\"crayon-599428674568b965944472-11\"><span class=\"crayon-h\">    </span><span class=\"crayon-p\"># add to documents in our corpus</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599428674568b965944472-12\"><span class=\"crayon-h\">    </span><span class=\"crayon-v\">documents</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">append</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">w</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">pattern</span><span class=\"crayon-sy\">[</span><span class=\"crayon-s\">'class'</span><span class=\"crayon-sy\">]</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line\" id=\"crayon-599428674568b965944472-13\"><span class=\"crayon-h\">    </span><span class=\"crayon-p\"># add to our classes list</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599428674568b965944472-14\"><span class=\"crayon-h\">    </span><span class=\"crayon-st\">if</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">pattern</span><span class=\"crayon-sy\">[</span><span class=\"crayon-s\">'class'</span><span class=\"crayon-sy\">]</span><span class=\"crayon-h\"> </span><span class=\"crayon-st\">not</span><span class=\"crayon-h\"> </span><span class=\"crayon-st\">in</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">classes</span><span class=\"crayon-o\">:</span></div><div class=\"crayon-line\" id=\"crayon-599428674568b965944472-15\"><span class=\"crayon-h\">        </span><span class=\"crayon-v\">classes</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">append</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">pattern</span><span class=\"crayon-sy\">[</span><span class=\"crayon-s\">'class'</span><span class=\"crayon-sy\">]</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599428674568b965944472-16\"> </div><div class=\"crayon-line\" id=\"crayon-599428674568b965944472-17\"><span class=\"crayon-p\"># stem and lower each word and remove duplicates</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599428674568b965944472-18\"><span class=\"crayon-v\">words</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">[</span><span class=\"crayon-v\">stemmer</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">stem</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">w</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">lower</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-st\">for</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">w</span><span class=\"crayon-h\"> </span><span class=\"crayon-st\">in</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">words </span><span class=\"crayon-st\">if</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">w</span><span class=\"crayon-h\"> </span><span class=\"crayon-st\">not</span><span class=\"crayon-h\"> </span><span class=\"crayon-st\">in</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">ignore_words</span><span class=\"crayon-sy\">]</span></div><div class=\"crayon-line\" id=\"crayon-599428674568b965944472-19\"><span class=\"crayon-v\">words</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">list</span><span class=\"crayon-sy\">(</span><span class=\"crayon-e\">set</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">words</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599428674568b965944472-20\"> </div><div class=\"crayon-line\" id=\"crayon-599428674568b965944472-21\"><span class=\"crayon-p\"># remove duplicates</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599428674568b965944472-22\"><span class=\"crayon-v\">classes</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">list</span><span class=\"crayon-sy\">(</span><span class=\"crayon-e\">set</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">classes</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line\" id=\"crayon-599428674568b965944472-23\"> </div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599428674568b965944472-24\"><span class=\"crayon-e\">print</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-e\">len</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">documents</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">\"documents\"</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line\" id=\"crayon-599428674568b965944472-25\"><span class=\"crayon-e\">print</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-e\">len</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">classes</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">\"classes\"</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">classes</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-599428674568b965944472-26\"><span class=\"crayon-e\">print</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-e\">len</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">words</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">\"unique stemmed words\"</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">words</span><span class=\"crayon-sy\">)</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0041 seconds] -->\r\n<p></p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-5994286745690144101748\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-always\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"复制代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\n12 documents\r\n3 classes ['greeting', 'goodbye', 'sandwich']\r\n26 unique stemmed words ['sandwich', 'hav', 'a', 'how', 'for', 'ar', 'good', 'mak', 'me', 'it', 'day', 'soon', 'nic', 'lat', 'going', 'you', 'today', 'can', 'lunch', 'is', \"'s\", 'see', 'to', 'talk', 'yo', 'what']</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5994286745690144101748-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5994286745690144101748-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5994286745690144101748-3\">3</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5994286745690144101748-1\"><span class=\"crayon-cn\">12</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">documents</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5994286745690144101748-2\"><span class=\"crayon-cn\">3</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">classes</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">[</span><span class=\"crayon-s\">'greeting'</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">'goodbye'</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">'sandwich'</span><span class=\"crayon-sy\">]</span></div><div class=\"crayon-line\" id=\"crayon-5994286745690144101748-3\"><span class=\"crayon-cn\">26</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">unique </span><span class=\"crayon-e\">stemmed </span><span class=\"crayon-i\">words</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">[</span><span class=\"crayon-s\">'sandwich'</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">'hav'</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">'a'</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">'how'</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">'for'</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">'ar'</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">'good'</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">'mak'</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">'me'</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">'it'</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">'day'</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">'soon'</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">'nic'</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">'lat'</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">'going'</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">'you'</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">'today'</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">'can'</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">'lunch'</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">'is'</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">\"'s\"</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">'see'</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">'to'</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">'talk'</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">'yo'</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">'what'</span><span class=\"crayon-sy\">]</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0020 seconds] -->\r\n<p>注意每个单词都是词根并且小写。词根有助于机器将“have”和“having”等同起来。同时我们也不关心大小写。<a href=\"http://jbcdn2.b0.upaiyun.com/2017/08/339dcac37e068d2783eff6ec4e21eb24.png\"><img class=\"alignnone size-full wp-image-112153 aligncenter\" src=\"http://jbcdn2.b0.upaiyun.com/2017/08/339dcac37e068d2783eff6ec4e21eb24.png\" alt=\"1-eUedufAl7_sI_QWSEIstZg\"></a></p>\n<p>我们将训练集中的每个句子转换为词包。</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-5994286745694195288866\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-always\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"复制代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\n# create our training data\r\ntraining = []\r\noutput = []\r\n# create an empty array for our output\r\noutput_empty = [0] * len(classes)\r\n\r\n# training set, bag of words for each sentence\r\nfor doc in documents:\r\n    # initialize our bag of words\r\n    bag = []\r\n    # list of tokenized words for the pattern\r\n    pattern_words = doc[0]\r\n    # stem each word\r\n    pattern_words = [stemmer.stem(word.lower()) for word in pattern_words]\r\n    # create our bag of words array\r\n    for w in words:\r\n        bag.append(1) if w in pattern_words else bag.append(0)\r\n\r\n    training.append(bag)\r\n    # output is a '0' for each tag and '1' for current tag\r\n    output_row = list(output_empty)\r\n    output_row[classes.index(doc[1])] = 1\r\n    output.append(output_row)\r\n\r\n# sample training/output\r\ni = 0\r\nw = documents[i][0]\r\nprint ([stemmer.stem(word.lower()) for word in w])\r\nprint (training[i])\r\nprint (output[i])</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5994286745694195288866-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5994286745694195288866-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5994286745694195288866-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5994286745694195288866-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-5994286745694195288866-5\">5</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5994286745694195288866-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-5994286745694195288866-7\">7</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5994286745694195288866-8\">8</div><div class=\"crayon-num\" data-line=\"crayon-5994286745694195288866-9\">9</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5994286745694195288866-10\">10</div><div class=\"crayon-num\" data-line=\"crayon-5994286745694195288866-11\">11</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5994286745694195288866-12\">12</div><div class=\"crayon-num\" data-line=\"crayon-5994286745694195288866-13\">13</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5994286745694195288866-14\">14</div><div class=\"crayon-num\" data-line=\"crayon-5994286745694195288866-15\">15</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5994286745694195288866-16\">16</div><div class=\"crayon-num\" data-line=\"crayon-5994286745694195288866-17\">17</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5994286745694195288866-18\">18</div><div class=\"crayon-num\" data-line=\"crayon-5994286745694195288866-19\">19</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5994286745694195288866-20\">20</div><div class=\"crayon-num\" data-line=\"crayon-5994286745694195288866-21\">21</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5994286745694195288866-22\">22</div><div class=\"crayon-num\" data-line=\"crayon-5994286745694195288866-23\">23</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5994286745694195288866-24\">24</div><div class=\"crayon-num\" data-line=\"crayon-5994286745694195288866-25\">25</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5994286745694195288866-26\">26</div><div class=\"crayon-num\" data-line=\"crayon-5994286745694195288866-27\">27</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5994286745694195288866-28\">28</div><div class=\"crayon-num\" data-line=\"crayon-5994286745694195288866-29\">29</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5994286745694195288866-30\">30</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5994286745694195288866-1\"><span class=\"crayon-p\"># create our training data</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5994286745694195288866-2\"><span class=\"crayon-v\">training</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">[</span><span class=\"crayon-sy\">]</span></div><div class=\"crayon-line\" id=\"crayon-5994286745694195288866-3\"><span class=\"crayon-v\">output</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">[</span><span class=\"crayon-sy\">]</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5994286745694195288866-4\"><span class=\"crayon-p\"># create an empty array for our output</span></div><div class=\"crayon-line\" id=\"crayon-5994286745694195288866-5\"><span class=\"crayon-v\">output_empty</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">[</span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">]</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">*</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">len</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">classes</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5994286745694195288866-6\"> </div><div class=\"crayon-line\" id=\"crayon-5994286745694195288866-7\"><span class=\"crayon-p\"># training set, bag of words for each sentence</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5994286745694195288866-8\"><span class=\"crayon-st\">for</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">doc </span><span class=\"crayon-st\">in</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">documents</span><span class=\"crayon-o\">:</span></div><div class=\"crayon-line\" id=\"crayon-5994286745694195288866-9\"><span class=\"crayon-h\">    </span><span class=\"crayon-p\"># initialize our bag of words</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5994286745694195288866-10\"><span class=\"crayon-h\">    </span><span class=\"crayon-v\">bag</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">[</span><span class=\"crayon-sy\">]</span></div><div class=\"crayon-line\" id=\"crayon-5994286745694195288866-11\"><span class=\"crayon-h\">    </span><span class=\"crayon-p\"># list of tokenized words for the pattern</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5994286745694195288866-12\"><span class=\"crayon-h\">    </span><span class=\"crayon-v\">pattern_words</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">doc</span><span class=\"crayon-sy\">[</span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">]</span></div><div class=\"crayon-line\" id=\"crayon-5994286745694195288866-13\"><span class=\"crayon-h\">    </span><span class=\"crayon-p\"># stem each word</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5994286745694195288866-14\"><span class=\"crayon-h\">    </span><span class=\"crayon-v\">pattern_words</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">[</span><span class=\"crayon-v\">stemmer</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">stem</span><span class=\"crayon-sy\">(</span><span class=\"crayon-t\">word</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">lower</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-st\">for</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">word</span><span class=\"crayon-h\"> </span><span class=\"crayon-st\">in</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">pattern_words</span><span class=\"crayon-sy\">]</span></div><div class=\"crayon-line\" id=\"crayon-5994286745694195288866-15\"><span class=\"crayon-h\">    </span><span class=\"crayon-p\"># create our bag of words array</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5994286745694195288866-16\"><span class=\"crayon-h\">    </span><span class=\"crayon-st\">for</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">w</span><span class=\"crayon-h\"> </span><span class=\"crayon-st\">in</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">words</span><span class=\"crayon-o\">:</span></div><div class=\"crayon-line\" id=\"crayon-5994286745694195288866-17\"><span class=\"crayon-h\">        </span><span class=\"crayon-v\">bag</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">append</span><span class=\"crayon-sy\">(</span><span class=\"crayon-cn\">1</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-st\">if</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">w</span><span class=\"crayon-h\"> </span><span class=\"crayon-st\">in</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">pattern_words </span><span class=\"crayon-st\">else</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">bag</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">append</span><span class=\"crayon-sy\">(</span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5994286745694195288866-18\"> </div><div class=\"crayon-line\" id=\"crayon-5994286745694195288866-19\"><span class=\"crayon-h\">    </span><span class=\"crayon-v\">training</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">append</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">bag</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5994286745694195288866-20\"><span class=\"crayon-h\">    </span><span class=\"crayon-p\"># output is a '0' for each tag and '1' for current tag</span></div><div class=\"crayon-line\" id=\"crayon-5994286745694195288866-21\"><span class=\"crayon-h\">    </span><span class=\"crayon-v\">output_row</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">list</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">output_empty</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5994286745694195288866-22\"><span class=\"crayon-h\">    </span><span class=\"crayon-v\">output_row</span><span class=\"crayon-sy\">[</span><span class=\"crayon-v\">classes</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">index</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">doc</span><span class=\"crayon-sy\">[</span><span class=\"crayon-cn\">1</span><span class=\"crayon-sy\">]</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">]</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">1</span></div><div class=\"crayon-line\" id=\"crayon-5994286745694195288866-23\"><span class=\"crayon-h\">    </span><span class=\"crayon-v\">output</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">append</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">output_row</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5994286745694195288866-24\"> </div><div class=\"crayon-line\" id=\"crayon-5994286745694195288866-25\"><span class=\"crayon-p\"># sample training/output</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5994286745694195288866-26\"><span class=\"crayon-v\">i</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span></div><div class=\"crayon-line\" id=\"crayon-5994286745694195288866-27\"><span class=\"crayon-v\">w</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">documents</span><span class=\"crayon-sy\">[</span><span class=\"crayon-v\">i</span><span class=\"crayon-sy\">]</span><span class=\"crayon-sy\">[</span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">]</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5994286745694195288866-28\"><span class=\"crayon-e\">print</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">[</span><span class=\"crayon-v\">stemmer</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">stem</span><span class=\"crayon-sy\">(</span><span class=\"crayon-t\">word</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">lower</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-st\">for</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">word</span><span class=\"crayon-h\"> </span><span class=\"crayon-st\">in</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">w</span><span class=\"crayon-sy\">]</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line\" id=\"crayon-5994286745694195288866-29\"><span class=\"crayon-e\">print</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">training</span><span class=\"crayon-sy\">[</span><span class=\"crayon-v\">i</span><span class=\"crayon-sy\">]</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5994286745694195288866-30\"><span class=\"crayon-e\">print</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">output</span><span class=\"crayon-sy\">[</span><span class=\"crayon-v\">i</span><span class=\"crayon-sy\">]</span><span class=\"crayon-sy\">)</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0043 seconds] -->\r\n<p></p>\n<figure id=\"29a3\" class=\"graf graf--figure graf--iframe graf-after--p\">\n<div class=\"aspectRatioPlaceholder is-locked\"></div>\n</figure>\n<p></p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-5994286745698389959575\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-always\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"复制代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\n['how', 'ar', 'you', '?']\r\n[0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]\r\n[1, 0, 0]</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5994286745698389959575-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5994286745698389959575-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5994286745698389959575-3\">3</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5994286745698389959575-1\"><span class=\"crayon-sy\">[</span><span class=\"crayon-s\">'how'</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">'ar'</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">'you'</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">'?'</span><span class=\"crayon-sy\">]</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5994286745698389959575-2\"><span class=\"crayon-sy\">[</span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">1</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">1</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">1</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">]</span></div><div class=\"crayon-line\" id=\"crayon-5994286745698389959575-3\"><span class=\"crayon-sy\">[</span><span class=\"crayon-cn\">1</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">]</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0020 seconds] -->\r\n<p>上面的步骤是文本分类中的一个经典步骤：每个训练句子被转化为一个包含0和1的数组，而不是语料库中包含独特单词的数组。</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-599428674569e678843380\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-always\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"复制代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\n['how', 'are', 'you', '?']</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-599428674569e678843380-1\">1</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-599428674569e678843380-1\"><span class=\"crayon-sy\">[</span><span class=\"crayon-s\">'how'</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">'are'</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">'you'</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">'?'</span><span class=\"crayon-sy\">]</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0004 seconds] -->\r\n<p>被词干化为：</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-59942867456a1919407719\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-always\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"复制代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\n['how', 'ar', 'you', '?']</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-59942867456a1919407719-1\">1</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-59942867456a1919407719-1\"><span class=\"crayon-sy\">[</span><span class=\"crayon-s\">'how'</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">'ar'</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">'you'</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">'?'</span><span class=\"crayon-sy\">]</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0004 seconds] -->\r\n<p>然后转换为输入词包的形式：<em>1</em>代表单词存在于词包中（忽略问号？）</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-59942867456a4314533057\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-always\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"复制代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\n[0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-59942867456a4314533057-1\">1</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-59942867456a4314533057-1\"><span class=\"crayon-sy\">[</span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">1</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">1</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">1</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">]</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0015 seconds] -->\r\n<p>输出：第一类</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-59942867456a7935281083\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-always\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"复制代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\n[1, 0, 0]</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-59942867456a7935281083-1\">1</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-59942867456a7935281083-1\"><span class=\"crayon-sy\">[</span><span class=\"crayon-cn\">1</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">]</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0004 seconds] -->\r\n<p></p>\n<p style=\"text-align: center;\">注意：一个句子可以有多个分类，也可以没有。确保理解上面的内容，仔细阅读代码直到你理解它。</p>\n<h4>机器学习的第一步是要有干净的数据</h4>\n<p style=\"text-align: center;\"><a href=\"http://jbcdn2.b0.upaiyun.com/2017/08/0f3abe8c32b873ad8ffa8c728a59102d.png\"><img class=\"alignnone size-full wp-image-112154\" src=\"http://jbcdn2.b0.upaiyun.com/2017/08/0f3abe8c32b873ad8ffa8c728a59102d.png\" alt=\"1-CcQPggEbLgej32mVF2lalg\"></a></p>\n<figure id=\"62c0\" class=\"graf graf--figure graf--layoutOutsetLeft graf-after--h4\">\n<div class=\"aspectRatioPlaceholder is-locked\"></div>\n</figure>\n<p>接下来我们的学习2层神经网络的核心功能。</p>\n<p>如果你是人工神经网络新手，这里是它的工作原理</p>\n<p>我们使用<a href=\"http://www.numpy.org/\">numpy</a>，原因是它可以提供快速的矩阵乘法运算。</p>\n<p style=\"text-align: center;\"><a href=\"http://jbcdn2.b0.upaiyun.com/2017/08/f397d71e69f5ebeaf6a3bf0522861d69.png\"><img class=\"alignnone size-full wp-image-112155\" src=\"http://jbcdn2.b0.upaiyun.com/2017/08/f397d71e69f5ebeaf6a3bf0522861d69.png\" alt=\"1-8SJcWjxz8j7YtY6K-DWxKw\"></a></p>\n<figure id=\"4f9a\" class=\"graf graf--figure graf--layoutOutsetLeft graf-after--p\">\n<div class=\"aspectRatioPlaceholder is-locked\"></div>\n</figure>\n<p>我们使用sigmoid函数对值进行归一化，用其导数来衡量错误率。通过不断迭代和调整，直到错误率低到一个可以接受的值。</p>\n<p>下面我们也实现了bag-of-words函数，将输入的一个句子转化为一个包含0和1的数组。这就是转换训练数据，得到正确的转换数据至关重要。</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-59942867456ab436869043\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-always\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"复制代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\nimport numpy as np\r\nimport time\r\n\r\n# compute sigmoid nonlinearity\r\ndef sigmoid(x):\r\n    output = 1/(1+np.exp(-x))\r\n    return output\r\n\r\n# convert output of sigmoid function to its derivative\r\ndef sigmoid_output_to_derivative(output):\r\n    return output*(1-output)\r\n\r\ndef clean_up_sentence(sentence):\r\n    # tokenize the pattern\r\n    sentence_words = nltk.word_tokenize(sentence)\r\n    # stem each word\r\n    sentence_words = [stemmer.stem(word.lower()) for word in sentence_words]\r\n    return sentence_words\r\n\r\n# return bag of words array: 0 or 1 for each word in the bag that exists in the sentence\r\ndef bow(sentence, words, show_details=False):\r\n    # tokenize the pattern\r\n    sentence_words = clean_up_sentence(sentence)\r\n    # bag of words\r\n    bag = [0]*len(words)  \r\n    for s in sentence_words:\r\n        for i,w in enumerate(words):\r\n            if w == s: \r\n                bag[i] = 1\r\n                if show_details:\r\n                    print (\"found in bag: %s\" % w)\r\n\r\n    return(np.array(bag))\r\n\r\ndef think(sentence, show_details=False):\r\n    x = bow(sentence.lower(), words, show_details)\r\n    if show_details:\r\n        print (\"sentence:\", sentence, \"n bow:\", x)\r\n    # input layer is our bag of words\r\n    l0 = x\r\n    # matrix multiplication of input and hidden layer\r\n    l1 = sigmoid(np.dot(l0, synapse_0))\r\n    # output layer\r\n    l2 = sigmoid(np.dot(l1, synapse_1))\r\n    return l2</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-59942867456ab436869043-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59942867456ab436869043-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-59942867456ab436869043-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59942867456ab436869043-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-59942867456ab436869043-5\">5</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59942867456ab436869043-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-59942867456ab436869043-7\">7</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59942867456ab436869043-8\">8</div><div class=\"crayon-num\" data-line=\"crayon-59942867456ab436869043-9\">9</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59942867456ab436869043-10\">10</div><div class=\"crayon-num\" data-line=\"crayon-59942867456ab436869043-11\">11</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59942867456ab436869043-12\">12</div><div class=\"crayon-num\" data-line=\"crayon-59942867456ab436869043-13\">13</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59942867456ab436869043-14\">14</div><div class=\"crayon-num\" data-line=\"crayon-59942867456ab436869043-15\">15</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59942867456ab436869043-16\">16</div><div class=\"crayon-num\" data-line=\"crayon-59942867456ab436869043-17\">17</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59942867456ab436869043-18\">18</div><div class=\"crayon-num\" data-line=\"crayon-59942867456ab436869043-19\">19</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59942867456ab436869043-20\">20</div><div class=\"crayon-num\" data-line=\"crayon-59942867456ab436869043-21\">21</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59942867456ab436869043-22\">22</div><div class=\"crayon-num\" data-line=\"crayon-59942867456ab436869043-23\">23</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59942867456ab436869043-24\">24</div><div class=\"crayon-num\" data-line=\"crayon-59942867456ab436869043-25\">25</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59942867456ab436869043-26\">26</div><div class=\"crayon-num\" data-line=\"crayon-59942867456ab436869043-27\">27</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59942867456ab436869043-28\">28</div><div class=\"crayon-num\" data-line=\"crayon-59942867456ab436869043-29\">29</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59942867456ab436869043-30\">30</div><div class=\"crayon-num\" data-line=\"crayon-59942867456ab436869043-31\">31</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59942867456ab436869043-32\">32</div><div class=\"crayon-num\" data-line=\"crayon-59942867456ab436869043-33\">33</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59942867456ab436869043-34\">34</div><div class=\"crayon-num\" data-line=\"crayon-59942867456ab436869043-35\">35</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59942867456ab436869043-36\">36</div><div class=\"crayon-num\" data-line=\"crayon-59942867456ab436869043-37\">37</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59942867456ab436869043-38\">38</div><div class=\"crayon-num\" data-line=\"crayon-59942867456ab436869043-39\">39</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59942867456ab436869043-40\">40</div><div class=\"crayon-num\" data-line=\"crayon-59942867456ab436869043-41\">41</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59942867456ab436869043-42\">42</div><div class=\"crayon-num\" data-line=\"crayon-59942867456ab436869043-43\">43</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59942867456ab436869043-44\">44</div><div class=\"crayon-num\" data-line=\"crayon-59942867456ab436869043-45\">45</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-59942867456ab436869043-1\"><span class=\"crayon-e\">import </span><span class=\"crayon-e\">numpy </span><span class=\"crayon-st\">as</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">np</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59942867456ab436869043-2\"><span class=\"crayon-e\">import </span><span class=\"crayon-v\">time</span></div><div class=\"crayon-line\" id=\"crayon-59942867456ab436869043-3\"> </div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59942867456ab436869043-4\"><span class=\"crayon-p\"># compute sigmoid nonlinearity</span></div><div class=\"crayon-line\" id=\"crayon-59942867456ab436869043-5\"><span class=\"crayon-e\">def </span><span class=\"crayon-e\">sigmoid</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">x</span><span class=\"crayon-sy\">)</span><span class=\"crayon-o\">:</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59942867456ab436869043-6\"><span class=\"crayon-h\">    </span><span class=\"crayon-v\">output</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">1</span><span class=\"crayon-o\">/</span><span class=\"crayon-sy\">(</span><span class=\"crayon-cn\">1</span><span class=\"crayon-o\">+</span><span class=\"crayon-v\">np</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">exp</span><span class=\"crayon-sy\">(</span><span class=\"crayon-o\">-</span><span class=\"crayon-v\">x</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line\" id=\"crayon-59942867456ab436869043-7\"><span class=\"crayon-h\">    </span><span class=\"crayon-st\">return</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">output</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59942867456ab436869043-8\"> </div><div class=\"crayon-line\" id=\"crayon-59942867456ab436869043-9\"><span class=\"crayon-p\"># convert output of sigmoid function to its derivative</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59942867456ab436869043-10\"><span class=\"crayon-e\">def </span><span class=\"crayon-e\">sigmoid_output_to_derivative</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">output</span><span class=\"crayon-sy\">)</span><span class=\"crayon-o\">:</span></div><div class=\"crayon-line\" id=\"crayon-59942867456ab436869043-11\"><span class=\"crayon-h\">    </span><span class=\"crayon-st\">return</span><span class=\"crayon-h\"> </span><span class=\"crayon-e \">output*</span><span class=\"crayon-sy\">(</span><span class=\"crayon-cn\">1</span><span class=\"crayon-o\">-</span><span class=\"crayon-v\">output</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59942867456ab436869043-12\"> </div><div class=\"crayon-line\" id=\"crayon-59942867456ab436869043-13\"><span class=\"crayon-e\">def </span><span class=\"crayon-e\">clean_up_sentence</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">sentence</span><span class=\"crayon-sy\">)</span><span class=\"crayon-o\">:</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59942867456ab436869043-14\"><span class=\"crayon-h\">    </span><span class=\"crayon-p\"># tokenize the pattern</span></div><div class=\"crayon-line\" id=\"crayon-59942867456ab436869043-15\"><span class=\"crayon-h\">    </span><span class=\"crayon-v\">sentence_words</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">nltk</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">word_tokenize</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">sentence</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59942867456ab436869043-16\"><span class=\"crayon-h\">    </span><span class=\"crayon-p\"># stem each word</span></div><div class=\"crayon-line\" id=\"crayon-59942867456ab436869043-17\"><span class=\"crayon-h\">    </span><span class=\"crayon-v\">sentence_words</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">[</span><span class=\"crayon-v\">stemmer</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">stem</span><span class=\"crayon-sy\">(</span><span class=\"crayon-t\">word</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">lower</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-st\">for</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">word</span><span class=\"crayon-h\"> </span><span class=\"crayon-st\">in</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">sentence_words</span><span class=\"crayon-sy\">]</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59942867456ab436869043-18\"><span class=\"crayon-h\">    </span><span class=\"crayon-st\">return</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">sentence_words</span></div><div class=\"crayon-line\" id=\"crayon-59942867456ab436869043-19\"> </div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59942867456ab436869043-20\"><span class=\"crayon-p\"># return bag of words array: 0 or 1 for each word in the bag that exists in the sentence</span></div><div class=\"crayon-line\" id=\"crayon-59942867456ab436869043-21\"><span class=\"crayon-e\">def </span><span class=\"crayon-e\">bow</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">sentence</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">words</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">show_details</span><span class=\"crayon-o\">=</span><span class=\"crayon-t\">False</span><span class=\"crayon-sy\">)</span><span class=\"crayon-o\">:</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59942867456ab436869043-22\"><span class=\"crayon-h\">    </span><span class=\"crayon-p\"># tokenize the pattern</span></div><div class=\"crayon-line\" id=\"crayon-59942867456ab436869043-23\"><span class=\"crayon-h\">    </span><span class=\"crayon-v\">sentence_words</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">clean_up_sentence</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">sentence</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59942867456ab436869043-24\"><span class=\"crayon-h\">    </span><span class=\"crayon-p\"># bag of words</span></div><div class=\"crayon-line\" id=\"crayon-59942867456ab436869043-25\"><span class=\"crayon-h\">    </span><span class=\"crayon-v\">bag</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">[</span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">]</span><span class=\"crayon-o\">*</span><span class=\"crayon-e\">len</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">words</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\">  </span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59942867456ab436869043-26\"><span class=\"crayon-h\">    </span><span class=\"crayon-st\">for</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">s</span><span class=\"crayon-h\"> </span><span class=\"crayon-st\">in</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">sentence_words</span><span class=\"crayon-o\">:</span></div><div class=\"crayon-line\" id=\"crayon-59942867456ab436869043-27\"><span class=\"crayon-h\">        </span><span class=\"crayon-st\">for</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">i</span><span class=\"crayon-sy\">,</span><span class=\"crayon-i\">w</span><span class=\"crayon-h\"> </span><span class=\"crayon-st\">in</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">enumerate</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">words</span><span class=\"crayon-sy\">)</span><span class=\"crayon-o\">:</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59942867456ab436869043-28\"><span class=\"crayon-h\">            </span><span class=\"crayon-st\">if</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">w</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">==</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">s</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span></div><div class=\"crayon-line\" id=\"crayon-59942867456ab436869043-29\"><span class=\"crayon-h\">                </span><span class=\"crayon-v\">bag</span><span class=\"crayon-sy\">[</span><span class=\"crayon-v\">i</span><span class=\"crayon-sy\">]</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">1</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59942867456ab436869043-30\"><span class=\"crayon-h\">                </span><span class=\"crayon-st\">if</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">show_details</span><span class=\"crayon-o\">:</span></div><div class=\"crayon-line\" id=\"crayon-59942867456ab436869043-31\"><span class=\"crayon-h\">                    </span><span class=\"crayon-e\">print</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-s\">\"found in bag: %s\"</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">%</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">w</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59942867456ab436869043-32\"> </div><div class=\"crayon-line\" id=\"crayon-59942867456ab436869043-33\"><span class=\"crayon-h\">    </span><span class=\"crayon-st\">return</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">np</span><span class=\"crayon-sy\">.</span><span class=\"crayon-t\">array</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">bag</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59942867456ab436869043-34\"> </div><div class=\"crayon-line\" id=\"crayon-59942867456ab436869043-35\"><span class=\"crayon-e\">def </span><span class=\"crayon-e\">think</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">sentence</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">show_details</span><span class=\"crayon-o\">=</span><span class=\"crayon-t\">False</span><span class=\"crayon-sy\">)</span><span class=\"crayon-o\">:</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59942867456ab436869043-36\"><span class=\"crayon-h\">    </span><span class=\"crayon-v\">x</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">bow</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">sentence</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">lower</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">words</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">show_details</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line\" id=\"crayon-59942867456ab436869043-37\"><span class=\"crayon-h\">    </span><span class=\"crayon-st\">if</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">show_details</span><span class=\"crayon-o\">:</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59942867456ab436869043-38\"><span class=\"crayon-h\">        </span><span class=\"crayon-e\">print</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-s\">\"sentence:\"</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">sentence</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">\"n bow:\"</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">x</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line\" id=\"crayon-59942867456ab436869043-39\"><span class=\"crayon-h\">    </span><span class=\"crayon-p\"># input layer is our bag of words</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59942867456ab436869043-40\"><span class=\"crayon-h\">    </span><span class=\"crayon-v\">l0</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">x</span></div><div class=\"crayon-line\" id=\"crayon-59942867456ab436869043-41\"><span class=\"crayon-h\">    </span><span class=\"crayon-p\"># matrix multiplication of input and hidden layer</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59942867456ab436869043-42\"><span class=\"crayon-h\">    </span><span class=\"crayon-v\">l1</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">sigmoid</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">np</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">dot</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">l0</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">synapse_0</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line\" id=\"crayon-59942867456ab436869043-43\"><span class=\"crayon-h\">    </span><span class=\"crayon-p\"># output layer</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59942867456ab436869043-44\"><span class=\"crayon-h\">    </span><span class=\"crayon-v\">l2</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">sigmoid</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">np</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">dot</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">l1</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">synapse_1</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line\" id=\"crayon-59942867456ab436869043-45\"><span class=\"crayon-h\">    </span><span class=\"crayon-st\">return</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">l2</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0070 seconds] -->\r\n<p>现在我们对神经网络训练函数进行编码，创造连接权重。别太激动，这主要是矩阵乘法——来自中学数学课堂。</p>\n<p><a href=\"http://jbcdn2.b0.upaiyun.com/2017/02/e0e648def4862d31563d98fa1d9e60a4.jpg\"><img class=\"alignnone size-medium wp-image-64665 aligncenter\" src=\"http://jbcdn2.b0.upaiyun.com/2017/02/e0e648def4862d31563d98fa1d9e60a4.jpg\" alt=\"2017-06-03_151025\"></a></p>\n<p>我们现在准备去构建我们的神经网络<em>模型</em>，我们将连接权重保存为json文件。</p>\n<p>你应该尝试不同的“α”（梯度下降参数），看看它是如何影响错误率。此参数有助于错误调整，并找到最低错误率：</p>\n<p>synapse_0 += <strong>alpha</strong> * synapse_0_weight_update</p>\n<p style=\"text-align: center;\"><a href=\"http://jbcdn2.b0.upaiyun.com/2017/08/41e84709aaf122cd41527923403b8e99.png\"><img class=\"alignnone size-full wp-image-112156\" src=\"http://jbcdn2.b0.upaiyun.com/2017/08/41e84709aaf122cd41527923403b8e99.png\" alt=\"1-HZ-YQpdBM4hDbh4Q5FcsMA\"></a></p>\n<p>我们在隐藏层使用了20个神经元，你可以很容易地调整。这些参数将随着于您的训练数据规模的不同而不同，将错误率调整到低于10 ^ – 3是比较合理的。</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-59942867456b0786432625\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-always\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"复制代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\nX = np.array(training)\r\ny = np.array(output)\r\n\r\nstart_time = time.time()\r\n\r\ntrain(X, y, hidden_neurons=20, alpha=0.1, epochs=100000, dropout=False, dropout_percent=0.2)\r\n\r\nelapsed_time = time.time() - start_time\r\nprint (\"processing time:\", elapsed_time, \"seconds\")</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-59942867456b0786432625-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59942867456b0786432625-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-59942867456b0786432625-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59942867456b0786432625-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-59942867456b0786432625-5\">5</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59942867456b0786432625-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-59942867456b0786432625-7\">7</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59942867456b0786432625-8\">8</div><div class=\"crayon-num\" data-line=\"crayon-59942867456b0786432625-9\">9</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-59942867456b0786432625-1\"><span class=\"crayon-v\">X</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">np</span><span class=\"crayon-sy\">.</span><span class=\"crayon-t\">array</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">training</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59942867456b0786432625-2\"><span class=\"crayon-v\">y</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">np</span><span class=\"crayon-sy\">.</span><span class=\"crayon-t\">array</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">output</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line\" id=\"crayon-59942867456b0786432625-3\"> </div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59942867456b0786432625-4\"><span class=\"crayon-v\">start_time</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">time</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">time</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line\" id=\"crayon-59942867456b0786432625-5\"> </div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59942867456b0786432625-6\"><span class=\"crayon-e\">train</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">X</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">y</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">hidden_neurons</span><span class=\"crayon-o\">=</span><span class=\"crayon-cn\">20</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">alpha</span><span class=\"crayon-o\">=</span><span class=\"crayon-cn\">0.1</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">epochs</span><span class=\"crayon-o\">=</span><span class=\"crayon-cn\">100000</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">dropout</span><span class=\"crayon-o\">=</span><span class=\"crayon-t\">False</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">dropout_percent</span><span class=\"crayon-o\">=</span><span class=\"crayon-cn\">0.2</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line\" id=\"crayon-59942867456b0786432625-7\"> </div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59942867456b0786432625-8\"><span class=\"crayon-v\">elapsed_time</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">time</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">time</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">start_time</span></div><div class=\"crayon-line\" id=\"crayon-59942867456b0786432625-9\"><span class=\"crayon-e\">print</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-s\">\"processing time:\"</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">elapsed_time</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">\"seconds\"</span><span class=\"crayon-sy\">)</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0019 seconds] -->\r\n<p></p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-59942867456bc845894226\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-always\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"复制代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\nTraining with 20 neurons, alpha:0.1, dropout:False \r\nInput matrix: 12x26    Output matrix: 1x3\r\ndelta after 10000 iterations:0.0062613597435\r\ndelta after 20000 iterations:0.00428296074919\r\ndelta after 30000 iterations:0.00343930779307\r\ndelta after 40000 iterations:0.00294648034566\r\ndelta after 50000 iterations:0.00261467859609\r\ndelta after 60000 iterations:0.00237219554105\r\ndelta after 70000 iterations:0.00218521899378\r\ndelta after 80000 iterations:0.00203547284581\r\ndelta after 90000 iterations:0.00191211022401\r\ndelta after 100000 iterations:0.00180823798397\r\nsaved synapses to: synapses.json\r\nprocessing time: 6.501226902008057 seconds</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-59942867456bc845894226-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59942867456bc845894226-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-59942867456bc845894226-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59942867456bc845894226-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-59942867456bc845894226-5\">5</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59942867456bc845894226-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-59942867456bc845894226-7\">7</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59942867456bc845894226-8\">8</div><div class=\"crayon-num\" data-line=\"crayon-59942867456bc845894226-9\">9</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59942867456bc845894226-10\">10</div><div class=\"crayon-num\" data-line=\"crayon-59942867456bc845894226-11\">11</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59942867456bc845894226-12\">12</div><div class=\"crayon-num\" data-line=\"crayon-59942867456bc845894226-13\">13</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59942867456bc845894226-14\">14</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-59942867456bc845894226-1\"><span class=\"crayon-e\">Training </span><span class=\"crayon-i\">with</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">20</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">neurons</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">alpha</span><span class=\"crayon-o\">:</span><span class=\"crayon-cn\">0.1</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">dropout</span><span class=\"crayon-o\">:</span><span class=\"crayon-t\">False</span><span class=\"crayon-h\"> </span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59942867456bc845894226-2\"><span class=\"crayon-e\">Input </span><span class=\"crayon-v\">matrix</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">12x26</span><span class=\"crayon-h\">    </span><span class=\"crayon-e\">Output </span><span class=\"crayon-v\">matrix</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">1x3</span></div><div class=\"crayon-line\" id=\"crayon-59942867456bc845894226-3\"><span class=\"crayon-e\">delta </span><span class=\"crayon-i\">after</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">10000</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">iterations</span><span class=\"crayon-o\">:</span><span class=\"crayon-cn\">0.0062613597435</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59942867456bc845894226-4\"><span class=\"crayon-e\">delta </span><span class=\"crayon-i\">after</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">20000</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">iterations</span><span class=\"crayon-o\">:</span><span class=\"crayon-cn\">0.00428296074919</span></div><div class=\"crayon-line\" id=\"crayon-59942867456bc845894226-5\"><span class=\"crayon-e\">delta </span><span class=\"crayon-i\">after</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">30000</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">iterations</span><span class=\"crayon-o\">:</span><span class=\"crayon-cn\">0.00343930779307</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59942867456bc845894226-6\"><span class=\"crayon-e\">delta </span><span class=\"crayon-i\">after</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">40000</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">iterations</span><span class=\"crayon-o\">:</span><span class=\"crayon-cn\">0.00294648034566</span></div><div class=\"crayon-line\" id=\"crayon-59942867456bc845894226-7\"><span class=\"crayon-e\">delta </span><span class=\"crayon-i\">after</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">50000</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">iterations</span><span class=\"crayon-o\">:</span><span class=\"crayon-cn\">0.00261467859609</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59942867456bc845894226-8\"><span class=\"crayon-e\">delta </span><span class=\"crayon-i\">after</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">60000</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">iterations</span><span class=\"crayon-o\">:</span><span class=\"crayon-cn\">0.00237219554105</span></div><div class=\"crayon-line\" id=\"crayon-59942867456bc845894226-9\"><span class=\"crayon-e\">delta </span><span class=\"crayon-i\">after</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">70000</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">iterations</span><span class=\"crayon-o\">:</span><span class=\"crayon-cn\">0.00218521899378</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59942867456bc845894226-10\"><span class=\"crayon-e\">delta </span><span class=\"crayon-i\">after</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">80000</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">iterations</span><span class=\"crayon-o\">:</span><span class=\"crayon-cn\">0.00203547284581</span></div><div class=\"crayon-line\" id=\"crayon-59942867456bc845894226-11\"><span class=\"crayon-e\">delta </span><span class=\"crayon-i\">after</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">90000</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">iterations</span><span class=\"crayon-o\">:</span><span class=\"crayon-cn\">0.00191211022401</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59942867456bc845894226-12\"><span class=\"crayon-e\">delta </span><span class=\"crayon-i\">after</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">100000</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">iterations</span><span class=\"crayon-o\">:</span><span class=\"crayon-cn\">0.00180823798397</span></div><div class=\"crayon-line\" id=\"crayon-59942867456bc845894226-13\"><span class=\"crayon-e\">saved </span><span class=\"crayon-e\">synapses </span><span class=\"crayon-st\">to</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">synapses</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">json</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59942867456bc845894226-14\"><span class=\"crayon-e\">processing </span><span class=\"crayon-v\">time</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">6.501226902008057</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">seconds</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0028 seconds] -->\r\n<p>synapse.json文件中包含了全部的连接权重，<strong>这就是我们的模型</strong>。</p>\n<p style=\"text-align: center;\"><a href=\"http://jbcdn2.b0.upaiyun.com/2017/08/8b07f3b20cfc25210fcad980aebab930.jpeg\"><img class=\"alignnone size-full wp-image-112157\" src=\"http://jbcdn2.b0.upaiyun.com/2017/08/8b07f3b20cfc25210fcad980aebab930.jpeg\" alt=\"1-qYkCgPE3DD26VD-qDwsicA\"></a></p>\n<p>一旦连接权重已经计算完成，对于分类来说只需要classify()函数了：大约15行代码</p>\n<p>备注：如果训练集有变化，我们的模型需要重新计算。对于非常大的数据集，这需要较长的时间。</p>\n<p>现在我们可以生成一个句子属于一个或者多个分类的概率了。它的速度非常快，这是因为我们之前定义的think()函数中的点积运算。</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-59942867456c1841358668\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-always\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"复制代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\n# probability threshold\r\nERROR_THRESHOLD = 0.2\r\n# load our calculated synapse values\r\nsynapse_file = 'synapses.json' \r\nwith open(synapse_file) as data_file: \r\n    synapse = json.load(data_file) \r\n    synapse_0 = np.asarray(synapse['synapse0']) \r\n    synapse_1 = np.asarray(synapse['synapse1'])\r\n\r\ndef classify(sentence, show_details=False):\r\n    results = think(sentence, show_details)\r\n\r\n    results = [[i,r] for i,r in enumerate(results) if r&gt;ERROR_THRESHOLD ] \r\n    results.sort(key=lambda x: x[1], reverse=True) \r\n    return_results =[[classes[r[0]],r[1]] for r in results]\r\n    print (\"%s n classification: %s\" % (sentence, return_results))\r\n    return return_results\r\n\r\nclassify(\"sudo make me a sandwich\")\r\nclassify(\"how are you today?\")\r\nclassify(\"talk to you tomorrow\")\r\nclassify(\"who are you?\")\r\nclassify(\"make me some lunch\")\r\nclassify(\"how was your lunch today?\")\r\nprint()\r\nclassify(\"good day\", show_details=True)</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-59942867456c1841358668-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59942867456c1841358668-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-59942867456c1841358668-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59942867456c1841358668-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-59942867456c1841358668-5\">5</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59942867456c1841358668-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-59942867456c1841358668-7\">7</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59942867456c1841358668-8\">8</div><div class=\"crayon-num\" data-line=\"crayon-59942867456c1841358668-9\">9</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59942867456c1841358668-10\">10</div><div class=\"crayon-num\" data-line=\"crayon-59942867456c1841358668-11\">11</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59942867456c1841358668-12\">12</div><div class=\"crayon-num\" data-line=\"crayon-59942867456c1841358668-13\">13</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59942867456c1841358668-14\">14</div><div class=\"crayon-num\" data-line=\"crayon-59942867456c1841358668-15\">15</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59942867456c1841358668-16\">16</div><div class=\"crayon-num\" data-line=\"crayon-59942867456c1841358668-17\">17</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59942867456c1841358668-18\">18</div><div class=\"crayon-num\" data-line=\"crayon-59942867456c1841358668-19\">19</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59942867456c1841358668-20\">20</div><div class=\"crayon-num\" data-line=\"crayon-59942867456c1841358668-21\">21</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59942867456c1841358668-22\">22</div><div class=\"crayon-num\" data-line=\"crayon-59942867456c1841358668-23\">23</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59942867456c1841358668-24\">24</div><div class=\"crayon-num\" data-line=\"crayon-59942867456c1841358668-25\">25</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59942867456c1841358668-26\">26</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-59942867456c1841358668-1\"><span class=\"crayon-p\"># probability threshold</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59942867456c1841358668-2\"><span class=\"crayon-v\">ERROR_THRESHOLD</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0.2</span></div><div class=\"crayon-line\" id=\"crayon-59942867456c1841358668-3\"><span class=\"crayon-p\"># load our calculated synapse values</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59942867456c1841358668-4\"><span class=\"crayon-v\">synapse_file</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">'synapses.json'</span><span class=\"crayon-h\"> </span></div><div class=\"crayon-line\" id=\"crayon-59942867456c1841358668-5\"><span class=\"crayon-e\">with </span><span class=\"crayon-e\">open</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">synapse_file</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-st\">as</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">data_file</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59942867456c1841358668-6\"><span class=\"crayon-h\">    </span><span class=\"crayon-v\">synapse</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">json</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">load</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">data_file</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span></div><div class=\"crayon-line\" id=\"crayon-59942867456c1841358668-7\"><span class=\"crayon-h\">    </span><span class=\"crayon-v\">synapse_0</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">np</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">asarray</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">synapse</span><span class=\"crayon-sy\">[</span><span class=\"crayon-s\">'synapse0'</span><span class=\"crayon-sy\">]</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59942867456c1841358668-8\"><span class=\"crayon-h\">    </span><span class=\"crayon-v\">synapse_1</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">np</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">asarray</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">synapse</span><span class=\"crayon-sy\">[</span><span class=\"crayon-s\">'synapse1'</span><span class=\"crayon-sy\">]</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line\" id=\"crayon-59942867456c1841358668-9\"> </div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59942867456c1841358668-10\"><span class=\"crayon-e\">def </span><span class=\"crayon-e\">classify</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">sentence</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">show_details</span><span class=\"crayon-o\">=</span><span class=\"crayon-t\">False</span><span class=\"crayon-sy\">)</span><span class=\"crayon-o\">:</span></div><div class=\"crayon-line\" id=\"crayon-59942867456c1841358668-11\"><span class=\"crayon-h\">    </span><span class=\"crayon-v\">results</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">think</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">sentence</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">show_details</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59942867456c1841358668-12\"> </div><div class=\"crayon-line\" id=\"crayon-59942867456c1841358668-13\"><span class=\"crayon-h\">    </span><span class=\"crayon-v\">results</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">[</span><span class=\"crayon-sy\">[</span><span class=\"crayon-v\">i</span><span class=\"crayon-sy\">,</span><span class=\"crayon-v\">r</span><span class=\"crayon-sy\">]</span><span class=\"crayon-h\"> </span><span class=\"crayon-st\">for</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">i</span><span class=\"crayon-sy\">,</span><span class=\"crayon-i\">r</span><span class=\"crayon-h\"> </span><span class=\"crayon-st\">in</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">enumerate</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">results</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-st\">if</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">r</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-v\">ERROR</span><span class=\"crayon-sy\">_</span>THRESHOLD<span class=\"crayon-h\"> </span><span class=\"crayon-sy\">]</span><span class=\"crayon-h\"> </span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59942867456c1841358668-14\"><span class=\"crayon-h\">    </span><span class=\"crayon-v\">results</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">sort</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">key</span><span class=\"crayon-o\">=</span><span class=\"crayon-i\">lambda</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">x</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">x</span><span class=\"crayon-sy\">[</span><span class=\"crayon-cn\">1</span><span class=\"crayon-sy\">]</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">reverse</span><span class=\"crayon-o\">=</span><span class=\"crayon-t\">True</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span></div><div class=\"crayon-line\" id=\"crayon-59942867456c1841358668-15\"><span class=\"crayon-h\">    </span><span class=\"crayon-v\">return_results</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-sy\">[</span><span class=\"crayon-sy\">[</span><span class=\"crayon-v\">classes</span><span class=\"crayon-sy\">[</span><span class=\"crayon-v\">r</span><span class=\"crayon-sy\">[</span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">]</span><span class=\"crayon-sy\">]</span><span class=\"crayon-sy\">,</span><span class=\"crayon-v\">r</span><span class=\"crayon-sy\">[</span><span class=\"crayon-cn\">1</span><span class=\"crayon-sy\">]</span><span class=\"crayon-sy\">]</span><span class=\"crayon-h\"> </span><span class=\"crayon-st\">for</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">r</span><span class=\"crayon-h\"> </span><span class=\"crayon-st\">in</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">results</span><span class=\"crayon-sy\">]</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59942867456c1841358668-16\"><span class=\"crayon-h\">    </span><span class=\"crayon-e\">print</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-s\">\"%s n classification: %s\"</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">%</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">sentence</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">return_results</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line\" id=\"crayon-59942867456c1841358668-17\"><span class=\"crayon-h\">    </span><span class=\"crayon-st\">return</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">return_results</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59942867456c1841358668-18\"> </div><div class=\"crayon-line\" id=\"crayon-59942867456c1841358668-19\"><span class=\"crayon-e\">classify</span><span class=\"crayon-sy\">(</span><span class=\"crayon-s\">\"sudo make me a sandwich\"</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59942867456c1841358668-20\"><span class=\"crayon-e\">classify</span><span class=\"crayon-sy\">(</span><span class=\"crayon-s\">\"how are you today?\"</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line\" id=\"crayon-59942867456c1841358668-21\"><span class=\"crayon-e\">classify</span><span class=\"crayon-sy\">(</span><span class=\"crayon-s\">\"talk to you tomorrow\"</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59942867456c1841358668-22\"><span class=\"crayon-e\">classify</span><span class=\"crayon-sy\">(</span><span class=\"crayon-s\">\"who are you?\"</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line\" id=\"crayon-59942867456c1841358668-23\"><span class=\"crayon-e\">classify</span><span class=\"crayon-sy\">(</span><span class=\"crayon-s\">\"make me some lunch\"</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59942867456c1841358668-24\"><span class=\"crayon-e\">classify</span><span class=\"crayon-sy\">(</span><span class=\"crayon-s\">\"how was your lunch today?\"</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line\" id=\"crayon-59942867456c1841358668-25\"><span class=\"crayon-e\">print</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59942867456c1841358668-26\"><span class=\"crayon-e\">classify</span><span class=\"crayon-sy\">(</span><span class=\"crayon-s\">\"good day\"</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">show_details</span><span class=\"crayon-o\">=</span><span class=\"crayon-t\">True</span><span class=\"crayon-sy\">)</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0048 seconds] -->\r\n<p></p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-59942867456c8846707850\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-always\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"复制代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\n&lt;strong&gt;sudo make me a sandwich &lt;/strong&gt;\r\n [['sandwich', 0.99917711814437993]]\r\n&lt;strong&gt;how are you today? &lt;/strong&gt;\r\n [['greeting', 0.99864563257858363]]\r\n&lt;strong&gt;talk to you tomorrow &lt;/strong&gt;\r\n [['goodbye', 0.95647479275905511]]\r\n&lt;strong&gt;who are you? &lt;/strong&gt;\r\n [['greeting', 0.8964283843977312]]\r\n&lt;strong&gt;make me some lunch&lt;/strong&gt; \r\n [['sandwich', 0.95371924052636048]]\r\n&lt;strong&gt;how was your lunch today? &lt;/strong&gt;\r\n [['greeting', 0.99120883810944971], ['sandwich', 0.31626066870883057]]</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-59942867456c8846707850-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59942867456c8846707850-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-59942867456c8846707850-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59942867456c8846707850-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-59942867456c8846707850-5\">5</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59942867456c8846707850-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-59942867456c8846707850-7\">7</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59942867456c8846707850-8\">8</div><div class=\"crayon-num\" data-line=\"crayon-59942867456c8846707850-9\">9</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59942867456c8846707850-10\">10</div><div class=\"crayon-num\" data-line=\"crayon-59942867456c8846707850-11\">11</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59942867456c8846707850-12\">12</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-59942867456c8846707850-1\"><span class=\"crayon-o\">&lt;</span><span class=\"crayon-v\">strong</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-e\">sudo </span><span class=\"crayon-e\">make </span><span class=\"crayon-i\">me</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">a</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">sandwich</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-o\">/</span><span class=\"crayon-v\">strong</span><span class=\"crayon-o\">&gt;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59942867456c8846707850-2\"><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">[</span><span class=\"crayon-sy\">[</span><span class=\"crayon-s\">'sandwich'</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0.99917711814437993</span><span class=\"crayon-sy\">]</span><span class=\"crayon-sy\">]</span></div><div class=\"crayon-line\" id=\"crayon-59942867456c8846707850-3\"><span class=\"crayon-o\">&lt;</span><span class=\"crayon-v\">strong</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-e\">how </span><span class=\"crayon-e\">are </span><span class=\"crayon-e\">you </span><span class=\"crayon-v\">today</span><span class=\"crayon-sy\">?</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-o\">/</span><span class=\"crayon-v\">strong</span><span class=\"crayon-o\">&gt;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59942867456c8846707850-4\"><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">[</span><span class=\"crayon-sy\">[</span><span class=\"crayon-s\">'greeting'</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0.99864563257858363</span><span class=\"crayon-sy\">]</span><span class=\"crayon-sy\">]</span></div><div class=\"crayon-line\" id=\"crayon-59942867456c8846707850-5\"><span class=\"crayon-o\">&lt;</span><span class=\"crayon-v\">strong</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-e\">talk </span><span class=\"crayon-st\">to</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">you </span><span class=\"crayon-v\">tomorrow</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-o\">/</span><span class=\"crayon-v\">strong</span><span class=\"crayon-o\">&gt;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59942867456c8846707850-6\"><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">[</span><span class=\"crayon-sy\">[</span><span class=\"crayon-s\">'goodbye'</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0.95647479275905511</span><span class=\"crayon-sy\">]</span><span class=\"crayon-sy\">]</span></div><div class=\"crayon-line\" id=\"crayon-59942867456c8846707850-7\"><span class=\"crayon-o\">&lt;</span><span class=\"crayon-v\">strong</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-e\">who </span><span class=\"crayon-e\">are </span><span class=\"crayon-v\">you</span><span class=\"crayon-sy\">?</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-o\">/</span><span class=\"crayon-v\">strong</span><span class=\"crayon-o\">&gt;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59942867456c8846707850-8\"><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">[</span><span class=\"crayon-sy\">[</span><span class=\"crayon-s\">'greeting'</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0.8964283843977312</span><span class=\"crayon-sy\">]</span><span class=\"crayon-sy\">]</span></div><div class=\"crayon-line\" id=\"crayon-59942867456c8846707850-9\"><span class=\"crayon-o\">&lt;</span><span class=\"crayon-v\">strong</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-e\">make </span><span class=\"crayon-e\">me </span><span class=\"crayon-e\">some </span><span class=\"crayon-v\">lunch</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-o\">/</span><span class=\"crayon-v\">strong</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59942867456c8846707850-10\"><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">[</span><span class=\"crayon-sy\">[</span><span class=\"crayon-s\">'sandwich'</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0.95371924052636048</span><span class=\"crayon-sy\">]</span><span class=\"crayon-sy\">]</span></div><div class=\"crayon-line\" id=\"crayon-59942867456c8846707850-11\"><span class=\"crayon-o\">&lt;</span><span class=\"crayon-v\">strong</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-e\">how </span><span class=\"crayon-e\">was </span><span class=\"crayon-e\">your </span><span class=\"crayon-e\">lunch </span><span class=\"crayon-v\">today</span><span class=\"crayon-sy\">?</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-o\">/</span><span class=\"crayon-v\">strong</span><span class=\"crayon-o\">&gt;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59942867456c8846707850-12\"><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">[</span><span class=\"crayon-sy\">[</span><span class=\"crayon-s\">'greeting'</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0.99120883810944971</span><span class=\"crayon-sy\">]</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">[</span><span class=\"crayon-s\">'sandwich'</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0.31626066870883057</span><span class=\"crayon-sy\">]</span><span class=\"crayon-sy\">]</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0029 seconds] -->\r\n<p>你可以用其它语句、不同概率来试验几次，也可以添加训练数据来改进／扩展当前的模型。尤其注意用很少的训练数据就得到稳定的预测结果。</p>\n<p>有一些句子将会产生多个预测结果（高于阈值）。你需要给你的程序设定一个合适的阈值。并非所有的文本分类方案都是相同的：<em>一些预测情况比其他预测需要更高的置信水平</em>。</p>\n<p>最后这个分类结果展示了一些内部的细节：</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-59942867456cd816177320\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-always\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"复制代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\nfound in bag: good\r\nfound in bag: day\r\nsentence: **good day** \r\n bow: [0 0 0 0 0 0 1 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]\r\ngood day \r\n [['greeting', 0.99664077655648697]]</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-59942867456cd816177320-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59942867456cd816177320-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-59942867456cd816177320-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59942867456cd816177320-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-59942867456cd816177320-5\">5</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59942867456cd816177320-6\">6</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-59942867456cd816177320-1\"><span class=\"crayon-e\">found </span><span class=\"crayon-st\">in</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">bag</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">good</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59942867456cd816177320-2\"><span class=\"crayon-e\">found </span><span class=\"crayon-st\">in</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">bag</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">day</span></div><div class=\"crayon-line\" id=\"crayon-59942867456cd816177320-3\"><span class=\"crayon-v\">sentence</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">*</span><span class=\"crayon-o\">*</span><span class=\"crayon-e\">good </span><span class=\"crayon-e \">day*</span><span class=\"crayon-o\">*</span><span class=\"crayon-h\"> </span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59942867456cd816177320-4\"><span class=\"crayon-h\"> </span><span class=\"crayon-v\">bow</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">[</span><span class=\"crayon-cn\">0</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">1</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">1</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">]</span></div><div class=\"crayon-line\" id=\"crayon-59942867456cd816177320-5\"><span class=\"crayon-e\">good </span><span class=\"crayon-i\">day</span><span class=\"crayon-h\"> </span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59942867456cd816177320-6\"><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">[</span><span class=\"crayon-sy\">[</span><span class=\"crayon-s\">'greeting'</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0.99664077655648697</span><span class=\"crayon-sy\">]</span><span class=\"crayon-sy\">]</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0019 seconds] -->\r\n<p>从这个句子的词包中可以看到，有两个单词和我们的词库是匹配的。同时我们的神经网络从这些 0 代表的非匹配词语中学习了。</p>\n<p>如果提供一个仅仅有一个常用单词 ‘a’ 被匹配的句子，那我们会得到一个低概率的分类结果A：</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-59942867456d1392646684\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-always\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"复制代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\nfound in bag: a\r\nsentence: **a burrito! **\r\n bow: [0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]\r\na burrito! \r\n [['sandwich', 0.61776860634647834]]</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-59942867456d1392646684-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59942867456d1392646684-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-59942867456d1392646684-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59942867456d1392646684-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-59942867456d1392646684-5\">5</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-59942867456d1392646684-1\"><span class=\"crayon-e\">found </span><span class=\"crayon-st\">in</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">bag</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">a</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59942867456d1392646684-2\"><span class=\"crayon-v\">sentence</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">*</span><span class=\"crayon-o\">*</span><span class=\"crayon-i\">a</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">burrito</span><span class=\"crayon-o\">!</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">*</span><span class=\"crayon-o\">*</span></div><div class=\"crayon-line\" id=\"crayon-59942867456d1392646684-3\"><span class=\"crayon-h\"> </span><span class=\"crayon-v\">bow</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">[</span><span class=\"crayon-cn\">0</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">1</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">]</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59942867456d1392646684-4\"><span class=\"crayon-i\">a</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">burrito</span><span class=\"crayon-o\">!</span><span class=\"crayon-h\"> </span></div><div class=\"crayon-line\" id=\"crayon-59942867456d1392646684-5\"><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">[</span><span class=\"crayon-sy\">[</span><span class=\"crayon-s\">'sandwich'</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0.61776860634647834</span><span class=\"crayon-sy\">]</span><span class=\"crayon-sy\">]</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0019 seconds] -->\r\n<p>现在你已经掌握了构建聊天机器人的一些基础知识结构，它能处理大量不同的意图，并且对于有限或者海量的训练数据都能很好的适配。想要为某个意图添加一个或者多个响应实在轻而易举，就不必多讲了。</p>\n<h4>Enjoy!</h4>\n\r\n        \r\n            <blockquote class=\"rewards\">\n        <p><strong>打赏支持我翻译更多好文章，谢谢！</strong></p>\n        <a href=\"#rewardbox\" id=\"rewards-button\" class=\"fancybox\"><span class=\"btn-bluet-blue href-style\"><i class=\"fa fa-jpy\"></i> 打赏译者</span></a>\n    </blockquote>\n\n    <div id=\"rewardbox\">\n        <h4>打赏支持我翻译更多好文章，谢谢！</h4>\n                <p>任选一种支付方式</p>\n                <p>\n                        <img src=\"http://jbcdn2.b0.upaiyun.com/2017/04/9d1537dc33c0a291a88e68a8d61b1cd2.jpg\">\n            \n                            <img src=\"http://jbcdn2.b0.upaiyun.com/2017/04/ac2801b765615f93574f10b0ac15990b.jpg\">\n                    </p>\n    </div>\n\n    \r\n        \n    <div class=\"post-adds\">\n        <span data-post-id=\"112049\" class=\" btn-bluet-bigger href-style vote-post-up   register-user-only \"><i class=\"fa  fa-thumbs-o-up\"></i> <h10 id=\"112049votetotal\">1</h10> 赞</span>\n        <span data-book-type=\"1\" data-site-id=\"2\" data-item-id=\"112049\" data-item-type=\"1\" class=\" btn-bluet-bigger href-style bookmark-btn  register-user-only \"><i class=\"fa fa-bookmark-o  \"></i> 2 收藏</span>\n\n                    <a href=\"#article-comment\"><span class=\"btn-bluet-bigger href-style hide-on-480\"><i class=\"fa fa-comments-o\"></i>  评论</span></a>\n        \n        \n        \n        <!-- JiaThis Button BEGIN -->\n        <div class=\"jiathis_style_24x24\" style=\"display: inline-flex; position: relative; margin: 0; clear: both;float: right;\">\n            <a class=\"jiathis_button_tsina\"></a>\n            <a class=\"jiathis_button_weixin\"></a>\n            <a class=\"jiathis_button_qzone\"></a>\n            <a class=\"jiathis_button_fb hide-on-480\"></a>\n            <a href=\"http://www.jiathis.com/share?uid=1745061\" class=\"jiathis jiathis_txt jiathis_separator jtico jtico_jiathis\" target=\"_blank\"></a>\n        </div>\n\n    </div>\n\n\n\n\r\n        <!-- BEGIN #author-bio -->\r\n\r\n<div id=\"author-bio\">\r\n\t\r\n\t<h3 class=\"widget-title\">\r\n\t关于作者：<a target=\"_blank\" href=\"http://www.jobbole.com/members/2106382253\">Anne90</a>\r\n\t</h3>\r\n\t<div class=\"alignleft\">\r\n\t\t<a target=\"_blank\" href=\"http://www.jobbole.com/members/2106382253\">\r\n\t\t\t<img src=\"http://jbcdn2.b0.upaiyun.com/2017/04/ee02ba031bee9222a2878fe9565d65a6.jpg\">\r\n\t\t</a>\r\n\t</div>\r\n\r\n    <div class=\"author-bio-info\">\r\n\r\n        <span class=\"author-bio-info-block\">\r\n            软件开发测试工程师，关注互联网/软件测试相关        </span>\r\n        <span class=\"author-bio-info-block\">\r\n            <a href=\"http://www.jobbole.com/members/2106382253\" target=\"_blank\"><i class=\"fa fa-user\"></i> 个人主页</a> ·\r\n            <a href=\"http://blog.jobbole.com/author/2106382253/\" target=\"_blank\"><i class=\"fa fa-file-text-o\"></i> 我的文章</a>\r\n\r\n             · <a title=\"声望值\" target=\"_blank\" href=\"http://www.jobbole.com/members/2106382253/reputation/\"><i class=\"fa fa-graduation-cap\"></i> 10</a> · <a title=\"微博主页\" target=\"_blank\" href=\"http://weibo.com/2106382253\"><i class=\"fa fa-weibo\"></i></a>         </span>\r\n    </div>\r\n\t<div class=\"clear\"></div>\r\n</div>\r\n\r\n<!-- END #author-bio -->\r\n\t</div>", "front_image_path": ["full/dc3f3abe02d5786d6d2caa044b15d4e14cafdcfa.jpg"]},{"title": "一文带你理解深度学习的局限性", "url": "http://blog.jobbole.com/112109/", "url_object_id": "4328959c58aa9ead28de3477f219829b", "create_date": "2017/08/03", "front_image_url": ["http://jbcdn2.b0.upaiyun.com/2016/08/c4ec441b51f9ac4f55dc702a6ae0e757.jpg"], "praise_nums": "2", "fav_nums": "2", "comment_nums": "1", "tags": "IT技术,深度学习", "content": "<div class=\"entry\">\r\n\r\n        \t\t\t<div class=\"textwidget\"></div>\n\t\t\r\n\t\t<div class=\"copyright-area\">原文出处： <a ref=\"nofollow\" target=\"_blank\" href=\"https://blog.keras.io/the-limitations-of-deep-learning.html\">Francois Chollet</a>   译文出处：<a target=\"_blank\" href=\"http://www.iteye.com/news/32557\">CSDN - 聂震坤</a>   </div><h3><strong>深度学习：几何视图</strong></h3>\n<p>深度学习最令人惊讶的特点便是极易上手。十年以前，没有人可以猜得到经过梯度下降法训练过的简单参数模型可以在机器感知问题上实现如此惊人的结果。现在，事实证明，研究者所需要做的只是使用足够大的梯度下降素材来训练参数模型。正如 Feynman 曾经描述宇宙一样，“它并不复杂，只是里面包含的东西实在太多。”</p>\n<p>在深度学习中，所有的东西都是一个向量（任何的东西都是几何空间中的一个点）。模型的输入（可能是文字，图片，等等）和目标首先被向量化（变成了一些初始输入向量空间和目标向量空间）。深度学习模型中的每个层都对通过它的数据进行一个简单的几何变换。同时，模型的层链形成一个非常复杂的几何变换，分解成一系列简单的几何变换。这种复杂的转换尝试将输入空间映射到目标空间，一次一个点。该变换按层级的比重进行参数化，这些层根据模型当前执行的程度进行迭代更新。这种几何变换的一个关键特征是它必须是可微分的，这是为了使我们能够通过梯度下降来学习来获得其参数。更直接一点，这意味着从输入到输出的几何变形必须是平滑和连续的——这是一个显着的约束。</p>\n<p>这种复杂的几何变换应用到输入数据的整个过程可以理解为一个试图破坏纸球的人在3D中被可视化。褶皱的纸球可以理解为模型开始时的大量输入数据。每一次人的行为则是数据通过不同层级被处理的过程。完整的不起眼的人的手势序列是整个模型的复杂变换。深度学习模型是用于解决高维数据的复杂流形的数学机器。</p>\n<p>这便是深度学习的奥妙：将含义转化为向量，几何空间，然后逐步学习将一个空间映射到另一个空间的复杂几何变换。所以开发者需要有足够高的维度的空间以便拥有原始数据关系的全部范围。</p>\n<p><strong>深度学习的局限性</strong></p>\n<p>可以通过这种简单策略实现的应用程序空间几乎是无限的。然而到目前为止，更多的应用程序对于当前的深入学习技术是完全无法实现的——即使是大量人为注释的数据。例如，你可以组装一个数据，数十万甚至数百万的英文语言描述软件产品的功能。由产品经理编写，由一个团队开发的相应的源代码并且有工程师满足这些要求。即使有这些数据，也不能训练出一个深入的学习模型来简单地阅读产品描述并生成相应的代码库。这只是其中一个例子。</p>\n<p>一般来说，无论投入多少数据，任何需要推理式编程或应用科学方法（长期规划和类似算法的数据操作）都无法使用深度学习模式进行实现。 即使是学习具有深层神经网络的排序算法也是非常困难的。</p>\n<p>这是因为一个深入的学习模型是“简单的”连续的几何变换链，将一个向量空间映射到另一个。他所可以做的是将一个数据包X映射到另一个数据包Y，并假设存在从X到Y的可学习的连续变换与X:Y的秘籍采用可用性作的数据。所以即使一个深入的学习模型可以被解释为一种程序，相反的大多数程序不能表示为深度学习模型 – 对于大多数任务，要么没有相应的实际大小的深层神经网络来解决任务，要么即使存在一个，它也可能不可学习，即相应的几何变换可能太复杂，或者可能没有可用的数据来学习它。通过堆叠更多层次和使用更多的培训数据来扩展当前的深度学习技术，只能表面缓解其中的一些问题。 深度学习模式在可以代表的方面是非常有限的，而且大多数希望学习的程序不能被表达为连续几何变形的数据流。</p>\n<p><strong>拟人化机器学习模型的隐患</strong></p>\n<p>现阶段人工智能的一个不得不面对的问题在于研究者们误解了深度学习模式的做法，并高估了自己的实力。人类思想的一个根本特征是我们的“主观意识”，我们倾向于对我们周围的事物投射意向，信仰和知识。在一个石头上画一个笑脸感觉石头都变高兴了。同样在深度学习中，当我们有能力成功地训练一个模型来创作描述图片的标题时，我们误认为该模型“理解”图片的内容以及它产生的标题。然而，当轻微改变训练数据中存在的图像时，研发者会非常惊讶的发现模型开始创作完全荒谬的字幕。</p>\n<div><img class=\"aligncenter\" src=\"http://jbcdn2.b0.upaiyun.com/2017/08/80b358a0334bd3f848b9040a6ecc43b0.png\"></div>\n<h3>通常，这类行为被强调为对抗例子，是通过向深度学习网络输出错误的样本来欺骗模型进行分类。通过梯度上升，可以稍微修改图像，以便最大化给定类的预测。 通过拍摄一只熊猫，并添加一个“长臂猿”梯度，我们可以得到一个神经网络将这只熊猫分类为长臂猿。 这证明了这些模型的脆弱性，以及它们运行的输入到输出映射与我们自己的人类感知之间的深刻差异。</h3>\n<div><img class=\"aligncenter\" src=\"http://jbcdn2.b0.upaiyun.com/2017/08/28bc6f2c7b510a1638a064d2f67bb284.png\"></div>\n<h3>简而言之，深度学习模式对他们的输入没有任何理解，至少不是从人的意义上来说。我们对图像，声音和语言的理解是基于我们的运动感觉体验。然而机器人却没有这种经验，因此不能以任何以人为本的方式理解他们的驶入。通过输入大量的培训示例来训练我们的模型，我们让他们学习一个几何变换，将数据映射到这个特定的一组示例上的人类概念，但是这个映射只是我们思想中原始模型的简单草图， 从我们的体验中发展出来的假想——就像一面镜子中的一个昏暗的形象。</h3>\n<div><img class=\"aligncenter\" src=\"http://jbcdn2.b0.upaiyun.com/2017/08/1ed2a28a045dfe53e0409369570c5fb6.png\"></div>\n<h3>作为一名机器学习从业者，始终要注意这一点，不要陷入陷阱，认为神经网络了解他们所执行的任务（并不会） – 至少不会对我们有意义。 他们接受了不同于我们教导，进行了不同的，更窄的任务的训练：即将训练投入与训练目标进行比较。 如果向他们展示偏离训练数据的任何东西，机器将以最荒谬的方式打破以前的结论。</h3>\n<p><strong>局部泛化与极端泛化</strong></p>\n<p>在深度学习模型所做的输入与输出之间的简单的几何变形以及人类思考和学习的方式之间似乎存在着根本的区别。人类不仅仅是从亲身体验中进行学习，还提供了明确的学习方法。除了不同的学习过程外，底层的特性有着根本的却别。</p>\n<p>人类的能力远不止对刺激做出回应，因为深网或者昆虫也可以。人会对目前的情况形成抽象复杂的模型，并根据这些模型来预测不同的未来，且进行长期的规划。人类有能力将已知的概念融合在一起，来表现以前从未经历过的事情，比如穿着牛仔裤的马，或者想象如果中了彩票会做什么。这种处理假设的能力，使我们的心理模型空间远远超过了我们可以直接体验到的一切。这种行为被称为极端泛化。</p>\n<p>这与深层网络的局部泛化形成了鲜明的对比：如果训练时间内新的输入信息差异甚微，则停止从输入到输出的映射。假设使用机器来学习适当的发射参数以解决火箭登陆月球的问题，在使用深网进行此项任务时，无论是使用监督学习还是强化学习进行培训，都需要数以千万次的启动试验作为补充，以便学习从入空间到输出空间的可靠映射。相比之下，人类可以利用抽象能力来提出物理模型——火箭科学，并得到一个精确地解决方案，只需要一次或几次时间即可以让火箭成功登月。同理，如果开发一款控制人体的深网，并希望他学会安全的在城市里行驶。那么在在这种情况下则需要现在各种情况下死掉数千次直到可以推断出危险的行车路线并制定合适的回避行为。当进入一个新的城市，深网有需要重新学习大部分知识。相反，人类能够直接学习安全行为而不用经历死亡，这都要归功于人脑的抽象建模。</p>\n<div><img class=\"aligncenter\" src=\"http://jbcdn2.b0.upaiyun.com/2017/08/cff17cac3a2dbd53c2f8a966899831d1.png\"></div>\n<h3>简而言之，尽管我们在机器感知方面取得了不小的进步，但是我们仍然离人类级别的人工智能有很大区别。我们的模型只能执行局部泛化，在过去中学习来适应最新的情况。而人类可以极端泛化，迅速适应大胆新奇的情况，或为长期未来的情况进行规划。</h3>\n<p><strong>总结</strong></p>\n<p>作为一个开发者应当记住：迄今为止，深入学习的唯一真正的成功是使用大量的人为注释的数据让机器使用连续的几何变换将空间X映射到空间Y。 做好这一切，则可以改变行业的游戏规则。但想让AI拥有人类的智慧，仍然有很长的路要走。</p>\n\r\n        \r\n        \r\n        \n    <div class=\"post-adds\">\n        <span data-post-id=\"112109\" class=\" btn-bluet-bigger href-style vote-post-up   register-user-only \"><i class=\"fa  fa-thumbs-o-up\"></i> <h10 id=\"112109votetotal\">2</h10> 赞</span>\n        <span data-book-type=\"1\" data-site-id=\"2\" data-item-id=\"112109\" data-item-type=\"1\" class=\" btn-bluet-bigger href-style bookmark-btn  register-user-only \"><i class=\"fa fa-bookmark-o  \"></i> 2 收藏</span>\n\n                    <a href=\"#article-comment\"><span class=\"btn-bluet-bigger href-style hide-on-480\"><i class=\"fa fa-comments-o\"></i> 1 评论</span></a>\n        \n        \n        \n        <!-- JiaThis Button BEGIN -->\n        <div class=\"jiathis_style_24x24\" style=\"display: inline-flex; position: relative; margin: 0; clear: both;float: right;\">\n            <a class=\"jiathis_button_tsina\"></a>\n            <a class=\"jiathis_button_weixin\"></a>\n            <a class=\"jiathis_button_qzone\"></a>\n            <a class=\"jiathis_button_fb hide-on-480\"></a>\n            <a href=\"http://www.jiathis.com/share?uid=1745061\" class=\"jiathis jiathis_txt jiathis_separator jtico jtico_jiathis\" target=\"_blank\"></a>\n        </div>\n\n    </div>\n\n\n\n\r\n        <!-- BEGIN #author-bio -->\r\n\r\n\r\n<!-- END #author-bio -->\r\n\t</div>", "front_image_path": ["full/13524960e8d4632f6f07ce3aa9b88181ad54518f.jpg"]},{"title": "你的时间值多少钱？", "url": "http://blog.jobbole.com/112127/", "url_object_id": "594e76e00f6ec905e2cdae3003e50c75", "create_date": "2017/08/08", "front_image_url": ["http://wx4.sinaimg.cn/large/7cc829d3gy1ficm10dakhj20m80ciq37.jpg"], "praise_nums": "2", "fav_nums": "7", "comment_nums": "1", "tags": "其他,时间", "content": "<div class=\"entry\">\r\n\r\n        \t\t\t<div class=\"textwidget\"></div>\n\t\t\r\n\t\t<div class=\"copyright-area\">本文由 <a href=\"http://blog.jobbole.com\">伯乐在线</a> - <a href=\"http://www.jobbole.com/members/wx879560138\">碎美</a> 翻译，<a href=\"http://www.jobbole.com/members/randomli\">欣仔</a> 校稿。未经许可，禁止转载！<br>英文出处：<a target=\"_blank\" href=\"http://jamesclear.com/value-of-time\">James Clear</a>。欢迎加入<a target=\"_blank\" href=\"http://group.jobbole.com/category/feedback/trans-team/\">翻译组</a>。</div><p>【导读】：本文介绍了几种估算你每小时值多少钱的方法，方便你判断值不值得花时间做某事，比如：值得为了省 $95 的机票而花 5 小时转机 2 次么？值得花 2 小时与某人吃顿饭？值得花半小时回某封邮件么？</p>\n<p><img id=\"pic\" class=\"\" src=\"http://wx4.sinaimg.cn/large/7cc829d3gy1ficm10dakhj20m80ciq37.jpg\"></p>\n<p>并非所有对时间的利用都是均等的，而且这个简单的道理可以让生活大为不同。明白怎样充分利用自己的时间，始于了解到（准确地说是）你的时间价值多少。本文讲述如何系统计算你时间的价值。</p>\n<p>把时间花在更有利可图的事上的人，能赚更多的钱。把时间投注在他人身上的人，能建立良好的人际关系。把时间花在创建灵活的事业上的人，能享受更多自由。把时间花在具有高影响力的项目上的人，能为社会带来更多贡献。不论你想要更多财富，更多友谊，更多自由，还是更多影响力，问题都会回归到你如何支配自己的时间。</p>\n<p>如果你和我一样，你可能会想要上面提到的东西（友谊，自由，影响力），也许还有其他（健康）。但是，你不可能同时拥有所有东西，所以你需要明白日常生活中如何有效地权衡这些问题。本文告诉你如何计算时间的价值，以及如何利用这些信息来更有效地利用时间。</p>\n<h2>时间的价值：一小时值多少？</h2>\n<p>在动笔写这篇文章的几周前，我正想买一个小的旅行包。搜索了半天，我找到一个我喜欢并且只要 19 美元的包，价格很实惠。问题在于：这包是一个英国公司产的，寄到美国要收 45 美元运费。</p>\n<p>我立即打消了花 45 美元运费拿到一个 19 美元的包的念头，所以我开始搜索零售店的位置。这家公司在纽约市有一间店，而我恰好打算几周后去一趟纽约。我找到了店址，发现假如我旅途中特地去一下这间店，要花一小时。</p>\n<p>那时我脑海中出现了促使我写这篇文章的问题：“我的一小时值 45 美元吗？”</p>\n<p>我应该节省时间，花 45 美元，让他们把包直接寄给我，还是应该省下钱，花一小时自己去店里买？我完全不知道去店里买或者额外花运费，哪一种是对于时间和钱更好的利用。</p>\n<h2>时间 VS 金钱的两难</h2>\n<p>我们或多或少都对自己时间的价值有个内在判断。比如说，如果有人提供你每小时 0.07 美元薪水的工作，你肯定会立刻回绝。但如果有人愿意付你每小时 7000 美元，你会立刻接受这份工作。</p>\n<p>在这个范围的两端，你很容易判断一件事是否值得花费时间去做。但当你向时间-价值比的中间档滑动，某一任务是否值得花费时间就变得不那么明朗。问题就在此：生活的多数时间，我们都处在时间-价值比的灰色区域。</p>\n<p>例如：</p>\n<ul>\n<li>    应当购买直飞航班，节省两小时，还是选择有一次经停的航班，节省 90 美元？</li>\n<li>    要不要花 20 美元请邻居的小孩帮忙除草，以享用周末额外的一小时？</li>\n<li>    这一周，应当服务一个会立刻付你 2000 美元的客户，还是挖掘一个能在明年产生 20000 美元利润的商业构想？</li>\n</ul>\n<p>每一天我们都会做出类似的选择，但大多数人都是依直觉或猜测行事，而不去计算他们时间的实际价值。每个人都有一个每小时（时间）价值，但很少有人能确切地告诉你这个数字是多少。在此之前，我也不例外。</p>\n<h2>如何计算你的时间的实际价值</h2>\n<p>这个时间 vs 金钱的难题促使我询问了各种我能接触的这个话题上的专家。我和企业家、生产力顾问、企业教练甚至是职业扑克玩家都聊过怎样计算时间价值，以及怎样利用这一点来更好地做决策。</p>\n<p>然后，我记录了三个月中，每一小时我都做了什么，并用六种不同的方法计算了一小时的价值。别担心，我已经把这些研究和实验精简成了一个相对简单的过程，接下来就讲。</p>\n<p>本文剩余内容分为两部分。</p>\n<ul>\n<li><strong>第一部分快捷易懂，基本涵盖了大部分人需要的东西。</strong>在 15 分钟内，第一部分能帮助你建立一份合理的评估，你能通过这份对你时间价值的评估做出更明智的决策。我推荐所有人都读一下第一部分。</li>\n<li><strong>第二部分要花费一些时间，但也值得一看。</strong>企业家和管理者会发现第二部分尤其有用。第二部分建立在第一部分的基础上，能帮你评估不同时间用途的期望价值，以便你做出更好的战略决策，获得长期回报。</li>\n</ul>\n<p>在我们开始第一部分之前，我想先分享一个免费的表格，里面有关于本文中所有计算公式的例子。你可以将你的数据填入表格，它会算出你的时间价值。余下的内容中，我会经常提及这个表格。</p>\n<blockquote><p>时间价值表，下载链接：<a href=\"https://docs.google.com/spreadsheets/d/1xJm9BIpuf0Cu4P01YJQ_PNam7fds31KaDXgwxJaJWxc/edit?usp=sharing\">Google Docs</a>、百度网盘：<a href=\"https://pan.baidu.com/s/1i5ta2SP\" target=\"_blank\">https://pan.baidu.com/s/1i5ta2SP</a></p></blockquote>\n<h2><span style=\"color: #ff0000;\">第一部分：实际收入法</span></h2>\n<p>我们先讲讲怎样用实际收入法来计算你的时间价值。这些计算主要基于你实际得到（或实现）的收入，所以叫实际收入法。此法可以帮你优化日常花费的决策（例如上述的例子，花 45 美元网购或开车去店里）。</p>\n<p>首先，你需要两个数字：</p>\n<ul>\n<li>    你花了多少时间赚钱。</li>\n<li>    利用这些时间你赚了多少钱。</li>\n</ul>\n<p>我们来聊聊怎样估算这两项数据，以及怎样快速用这两个数据得出一个对你时间价值的估计。</p>\n<h3>第 1 步：如何追踪你的时间</h3>\n<p>第一步是估算你投资了多少时间在赚钱上，而不是你有多少小时在工作岗位上。举例来说，假如每天你有一小时在路途中，另有八小时在工作，那么实际上你每天花费了九小时在赚钱上。同样，你也应该算上你搞副业或者送孩子去日托中心的时间。我们将用这些数字来全面地了解一年中你花在赚钱上的总时间。</p>\n<p>不止你一个人会觉得估算时间有点困难。大部分人对于自己一天 24 小时做了什么只有一种模糊的意识。如果你不确定你花了多少时间工作，我推荐用一年 2500 小时作为起点。理由：假设你一天花了 10 小时工作、通勤或者做工作相关的事。一周工作五天，那就是每周 50 小时。再假设你每年工作 50 周（两周休假），那就是每年 2500 小时。你可以根据自己的实际情况调整，不过对于大多数全职员工或企业家来说，我觉得 2500 小时是一个基本准确的估计。</p>\n<h3>追踪时间：我是如何做的</h3>\n<p>我是个网络创业者，多数时间我都在电脑上工作。当我开始估算时间时，我安装了一个叫 <a href=\"https://www.rescuetime.com/\">RescueTime</a> 的软件。它能准确记录我在每件事上花费的时间：用了多久看每个网站、用每个软件、浏览社交媒体等等。</p>\n<p>在我完成三个月的收集后，我还整合了从其他应用中得到的数字，以完善我的估算。比如说，我算出了在 <a href=\"https://www.amazon.com/gp/product/B00NB86OYE/ref=as_li_qf_sp_asin_il_tl?ie=UTF8&amp;camp=1789&amp;creative=9325&amp;creativeASIN=B00NB86OYE&amp;linkCode=as2&amp;tag=jamesclear-20&amp;linkId=IEHSPLRV25VARHV7\">Audible</a> 上面听有声书的时间，就得到了我花费在“读书”上的时间。</p>\n<p>利用从 RescueTime 获得的数字，加上几个合理的推算，我得出我每年工作 2742 小时的结论。</p>\n<p>RecueTime 是分类记录事件的，所以我还能分别了解我在写作、阅读、网站设计、市场营销等事上分别花了多少时间。这么细的分类其实不是很必要，不过在本文的第二部分中能派上用场。目前，你只需要对你每年花在赚钱上的总时间有一个合理的估计就好了。</p>\n<h3>第 2 步：如何记录你赚了多少钱</h3>\n<p>第二步你需要知道利用工作时间你赚了多少钱。</p>\n<p>这项非常简单。如果你是个小时工或赚薪水的职员，看看你最新的工资支票，乘上每年获取的支票数即可。如果你今年的薪水变化不大，还可以看看去年退了多少税。你还要加上从副业和自由工作中得到的钱，因为花在这些事情上的时间在第一步中已经包含在内了。</p>\n<p>我们现在计算的是你的税后收入，即扣除税款后得到的钱。对于多数职员来说，税款在工资支票中就已经扣除了，所以你的税后收入就是付给你的钱。如果你是个企业主，那你就需要从总收入中扣掉税款和其他业务支出。</p>\n<h3>追踪收入：我是如何做的</h3>\n<p>我用了一个叫 <a href=\"https://bench.co/?fbuy_ref_code=bnbQH\">Bench Accounting</a> 的服务来记录我生意的收入和开支。Bench 是一个在线的记账服务，可以自动从我的企业账户自动提取数据，然后会计就会将所有东西整理在一个算好税的财务报表中。点击几下，我就能看到在上个月、上个季度或者上一年中我赚了多少钱。</p>\n<p>如果你和我一样是一个小企业主，自由职业者或企业家，我推荐你使用全年的收入来做计算，因为小公司的月收入可能会波动（有时是激烈波动）。查看一段更长时期的收入可以消除这些差异，让你对时间价值有个更实际的估算。</p>\n<h3>第 3 步：计算你的时间价值</h3>\n<p>最后一步，用你的总收入（得自第二步）除以你总共花费的时间（得自第一步）即可。</p>\n<p>举例说明，假设你每年花了 2500 小时来赚钱：</p>\n<ul>\n<li>如果你的收入是 12316 美元/年，你的时间价值 4.93 美元/小时。这是 2014 年全美个人收入的贫困线。</li>\n<li>如果你的收入是 46226 美元/年，你的时间价值 18.49 美元/小时。这是 2014 年全美女性收入的中位数。</li>\n<li>如果你的收入是 62455 美元/年，你的时间价值 24.98 美元/小时。这是 2014 年全美男性收入的中位数。</li>\n<li>如果你的收入是 10 万美元/年，你的时间价值 40 美元/小时。</li>\n<li>如果你的收入是 100 万美元/年，你的时间价值 400 美元/小时。</li>\n</ul>\n<p>当然啦，这些都是假设你每年花费了 2500 小时在工作上。计算结果会随着不同的工作时间而改变。</p>\n<h3>这些数字精确吗？</h3>\n<p>当我第一次做这个计算的时候我很惊讶。我一小时的价值比我想象的低得多。</p>\n<p>想想有多少自由职业者每小时收费40美元，一年赚不到 10 万美元。或者想想多少顾问每小时收费 400 美元，一年却赚不到 100 万美元。怎么会这样呢？答案是，他们只是在部分工作时间获得 40 或 400 美元一小时的薪酬，而非所有的时间。当我们用他们的总收入除以总工作时间时，每小时的价值比他们每小时向顾客收的费用低得多。</p>\n<p>此外，虽然我们知道自己每小时收多少佣金，但我们很少会计算除了工作时间外还有多少时间也是花费在赚钱上。搞清楚到底多少时间投资在赚钱上，我们就对自己时间的实际价值有一个更清楚的认识——通常这个数字比你每小时收的佣金低得多。</p>\n<p>呐，如果你和我一样，你可能会想核实一下计算的准确度。有几种快速检查你计算的小时价值是否准确的方法。我们现在来看一下。</p>\n<h3>支票和余额</h3>\n<p>我们刚刚用的计算方法是税后实得法，因为它是根据你的税后收入算的。还有另外两种实际收入方法，可以用来和税后实得法对照。下面我会简单地介绍一下这两种方法，不过最简单的学习方法是参照时间价值表的步骤3.</p>\n<h3>市场价格法</h3>\n<p>市场价格法是第一种检查的方法。这个方法用的是一个估价，即假设你接受了另一个公司的一个你能胜任的职位，所预期能挣到的钱。举例来说，我花很多时间在写作上，所以我可以胜任一个“内容创造者”的职位。我还花时间来扩展业务，所以我也可能胜任一个业务拓展的职位。我查了一下我可能胜任的每个职位的薪水，按照我在每种工作上投入的时间进行划分，就得到了对于我时间价值的另一种估算。你可以把这种方法想成在就业市场上你的时间的价值。</p>\n<h3>基于成本的方法</h3>\n<p>基于成本的方法是另一种核实方法。这个方法用的是一个估价，即你会付多少钱来让另一个人做你的工作。换句话说，想象你是老板，需要雇人代替你工作。我先是把我的工作分成了具体的任务（写作，市场营销等等），然后估算了花费在每项任务上的时间。然后，我代入了我会付别人全职做这项工作的薪水。之后，我计算了所有任务放在一起的加权平均数，得出了我愿意支付给别人做我每天做的工作的价格。最后，我用这个价格除以总的工作小时数。</p>\n<p>我用这三种方法算出了三个数值，得到了我的时间价值的平均值。我料到我可能会用一种方法得到高一些的结果，而用另一种得到低一些的结果，但是当我们用三种方法来取平均值，得到的时间价值可能更精确一些。重申一次，在时间价值表中，你可以看到每一种方法。</p>\n<h3>怎样利用这项信息</h3>\n<p>我们已经完成了第一部分。有了上面的计算结果，我们对你的时间价值有了一个快捷准确的估计。现在，我们可以缩小不确定的范围，做出更好的决策。</p>\n<p>例如：</p>\n<ul>\n<li>    如果你的时间值 25 美元一小时，那就不该排半小时队来领取 10 美元的礼品卡。</li>\n<li>    如果你的时间值 60 美元一小时，那你就应该花 49 美元网购而不是花一小时去店里。</li>\n<li>    如果你的时间值 80 美元一小时，那你就应该买直飞航班，而不是花两小时等待转机，只为节省 150 美元。</li>\n</ul>\n<p>当你精确地知道你的一小时到底值多少钱时，你每天都可以做出更好的决策。</p>\n<p>至此，我们知道你的时间<u>至少</u>值你刚刚算出来的那么多，因为实际收入法只能计算你已经获得的收入。准备好来看看你的时间是否值更多了吗？我们来看第二部分。</p>\n<h2><span style=\"color: #ff0000;\">第二部分：期望值法</span></h2>\n<p>现在来看第二种方法：期望值法。这种计算法基于你对于一小时的工作在长远来看能创造的价值的期望。</p>\n<p>期望值法可以帮助你在重大的、战略性的决策中决定要把时间花在哪里。你的公司今年应该专注于哪个项目？哪些事务没什么效率，应当从你的日常工作中取消？你应该开创一项十年后会获得巨大成功，但不能即刻为你带来收入的事业，还是找一份有可靠收入的稳定工作？管理这些权衡的最佳方法是什么？</p>\n<p>让我们从最简单的期望值法开始吧。</p>\n<h3>增长倍数法</h3>\n<p>有一种简单的方法，可以解释你的决策带来的期望收入。将你前几年的净收入乘以一个合理的增长倍数。</p>\n<p>关键当然在于选择一个合适的增长倍数。举个例子，我的生意从去年到今年翻了一番，所以我选择 2× 作为我的增长倍数。用这种方法实际上相当于说，“你今年的行动会持续推动下一年的增长，所以你的时间的真实价值其实是高于你现在的实际收入。”</p>\n<p>增长倍数法能让你简单估算今天的工作在长远看来能获得多少回报，但它并不能告诉你如何更高效地利用你的时间。要获知这一点，我们需要使用完整的期望值法。</p>\n<h3>期望值法</h3>\n<p>期望值法是最终也是最难的计算时间价值的方法。我会努力用最简单的话来解释，但我想最简单的学习方法就是来看时间价值表中的步骤4。</p>\n<p>基本逻辑如下：</p>\n<p>首先按不同工作来分类时间。你越能具体地说出每份时间用来做了什么，你就越能分辨哪些工作驱动了最多利益。</p>\n<p>选择一个可以将每项工作和收入连接在一起的测量单位。对于大部分企业主来说，这意味着你需要知道你的生意中一个“引子”的价值。就我自己来说，我用的是邮件订阅数，因为我知道平均每个新的订阅者能带来的收益，并且我大部分的工作内容都可以关联到获取更多地邮件订阅上。</p>\n<ul>\n<li>估算每项工作的价值。假设我花一小时工作，获得 50 个新的邮件订阅。如果每个订阅者的总价值是 1 美元，那么这项工作的期望价值就是 50 美元一小时。重复估算你的每一项工作的价值。</li>\n<li>把所有期望值加在一起，获得总的期望值。</li>\n<li>如有需要，加上其他变量。期望值法可以像你希望的一样复杂。你可以处理一些因素，像是某项工作可以带给你的生活多少幸福感，或者现在一小时的工作有多少可能性在之后的几年持续给你回报。</li>\n</ul>\n<p>期望值法是高度个性化的，你可能需要多斟酌一番这些公式，来让它们满足你的需求。当然啦，最简单的还是从数字层面看这个方法是怎么用的。你可以在<a href=\"https://docs.google.com/spreadsheets/d/1xJm9BIpuf0Cu4P01YJQ_PNam7fds31KaDXgwxJaJWxc/edit#gid=0\">时间-价值表</a>的步骤4中看到所有加入计算的因子。</p>\n<h2>补充说明</h2>\n<p>其实这些计算的幕后还有很多其他的想法。如下是另外一些我在思考我的时间价值时一直惦记的因素。</p>\n<h3>误入歧途的成功</h3>\n<p>不要把时间浪费于在错误的事情上取得成功。简单地了解你时间的价值是有帮助的，但你仍需明白你想要怎样的生活，以获取最精确的对于时间价值的概念。太多人追逐金钱、权利或认同，因为他们身边的每个人都一样。倘若这不是你真正想要的呢？没错，你可以找到增加时间价值的方法，但如果你宁愿有更多空闲时间而非钞票呢？这就是为什么弄明白你的<a href=\"http://jamesclear.com/core-values\">核心价值观</a>，做<a href=\"http://jamesclear.com/integrity\">诚实报告</a>，弄清楚什么对你来说最重要，都是有用的。</p>\n<h3>权衡和机会加成</h3>\n<p>比尔·盖茨多次被被称为世界上最富有的人。在 2015 年，他以 727 亿美元净资产再次排在首位。根据一个分析师的推算，“有 720 亿美元，6%的回报率大概能让盖茨活着的每秒赚 114.15 美元。一张 100 美元的纸币掉在地上，都不值得他花时间捡起来。”</p>\n<p>虽然有趣又值得引用，但是这个掉在地上的 100 美元钞票不值得盖茨弯腰捡起来的想法是错的。为什么？因为捡起这 100 美元不妨碍盖茨在同时赚 114.16 美元。不管他捡不捡这 100 美元，他总归在赚钱。实际上，捡起这 100 美元，在那一秒他就赚了 214.16 美元，而不是常规的 114.16 美元。</p>\n<p>捡起 100 美元并不需要比尔·盖茨付出停止赚钱的代价。这是在他已获得的收入之上的机会加成。机会加成，指的是那种如果你把所有时间花在上面会使你减少时间价值，但如果你在有机会的时候才去做，却会增加时间价值的选择。举例来说，试想那种有时会做演讲的作家。如果他们把所有时间都花在演讲上，会减少他们的时间价值，因为这样一来他们就没法写新书了，这会导致他们逐渐过气，演讲的出场费也会降低。但是，偶尔做一些演讲——比如一月一两次——许多作家就可以在净收入中增加几千美元，并仍能保持足够的时间来写新书。</p>\n<h3>不能商量的空闲时间</h3>\n<p>计算你的时间价值有一个危险之处，即你可能会说服自己多一个“创造价值”的小时，就能增加总的时间价值了。引自<a href=\"https://www.wsj.com/articles/do-you-know-what-your-time-is-really-worth-1437500727\">华尔街日报</a>的一篇文章，“一些研究人员表示，给时间标注经济价值，有损害人们生活质量的风险。那些被怂恿而只专注于时间的金钱价值的人，倾向于变得不耐烦而且压力大，Jeffery Pfeffer，一个斯坦福商学院组织行为学教授说到，这些人工作太多，花太少的时间做一些奖励自己的事，例如参加志愿活动或享受音乐。”</p>\n<p>对我来说，我决定记录我的空闲时间，来看看相较于工作我有多少闲暇，但我不会给空闲时间标注金钱价值。相反，我决定我的空闲时间是不能商量的。空闲时我可以放松减压，让我可以在工作时间保持高效。你应当重视你的空闲时间、停工时间、休闲活动，因为它们能为你的生活提供全面的身心健康。</p>\n<h3>你应当再工作一小时吗?</h3>\n<p>想不想知道你是否应该再工作一小时？如下是我从 <a href=\"http://sebastianmarshall.com/\">Sebastian Marshall</a> 那里学来的一个很好的经验法则：想想你一天中的每个小时。早上 9 点到 10 点，10 点到 11 点，以此类推。平均下来，那一个小时中，你的净收益是正的还是负的？例如如果你工作到比较晚，晚上 9 点到 10 点那一小时的成果平均下来是正向的吗？还是说那一小时的工作出的错比完成的内容多？那一小时是拖延还是高产？如果这一小时总的来说是负产出，那你就该停止工作了。努力做一个项目是好的，但如果接下来下一小时的工作会让你筋疲力尽，而非创造价值，那么在此之前就该停下来。</p>\n<h3>幸福和意义</h3>\n<p>如果你想的话，你可以将一项工作带给你的幸福或意义之类的因素也加入考虑。不过，我没有把这些变量放入我的计算公式中，而是对于每项工作，将这些因素进行了基于实现程度的1到10的排序。虽然这些排序没有放入任何公式中，但是当几项工作的期望值很接近时，这些排序就可以作为决胜属性。</p>\n<h3>下一步去哪儿</h3>\n<p>计算时间的真实价值实际上比听上去难得多，也比看上去有用得多。</p>\n<p>你的时间价值可能每年都有变化，甚至变化得更快。本文中我列出的这些方法都很灵活，可以修改。如果你在某件事上花费了更多时间，或者有了更多的收入，仅需将新的数字代入表格中，就能得到新的结果。</p>\n<p>我希望本文分享的策略，随着时间的推移，还会一直对你有所帮助。</p>\n\r\n        \r\n        \r\n        \n    <div class=\"post-adds\">\n        <span data-post-id=\"112127\" class=\" btn-bluet-bigger href-style vote-post-up   register-user-only \"><i class=\"fa  fa-thumbs-o-up\"></i> <h10 id=\"112127votetotal\">2</h10> 赞</span>\n        <span data-book-type=\"1\" data-site-id=\"2\" data-item-id=\"112127\" data-item-type=\"1\" class=\" btn-bluet-bigger href-style bookmark-btn  register-user-only \"><i class=\"fa fa-bookmark-o  \"></i> 7 收藏</span>\n\n                    <a href=\"#article-comment\"><span class=\"btn-bluet-bigger href-style hide-on-480\"><i class=\"fa fa-comments-o\"></i> 1 评论</span></a>\n        \n        \n        \n        <!-- JiaThis Button BEGIN -->\n        <div class=\"jiathis_style_24x24\" style=\"display: inline-flex; position: relative; margin: 0; clear: both;float: right;\">\n            <a class=\"jiathis_button_tsina\"></a>\n            <a class=\"jiathis_button_weixin\"></a>\n            <a class=\"jiathis_button_qzone\"></a>\n            <a class=\"jiathis_button_fb hide-on-480\"></a>\n            <a href=\"http://www.jiathis.com/share?uid=1745061\" class=\"jiathis jiathis_txt jiathis_separator jtico jtico_jiathis\" target=\"_blank\"></a>\n        </div>\n\n    </div>\n\n\n\n\r\n        <!-- BEGIN #author-bio -->\r\n\r\n<div id=\"author-bio\">\r\n\t\r\n\t<h3 class=\"widget-title\">\r\n\t关于作者：<a target=\"_blank\" href=\"http://www.jobbole.com/members/wx879560138\">碎美</a>\r\n\t</h3>\r\n\t<div class=\"alignleft\">\r\n\t\t<a target=\"_blank\" href=\"http://www.jobbole.com/members/wx879560138\">\r\n\t\t\t<img src=\"http://jbcdn2.b0.upaiyun.com/2017/05/14c9242bd4336d2c12ac8ba7e56bd6c8.jpg\">\r\n\t\t</a>\r\n\t</div>\r\n\r\n    <div class=\"author-bio-info\">\r\n\r\n        <span class=\"author-bio-info-block\">\r\n            University at Buffalo IE Human Factors PhD program 在读        </span>\r\n        <span class=\"author-bio-info-block\">\r\n            <a href=\"http://www.jobbole.com/members/wx879560138\" target=\"_blank\"><i class=\"fa fa-user\"></i> 个人主页</a> ·\r\n            <a href=\"http://blog.jobbole.com/author/wx879560138/\" target=\"_blank\"><i class=\"fa fa-file-text-o\"></i> 我的文章</a>\r\n\r\n             · <a title=\"声望值\" target=\"_blank\" href=\"http://www.jobbole.com/members/wx879560138/reputation/\"><i class=\"fa fa-graduation-cap\"></i> 11</a> · <a title=\"QQ：274121119\" target=\"_blank\" href=\"#\"><i class=\"fa fa-qq\"></i></a> <a title=\"Facebook主页\" target=\"_blank\" href=\"https://www.facebook.com/profile.php?id=100009659581170&amp;ref=bookmarks\"><i class=\"fa fa-facebook\"></i></a>         </span>\r\n    </div>\r\n\t<div class=\"clear\"></div>\r\n</div>\r\n\r\n<!-- END #author-bio -->\r\n\t</div>", "front_image_path": ["full/5a100e2d6c9b049065e2a317a0a393644a168302.jpg"]},{"title": "写给自学者的入门指南", "url": "http://blog.jobbole.com/112052/", "url_object_id": "47b29ae058a42e8c7d20bb7935eb996f", "create_date": "2017/08/02", "front_image_url": ["http://insights.thoughtworkers.org/wp-content/uploads/2017/07/1-story-1024x595.jpg"], "praise_nums": "5", "fav_nums": "21", "comment_nums": "2", "tags": "其他,程序员,编程,自学", "content": "<div class=\"entry\">\r\n\r\n        \t\t\t<div class=\"textwidget\"></div>\n\t\t\r\n\t\t<div class=\"copyright-area\">本文作者： <a href=\"http://blog.jobbole.com\">伯乐在线</a> - <a href=\"http://www.jobbole.com/members/thoughtworkschina\">ThoughtWorks</a> 。未经作者许可，禁止转载！<br>欢迎加入伯乐在线 <a href=\"http://blog.jobbole.com/99322\" target=\"_blank\">专栏作者</a>。</div><div>\n<p>在 IT 工程师和培训机构多如牛毛的时代，拜师学艺并不难。但自学编程对于毫无基础的同学来说却可能是个问题，相信有过类似经历的朋友都有一把辛酸泪和一肚不吐不快的体会。让我们从一个故事说起…</p>\n<p><img src=\"http://insights.thoughtworkers.org/wp-content/uploads/2017/07/1-story-1024x595.jpg\" alt=\"\" width=\"700\" height=\"407\"></p>\n<h3>故事</h3>\n<p>某君在一个普通大学读着自己不喜欢的专业，以打游戏、刷段子和睡觉度日，突然有一天想学点什么。学编程好像挺酷，而且听说IT行业充满了机会，没准一不小心就和大佬一起“改变世界”了。</p>\n<p>那么第一个问题来了，他该选择什么语言？</p>\n<p>是世界上最好的语言 PHP？还是语言之母的 C？幸好还知道个编程语言排行榜，找到一看、几十种不带重样，这要逼死天秤座的小朋友。选 PHP 吧？上非诚勿扰都要被灭灯，而且就只能做个网页。万般纠结之后我们选 C 吧，听起来既高级又底层，说不准还能考个计算机二级。</p>\n<p>接下来得干正事儿了。在这个便捷的网络时代，自学可选择的方式非常丰富。除了在网络上收集资料、阅读干货外，某君还向一些前辈咨询了自学的方法。</p>\n<p>网络上流传的编程学习方式有：</p>\n<ul>\n<li>看书（这是最容易想到的方法）</li>\n<li>观看视频教程</li>\n<li>阅读官网文档</li>\n<li>读源码</li>\n<li>到大学蹭课或者报名培训（不知道还算不算自学，没交学费都算吧？）</li>\n</ul>\n<p>某君又得纠结一番了，大学蹭课和培训并不一定有合适条件，且不符合自学的气质；观看视频教程，前辈们觉得比较low；阅读官网文档和源码，这不适合初学者。总得来说看书算是比较中肯的方法，至于看什么书呢，前辈推荐了《C Primer Plus》，据说是学习C语言的经典之作。</p>\n<p><img src=\"http://insights.thoughtworkers.org/wp-content/uploads/2017/07/2-C-Primer-Plus-1-1024x572.jpg\" alt=\"\" width=\"700\" height=\"391\"></p>\n<p>好吧，不再纠结，直接啃这本大部头，虽然有人说看原版好一些，但是实在能力有限、还是看中文版吧。一口气花了一周时间读完这本书，果然是经典，变量、语句、条件判断甚至指针都知道怎么回事了。</p>\n<p>某君决定按照书中的说法实践一下了，于是打开了记事本，折腾很久装了GCC，把书上的第一个例子抄了下来，在控制台的小黑窗输出了“Hello World”，成就感满满。决定上手写点高级的的东西一试身手，合上书。咦，为什么会报错？哦，原来少个分号。不禁陷入思考：为什么学了两个月还是只能在这个黑窗口算算秋水仙数？网友还说要看官网文档、要读源码、要看英文原版，我一样都不能做到，我一定是能力不够，编程果然是天才做的事情……</p>\n<h3>正经话</h3>\n<p>上面的故事是我编的，但其中的纠结却是自学者或多或少都经历过的。实际上，IT从业者并不像传说中那样需要天才般的智商，要点在于能否找到合适的入门途径，再加上一点点坚持和思考。比较可惜的情况是一些人没能找到适合自己的学习方法，并在纠结和碰壁后失去信心，然后沮丧的认定自己并不适合干这行。学编程很多时候就是一个趟坑的过程，但不是每一个坑都有必要趟，写这篇文章的目的是希望能够帮助初学者尽量少趟一些坑。</p>\n<p><img src=\"http://insights.thoughtworkers.org/wp-content/uploads/2017/07/3-learning-method-1024x553.jpg\" alt=\"\" width=\"700\" height=\"378\"></p>\n<h3>IT世界的地图</h3>\n<p>初学者遇到的一个典型问题是对IT世界没有一个大的图景。比如大多数的Java书籍，教完你基础语法知识和秋水仙数的求法后就结束了，并没告诉你接下来能干什么。我曾经为此感到非常困惑，学完Java SE后做了一个非常简陋的GUI demo，就失去了后续的Java学习方向，带着对Java的偏见，这成为了我一段令人沮丧的学习经历。关于这个话题一本书可能都不够，简单来说，我尝试从计算机科学知识和技术实践两方面来聊聊成为一名IT工程师需要具备哪些东西。</p>\n<h3>计算机科学基础</h3>\n<p>首先初学者要具备一些非常基础的知识，这些知识在你踏上工作岗位后能被实际的用到，比如计算机运行原理、网络的传输、常用数据结构和算法等。这部分属于计算机科学，也是应该被计算机专业本科课程涵盖的，不要伤心错过了大学本科的相关课程，我会分享一些有用的资源。</p>\n<p>这里我罗列了一些计算机专业的学生一般需要学习的课程，当然每个学校专业设计都不一样，甚至采用的教材名字也不一样，仅供参考。大学计算机科学课程往往包括：《高等数学》、《离线数学》、《电子电路》、《数据结构》、《程序设计》、《计算机组成原理》、《编译原理》、《计算机网络》、《软件工程》、《数据库原理》等。有些学校会有一些额外的课程，例如《通信原理》、《汇编语言》、《线性代数》、《C语言》、《Java 语言》等。</p>\n<p><img src=\"http://insights.thoughtworkers.org/wp-content/uploads/2017/07/4-MOOC.png\" alt=\"\" width=\"761\" height=\"403\"></p>\n<p style=\"text-align: center;\">图片来源于网易计算机专业的课程体系</p>\n<p>尽管IT行业知识更迭非常快，但是基础知识并不容易过时，因此有大量的资料可以选择。可以选择从计算机经典丛书系列开始，比如佛罗赞和莫沙拉夫的《计算机科学导论》，甚至可以阅读一些计算机科普类读物例如《穿越计算机的迷雾》。另一种直观的方式是观看大学精品课和去跟慕课课程，比较推荐的有几个：</p>\n<ul>\n<li>中国大学精品开放课程，高等教育出版社的精品课程项目，有全国大量的名校授课视频和课件</li>\n<li>中国大学MOOC ，这个是中国大学MOOC和网易合作的，提供了上文附图中计算机课程体系中所有课程</li>\n<li>果壳网的MOOC学院，主打翻译全球名校的优秀课程，比如斯坦福的《编译原理》和MIT的《Python》</li>\n</ul>\n<h3>从知识到实践</h3>\n<p>除此之外，还需要了解实际应用于设计软件或者开发网站中的实践类知识，包括某个特定语言以及周边的库、框架和工具等。 我们可以把特定需求中用到的语言、库和框架以及其他的工具称为技术栈，在技术选型上通常也是被这样考虑的，HR常常会根据技术栈来寻找需要的工程师。比如需要学习SSH 三大框架和Java的Java技术栈；为服务器web开发而生的PHP技术栈；在移动开发领域流行的IOS、安卓技术栈等。当然这里面有一些重合和共用的技术也需要学习，比如版本管理器Git、SVN就是每个合格的工程师需要去学习的。</p>\n<p>换句话说，大学课程主要定位在上面说到的计算机科学基础知识，而市面上的培训机构主要是告诉你在怎么在实际工作中运用，所以大学和培训机构都有他们的价值。</p>\n<p>想要更加详细的了解这部分内容，这里有一些开源的技能图谱可以参考:</p>\n<p><img src=\"http://insights.thoughtworkers.org/wp-content/uploads/2017/07/5-skill-map-1024x752.jpeg\" alt=\"\" width=\"700\" height=\"514\"></p>\n<p style=\"text-align: center;\">图片来自： http://skill-map.stuq.org/</p>\n<h3>如何挑选你的兵器？</h3>\n<p>在介绍完计算机领域的大致图景后，就需要选择一门合适的编程语言，一个较为形象的例子是把编程语言比喻成兵器，因为我们深知编程语言对于工程师而言是实实在在的工具，我们不是为了学它而学，学编程不仅仅是学语言特性，一般来说我们也不用知道赋值语句像“茴香豆蔻”的“茴”字有四种写法。</p>\n<p>当然语言之争从来没有停止过，如果把编程语言比喻江湖武器的话十分有趣。</p>\n<blockquote><p>C语言是M1式加兰德步枪，很老但可靠。</p>\n<p>C++是双截棍，挥舞起来很强悍，很吸引人，但需要多年的磨练来掌握，很多人希望改用别的武器。</p>\n<p>Perl语言是燃烧弹，曾经在战场上很有用，但现在很少人使用它。</p>\n<p>Java是M240通用弹夹式自动机枪，有时它的弹夹是圆的，但有时候不是，如果不是，当你开火时，会遇到NullPointerException问题，枪会爆炸，你就会被炸死。</p>\n<p>JavaScript是一把宝剑，但没有剑柄。</p>\n<p>— 来自网络</p></blockquote>\n<p>老实来讲IT行业的最终目的是交付可用的软件，编程语言也是适应市场的。这对于初学者或许有些残酷，在工作中我们发现最好的语言是用来处理工作任务或者构建合适的应用，并不是出于爱好或者某种Geek精神。</p>\n<p><img src=\"http://insights.thoughtworkers.org/wp-content/uploads/2017/07/6-Geek-1024x586.png\" alt=\"\" width=\"700\" height=\"401\"></p>\n<p>对于初学者而言，在选择合适的入门语言时至少需要考虑两点：</p>\n<ul>\n<li>是否能适用于构建你想要的应用。如果你的目标是创建一个运行在IPhone上的APP，那么最好选择 Object C 或者 Swift，学习web开发可以选择PHP 或者JAVA。实际上我们仍然可以用汇编做出网页，但是这样做成本高昂。</li>\n<li>是否容易学习，在满足第一点的条件下请尽量选择容易学习的语言。容易不仅仅指语法简单，包括环境搭建、部署等都需要考虑在内，以及能不能容易找到好的学习资料，因此尽可能的选择主流语言。</li>\n</ul>\n<p>别忘了非常重要的一点，学习编程语言还包括平台提供的API，比如Win 32 之于C++/C#/VB，以及周边的库和框架（这些库、框架和工具能在上面说的技术图谱中找到）。IT历史上甚至出现框架和库引领编程语言走向的情况：JQuery 和Angular 改变了前端开发的思想; Rails 抢走了Ruby的名气；而SSH三大框架一度代表了Java世界。</p>\n<p>最后我为初学者整理了一个流行编程语言和用途的表：</p>\n<p><img src=\"http://insights.thoughtworkers.org/wp-content/uploads/2017/07/7-programming-language-1.png\" alt=\"\" width=\"606\" height=\"555\"></p>\n<p>另外还需要注意的是开发工具，可以选用IDE和有代码提示的编辑器，但尽量不要在这上喋喋不休，这就像用来盛放你锋利兵器的架子，用着顺手就行，也不推荐使用纯文本编辑器，这看起来像赤手空拳。 推荐一些编辑器和IDE</p>\n<p><img src=\"http://insights.thoughtworkers.org/wp-content/uploads/2017/07/8-IDE-1.png\" alt=\"\" width=\"674\" height=\"323\"></p>\n<h3>挑选合适的资料和有效的阅读</h3>\n<p>对初学者而言，我仍然推荐好的视频教程，虽然我已经听到不下5个人声称是靠阅读官方文档或者看源码学会编程的，而且认为观看视频教程见效太慢。但这个思想对初学者很危险，不得不承认阅读文档和源码能更准确找到自己想要的信息，这对深入技术原理非常有用，但视频能比文字传达出更丰富的内容，有更直观的演示和细致的讲解，我想没有比这个更适合初学者了。</p>\n<p>除了上面提到的精品课程和慕课教程，国内有像网易云课堂，国外有lynda.com这种在线学习视频网站，甚至在优酷和土豆都能找到足够的教程资源。</p>\n<p>如果选择了阅读技术类书籍，我们来聊聊怎么有效的阅读一本技术书籍。</p>\n<p>读IT类书籍和读考试类书籍的方式不同，初学者需要选择更接地气、并且能告诉你最终能做出什么案例的书籍。你不需要通读整本书，而是需要搭建好和书中版本一致的环境，然后把书中的每行代码敲入电脑，观察这些代码怎样被运行，在遇到问题时去请教朋友或者到搜索引擎中寻找解决办法，直到示例程序能被正确运行。</p>\n<p>可能一个月才能读完一本书，但慢点并没什么坏处，敲过一遍的代码才能算是你的，否则永远存在于纸上的代码清单中。对于关键的概念和知识点，可以在阅读的同时做一些笔记，去尝试使用思维导图来做你的笔记吧，这让你的笔记跟上你的思考，并形成一个知识网络。</p>\n<p><img src=\"http://insights.thoughtworkers.org/wp-content/uploads/2017/07/9-spring.png\" alt=\"\" width=\"940\" height=\"356\"></p>\n<h3>自我激励</h3>\n<p>自学无疑是寂寞的。编程学习耗时较长，如何保证在这个阶段能坚持下去？</p>\n<p>我们知道很多人都能对游戏产生强烈的兴趣、愿意为之投入时间，这其中的秘密就是游戏的奖励规则。杀死一个怪物就能得到一些金币，通过完成任务获得满足感，通过关卡的设计产生持续吸引力，进而形成正向的反馈。</p>\n<p>其实学习编程也一样，实现一小段程序并运行，足以让人感到成就感和满足，借鉴这个简单的心理学技巧，定期给自己设定一些有实际意义但是不太难的目标和任务。太难会让人失去耐心，太简单又很无聊，最好设定一个跳起来刚好摸得着的任务。每完成一个目标就给予自己奖励，可以是完成任务的成就感，也可以是其他的物质奖励。</p>\n<p>这个时候一个代办记事的清单就可以帮上忙了，可以是一个to do list的软件，或者自己手写一张卡片贴到墙上，关键在于不要忘了在任务达成后给予自己适当的奖励。</p>\n<p><img src=\"http://insights.thoughtworkers.org/wp-content/uploads/2017/07/10-to-do-list.png\" alt=\"\" width=\"940\" height=\"560\"></p>\n<p style=\"text-align: center;\">图片来源：https://appadvice.com</p>\n<p>那如果真的遇到一些麻烦的任务呢，如何顺利解决而不至于丧失信心？笛卡尔在《方法论》一书中告诉了我们研究复杂问题的方法和步骤:</p>\n<ul>\n<li>尽量将其分解为多个比较简单的小问题，一个一个地分开解决</li>\n<li>将小问题从简单到复杂排列，先从容易解决的问题着手</li>\n<li>子问题被解决后，进行联调测试，看是否能协同运行</li>\n</ul>\n<p>在敏捷开发这种工程思想中我们正是这样做的，我们需要把业务需求进行拆分然后评估工作量，不仅可以直观的看到任务进展，手上的工作也不会看起来庞大得难以完成。</p>\n<h3>最后多说几句</h3>\n<p>非科班出身的工程师入门是有一定痛苦的，不像武侠世界里面的名门正派弟子，也没有机缘遇到骨骼精奇的世外高人，如何选择合适自己的学习方式并自我管理是很重要的一方面。没有任何Low的学习方式，只要直接而又高效，而且要能达到我们的目的就好。以我为例，从大专学校毕业并没有机会参加本科课程，曾经也在网上攫取各种视频教程，去别的学校蹭课，甚至带上礼物去一个老师那里登门拜访补课。</p>\n<p>另一方面是如何上桌，吃上编程这碗饭。学习的成果如果无处施展便成为屠龙之技，参加一些开源项目和一些公益活动，谁不喜欢一个热心的人呢。也可以尝试去实现自己的一些idea，当做一个小项目来开发，有了一些项目实践后去找一个公司实习会容易的多。</p>\n<p>我不知道算是有幸还是不幸经历了这一个过程，矫情一点来说是有一些曲折，但是我知道“聪明”从来不是这个行业的门槛。引用流行于知乎的一句老话“以大多人的努力程度，还轮不到拼天赋的程度”，在Thoughtworks有大量优秀的工程师，从他们身上我能看到聪明不是学习编程成功的关键，坚持和勤于思考才是。</p>\n<div></div>\n</div>\n\r\n        \r\n        \r\n        \n    <div class=\"post-adds\">\n        <span data-post-id=\"112052\" class=\" btn-bluet-bigger href-style vote-post-up   register-user-only \"><i class=\"fa  fa-thumbs-o-up\"></i> <h10 id=\"112052votetotal\">5</h10> 赞</span>\n        <span data-book-type=\"1\" data-site-id=\"2\" data-item-id=\"112052\" data-item-type=\"1\" class=\" btn-bluet-bigger href-style bookmark-btn  register-user-only \"><i class=\"fa fa-bookmark-o  \"></i> 21 收藏</span>\n\n                    <a href=\"#article-comment\"><span class=\"btn-bluet-bigger href-style hide-on-480\"><i class=\"fa fa-comments-o\"></i> 2 评论</span></a>\n        \n        \n        \n        <!-- JiaThis Button BEGIN -->\n        <div class=\"jiathis_style_24x24\" style=\"display: inline-flex; position: relative; margin: 0; clear: both;float: right;\">\n            <a class=\"jiathis_button_tsina\"></a>\n            <a class=\"jiathis_button_weixin\"></a>\n            <a class=\"jiathis_button_qzone\"></a>\n            <a class=\"jiathis_button_fb hide-on-480\"></a>\n            <a href=\"http://www.jiathis.com/share?uid=1745061\" class=\"jiathis jiathis_txt jiathis_separator jtico jtico_jiathis\" target=\"_blank\"></a>\n        </div>\n\n    </div>\n\n\n\n\r\n        <!-- BEGIN #author-bio -->\r\n\r\n<div id=\"author-bio\">\r\n\t\r\n\t<h3 class=\"widget-title\">\r\n\t关于作者：<a target=\"_blank\" href=\"http://www.jobbole.com/members/thoughtworkschina\">ThoughtWorks</a>\r\n\t</h3>\r\n\t<div class=\"alignleft\">\r\n\t\t<a target=\"_blank\" href=\"http://www.jobbole.com/members/thoughtworkschina\">\r\n\t\t\t<img src=\"http://tp3.sinaimg.cn/1774908135/180/0/1\">\r\n\t\t</a>\r\n\t</div>\r\n\r\n    <div class=\"author-bio-info\">\r\n\r\n        <span class=\"author-bio-info-block\">\r\n            ThoughtWorks是一家全球IT咨询公司，追求卓越软件质量，致力于科技驱动商业变革。擅长构建定制化软件产品，帮助客户快速将概念转化为价值。同时为客户提供用户体验设计、技术战略咨询、组织转型等咨询服务。        </span>\r\n        <span class=\"author-bio-info-block\">\r\n            <a href=\"http://www.jobbole.com/members/thoughtworkschina\" target=\"_blank\"><i class=\"fa fa-user\"></i> 个人主页</a> ·\r\n            <a href=\"http://blog.jobbole.com/author/thoughtworkschina/\" target=\"_blank\"><i class=\"fa fa-file-text-o\"></i> 我的文章</a>\r\n\r\n             · <a title=\"声望值\" target=\"_blank\" href=\"http://www.jobbole.com/members/thoughtworkschina/reputation/\"><i class=\"fa fa-graduation-cap\"></i> 70</a> · <a title=\"我的网站\" target=\"_blank\" href=\"http://insights.thoughtworkers.org/\"><i class=\"fa fa-link\"></i></a> <a title=\"微博主页\" target=\"_blank\" href=\"http://weibo.com/thoughtworkschina\"><i class=\"fa fa-weibo\"></i></a>         </span>\r\n    </div>\r\n\t<div class=\"clear\"></div>\r\n</div>\r\n\r\n<!-- END #author-bio -->\r\n\t</div>", "front_image_path": ["full/d1090f61ad1b5ed427d81d03e12c8b76397dd93a.jpg"]},{"title": "CoreOS，一款 Linux 容器发行版", "url": "http://blog.jobbole.com/112189/", "url_object_id": "6cbfecaa4a696000b1d800f677cb3f43", "create_date": "2017/08/14", "front_image_url": ["http://jbcdn2.b0.upaiyun.com/2016/11/59d49abe8909a122bc2c9aa43b71e3bb.png"], "praise_nums": "1", "fav_nums": 0, "comment_nums": 0, "tags": "IT技术,Linux,容器", "content": "<div class=\"entry\">\r\n\r\n        \t\t\t<div class=\"textwidget\"></div>\n\t\t\r\n\t\t<div class=\"copyright-area\">原文出处： <a ref=\"nofollow\" target=\"_blank\" href=\"https://medium.com/linode-cube/the-what-why-and-wow-behind-the-coreos-container-linux-fa7ceae5593c\">Steven J. Vaughan-nichols</a>   译文出处：<a target=\"_blank\" href=\"https://linux.cn/article-8768-1.html\">Linux中国/toyijiu</a>   </div><blockquote><p>CoreOS，一款最新的 Linux 发行版本，支持自动升级内核软件，提供各集群间配置的完全控制。</p></blockquote>\n<p>关于使用哪个版本的 Linux 服务器系统的争论，常常是以这样的话题开始的：</p>\n<blockquote><p>你是喜欢基于 <a href=\"https://www.redhat.com/en/technologies/linux-platforms/enterprise-linux\">Red Hat Enterprise Linux （RHEL）</a> 的 <a href=\"https://www.centos.org/\">CentOS</a> 或者 <a href=\"https://getfedora.org/\">Fedora</a>，还是基于 <a href=\"https://www.debian.org/\">Debian</a> 的 <a href=\"https://www.ubuntu.com/\">Ubuntu</a>，抑或 <a href=\"https://www.suse.com/\">SUSE</a> 呢？</p></blockquote>\n<p>但是现在，一款名叫 <a href=\"https://coreos.com/os/docs/latest\">CoreOS 容器 Linux</a> 的 Linux 发行版加入了这场“圣战”。<a href=\"https://www.linode.com/docs/platform/use-coreos-container-linux-on-linode\">这个最近在 Linode 服务器上提供的 CoreOS</a>，和它的老前辈比起来，它使用了完全不同的实现方法。</p>\n<p>你可能会感到不解，这里有这么多成熟的 Linux 发行版本，为什么要选择用 CoreOS ？借用 Linux 主干分支的维护者，也是 CoreOS 顾问的 Greg Kroah-Hartman 先生的一句话：</p>\n<blockquote><p>CoreOS 可以控制发行版的升级（基于 ChromeOS 代码），并结合了 Docker 和潜在的核对/修复功能，这意味着不用停止或者重启你的相关进程，就可以<a href=\"https://plus.google.com/+gregkroahhartman/posts/YvWFmPa9kVf\">在线升级</a>。测试版本已经支持此功能，这是史无前例的。</p></blockquote>\n<p>当 Greg Kroah-Hartman 做出这段评价时，CoreOS 还处于 α 测试阶段，当时也许就是在硅谷的一个车库当中，<a href=\"https://www.wired.com/2013/08/coreos-the-new-linux/\">开发团队正在紧锣密鼓地开发此产品</a>，但 CoreOS 不像最开始的苹果或者惠普，其在过去的四年当中一直稳步发展。</p>\n<p>当我参加在旧金山举办的 <a href=\"https://coreos.com/fest/\">2017 CoreOS 大会</a>时，CoreOS 已经支持谷歌云、IBM、AWS 和微软的相关服务。现在有超过 1000 位开发人员参与到这个项目中，并为能够成为这个伟大产品的一员而感到高兴。</p>\n<p>究其原因，CoreOS 从开始就是为容器而设计的轻量级 Linux 发行版，其起初是作为一个 <a href=\"https://www.docker.com/\">Docker</a> 平台，随着时间的推移， CoreOS 在容器方面走出了自己的道路，除了 Docker 之外，它也支持它自己的容器 <a href=\"https://coreos.com/rkt\">rkt</a> （读作 rocket ）。</p>\n<p>不像大多数其他的 Linux 发行版，CoreOS 没有包管理器，取而代之的是通过 Google ChromeOS 的页面自动进行软件升级，这样能提高在集群上运行的机器/容器的安全性和可靠性。不用通过系统管理员的干涉，操作系统升级组件和安全补丁可以定期推送到 CoreOS 容器。</p>\n<p>你可以通过 <a href=\"https://coreos.com/products/coreupdate/\">CoreUpdate 和它的 Web 界面</a>上来修改推送周期，这样你就可以控制你的机器何时更新，以及更新以多快的速度滚动分发到你的集群上。</p>\n<p>CoreOS 通过一种叫做 <a href=\"https://github.com/coreos/etcd\">etcd</a> 的分布式配置服务来进行升级，etcd 是一种基于 <a href=\"http://yaml.org/\">YAML</a> 的开源的分布式哈希存储系统，它可以为 Linux 集群容器提供配置共享和服务发现等功能。</p>\n<p>此服务运行在集群上的每一台服务器上，当其中一台服务器需要下线升级时，它会发起领袖选举，以便服务器更新时整个Linux 系统和容器化的应用可以继续运行。</p>\n<p>对于集群管理，CoreOS 之前采用的是 <a href=\"https://github.com/coreos/fleet\">fleet</a> 方法，这将 etcd 和 <a href=\"https://www.freedesktop.org/wiki/Software/systemd/\">systemd</a> 结合到分布式初始化系统中。虽然 fleet 仍然在使用，但 CoreOS 已经将 etcd 加入到 <a href=\"https://kubernetes.io/\">Kubernetes</a> 容器编排系统构成了一个更加强有力的管理工具。</p>\n<p>CoreOS 也可以让你定制其它的操作系统相关规范，比如用 <a href=\"https://coreos.com/os/docs/latest/cloud-config.html\">cloud-config</a> 的方式管理网络配置、用户账号和 systemd 单元等。</p>\n<p>综上所述，CoreOS 可以不断地自行升级到最新版本，能让你获得从单独系统到集群等各种场景的完全控制。如 CoreOS 宣称的，你再也不用为了改变一个单独的配置而在每一台机器上运行 <a href=\"https://insights.hpe.com/articles/what-is-chef-a-primer-for-devops-newbies-1704.html\">Chef</a> 了。</p>\n<p>假如说你想进一步的扩展你的 DevOps 控制，<a href=\"https://blogs.dxc.technology/2017/06/08/coreos-moves-in-on-cloud-devops-with-kubernetes/\">CoreOS 能够轻松地帮助你部署 Kubernetes</a>。</p>\n<p>CoreOS 从一开始就是构建来易于部署、管理和运行容器的。当然，其它的 Linux　发行版，比如 RedHat 家族的<a href=\"http://www.projectatomic.io/\">原子项目</a>也可以达到类似的效果，但是对于那些发行版而言是以附加组件的方式出现的，而 CoreOS 从它诞生的第一天就是为容器而设计的。</p>\n<p>当前<a href=\"http://www.zdnet.com/article/what-is-docker-and-why-is-it-so-darn-popular/\">容器和 Docker 已经逐渐成为商业系统的主流</a>，如果在可预见的未来中你要在工作中使用容器，你应该考虑下 CoreOS，不管你的系统是在裸机硬件上、虚拟机还是云上。</p>\n<p>如果有任何关于 CoreOS 的观点或者问题，还请在评论栏中留言。如果你觉得这篇博客还算有用的话，还请分享一下~</p>\n<hr>\n<p>关于博主：Steven J. Vaughan-Nichols 是一位经验丰富的 IT 记者，许多网站中都刊登有他的文章，包括 <a href=\"http://www.zdnet.com/meet-the-team/us/steven-j-vaughan-nichols/\">ZDNet.com</a>、<a href=\"http://www.pcmag.com/author-bio/steven-j.-vaughan-nichols\">PC Magazine</a>、<a href=\"http://www.infoworld.com/author/Steven-J.-Vaughan_Nichols/\">InfoWorld</a>、<a href=\"http://www.computerworld.com/author/Steven-J.-Vaughan_Nichols/\">ComputerWorld</a>、<a href=\"http://www.linuxtoday.com/author/Steven+J.+Vaughan-Nichols/\">Linux Today</a> 和 <a href=\"http://www.eweek.com/cp/bio/Steven-J.-Vaughan-Nichols/\">eWEEK</a> 等。他拥有丰富的 IT 知识 – 而且他曾参加过智力竞赛节目 Jeopardy ！他的相关观点都是自身思考的结果，并不代表 Linode 公司，我们对他做出的贡献致以最真诚的感谢。如果想知道他更多的信息，可以关注他的 Twitter <a href=\"http://www.twitter.com/sjvn\"><em>@sjvn</em></a>。</p>\n\r\n        \r\n        \r\n        \n    <div class=\"post-adds\">\n        <span data-post-id=\"112189\" class=\" btn-bluet-bigger href-style vote-post-up   register-user-only \"><i class=\"fa  fa-thumbs-o-up\"></i> <h10 id=\"112189votetotal\">1</h10> 赞</span>\n        <span data-book-type=\"1\" data-site-id=\"2\" data-item-id=\"112189\" data-item-type=\"1\" class=\" btn-bluet-bigger href-style bookmark-btn  register-user-only \"><i class=\"fa fa-bookmark-o  \"></i>  收藏</span>\n\n                    <a href=\"#article-comment\"><span class=\"btn-bluet-bigger href-style hide-on-480\"><i class=\"fa fa-comments-o\"></i>  评论</span></a>\n        \n        \n        \n        <!-- JiaThis Button BEGIN -->\n        <div class=\"jiathis_style_24x24\" style=\"display: inline-flex; position: relative; margin: 0; clear: both;float: right;\">\n            <a class=\"jiathis_button_tsina\"></a>\n            <a class=\"jiathis_button_weixin\"></a>\n            <a class=\"jiathis_button_qzone\"></a>\n            <a class=\"jiathis_button_fb hide-on-480\"></a>\n            <a href=\"http://www.jiathis.com/share?uid=1745061\" class=\"jiathis jiathis_txt jiathis_separator jtico jtico_jiathis\" target=\"_blank\"></a>\n        </div>\n\n    </div>\n\n\n\n\r\n        <!-- BEGIN #author-bio -->\r\n\r\n\r\n<!-- END #author-bio -->\r\n\t</div>", "front_image_path": ["full/d3d1a5ad957de059084690efae6fdfaa3527e1c3.jpg"]},{"title": "程序员的自我修养：温故而知新", "url": "http://blog.jobbole.com/112161/", "url_object_id": "697cda33f7258dcfabbacb139fb85b20", "create_date": "2017/08/11", "front_image_url": ["http://jbcdn2.b0.upaiyun.com/2017/08/fd582ce02602d145acd4982f8b868c92.png"], "praise_nums": "1", "fav_nums": "5", "comment_nums": 0, "tags": "职场,程序员", "content": "<div class=\"entry\">\r\n\r\n        \t\t\t<div class=\"textwidget\"></div>\n\t\t\r\n\t\t<div class=\"copyright-area\">原文出处： <a target=\"_blank\" href=\"http://www.cnblogs.com/Tan-sir/p/7272652.html\">目不识丁</a>   </div><h2>1.1从Hello World说起</h2>\n<p>目的：从最基本的编译，静态链接到操作系统如何转载程序，动态链接及运行库和标准库的实现，和一些操作系统的机制。了解计算机上程序运行的一个基本脉络。</p>\n<h2>1.2变不离其宗</h2>\n<p>计算机最关键的三个部分：CPU,内存,I/O控制芯片。</p>\n<ul>\n<li>早期的计算机：没有复杂的图形功能，CPU和内存频率一样，都连接在同一个总线上。</li>\n<li>CPU频率提升：内存跟不上CPU，产生了和内存频率一致的系统总线，CPU使用倍频的方式和总线通信。</li>\n<li>图形界面的出现：图形芯片需要和内存和CPU大量交换数据，慢速的I/O总线无法满足图形设备的巨大需求。为了高效处理数据，设计了一个高速的北桥芯片。后来有设计处理低速处理设备南桥芯片，磁盘，USB，键盘都是连接在南桥上。在由南桥将它们汇总到北桥上。</li>\n</ul>\n<h5><strong>北桥</strong></h5>\n<ul>\n<li>北桥左边CPU和cache：CPU负责所有控制和运算。</li>\n<li>北桥下面PCI总线</li>\n<li>北桥右边memory</li>\n</ul>\n<h5>SMP和多核</h5>\n<p>现在CPU已经达到物理极限，被4GHz所限制，于是，开始通过增加CPU数量来提高计算机速度。<br>\n<strong>对称多处理器（SMP）</strong>：最常见的一种形式。每个CPU在系统中所处的地位和所发挥的功能是一样，是相互对称的。但在处理程序时，我们并不能把他们分成若干个不相干的子问题，所以，使得多处理器速度实际提高得并没有理论上那么高。当对于相互独立的问题，多处理器就能最大效能的发挥威力了（比如：大型数据库,网络服务等）。<br>\n对处理器由于造价比较高昂，主要用在商用电脑上，对于个人电脑，主要是<strong>多核处理器</strong>。<br>\n多核处理器：其实际上是(SMP)的简化版，思想是将多个处理器合并在一起打包出售，它们之间共享比较昂贵的缓存部件，只保留了多个核心。在逻辑上看，它们和SMP完全相同。</p>\n<h2>1.3站得高,看得远</h2>\n<p><strong>系统软件</strong>：一般用于管理计算机本地的软件。</p>\n<p>主要分为两块：</p>\n<ul>\n<li>平台性的：操作系统内核，驱动程序，运行库。</li>\n<li>程序开发：编译器，汇编器，链接器。</li>\n</ul>\n<p>计算机系统软件体系结构采用一种<strong>层</strong>的结构。<br>\n每个层次之间都需要相互通信，那么它们之间就有通信协议，我们将它称为接口，接口下层是提供者，定义接口。上层是使用者，使用接口实现所需功能。<br>\n除了硬件和应用程序，其他的都是中间层，每个中间层都是对它下面的那层的包装和扩展。它们使得应用程序和硬件之间保持相对独立。<br>\n从整个层次结构来看，开发工具与应用程序属于同一个层次，因为它们都使用同一个接口—操作系统<strong>应用程序编程接口</strong>。应用程序接口提供者是运行库，什么样的运行库提供什么样的接口。winsows的运行库提供Windows API，Linux下的Gliba库提供POSIX的API。<br>\n运行库使用操作系统提供的<strong>系统调用接口</strong>。<br>\n系统调用接口在实现中往往以<strong>软件中断</strong>的方式提供。<br>\n操作系统内核层对于硬件层来说是硬件接口的使用者，而硬件是接口的定义者。这种接口叫做<strong>硬件规格</strong>。</p>\n<h2>1.4操作系统做了什么</h2>\n<p>操作系统的一个功能是提供抽象的接口，另外一个主要功能是管理硬件资源。<br>\n一个计算机中的资源主要分CPU,存储器（包括内存和磁盘）和I/O设备。下面从这3个方面来看如何挖机它们。</p>\n<h3>1.4.1不要让CPU打盹</h3>\n<p><strong>多道程序</strong>：编译一个监控程序，当程序不需要使用CPU时，将其他在等待CPU的程序启动。但它的弊端是不分轻重缓急，有时候一个交互操作可能要等待数十分钟。<br>\n改进后<br>\n<strong>分时系统</strong>：每个CPU运行一段时间后，就主动让出给其他CPU使用。完整的操作系统雏形在此时开始出现。但当一个程序死机的时候，无法主动让出CPU，那么，整个系统都无法响应。<br>\n目前操作系统采用的方式<br>\n<strong>多任务系统</strong>：操作系统接管了所有的硬件资源，并且本身运行在一个受硬件保护的级别。所有的应用都以<strong>进程</strong>的方式运行在比操作系统更低的级别，每个进程都有自己独立的地址空间，使得进程之间的地址空间相互隔离。CPU由操作系统进行同一分配，每个进程根据进程优先级的高低都有机会获得CPU，但如果运行超过一定的时间，CPU会将资源分配给其他进程，这种CPU分配方式是<strong>抢占式</strong>。如果操作系统分配每个进程的时间很短，就会造成很多进程都在同时运行的假象，即所谓的<strong>宏观并行，微观串行</strong>。</p>\n<h5><a name=\"%E8%AE%BE%E5%A4%87%E9%A9%B1%E5%8A%A8\"></a>设备驱动</h5>\n<p>操作系统作为硬件层的上层，它是对硬件的管理和抽象。<br>\n对于操作系统上面的运行库和应用程序来说，它们只希望看到一个统一的硬件访问模式。<br>\n当成熟的操作系统出现后，硬件逐渐成了抽象的概念。在UNIX中，硬件设备的访问形式和访问普通的文件形式一样。在Windows系统中，图形硬件被抽象成GDI，声音和多媒体设备被抽象成DirectX对象，磁盘被抽象成普通文件系统。<br>\n这些繁琐的硬件细节全都交给了操作系统中的硬件驱动。<br>\n文件系统管理这磁盘的存储方式。<br>\n<strong>磁盘的结构</strong>：一个硬盘往往有多个盘片，每个盘片分两面，每面按照同心圆划分为若干磁道，每个磁道划分为若干扇区，每个扇区一般512字节。<br>\n<strong>LBA</strong>：整个硬盘中所有扇区从0开始编号，一直到最后一个扇区，这个扇区编号叫做<strong>逻辑扇区号</strong>。<br>\n文件系统保存了这些文件的存储结构，负责维护这些数据结构并且保证磁盘中的扇区能有效的组织和利用。</p>\n<h2>1.5内存不够怎么办</h2>\n<p>在早期计算机中，程序是直接运行在物理内存上的，程序所访问的都是物理地址。<br>\n那么如何将计算机有限的地址分配给多个程序使用。<br>\n直接按物理内存分配将产生很多问题：</p>\n<ul>\n<li><strong>地址空间不隔离</strong>：所有的程序都直接访问物理地址，导致程序使用的物理地址不是相互隔离的，恶意的程序很容易串改其他程序的内存数据。</li>\n<li><strong>内存使用效率低</strong>：由于没有有效的内存管理机制，通常一个程序执行的时候，监控程序要将整个程序读入。内存不够的时候，需要先将内存中的程序读出，保存在硬盘上，才能将需要运行的程序读入。这样会使得整个过程有大量数据换入换出。</li>\n<li><strong>程序运行地址不确定</strong>：每次程序运行都需要内存分配一块足够大的内存空间，使得这个地址是不确定的。但在程序编写的时候，他访问的数据和指令跳转的目标地址都是固定的，这就涉及到了程序的<strong>重定向</strong>问题。</li>\n</ul>\n<p>一种解决办法：<br>\n<strong>中间层</strong>：使用一种间接的地址访问方法，我们把程序给出的地址看作一种<strong>虚拟地址</strong>。虚拟地址是物理地址的映射，只要处理好这个过程，就可以起到隔离的作用。</p>\n<h3>1.5.1关于隔离</h3>\n<p>普通的程序它只需要一个简单的执行环境，一个单一的地址空间，有自己的CPU。<br>\n地址空间比较抽象，如果把它想象成一个数组，每一个数组是一字节，数组大小就是地址空间的长度，那么32位的地址空间大小就是2^32=4294967296字节，即4G，地址空间有效位是0x00000000~0xFFFFFFFF。<br>\n地址空间分为两种：<br>\n<strong>物理空间</strong>：就是物理内存。32位的机器，地址线就有32条，物理空间4G，但如果值装有512M的内存，那么实际有效的空间地址就是0x00000000~0x1FFFFFFF，其他部分都是无效的。<br>\n虚拟空间：每个进程都有自己独立的虚拟空间，而且每个进程只能访问自己的空间地址，这样就有效的做到了进程隔离。</p>\n<h3>1.5.2分段<a name=\"152%E5%88%86%E6%AE%B5\"></a></h3>\n<p>基本思路：把一段与程序所需要的内存空间大小的虚拟空间映射到某个地址空间。虚拟空间的每个字节对应物理空间的每个字节。这个映射过程由软件来完成。<br>\n分段的方式可以解决之前的第一个（地址空间不隔离）和第三个问题（程序运行地址不确定）<br>\n第二问题内存使用效率问题依旧没有解决。</p>\n<h3>1.5.3分页</h3>\n<p>基本方法：把地址空间人为的分成固定大小的页，每一页大小有硬件决定或硬件支持多种大小的页，由操作系统决定页的大小。<br>\n目前几乎所有的PC上的操作系统都是4KB大小的页。<br>\n我们把进程的虚拟地址空间按页分割，把常用的数据和代码页转载到内存中，把不常用的代码和数据保存到磁盘里，当需要的时候从磁盘取出来。<br>\n虚拟空间的页叫做<strong>虚拟页（VP）</strong>,物理内存中页叫做<strong>物理页</strong>，把磁盘中的页叫做<strong>磁盘页</strong>。虚拟空间的有的页被映射到同一个物理页，这样就可以实现内存共享。<br>\n当进程需要一个页时，这个页是磁盘页时，硬件会捕获到这个消息，就是所谓的<strong>页错误</strong>，然后操作系统接管进程，负责从磁盘中读取内容装入内存中，然后再将内存和这个页建立映射关系。<br>\n<strong>保护</strong>也是页映射的目的之一，每个页都可以设置权限属性，只有操作系统可以修改这些属性，这样操作系统就可以保护自己保护进程。<br>\n<strong>虚拟存储</strong>的实现需要依靠硬件支持，所有硬件都采用一个叫做MMU的部件来进行页映射。<br>\nCPU发出虚拟地址经过MMU转换成物理地址，MMU一般都集成在CPU内部。</p>\n<h2>1.6众人拾柴火焰高</h2>\n<h3>1.6.1线程基础<a name=\"161%E7%BA%BF%E7%A8%8B%E5%9F%BA%E7%A1%80\"></a></h3>\n<p>多线程现在作为实现软件并发执行的一个重要方法，具有越来越重的地位。</p>\n<h5><a name=\"%E4%BB%80%E4%B9%88%E6%98%AF%E7%BA%BF%E7%A8%8B\"></a>什么是线程</h5>\n<p><strong>线程</strong>有时被称为轻量级的进程，是程序执行流的最小单位。</p>\n<p>构成：</p>\n<ul>\n<li>线程ID</li>\n<li>当前指令指针</li>\n<li>寄存器集合</li>\n<li>堆栈空间（代码段，数据段，堆）</li>\n<li>进程级的资源（打开文件和信号）</li>\n</ul>\n<p>线程与进程的关系：</p>\n<p><img src=\"http://jbcdn2.b0.upaiyun.com/2017/08/fd582ce02602d145acd4982f8b868c92.png\" alt=\"\"></p>\n<p>多线程可以互不干扰的并发执行，并共享进程的全局变量和堆的数据。<br>\n使用多线程的原因有如下几点：</p>\n<ul>\n<li>某个操作可能会陷入长时间等待，等待的线程会进入睡眠状态，无法继续执行。</li>\n<li>某个操作会消耗大量的时间，如果只有一个线程，程序和用户之间的交互会中断。</li>\n<li>程序逻辑本身就要求并发操作。</li>\n<li>多CPU或多核计算机，本身具备同时执行多个线程的能力。</li>\n<li>相对于多进程应用，多线程在数据共享方面效率要高很多。</li>\n</ul>\n<h5><a name=\"%E7%BA%BF%E7%A8%8B%E7%9A%84%E8%AE%BF%E9%97%AE%E6%9D%83%E9%99%90\"></a>线程的访问权限</h5>\n<p>线程的访问非常自由，它可以访问进程内存里所有数据，包括其他线程的堆栈（如果知道地址的话，情况很少见）。<br>\n线程自己的私用存储空间：</p>\n<ul>\n<li>栈（并发完全无法被其他线程访问）</li>\n<li>线程局部存储。某些操作系统为线程提供私用空间，但容量有限。</li>\n<li>寄存器。执行流的基本数据，为线程私用。</li>\n</ul>\n<table>\n<thead>\n<tr>\n<th>线程私用</th>\n<th>线程间共享（进程所有）</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>局部变量</td>\n<td>全局变量</td>\n</tr>\n<tr>\n<td>函数参数</td>\n<td>堆上数据</td>\n</tr>\n<tr>\n<td>TLS数据</td>\n<td>函数里的静态变量</td>\n</tr>\n<tr>\n<td></td>\n<td>程序代码</td>\n</tr>\n<tr>\n<td></td>\n<td>打开的文件，A线程打开的文件可以由B线程读取</td>\n</tr>\n</tbody>\n</table>\n<h5><a name=\"%E7%BA%BF%E7%A8%8B%E8%B0%83%E5%BA%A6%E4%B8%8E%E4%BC%98%E5%85%88%E7%BA%A7\"></a>线程调度与优先级</h5>\n<p>不论在多处理器还是单处理器上，线程都是“并发”的。<br>\n线程数量小于处理器数量时，是真正并发的。<br>\n单处理器下，并发是模拟的，操作系统会让这些多线程程序轮流执行，每次都只执行一小段时间，这就称为<strong>线程调度</strong>。<br>\n线程调度中，线程拥有三种状态：</p>\n<ul>\n<li>运行：线程正在执行</li>\n<li>就绪：线程可以立刻运行，但CPU被占用</li>\n<li>等待：线程正在等待某一事件发生，无法立即执行。</li>\n</ul>\n<p>处于运行中的线程拥有一段可以执行的时间，这称为<strong>时间片</strong>，当时间片用尽的时候，进程进入就绪状态，如果在用尽之前开始等待某事件，那么它就进入等待状态。每当一个线程离开运行状态的时候，调度系统就会选择一个其他的就绪线程继续执行。</p>\n<p><img src=\"http://jbcdn2.b0.upaiyun.com/2017/08/98d32af045fd36e5fc3477f9fe4a2758.png\" alt=\"\"></p>\n<p>现在的主流调度方法尽管都不一样，但基本都带有<strong>优先级调度</strong>和<strong>轮转法</strong>。<br>\n轮转法：各个线程轮流执行一段时间。<br>\n优先级调度：按线程的优先级来轮流执行，每个线程都拥有各自的线程优先级。<br>\n在win和lin里面，线程优先级不仅可以由用户手动设置，系统还会根据不同线程表现自动调整优先级。<br>\n一般频繁等待的线程称之为<strong>IO密集型线程</strong>，而把很少等待的线程称为<strong>CPU密集型线程</strong>。<br>\n优先级调度下，存在一种<strong>饿死</strong>现象。<br>\n饿死：线程优先级较低，在它执行之前，总是有较高级的线程要执行，所以，低优先级线程总是无法执行的。<br>\n当一个CPU密集型线程获得较高优先级时，许多低优先级线程就可能被饿死。<br>\n为了避免饿死，操作系统常常会逐步提升那些等待时间过长的线程。<br>\n线程优先级改变一般有三种方式：</p>\n<ul>\n<li>用户指定优先级</li>\n<li>根据进入等待状态的频繁程度提升或降低优先级</li>\n<li>长时间得不到执行而被提升优先级</li>\n</ul>\n<h5><a name=\"%E5%8F%AF%E6%8A%A2%E5%8D%A0%E7%BA%BF%E7%A8%8B%E5%92%8C%E4%B8%8D%E5%8F%AF%E6%8A%A2%E5%8D%A0%E7%BA%BF%E7%A8%8B\"></a>可抢占线程和不可抢占线程</h5>\n<p><strong>抢占</strong>：在线程用尽时间片之后被强制剥夺继续执行的权利，而进入就绪状态。<br>\n在早期的系统中，线程是<strong>不可抢占</strong>的，线程必须主动进入就绪状态。<br>\n在不可抢占线程中，线程主动放弃主要是2种：</p>\n<ul>\n<li>当线程试图等待某个事件（I/O）时</li>\n<li>线程主动放弃时间片</li>\n</ul>\n<p>不可抢占线程有一个好处，就是线程调度只会发生在线程主动放弃执行或线程等待某个事件的时候，这样就可以避免一些抢占式线程时间不确定而产生的问题。</p>\n<h5><a name=\"linux%E7%9A%84%E5%A4%9A%E7%BA%BF%E7%A8%8B\"></a>Linux的多线程</h5>\n<p>Linux内核中并不存在真正意义上的线程概念。Linux所有执行实体（线程和进程）都称为<strong>任务</strong>，每一个任务概念上都类似一个单线程的进程，具有内存空间，执行实体，文件资源等。Linux不同任务之间可以选择共享内存空间，相当于同一个内存空间的多个任务构成一个进程，这些任务就是进程中的线程。</p>\n<table>\n<thead>\n<tr>\n<th>系统调用</th>\n<th>作用</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>fork</td>\n<td>复制当前线程</td>\n</tr>\n<tr>\n<td>exec</td>\n<td>使用新的可执行映像覆盖当前可执行映像</td>\n</tr>\n<tr>\n<td>clone</td>\n<td>创建子进程并从指定位置开始执行</td>\n</tr>\n</tbody>\n</table>\n<p>fork产生新任务速度非常快，因为fork不复制原任务的内存空间，而是和原任务一起共享一个<strong>写时复制</strong>的内存空间。</p>\n<p><img src=\"http://jbcdn2.b0.upaiyun.com/2017/08/4c89163b6db707d13e93ae4f5ad6fdca.png\" alt=\"\"></p>\n<p>写时复制：两个任务可以同时自由读取内存，当任意一个任务试图对内存进行修改时，内存就会复制一份单独提供给修改方使用。<br>\nfork只能够产生本任务的镜像，因此需要和exec配合才能启动别的新任务。<br>\n而如果要产生新线程，则使用clone。<br>\nclone可以产生一个新的任务，从指定位置开始执行，并且共享当前进程的内存空间和文件等，实际效果就是产生一个线程。</p>\n<h3>1.6.2线程安全</h3>\n<p>多线程程序处于一个多变的环境中，可访问的全局变量和堆数据随时都可能被其他的线程改变。因此多线程程序在并发时数据的一致性变得非常重要。</p>\n<h5><a name=\"%E7%AB%9E%E4%BA%89%E4%B8%8E%E5%8E%9F%E5%AD%90%E6%93%8D%E4%BD%9C\"></a>竞争与原子操作</h5>\n<p>++i的实现方法：</p>\n<ul>\n<li>读取i到某个寄存器X</li>\n<li>X++</li>\n<li>将X的内容存储回i<br>\n单条指令的操作称为<strong>原子的</strong>，单挑指令的执行不会被打断。在windows里，有一套API专门进行一些原子操作，这些API称为Interlocked API。</li>\n</ul>\n<h5><a name=\"%E5%90%8C%E6%AD%A5%E4%B8%8E%E9%94%81\"></a>同步与锁</h5>\n<p>为了防止多个线程读取同一个数据产生不可预料结果，我们将各个线程对一个数据的访问同步。<br>\n<strong>同步</strong>：在一个线程对一个数据访问结束的时候，其他线程不能对同一个数据进行访问。对数据的访问被原子化。<br>\n<strong>锁</strong>：锁是一种非强制机制，每一个线程在访问数据或者资源之前会先获取锁，在访问结束后会释放锁。在锁被占用时候试图获取锁时，线程会等待，知道锁可以重新使用。<br>\n<strong>二元信号量</strong>：最简单的锁，它适合只能被唯一一个线程独占访问的资源，它的两种状态：</p>\n<ul>\n<li>非占用状态：第一个获取该二元信号量的线程会获得该锁，并将二元信号量置为占用状态，其他所有访问该二元信号量线程将会等待。</li>\n<li>占用状态</li>\n</ul>\n<p><strong>信号量</strong>：允许多个线程并发访问的资源。一个初始值为N的信号量允许N个线程并发访问。<br>\n操作如下：</p>\n<ul>\n<li>将信号量值键1</li>\n<li>如果信号量值小于0，就进入等待状态。</li>\n</ul>\n<p>访问完资源后，线程释放信号量：</p>\n<ul>\n<li>将信号量加1</li>\n<li>如果信号量的值小于1，唤醒一个等待中的线程。</li>\n</ul>\n<p><strong>互斥量</strong>：和二元信号量很类似，但和信号量不同的是：信号量在一个系统中，可以被任意线程获取或释放。互斥量要求那个线程获取互斥量，那么哪个线程就释放互斥量，其他线程释放无效。<br>\n<strong>临界区</strong>：比互斥量更加严格的手段。把临界区的锁获取称为进入临界区，而把锁的释放称为离开临界区。临界区和互斥量，信号量区别在与互斥量，信号量在系统中任意进程都是可见的。临界区的作用范围仅限于本线程，其他线程无法获取。其他性质与互斥量相同。<br>\n<strong>读写锁</strong>：致力于一种更加特定的场合的同步。如果使用之前使用的信号量、互斥量或临界区中的任何一种进行同步，对于读取频繁，而仅仅是偶尔写入的情况会显得非常低效。读写锁可以避免这个问题。对于同一个锁，读写锁有两种获取方式：</p>\n<ul>\n<li>共享的</li>\n<li>独占的</li>\n</ul>\n<p>读写锁的总结</p>\n<table>\n<thead>\n<tr>\n<th>读写锁状态</th>\n<th>以共享方式获取</th>\n<th>以独占方式获取</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>自由</td>\n<td>成功</td>\n<td>成功</td>\n</tr>\n<tr>\n<td>共享</td>\n<td>成功</td>\n<td>等待</td>\n</tr>\n<tr>\n<td>独占</td>\n<td>等待</td>\n<td>等待</td>\n</tr>\n</tbody>\n</table>\n<p><strong>条件变量</strong>：作为同步的手段，作用类似于一个栅栏。对于条件变量，线程有两个操作：</p>\n<ul>\n<li>线程可以等待条件变量，一个条件变量可以被多个线程等待</li>\n<li>线程可以唤醒条件变量，此时某个或所有等待此条件变量的线程都会被唤醒并继续支持</li>\n</ul>\n<p>使用条件变量可以让许多线程一起等待某个事件的发生，当事件发生时，所有线程可以一起恢复执行。</p>\n<h5><a name=\"%E5%8F%AF%E9%87%8D%E5%85%A5%E4%B8%8E%E7%BA%BF%E7%A8%8B%E5%AE%89%E5%85%A8\"></a>可重入与线程安全</h5>\n<p>一个函数被重入，表示这个函数没有执行完成，由于外部因素或内部调用，又一次进入该函数执行。<br>\n一个函数要被重入，只有两种情况：</p>\n<ul>\n<li>多个线程同时执行这个函数</li>\n<li>函数自身（可能经过多层调用之后）调用自身</li>\n</ul>\n<p>一个函数被称为可重入，表示重入之后不会产生任何不良影响</p>\n<p>可重入函数：</p>\n<div>\n<!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-5994362e07b76072452393\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-always\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"复制代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\nint sqr(int x) \r\n{\r\n    return x * x;\r\n}</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5994362e07b76072452393-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5994362e07b76072452393-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5994362e07b76072452393-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5994362e07b76072452393-4\">4</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5994362e07b76072452393-1\"><span class=\"crayon-t\">int</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">sqr</span><span class=\"crayon-sy\">(</span><span class=\"crayon-t\">int</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">x</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5994362e07b76072452393-2\"><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-5994362e07b76072452393-3\"><span class=\"crayon-h\">    </span><span class=\"crayon-st\">return</span><span class=\"crayon-h\"> </span><span class=\"crayon-e \">x *</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">x</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5994362e07b76072452393-4\"><span class=\"crayon-sy\">}</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0006 seconds] -->\r\n\n</div>\n<p>一个函数要成为可重入，必须具有如下特点：</p>\n<ul>\n<li>不使用任何（局部）静态或全局的非const变量</li>\n<li>不返回任何（局部）静态或全部的非const变量的指针</li>\n<li>仅依赖调用方提供的参数</li>\n<li>不依赖任何单个资源的锁</li>\n<li>不调用任何不可重入的函数</li>\n</ul>\n<p>可重入是并发安全的强力保障，一个可重入的函数可以在多程序环境下方向使用</p>\n<h5><a name=\"%E8%BF%87%E5%BA%A6%E4%BC%98%E5%8C%96\"></a>过度优化</h5>\n<p>有时候合理的合理的使用了锁也不一定能保证线程的安全。</p>\n<div>\n<!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-5994362e07b81590386572\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-always\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"复制代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\n//Thread1\r\nx=0;\r\nlock();\r\nx++;\r\nunlock();\r\n//Thread2\r\nx=0;\r\nlock();\r\nx++;\r\nunlock();</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5994362e07b81590386572-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5994362e07b81590386572-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5994362e07b81590386572-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5994362e07b81590386572-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-5994362e07b81590386572-5\">5</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5994362e07b81590386572-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-5994362e07b81590386572-7\">7</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5994362e07b81590386572-8\">8</div><div class=\"crayon-num\" data-line=\"crayon-5994362e07b81590386572-9\">9</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5994362e07b81590386572-10\">10</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5994362e07b81590386572-1\"><span class=\"crayon-c\">//Thread1</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5994362e07b81590386572-2\"><span class=\"crayon-v\">x</span><span class=\"crayon-o\">=</span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5994362e07b81590386572-3\"><span class=\"crayon-e\">lock</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5994362e07b81590386572-4\"><span class=\"crayon-v\">x</span><span class=\"crayon-o\">++</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5994362e07b81590386572-5\"><span class=\"crayon-e\">unlock</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5994362e07b81590386572-6\"><span class=\"crayon-c\">//Thread2</span></div><div class=\"crayon-line\" id=\"crayon-5994362e07b81590386572-7\"><span class=\"crayon-v\">x</span><span class=\"crayon-o\">=</span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5994362e07b81590386572-8\"><span class=\"crayon-e\">lock</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5994362e07b81590386572-9\"><span class=\"crayon-v\">x</span><span class=\"crayon-o\">++</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5994362e07b81590386572-10\"><span class=\"crayon-e\">unlock</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0008 seconds] -->\r\n\n</div>\n<p>上面X的值应该为2，但如果编译器为了提高X的访问速度，把X放到了某个寄存器里面，不同线程的寄存器是各自独立的，因此，如果Thread1先获得锁，则程序的执行可能会呈现如下：<br>\n[Thread1]读取x的值到某个寄存器R [1] (R[1]=0);<br>\n[Thread1]R[1]++(由于之后可能要访问到x,所以Thread1暂时不将R[1]写回x);<br>\n[Thread2]读取x的值到某个寄存器R[2] (R[2]=0);<br>\n[Thread2]R[2]++(R[2]=1);<br>\n[Thread2]将R[2]写回至x(x=1);<br>\n[Thread1] (很久以后)将R[1]写回至x(x=1);<br>\n如果这样，即使加锁也不能保证线程安全</p>\n<div>\n<!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-5994362e07b88119988991\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-always\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"复制代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\nx=y=0;\r\n//Thread1\r\nx=1;\r\nr1=y;\r\n//Thread2\r\ny=1;\r\nr2=x;</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5994362e07b88119988991-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5994362e07b88119988991-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5994362e07b88119988991-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5994362e07b88119988991-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-5994362e07b88119988991-5\">5</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5994362e07b88119988991-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-5994362e07b88119988991-7\">7</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5994362e07b88119988991-1\"><span class=\"crayon-v\">x</span><span class=\"crayon-o\">=</span><span class=\"crayon-v\">y</span><span class=\"crayon-o\">=</span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5994362e07b88119988991-2\"><span class=\"crayon-c\">//Thread1</span></div><div class=\"crayon-line\" id=\"crayon-5994362e07b88119988991-3\"><span class=\"crayon-v\">x</span><span class=\"crayon-o\">=</span><span class=\"crayon-cn\">1</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5994362e07b88119988991-4\"><span class=\"crayon-v\">r1</span><span class=\"crayon-o\">=</span><span class=\"crayon-v\">y</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5994362e07b88119988991-5\"><span class=\"crayon-c\">//Thread2</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5994362e07b88119988991-6\"><span class=\"crayon-v\">y</span><span class=\"crayon-o\">=</span><span class=\"crayon-cn\">1</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5994362e07b88119988991-7\"><span class=\"crayon-v\">r2</span><span class=\"crayon-o\">=</span><span class=\"crayon-v\">x</span><span class=\"crayon-sy\">;</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0007 seconds] -->\r\n\n</div>\n<p>上面代码有可能发生r1=r2=0的情况。<br>\n<strong>CPU动态调度</strong>：在执行程序的时候，为了提高效率有可能交换指令的顺序。<br>\n编译器在进行优化的时候，也可能为了效率交换两个毫不相干的相邻指令的执行顺序。<br>\n上面代码执行顺序可能是这样：</p>\n<div>\n<!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-5994362e07b8b361357631\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-always\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"复制代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\nx=y=0;\r\n[Thread1]\r\nr1=y;\r\nx=1;\r\n[Thread2]\r\ny=1;\r\nr2=x;</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5994362e07b8b361357631-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5994362e07b8b361357631-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5994362e07b8b361357631-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5994362e07b8b361357631-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-5994362e07b8b361357631-5\">5</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5994362e07b8b361357631-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-5994362e07b8b361357631-7\">7</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5994362e07b8b361357631-1\"><span class=\"crayon-v\">x</span><span class=\"crayon-o\">=</span><span class=\"crayon-v\">y</span><span class=\"crayon-o\">=</span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5994362e07b8b361357631-2\"><span class=\"crayon-sy\">[</span><span class=\"crayon-v\">Thread1</span><span class=\"crayon-sy\">]</span></div><div class=\"crayon-line\" id=\"crayon-5994362e07b8b361357631-3\"><span class=\"crayon-v\">r1</span><span class=\"crayon-o\">=</span><span class=\"crayon-v\">y</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5994362e07b8b361357631-4\"><span class=\"crayon-v\">x</span><span class=\"crayon-o\">=</span><span class=\"crayon-cn\">1</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5994362e07b8b361357631-5\"><span class=\"crayon-sy\">[</span><span class=\"crayon-v\">Thread2</span><span class=\"crayon-sy\">]</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5994362e07b8b361357631-6\"><span class=\"crayon-v\">y</span><span class=\"crayon-o\">=</span><span class=\"crayon-cn\">1</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5994362e07b8b361357631-7\"><span class=\"crayon-v\">r2</span><span class=\"crayon-o\">=</span><span class=\"crayon-v\">x</span><span class=\"crayon-sy\">;</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0008 seconds] -->\r\n\n</div>\n<p>使用volatile关键字可以阻止过度优化，colatile可以做两件事情：</p>\n<ul>\n<li>阻止编译器为了提高速度将一个变量缓存到寄存器内而不写回</li>\n<li>阻止编译器调整操作volatile变量的指令顺序</li>\n</ul>\n<p>但volatile无法阻止CPU动态调度换序<br>\nC++中，单例模式。</p>\n<div>\n<!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-5994362e07b8f845510437\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-always\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"复制代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div><span class=\"crayon-language\">C++</span></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\nvolatile T * pInst = 0;\r\nT * GetInstance() \r\n{\r\n    if (pInst == NULL) \r\n    {\r\n        LOCK();\r\n        if (pInst == NULL)\r\n            pInst = new T;\r\n        unlock();\r\n    }\r\n    return pInst;\r\n}</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5994362e07b8f845510437-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5994362e07b8f845510437-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5994362e07b8f845510437-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5994362e07b8f845510437-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-5994362e07b8f845510437-5\">5</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5994362e07b8f845510437-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-5994362e07b8f845510437-7\">7</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5994362e07b8f845510437-8\">8</div><div class=\"crayon-num\" data-line=\"crayon-5994362e07b8f845510437-9\">9</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5994362e07b8f845510437-10\">10</div><div class=\"crayon-num\" data-line=\"crayon-5994362e07b8f845510437-11\">11</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5994362e07b8f845510437-12\">12</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5994362e07b8f845510437-1\"><span class=\"crayon-m\">volatile</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">T</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">*</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">pInst</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5994362e07b8f845510437-2\"><span class=\"crayon-v\">T</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">*</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">GetInstance</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span></div><div class=\"crayon-line\" id=\"crayon-5994362e07b8f845510437-3\"><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5994362e07b8f845510437-4\"><span class=\"crayon-h\">    </span><span class=\"crayon-st\">if</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">pInst</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">==</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">NULL</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span></div><div class=\"crayon-line\" id=\"crayon-5994362e07b8f845510437-5\"><span class=\"crayon-h\">    </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5994362e07b8f845510437-6\"><span class=\"crayon-h\">        </span><span class=\"crayon-e\">LOCK</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5994362e07b8f845510437-7\"><span class=\"crayon-h\">        </span><span class=\"crayon-st\">if</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">pInst</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">==</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">NULL</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5994362e07b8f845510437-8\"><span class=\"crayon-h\">            </span><span class=\"crayon-v\">pInst</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-r\">new</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">T</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5994362e07b8f845510437-9\"><span class=\"crayon-h\">        </span><span class=\"crayon-e\">unlock</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5994362e07b8f845510437-10\"><span class=\"crayon-h\">    </span><span class=\"crayon-sy\">}</span></div><div class=\"crayon-line\" id=\"crayon-5994362e07b8f845510437-11\"><span class=\"crayon-h\">    </span><span class=\"crayon-st\">return</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">pInst</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5994362e07b8f845510437-12\"><span class=\"crayon-sy\">}</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0017 seconds] -->\r\n\n</div>\n<p>CPU的乱序执行可能会对上面代码照成影响<br>\nC++里的new包含两个步骤：</p>\n<ul>\n<li>分配内存</li>\n<li>调用构造函数</li>\n</ul>\n<p>所以pInst=new T包含三个步骤：</p>\n<ul>\n<li>分配内存</li>\n<li>在内存的位置上调用构造函数</li>\n<li>将内存的地址赋值给pInst</li>\n</ul>\n<p>这三步中2和3的步骤可以颠倒，可能出现这种情况：pInst中的值不是NULL，但对象还是没有构造完成。<br>\n要阻止CPU换序，可以调用一条指令，这条指令常常被称为barrier：它会阻止CPU将该指令之前的指令交换到barrier之后。<br>\n许多体系的CPU都提供了barrier指令，不过，它们的名称各不相同。例如POWERPC提供的指令就叫做lwsync。所以我们可以这样保证线程安全：</p>\n<div>\n<!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-5994362e07b93655354446\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-always\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"复制代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div><span class=\"crayon-language\">C++</span></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\n#define barrier() __asm__ volatile(\"lwsync\")\r\nvolatile T * pInst = 0;\r\nT * GetInstance()\r\n{\r\n    if (pInst == NULL) \r\n    {\r\n        LOCK();\r\n        if (pInst == NULL) \r\n        {\r\n            T * temp = new T;\r\n            barrier();\r\n            pInst = temp;\r\n        }\r\n        unlock();\r\n    }\r\n    return pInst;\r\n}</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5994362e07b93655354446-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5994362e07b93655354446-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5994362e07b93655354446-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5994362e07b93655354446-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-5994362e07b93655354446-5\">5</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5994362e07b93655354446-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-5994362e07b93655354446-7\">7</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5994362e07b93655354446-8\">8</div><div class=\"crayon-num\" data-line=\"crayon-5994362e07b93655354446-9\">9</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5994362e07b93655354446-10\">10</div><div class=\"crayon-num\" data-line=\"crayon-5994362e07b93655354446-11\">11</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5994362e07b93655354446-12\">12</div><div class=\"crayon-num\" data-line=\"crayon-5994362e07b93655354446-13\">13</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5994362e07b93655354446-14\">14</div><div class=\"crayon-num\" data-line=\"crayon-5994362e07b93655354446-15\">15</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5994362e07b93655354446-16\">16</div><div class=\"crayon-num\" data-line=\"crayon-5994362e07b93655354446-17\">17</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5994362e07b93655354446-1\"><span class=\"crayon-p\">#define barrier() __asm__ volatile(\"lwsync\")</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5994362e07b93655354446-2\"><span class=\"crayon-m\">volatile</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">T</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">*</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">pInst</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5994362e07b93655354446-3\"><span class=\"crayon-v\">T</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">*</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">GetInstance</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5994362e07b93655354446-4\"><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-5994362e07b93655354446-5\"><span class=\"crayon-h\">    </span><span class=\"crayon-st\">if</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">pInst</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">==</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">NULL</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5994362e07b93655354446-6\"><span class=\"crayon-h\">    </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-5994362e07b93655354446-7\"><span class=\"crayon-h\">        </span><span class=\"crayon-e\">LOCK</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5994362e07b93655354446-8\"><span class=\"crayon-h\">        </span><span class=\"crayon-st\">if</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">pInst</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">==</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">NULL</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span></div><div class=\"crayon-line\" id=\"crayon-5994362e07b93655354446-9\"><span class=\"crayon-h\">        </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5994362e07b93655354446-10\"><span class=\"crayon-h\">            </span><span class=\"crayon-v\">T</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">*</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">temp</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-r\">new</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">T</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5994362e07b93655354446-11\"><span class=\"crayon-h\">            </span><span class=\"crayon-e\">barrier</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5994362e07b93655354446-12\"><span class=\"crayon-h\">            </span><span class=\"crayon-v\">pInst</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">temp</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5994362e07b93655354446-13\"><span class=\"crayon-h\">        </span><span class=\"crayon-sy\">}</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5994362e07b93655354446-14\"><span class=\"crayon-h\">        </span><span class=\"crayon-e\">unlock</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5994362e07b93655354446-15\"><span class=\"crayon-h\">    </span><span class=\"crayon-sy\">}</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5994362e07b93655354446-16\"><span class=\"crayon-h\">    </span><span class=\"crayon-st\">return</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">pInst</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5994362e07b93655354446-17\"><span class=\"crayon-sy\">}</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0020 seconds] -->\r\n\n</div>\n<h3>1.6.3多线程的内部情况</h3>\n<p>线程的并发执行是由多处理器或操作系统调度来实现的。windows和linux都在内核中提供线程支持，有多处理器或调度来实现并发。用户实际使用线程并不是内核线程，而是存在于用户态的用户线程。用户线程并不一定在操作系统内核里对应同等数量的内核线程。对用户来说，如果有三个线程同时执行，可能在内核中只有一个线程。</p>\n<h5><a name=\"%E4%B8%80%E5%AF%B9%E4%B8%80%E6%A8%A1%E5%9E%8B\"></a>一对一模型</h5>\n<p>对于直接支持线程的系统，一对一模型始终是最为简单的模型。一个用户使用的线程就唯一对应一个内核使用的线程，但返回来，一个内核里面的线程在用户态不一定有对应的线程存在。</p>\n<p><img src=\"http://jbcdn2.b0.upaiyun.com/2017/08/a5b98d84c57ecfa88795e674e4a711ec.png\" alt=\"\"></p>\n<p>对于一对一模型，线程之间的并发是真正的并发，一个线程因为某个原因阻塞，并不会影响到其他线程。一对一模型也可以让多线程程序在多处理器的系统上有更好的表现。<br>\n一般直接使用API或者系统调用创建的线程均为一对一线程。<br>\n一对一线程的两个缺点：</p>\n<ul>\n<li>由于许多操作系统限制了内核线程数量，因此一对一线程会让用户的线程数量受到限制。</li>\n<li>许多操作系统内核线程调度是，上下文切换的开销较大，导致用户线程的执行效率下降。</li>\n</ul>\n<h5><a name=\"%E5%A4%9A%E5%AF%B9%E4%B8%80%E6%A8%A1%E5%9E%8B\"></a>多对一模型</h5>\n<p>多对一模型将多个用户线程映射到一个内核线程上，线程之间的切换由用户态的代码来进行，相对于一对一模型，多对一模型的线程切换要快速许多。</p>\n<p><img src=\"http://jbcdn2.b0.upaiyun.com/2017/08/4a464ae600296b61c454403e9cab160b.png\" alt=\"\"></p>\n<p>多对一模型的问题就是如果一个用户线程阻塞了，那么所有的线程都将无法执行。在多处理系统上，处理器的增多对多对一模型的线程性能不会有明显帮助。多对一模型得到的好处是高效的上下文切换和几乎无限制的线程数量。</p>\n<h5><a name=\"%E5%A4%9A%E5%AF%B9%E5%A4%9A%E6%A8%A1%E5%9E%8B\"></a>多对多模型</h5>\n<p>多对多模型结合了多对一和一对一的特点，将多个用户线程映射到少数但不止一个内核线程上。</p>\n<p><img src=\"http://jbcdn2.b0.upaiyun.com/2017/08/88cf46ce05bf777caef1b92def4dca9d.png\" alt=\"\"></p>\n<p>一个用户线程阻塞并不会使得所有的用户线程阻塞。并且对用户线程数量也没有什么限制，在多处理器系统上，多对多模型的线程也能得到一定的性能提升，不过提升的幅度没有一对一模型高。</p>\n\r\n        \r\n        \r\n        \n    <div class=\"post-adds\">\n        <span data-post-id=\"112161\" class=\" btn-bluet-bigger href-style vote-post-up   register-user-only \"><i class=\"fa  fa-thumbs-o-up\"></i> <h10 id=\"112161votetotal\">1</h10> 赞</span>\n        <span data-book-type=\"1\" data-site-id=\"2\" data-item-id=\"112161\" data-item-type=\"1\" class=\" btn-bluet-bigger href-style bookmark-btn  register-user-only \"><i class=\"fa fa-bookmark-o  \"></i> 5 收藏</span>\n\n                    <a href=\"#article-comment\"><span class=\"btn-bluet-bigger href-style hide-on-480\"><i class=\"fa fa-comments-o\"></i>  评论</span></a>\n        \n        \n        \n        <!-- JiaThis Button BEGIN -->\n        <div class=\"jiathis_style_24x24\" style=\"display: inline-flex; position: relative; margin: 0; clear: both;float: right;\">\n            <a class=\"jiathis_button_tsina\"></a>\n            <a class=\"jiathis_button_weixin\"></a>\n            <a class=\"jiathis_button_qzone\"></a>\n            <a class=\"jiathis_button_fb hide-on-480\"></a>\n            <a href=\"http://www.jiathis.com/share?uid=1745061\" class=\"jiathis jiathis_txt jiathis_separator jtico jtico_jiathis\" target=\"_blank\"></a>\n        </div>\n\n    </div>\n\n\n\n\r\n        <!-- BEGIN #author-bio -->\r\n\r\n\r\n<!-- END #author-bio -->\r\n\t</div>", "front_image_path": ["full/b019444f07f74231bdbf3445811ed2d3e5e85724.jpg"]}]